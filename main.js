/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');
var fs = require('fs');
var path = require('path');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function setPrototypeOf(obj, proto) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    if (Object.setPrototypeOf) {
        Object.setPrototypeOf(obj, proto);
    }
    else {
        obj.__proto__ = proto;
    }
}
// This is pretty much the only way to get nice, extended Errors
// without using ES6
/**
 * This returns a new Error with a custom prototype. Note that it's _not_ a constructor
 *
 * @param message Error message
 *
 * **Example**
 *
 * ```js
 * throw EtaErr("template not found")
 * ```
 */
function EtaErr(message) {
    var err = new Error(message);
    setPrototypeOf(err, EtaErr.prototype);
    return err;
}
EtaErr.prototype = Object.create(Error.prototype, {
    name: { value: 'Eta Error', enumerable: false }
});
/**
 * Throws an EtaErr with a nicely formatted error and message showing where in the template the error occurred.
 */
function ParseErr(message, str, indx) {
    var whitespace = str.slice(0, indx).split(/\n/);
    var lineNo = whitespace.length;
    var colNo = whitespace[lineNo - 1].length + 1;
    message +=
        ' at line ' +
            lineNo +
            ' col ' +
            colNo +
            ':\n\n' +
            '  ' +
            str.split(/\n/)[lineNo - 1] +
            '\n' +
            '  ' +
            Array(colNo).join(' ') +
            '^';
    throw EtaErr(message);
}

/**
 * @returns The global Promise function
 */
var promiseImpl$1 = new Function('return this')().Promise;
/**
 * @returns A new AsyncFunction constuctor
 */
function getAsyncFunctionConstructor() {
    try {
        return new Function('return (async function(){}).constructor')();
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr("This environment doesn't support async/await");
        }
        else {
            throw e;
        }
    }
}
/**
 * str.trimLeft polyfill
 *
 * @param str - Input string
 * @returns The string with left whitespace removed
 *
 */
function trimLeft(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimLeft) {
        return str.trimLeft();
    }
    else {
        return str.replace(/^\s+/, '');
    }
}
/**
 * str.trimRight polyfill
 *
 * @param str - Input string
 * @returns The string with right whitespace removed
 *
 */
function trimRight(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimRight) {
        return str.trimRight();
    }
    else {
        return str.replace(/\s+$/, ''); // TODO: do we really need to replace BOM's?
    }
}

// TODO: allow '-' to trim up until newline. Use [^\S\n\r] instead of \s
/* END TYPES */
function hasOwnProp$1(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}
function copyProps$1(toObj, fromObj) {
    for (var key in fromObj) {
        if (hasOwnProp$1(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
/**
 * Takes a string within a template and trims it, based on the preceding tag's whitespace control and `config.autoTrim`
 */
function trimWS(str, config, wsLeft, wsRight) {
    var leftTrim;
    var rightTrim;
    if (Array.isArray(config.autoTrim)) {
        // kinda confusing
        // but _}} will trim the left side of the following string
        leftTrim = config.autoTrim[1];
        rightTrim = config.autoTrim[0];
    }
    else {
        leftTrim = rightTrim = config.autoTrim;
    }
    if (wsLeft || wsLeft === false) {
        leftTrim = wsLeft;
    }
    if (wsRight || wsRight === false) {
        rightTrim = wsRight;
    }
    if (!rightTrim && !leftTrim) {
        return str;
    }
    if (leftTrim === 'slurp' && rightTrim === 'slurp') {
        return str.trim();
    }
    if (leftTrim === '_' || leftTrim === 'slurp') {
        // console.log('trimming left' + leftTrim)
        // full slurp
        str = trimLeft(str);
    }
    else if (leftTrim === '-' || leftTrim === 'nl') {
        // nl trim
        str = str.replace(/^(?:\r\n|\n|\r)/, '');
    }
    if (rightTrim === '_' || rightTrim === 'slurp') {
        // full slurp
        str = trimRight(str);
    }
    else if (rightTrim === '-' || rightTrim === 'nl') {
        // nl trim
        str = str.replace(/(?:\r\n|\n|\r)$/, ''); // TODO: make sure this gets \r\n
    }
    return str;
}
/**
 * A map of special HTML characters to their XML-escaped equivalents
 */
var escMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
};
function replaceChar(s) {
    return escMap[s];
}
/**
 * XML-escapes an input value after converting it to a string
 *
 * @param str - Input value (usually a string)
 * @returns XML-escaped string
 */
function XMLEscape(str) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    // To deal with XSS. Based on Escape implementations of Mustache.JS and Marko, then customized.
    var newStr = String(str);
    if (/[&<>"']/.test(newStr)) {
        return newStr.replace(/[&<>"']/g, replaceChar);
    }
    else {
        return newStr;
    }
}

/* END TYPES */
var templateLitReg = /`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g;
var singleQuoteReg = /'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g;
var doubleQuoteReg = /"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;
/** Escape special regular expression characters inside a string */
function escapeRegExp(string) {
    // From MDN
    return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
}
function parse(str, config) {
    var buffer = [];
    var trimLeftOfNextStr = false;
    var lastIndex = 0;
    var parseOptions = config.parse;
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processTemplate) {
                str = plugin.processTemplate(str, config);
            }
        }
    }
    /* Adding for EJS compatibility */
    if (config.rmWhitespace) {
        // Code taken directly from EJS
        // Have to use two separate replaces here as `^` and `$` operators don't
        // work well with `\r` and empty lines don't work well with the `m` flag.
        // Essentially, this replaces the whitespace at the beginning and end of
        // each line and removes multiple newlines.
        str = str.replace(/[\r\n]+/g, '\n').replace(/^\s+|\s+$/gm, '');
    }
    /* End rmWhitespace option */
    templateLitReg.lastIndex = 0;
    singleQuoteReg.lastIndex = 0;
    doubleQuoteReg.lastIndex = 0;
    function pushString(strng, shouldTrimRightOfString) {
        if (strng) {
            // if string is truthy it must be of type 'string'
            strng = trimWS(strng, config, trimLeftOfNextStr, // this will only be false on the first str, the next ones will be null or undefined
            shouldTrimRightOfString);
            if (strng) {
                // replace \ with \\, ' with \'
                // we're going to convert all CRLF to LF so it doesn't take more than one replace
                strng = strng.replace(/\\|'/g, '\\$&').replace(/\r\n|\n|\r/g, '\\n');
                buffer.push(strng);
            }
        }
    }
    var prefixes = [parseOptions.exec, parseOptions.interpolate, parseOptions.raw].reduce(function (accumulator, prefix) {
        if (accumulator && prefix) {
            return accumulator + '|' + escapeRegExp(prefix);
        }
        else if (prefix) {
            // accumulator is falsy
            return escapeRegExp(prefix);
        }
        else {
            // prefix and accumulator are both falsy
            return accumulator;
        }
    }, '');
    var parseOpenReg = new RegExp('([^]*?)' + escapeRegExp(config.tags[0]) + '(-|_)?\\s*(' + prefixes + ')?\\s*', 'g');
    var parseCloseReg = new RegExp('\'|"|`|\\/\\*|(\\s*(-|_)?' + escapeRegExp(config.tags[1]) + ')', 'g');
    // TODO: benchmark having the \s* on either side vs using str.trim()
    var m;
    while ((m = parseOpenReg.exec(str))) {
        lastIndex = m[0].length + m.index;
        var precedingString = m[1];
        var wsLeft = m[2];
        var prefix = m[3] || ''; // by default either ~, =, or empty
        pushString(precedingString, wsLeft);
        parseCloseReg.lastIndex = lastIndex;
        var closeTag = void 0;
        var currentObj = false;
        while ((closeTag = parseCloseReg.exec(str))) {
            if (closeTag[1]) {
                var content = str.slice(lastIndex, closeTag.index);
                parseOpenReg.lastIndex = lastIndex = parseCloseReg.lastIndex;
                trimLeftOfNextStr = closeTag[2];
                var currentType = prefix === parseOptions.exec
                    ? 'e'
                    : prefix === parseOptions.raw
                        ? 'r'
                        : prefix === parseOptions.interpolate
                            ? 'i'
                            : '';
                currentObj = { t: currentType, val: content };
                break;
            }
            else {
                var char = closeTag[0];
                if (char === '/*') {
                    var commentCloseInd = str.indexOf('*/', parseCloseReg.lastIndex);
                    if (commentCloseInd === -1) {
                        ParseErr('unclosed comment', str, closeTag.index);
                    }
                    parseCloseReg.lastIndex = commentCloseInd;
                }
                else if (char === "'") {
                    singleQuoteReg.lastIndex = closeTag.index;
                    var singleQuoteMatch = singleQuoteReg.exec(str);
                    if (singleQuoteMatch) {
                        parseCloseReg.lastIndex = singleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '"') {
                    doubleQuoteReg.lastIndex = closeTag.index;
                    var doubleQuoteMatch = doubleQuoteReg.exec(str);
                    if (doubleQuoteMatch) {
                        parseCloseReg.lastIndex = doubleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '`') {
                    templateLitReg.lastIndex = closeTag.index;
                    var templateLitMatch = templateLitReg.exec(str);
                    if (templateLitMatch) {
                        parseCloseReg.lastIndex = templateLitReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
            }
        }
        if (currentObj) {
            buffer.push(currentObj);
        }
        else {
            ParseErr('unclosed tag', str, m.index + precedingString.length);
        }
    }
    pushString(str.slice(lastIndex, str.length), false);
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processAST) {
                buffer = plugin.processAST(buffer, config);
            }
        }
    }
    return buffer;
}

/* END TYPES */
/**
 * Compiles a template string to a function string. Most often users just use `compile()`, which calls `compileToString` and creates a new function using the result
 *
 * **Example**
 *
 * ```js
 * compileToString("Hi <%= it.user %>", eta.config)
 * // "var tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR"
 * ```
 */
function compileToString(str, config) {
    var buffer = parse(str, config);
    var res = "var tR='',__l,__lP" +
        (config.include ? ',include=E.include.bind(E)' : '') +
        (config.includeFile ? ',includeFile=E.includeFile.bind(E)' : '') +
        '\nfunction layout(p,d){__l=p;__lP=d}\n' +
        (config.useWith ? 'with(' + config.varName + '||{}){' : '') +
        compileScope(buffer, config) +
        (config.includeFile
            ? 'if(__l)tR=' +
                (config.async ? 'await ' : '') +
                ("includeFile(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
            : config.include
                ? 'if(__l)tR=' +
                    (config.async ? 'await ' : '') +
                    ("include(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
                : '') +
        'if(cb){cb(null,tR)} return tR' +
        (config.useWith ? '}' : '');
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processFnString) {
                res = plugin.processFnString(res, config);
            }
        }
    }
    return res;
}
/**
 * Loops through the AST generated by `parse` and transform each item into JS calls
 *
 * **Example**
 *
 * ```js
 * // AST version of 'Hi <%= it.user %>'
 * let templateAST = ['Hi ', { val: 'it.user', t: 'i' }]
 * compileScope(templateAST, eta.config)
 * // "tR+='Hi ';tR+=E.e(it.user);"
 * ```
 */
function compileScope(buff, config) {
    var i = 0;
    var buffLength = buff.length;
    var returnStr = '';
    for (i; i < buffLength; i++) {
        var currentBlock = buff[i];
        if (typeof currentBlock === 'string') {
            var str = currentBlock;
            // we know string exists
            returnStr += "tR+='" + str + "'\n";
        }
        else {
            var type = currentBlock.t; // ~, s, !, ?, r
            var content = currentBlock.val || '';
            if (type === 'r') {
                // raw
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
            }
            else if (type === 'i') {
                // interpolate
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                if (config.autoEscape) {
                    content = 'E.e(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
                // reference
            }
            else if (type === 'e') {
                // execute
                returnStr += content + '\n'; // you need a \n in case you have <% } %>
            }
        }
    }
    return returnStr;
}

/**
 * Handles storage and accessing of values
 *
 * In this case, we use it to store compiled template functions
 * Indexed by their `name` or `filename`
 */
var Cacher$1 = /** @class */ (function () {
    function Cacher(cache) {
        this.cache = cache;
    }
    Cacher.prototype.define = function (key, val) {
        this.cache[key] = val;
    };
    Cacher.prototype.get = function (key) {
        // string | array.
        // TODO: allow array of keys to look down
        // TODO: create plugin to allow referencing helpers, filters with dot notation
        return this.cache[key];
    };
    Cacher.prototype.remove = function (key) {
        delete this.cache[key];
    };
    Cacher.prototype.reset = function () {
        this.cache = {};
    };
    Cacher.prototype.load = function (cacheObj) {
        copyProps$1(this.cache, cacheObj);
    };
    return Cacher;
}());

/* END TYPES */
/**
 * Eta's template storage
 *
 * Stores partials and cached templates
 */
var templates = new Cacher$1({});

/* END TYPES */
/**
 * Include a template based on its name (or filepath, if it's already been cached).
 *
 * Called like `include(templateNameOrPath, data)`
 */
function includeHelper(templateNameOrPath, data) {
    var template = this.templates.get(templateNameOrPath);
    if (!template) {
        throw EtaErr('Could not fetch template "' + templateNameOrPath + '"');
    }
    return template(data, this);
}
/** Eta's base (global) configuration */
var config = {
    async: false,
    autoEscape: true,
    autoTrim: [false, 'nl'],
    cache: false,
    e: XMLEscape,
    include: includeHelper,
    parse: {
        exec: '',
        interpolate: '=',
        raw: '~'
    },
    plugins: [],
    rmWhitespace: false,
    tags: ['<%', '%>'],
    templates: templates,
    useWith: false,
    varName: 'it'
};
/**
 * Takes one or two partial (not necessarily complete) configuration objects, merges them 1 layer deep into eta.config, and returns the result
 *
 * @param override Partial configuration object
 * @param baseConfig Partial configuration object to merge before `override`
 *
 * **Example**
 *
 * ```js
 * let customConfig = getConfig({tags: ['!#', '#!']})
 * ```
 */
function getConfig(override, baseConfig) {
    // TODO: run more tests on this
    var res = {}; // Linked
    copyProps$1(res, config); // Creates deep clone of eta.config, 1 layer deep
    if (baseConfig) {
        copyProps$1(res, baseConfig);
    }
    if (override) {
        copyProps$1(res, override);
    }
    return res;
}

/* END TYPES */
/**
 * Takes a template string and returns a template function that can be called with (data, config, [cb])
 *
 * @param str - The template string
 * @param config - A custom configuration object (optional)
 *
 * **Example**
 *
 * ```js
 * let compiledFn = eta.compile("Hi <%= it.user %>")
 * // function anonymous()
 * let compiledFnStr = compiledFn.toString()
 * // "function anonymous(it,E,cb\n) {\nvar tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR\n}"
 * ```
 */
function compile(str, config) {
    var options = getConfig(config || {});
    /* ASYNC HANDLING */
    // The below code is modified from mde/ejs. All credit should go to them.
    var ctor = options.async ? getAsyncFunctionConstructor() : Function;
    /* END ASYNC HANDLING */
    try {
        return new ctor(options.varName, 'E', // EtaConfig
        'cb', // optional callback
        compileToString(str, options)); // eslint-disable-line no-new-func
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr('Bad template syntax\n\n' +
                e.message +
                '\n' +
                Array(e.message.length + 1).join('=') +
                '\n' +
                compileToString(str, options) +
                '\n' // This will put an extra newline before the callstack for extra readability
            );
        }
        else {
            throw e;
        }
    }
}

var _BOM = /^\uFEFF/;
/* END TYPES */
/**
 * Get the path to the included file from the parent file path and the
 * specified path.
 *
 * If `name` does not have an extension, it will default to `.eta`
 *
 * @param name specified path
 * @param parentfile parent file path
 * @param isDirectory whether parentfile is a directory
 * @return absolute path to template
 */
function getWholeFilePath(name, parentfile, isDirectory) {
    var includePath = path.resolve(isDirectory ? parentfile : path.dirname(parentfile), // returns directory the parent file is in
    name // file
    ) + (path.extname(name) ? '' : '.eta');
    return includePath;
}
/**
 * Get the absolute path to an included template
 *
 * If this is called with an absolute path (for example, starting with '/' or 'C:\')
 * then Eta will attempt to resolve the absolute path within options.views. If it cannot,
 * Eta will fallback to options.root or '/'
 *
 * If this is called with a relative path, Eta will:
 * - Look relative to the current template (if the current template has the `filename` property)
 * - Look inside each directory in options.views
 *
 * Note: if Eta is unable to find a template using path and options, it will throw an error.
 *
 * @param path    specified path
 * @param options compilation options
 * @return absolute path to template
 */
function getPath(path, options) {
    var includePath = false;
    var views = options.views;
    var searchedPaths = [];
    // If these four values are the same,
    // getPath() will return the same result every time.
    // We can cache the result to avoid expensive
    // file operations.
    var pathOptions = JSON.stringify({
        filename: options.filename,
        path: path,
        root: options.root,
        views: options.views
    });
    if (options.cache && options.filepathCache && options.filepathCache[pathOptions]) {
        // Use the cached filepath
        return options.filepathCache[pathOptions];
    }
    /** Add a filepath to the list of paths we've checked for a template */
    function addPathToSearched(pathSearched) {
        if (!searchedPaths.includes(pathSearched)) {
            searchedPaths.push(pathSearched);
        }
    }
    /**
     * Take a filepath (like 'partials/mypartial.eta'). Attempt to find the template file inside `views`;
     * return the resulting template file path, or `false` to indicate that the template was not found.
     *
     * @param views the filepath that holds templates, or an array of filepaths that hold templates
     * @param path the path to the template
     */
    function searchViews(views, path) {
        var filePath;
        // If views is an array, then loop through each directory
        // And attempt to find the template
        if (Array.isArray(views) &&
            views.some(function (v) {
                filePath = getWholeFilePath(path, v, true);
                addPathToSearched(filePath);
                return fs.existsSync(filePath);
            })) {
            // If the above returned true, we know that the filePath was just set to a path
            // That exists (Array.some() returns as soon as it finds a valid element)
            return filePath;
        }
        else if (typeof views === 'string') {
            // Search for the file if views is a single directory
            filePath = getWholeFilePath(path, views, true);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                return filePath;
            }
        }
        // Unable to find a file
        return false;
    }
    // Path starts with '/', 'C:\', etc.
    var match = /^[A-Za-z]+:\\|^\//.exec(path);
    // Absolute path, like /partials/partial.eta
    if (match && match.length) {
        // We have to trim the beginning '/' off the path, or else
        // path.resolve(dir, path) will always resolve to just path
        var formattedPath = path.replace(/^\/*/, '');
        // First, try to resolve the path within options.views
        includePath = searchViews(views, formattedPath);
        if (!includePath) {
            // If that fails, searchViews will return false. Try to find the path
            // inside options.root (by default '/', the base of the filesystem)
            var pathFromRoot = getWholeFilePath(formattedPath, options.root || '/', true);
            addPathToSearched(pathFromRoot);
            includePath = pathFromRoot;
        }
    }
    else {
        // Relative paths
        // Look relative to a passed filename first
        if (options.filename) {
            var filePath = getWholeFilePath(path, options.filename);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                includePath = filePath;
            }
        }
        // Then look for the template in options.views
        if (!includePath) {
            includePath = searchViews(views, path);
        }
        if (!includePath) {
            throw EtaErr('Could not find the template "' + path + '". Paths tried: ' + searchedPaths);
        }
    }
    // If caching and filepathCache are enabled,
    // cache the input & output of this function.
    if (options.cache && options.filepathCache) {
        options.filepathCache[pathOptions] = includePath;
    }
    return includePath;
}
/**
 * Reads a file synchronously
 */
function readFile(filePath) {
    try {
        return fs.readFileSync(filePath).toString().replace(_BOM, ''); // TODO: is replacing BOM's necessary?
    }
    catch (_a) {
        throw EtaErr("Failed to read template at '" + filePath + "'");
    }
}

// express is set like: app.engine('html', require('eta').renderFile)
/* END TYPES */
/**
 * Reads a template, compiles it into a function, caches it if caching isn't disabled, returns the function
 *
 * @param filePath Absolute path to template file
 * @param options Eta configuration overrides
 * @param noCache Optionally, make Eta not cache the template
 */
function loadFile(filePath, options, noCache) {
    var config = getConfig(options);
    var template = readFile(filePath);
    try {
        var compiledTemplate = compile(template, config);
        if (!noCache) {
            config.templates.define(config.filename, compiledTemplate);
        }
        return compiledTemplate;
    }
    catch (e) {
        throw EtaErr('Loading file: ' + filePath + ' failed:\n\n' + e.message);
    }
}
/**
 * Get the template from a string or a file, either compiled on-the-fly or
 * read from cache (if enabled), and cache the template if needed.
 *
 * If `options.cache` is true, this function reads the file from
 * `options.filename` so it must be set prior to calling this function.
 *
 * @param options   compilation options
 * @return Eta template function
 */
function handleCache(options) {
    var filename = options.filename;
    if (options.cache) {
        var func = options.templates.get(filename);
        if (func) {
            return func;
        }
        return loadFile(filename, options);
    }
    // Caching is disabled, so pass noCache = true
    return loadFile(filename, options, true);
}
/**
 * Get the template function.
 *
 * If `options.cache` is `true`, then the template is cached.
 *
 * This returns a template function and the config object with which that template function should be called.
 *
 * @remarks
 *
 * It's important that this returns a config object with `filename` set.
 * Otherwise, the included file would not be able to use relative paths
 *
 * @param path path for the specified file (if relative, specify `views` on `options`)
 * @param options compilation options
 * @return [Eta template function, new config object]
 */
function includeFile(path, options) {
    // the below creates a new options object, using the parent filepath of the old options object and the path
    var newFileOptions = getConfig({ filename: getPath(path, options) }, options);
    // TODO: make sure properties are currectly copied over
    return [handleCache(newFileOptions), newFileOptions];
}

/* END TYPES */
/**
 * Called with `includeFile(path, data)`
 */
function includeFileHelper(path, data) {
    var templateAndConfig = includeFile(path, this);
    return templateAndConfig[0](data, templateAndConfig[1]);
}

/* END TYPES */
function handleCache$1(template, options) {
    if (options.cache && options.name && options.templates.get(options.name)) {
        return options.templates.get(options.name);
    }
    var templateFunc = typeof template === 'function' ? template : compile(template, options);
    // Note that we don't have to check if it already exists in the cache;
    // it would have returned earlier if it had
    if (options.cache && options.name) {
        options.templates.define(options.name, templateFunc);
    }
    return templateFunc;
}
/**
 * Render a template
 *
 * If `template` is a string, Eta will compile it to a function and then call it with the provided data.
 * If `template` is a template function, Eta will call it with the provided data.
 *
 * If `config.async` is `false`, Eta will return the rendered template.
 *
 * If `config.async` is `true` and there's a callback function, Eta will call the callback with `(err, renderedTemplate)`.
 * If `config.async` is `true` and there's not a callback function, Eta will return a Promise that resolves to the rendered template.
 *
 * If `config.cache` is `true` and `config` has a `name` or `filename` property, Eta will cache the template on the first render and use the cached template for all subsequent renders.
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function render(template, data, config, cb) {
    var options = getConfig(config || {});
    if (options.async) {
        if (cb) {
            // If user passes callback
            try {
                // Note: if there is an error while rendering the template,
                // It will bubble up and be caught here
                var templateFn = handleCache$1(template, options);
                templateFn(data, options, cb);
            }
            catch (err) {
                return cb(err);
            }
        }
        else {
            // No callback, try returning a promise
            if (typeof promiseImpl$1 === 'function') {
                return new promiseImpl$1(function (resolve, reject) {
                    try {
                        resolve(handleCache$1(template, options)(data, options));
                    }
                    catch (err) {
                        reject(err);
                    }
                });
            }
            else {
                throw EtaErr("Please provide a callback function, this env doesn't support Promises");
            }
        }
    }
    else {
        return handleCache$1(template, options)(data, options);
    }
}
/**
 * Render a template asynchronously
 *
 * If `template` is a string, Eta will compile it to a function and call it with the provided data.
 * If `template` is a function, Eta will call it with the provided data.
 *
 * If there is a callback function, Eta will call it with `(err, renderedTemplate)`.
 * If there is not a callback function, Eta will return a Promise that resolves to the rendered template
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function renderAsync(template, data, config, cb) {
    // Using Object.assign to lower bundle size, using spread operator makes it larger because of typescript injected polyfills
    return render(template, data, Object.assign({}, config, { async: true }), cb);
}

// @denoify-ignore
config.includeFile = includeFileHelper;
config.filepathCache = {};

const VAR_NAME = 'sk';
const EBAR = `\n---------------------------\n`;

Element.prototype.addClazz = function (str) {
    if (Array.isArray(str)) {
        this.addClass(...str);
    }
    else
        this.addClass(str);
};
function getFiles(app, dir) {
    let dirPath = obsidian.normalizePath(dir);
    let fo = app.vault.getAbstractFileByPath(dirPath);
    // console.log(dirPath), console.log(fo);
    if (!fo || !(fo instanceof obsidian.TFolder))
        throw `Skribi: Could not find folder '${dirPath}'`;
    let files = [];
    obsidian.Vault.recurseChildren(fo, (fi) => {
        if (fi instanceof obsidian.TFile)
            files.push(fi);
    });
    return files;
}
function checkFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).every((f) => { return exts.contains(f.extension); });
}
function filterFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).filter((f) => { if (checkFileExt(f, exts))
        return f; });
}
function toArray(args) {
    return (Array.isArray(args) ? args : [args]);
}
function isInFolder(e, dir) {
    let boo = (obsidian.normalizePath((/.+\//g).exec(e.path)[0]) == obsidian.normalizePath(dir));
    return boo;
}
function isExtant(obj) {
    return !((obj === null) || (obj === undefined));
}
function roundTo(x, to) {
    return parseFloat(parseFloat(x).toPrecision(to !== null && to !== void 0 ? to : 4));
}
function getVerbosity() {
    var _a;
    //@ts-ignore
    return ((_a = window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings.verboseLogging) || false;
}
function vLog(...args) {
    if (getVerbosity()) {
        console.log("Skribi:", ...args);
    }
}
function dLog(...args) {
    var _a, _b;
    //@ts-ignore
    if (((_b = (_a = window === null || window === void 0 ? void 0 : window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.devLogging) || false) {
        console.log(...args);
    }
}
function toDupeRecord(arr) {
    return arr.reduce((a, i) => (Object.assign(Object.assign({}, a), { [i]: i })), {});
}
function withoutKey(input, key) {
    const clone = Object.assign({}, input);
    if (Array.isArray(key)) {
        key.forEach((k) => {
            delete clone[k];
        });
    }
    else {
        delete clone[key];
    }
    return clone;
}
Object.getPrototypeOf(function () {
    return __awaiter(this, void 0, void 0, function* () { });
}).constructor;
const promiseImpl = new Function('return this')().Promise;
const isFunc = (func) => (func instanceof Function);
const isFile = (item) => (item) instanceof obsidian.TFile;
const getAsyncConstructor = () => new Function('return (async function(){}).constructor')();

/** Adds the entries of scope to a function string.
* @param functionString A string function compiled by Eta's compileToString()
* @param keys Array of keys that the returned function will expect to be present in its scope argument
* @param async If true, returned function will be asynchronous */
function compileWith(functionString, keys, async) {
    var a = "";
    for (let k of keys) {
        a += `${k},`;
    }
    let func = `var {${a.substr(0, a.length - 1)}} = scope;\n` + functionString;
    let constructor = (async) ? getAsyncConstructor() : Function;
    let compiled = new constructor('scope', func);
    return compiled;
}
/* Version of Eta's render function, modified to handle scoped templates */
function renderEta(handler, template, data, config, cb, scope, binder) {
    const options = getConfig(config || {});
    if (options.async) {
        // if (cb) {
        // try { 
        // const templateFn = handler.getCached(template, options, scope, binder)
        // templateFn(scope)
        // } catch(e) {
        // return cb(e)
        // }
        // } else {
        // return (async () => handler.getCached(template, options, scope, binder)(scope))()
        return new promiseImpl(function (resolve, reject) {
            try {
                resolve(handler.getCached(template, options, scope, binder)(scope));
            }
            catch (e) {
                reject(e);
            }
        });
        // }
    }
    else {
        let func = handler.getCached(template, options, scope, binder);
        dLog(`Rendering function`, func);
        return func(scope);
    }
}
/* Version of Eta's async render function, just sets async to true */
/* Note: perf impact of using async templatefunctions is negligible */
function renderEtaAsync(handler, template, data, config, cb, scope, binder) {
    return renderEta(handler, template, data, Object.assign({}, config, { async: true }), cb, scope, binder);
}

class Provider {
    constructor(bus, id) {
        this.functions = new Map();
        this.initLoaded = false;
        this.isDirty = false;
        this.bus = bus;
        this.id = id;
    }
    createObject() {
        return Object.assign({}, Object.fromEntries(this.functions));
    }
    init() {
        this.initLoaded = true;
        return Promise.resolve();
    }
    unload() { }
    reload() {
        return Promise.resolve();
    }
    /**
     * @param clean If true, provider.isDirty = false */
    setDirty(dirty) {
        this.isDirty = isExtant(dirty) ? dirty : true;
        this.bus.providerNotificationDirty(this, this.isDirty);
    }
}
class ProviderPredicated extends Provider {
    constructor() {
        super(...arguments);
        this.predicatePluginName = '';
    }
    getPredicate() {
        var _a;
        return ((_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a[this.predicatePluginName]) || null;
    }
    /**
     * @returns true only when the predicate condition is met */
    predicateCheck() {
        return this.bus.plugin.app.plugins.enabledPlugins.has(this.predicatePluginName);
    }
    /**
     * @returns An error string describing the unmet predicate condition */
    predicateError() {
        return `Integration Module '${this.id}' not available, could not find required plugin: '${this.predicatePluginName}'`;
    }
}

class ProviderSK extends Provider {
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return _super.init.call(this);
        });
    }
    createObject() {
        return {
            render: function (str) {
                let e = createDiv({ cls: "skribi-render-virtual" });
                console.log(this);
                obsidian.MarkdownRenderer.renderMarkdown(str, e, this.this.file.path, null);
                return e.innerHTML;
            },
            has: function (v) {
                var _a, _b;
                return !((((_a = this.v) === null || _a === void 0 ? void 0 : _a[v]) == null) || (((_b = this.v) === null || _b === void 0 ? void 0 : _b[v]) == undefined));
            },
            abort: function (s) {
                let abortPacket = String.isString(s)
                    ? { hasData: true, flag: 'abort', hover: s }
                    : Object.assign({ hasData: true, flag: 'abort' }, s);
                throw abortPacket;
            },
        };
    }
}

class ProviderDataview extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'dataview';
        // createDynamic(state: DynamicState) {
        // let api = new DataviewInlineApi(this.dvp.index, state.child, state.el, this.bus.plugin.app, this.dvp.settings, state.file.path)
        // return this?.dvp?.api || null
        // }
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            // this.dvp = this.bus.plugin.app.plugins.plugins.dataview as DataviewPlugin || null
            this.eventRef_API_READY = this.bus.plugin.app.metadataCache.on('dataview:api-ready', (api) => { this.apiReady(); });
            return _super.init.call(this);
        });
    }
    unload() {
        this.bus.plugin.app.metadataCache.offref(this.eventRef_API_READY);
    }
    createObject() {
        var _a, _b;
        return ((_b = (_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a.dataview) === null || _b === void 0 ? void 0 : _b.api) || null;
    }
    apiReady() {
    }
}

class ProviderWeather extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'obsidian-weather';
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.eventRefs = {
                ready: this.bus.plugin.app.workspace.on("az-weather:api-ready", () => { }),
                unload: this.bus.plugin.app.workspace.on("az-weather:api-unload", () => { }),
                tick: this.bus.plugin.app.workspace.on("az-weather:api-tick", () => { })
            };
            this.functions.set("check", this.provide_predicate());
            this.functions.set("cache", this.provide_dispenseCache());
            this.functions.set("tickEventRef", this.provide_tickEventRef());
            return _super.init.call(this);
        });
    }
    unload() {
        for (let r of Object.values(this.eventRefs)) {
            this.bus.plugin.app.workspace.offref(r);
        }
    }
    /* Provisions */
    provide_predicate() {
        return () => {
            return (!!this.weatherAPI);
        };
    }
    provide_dispenseCache() {
        return () => {
            var _a;
            let p = this.getPredicate();
            return (_a = p === null || p === void 0 ? void 0 : p.API) === null || _a === void 0 ? void 0 : _a.dispenseCache.bind(p.API)();
        };
    }
    provide_tickEventRef() {
        return (cb) => {
            return this.bus.plugin.app.workspace.on("az-weather:api-tick", (...a) => cb(...a));
        };
    }
}

class ProviderScriptloader extends Provider {
    constructor() {
        super(...arguments);
        this.loadedModules = new Map();
    }
    get directory() { return this.bus.plugin.settings.scriptFolder; }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad().then(() => _super.init.call(this));
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.loadAndSet(...getFiles(this.bus.plugin.app, this.bus.plugin.settings.scriptFolder));
        });
    }
    loadAndSet(...file) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.readFiles(...file)
                .then((ret) => { /*vLog('Loading JS modules...', ret);*/ this.stashModule(ret); return Promise.resolve(); });
        });
    }
    stashModule(modules) {
        dLog('Scriptloader: stashModule', modules);
        modules.map((r) => {
            var _a, _b;
            if (r) {
                this.loadedModules.delete(r[0]);
                this.loadedModules.set(r[0], {
                    name: (String.isString((_b = (_a = r[1]) === null || _a === void 0 ? void 0 : _a._name) !== null && _b !== void 0 ? _b : null) ? r[1]._name : null),
                    properties: withoutKey(r[1], '_name')
                });
            }
        });
    }
    createObject() {
        let exports = new Map();
        this.loadedModules.forEach((value, key) => {
            var _a;
            let single = (Object.keys(value.properties).length == 1);
            exports.set(((_a = value.name) !== null && _a !== void 0 ? _a : (single ? Object.keys(value.properties)[0] : key)), single ? Object.values(value.properties)[0] : value.properties);
        });
        return Object.assign({}, Object.fromEntries(exports));
    }
    readFiles(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            let filtered = filterFileExt(files, "js");
            const reads = filtered.map((f) => __awaiter(this, void 0, void 0, function* () {
                try {
                    if (!(this.bus.plugin.app.vault.adapter instanceof obsidian.FileSystemAdapter))
                        return Promise.reject();
                    let path = this.bus.plugin.app.vault.adapter.getBasePath() + "/" + f.path;
                    let resPath = window.require.resolve(path);
                    if (Object.keys(window.require.cache).contains(resPath))
                        delete window.require.cache[window.require.resolve(resPath)];
                    const mod = require(path);
                    return (isExtant(mod))
                        ? Promise.resolve([f.basename, mod])
                        : Promise.reject();
                }
                catch (e) {
                    console.warn(e);
                    return Promise.reject();
                }
            }));
            return yield Promise.allSettled(reads)
                .then((settled) => {
                return settled
                    .filter((r) => { return r.status == "fulfilled"; })
                    .map((v) => { return v.value; });
            });
        });
    }
    clearJS(...items) {
        let names = items.map((item) => {
            if (isFile(item))
                return filterFileExt(item, 'js')[0].basename;
            else if (String.isString(item))
                return item;
        });
        for (let name of names)
            this.loadedModules.delete(name);
    }
    reload() {
        const _super = Object.create(null, {
            reload: { get: () => super.reload }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.loadedModules.clear();
            yield this.initLoad();
            return _super.reload.call(this);
        });
    }
    // Event listeners for file events registered by EtaHander
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in script directory modified, updating...`);
        this.clearJS(file);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from script directory, unloading...`);
        this.clearJS(file);
        this.setDirty();
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to script directory, loading...`);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Script file '${oldName}' renamed to '${file.name}', updating...`);
        this.clearJS(oldName);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => { });
    }
    directoryChanged() {
        vLog(`Script directory changed, reloading scripts...`);
        this.reload().then(() => this.setDirty(), (e) => { console.warn(e); });
    }
}

const obsidianModule = require("obsidian");
const MODULE_NAME_INTEGRATIONS = 'int';
/* Handles all script function providers */
class ProviderBus {
    constructor(handler) {
        this.providers = new Map();
        this.providersPredicated = new Map();
        this.scopeStatic = {};
        // Indicates that a provider has been added or removed, and the static scope should be regenerated.
        this.isStaticScopeDirty = false;
        /**
         * Integration point for other plugins to add a provider
         * @param provider Provider implementation to add */
        this.addProvider = (provider) => {
            this.providers.set(provider.id, provider);
            this.isStaticScopeDirty = true;
            this.handler.recompileTemplates();
        };
        /**
         * Integration point for other plugins to add a predicated provider
         * @param provider ProviderPredicated implementation to add */
        this.addProviderPredicated = (provider) => {
            this.providersPredicated.set(provider.id, provider);
        };
        this.handler = handler;
        this.plugin = handler.plugin;
        this.scriptLoader = new ProviderScriptloader(this, 'js'); // assigned here so that we can register file events in handler
    }
    /* Construct all providers but do not initialize them yet, so that we can compile and cache templates ASAP */
    preInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addTo(this.providers, this.scriptLoader);
            this.addTo(this.providersPredicated, new ProviderDataview(this, 'dv'));
            this.addTo(this.providersPredicated, new ProviderWeather(this, 'weather'));
            this.skBase = new ProviderSK(this, VAR_NAME);
            return Promise.resolve();
        });
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            const inits = Object.values(this.execOnProviders('init'));
            yield Promise.allSettled(inits);
            this.createStaticScope();
            return Promise.resolve();
        });
    }
    addTo(providers, provider) {
        providers.set(provider.id, provider);
    }
    unload() {
        this.execOnProviders('unload');
    }
    /* Invoked by providers to indicate their provision must be regenerated */
    providerNotificationDirty(provider, isDirty) {
        if (isDirty)
            this.refreshProvider(provider);
    }
    /* Clean dirty providers by regenerating their provision */
    refreshProvider(...providers) {
        let proxy = {};
        for (let provider of providers) {
            proxy[provider.id] = provider.createObject();
            provider.setDirty(false);
        }
        Object.assign(this.scopeStatic, proxy);
    }
    /* Reloads all providers */
    reloadProviders() {
        return __awaiter(this, void 0, void 0, function* () {
            let proms = this.execOnProviders('reload');
            return Promise.allSettled(Object.values(proms));
        });
    }
    getScopeKeys() {
        return [...this.providers.keys(), MODULE_NAME_INTEGRATIONS, 'moment', 'obsidian'];
    }
    /* Retrieves providers object */
    getScope(ctx, refresh) {
        let dirties = Object.values(this.providers).filter((p) => { return p.isDirty; });
        if (dirties)
            this.refreshProvider(...dirties);
        if (this.isStaticScopeDirty)
            this.createStaticScope();
        return Object.assign({}, this.scopeStatic, { [MODULE_NAME_INTEGRATIONS]: this.createPredicatedScope(ctx || null) });
    }
    /* Creates scope object. Should not be used to get the scope. */
    createStaticScope() {
        let spaces = {};
        for (let p of this.providers)
            spaces[p[0]] = p[1].createObject();
        spaces['moment'] = window.moment;
        spaces['obsidian'] = obsidianModule;
        this.scopeStatic = spaces;
        this.isStaticScopeDirty = false;
        return this.scopeStatic;
    }
    /* Predicated providers */
    createPredicatedScope(ctx) {
        let spaces = {};
        for (let p of this.providersPredicated) {
            Object.defineProperty(spaces, p[0], { get: function () {
                    if (p[1].predicateCheck())
                        return p[1].createObject();
                    else
                        throw new Error(p[1].predicateError());
                }
            });
        }
        return spaces;
    }
    /* Get the base provider scope */
    getScopeSK() {
        return this.skBase.createObject();
    }
    /* Invoke function on all providers and return array of results */
    execOnProviders(func) {
        let rets = {};
        const invoke = (providers) => {
            for (let p of providers)
                if ((p != null) && (isFunc(p[1][func]))) {
                    rets[p[0]] = p[1][func]();
                }
        };
        invoke(this.providers);
        invoke(this.providersPredicated);
        return rets;
    }
}

class Cacher {
    constructor(cache) {
        this.cache = cache;
    }
    define(key, val) { this.cache[key] = val; }
    get(key) { return this.cache[key]; }
    remove(key) { delete this.cache[key]; }
    reset() { this.cache = {}; }
    load(cacheObj) { copyProps(this.cache, cacheObj); }
}
function copyProps(toObj, fromObj) {
    for (const key in fromObj) {
        if (hasOwnProp(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
function hasOwnProp(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* Responsible for the caching and management of templates. */
class TemplateLoader {
    constructor(handler) {
        this.templateCache = new Cacher({});
        this.templateFailures = new Map();
        this.templateFrontmatters = new Map();
        this.handler = handler;
        this.plugin = handler.plugin;
    }
    get directory() { return this.plugin.settings.templateFolder; }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad();
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.definePartials(...getFiles(this.plugin.app, this.directory));
            this.plugin.loadEvents.trigger('init-load-complete'); //TODO: use native events?
            return Promise.resolve();
        });
    }
    /* Load and compile files into the template cache */
    definePartials(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            const startTime = window.performance.now();
            var failureCount = 0;
            var successCount = 0;
            const scopeKeys = this.handler.bus.getScopeKeys();
            const readPromises = files.map((file) => __awaiter(this, void 0, void 0, function* () {
                var _a, _b, _c;
                if (!checkFileExt(file, ["md", "eta", "txt"]))
                    return Promise.reject();
                let read = yield this.plugin.app.vault.cachedRead(file);
                let fileFrontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) === null || _a === void 0 ? void 0 : _a.frontmatter;
                if (fileFrontmatter) {
                    let fmSearch = (/(?<frontmatter>^---.*?(?=\n---)\n---)/s).exec(read);
                    let fmText = (_c = (_b = fmSearch === null || fmSearch === void 0 ? void 0 : fmSearch.groups) === null || _b === void 0 ? void 0 : _b.frontmatter) !== null && _c !== void 0 ? _c : null;
                    if (isExtant(fmText)) {
                        read = read.substr(fmText.length);
                    }
                }
                try {
                    let compiledString = compileToString(read, getConfig({ varName: VAR_NAME, name: file.basename }));
                    var compiled = compileWith(compiledString, [VAR_NAME, 'E', 'cb', ...scopeKeys]);
                }
                catch (err) {
                    this.templateFailures.set(file.basename, err || `Template failed to compile: Unknown Error`);
                    console.warn(`Skribi: template '${file.basename}' failed to compile`, EBAR, err, EBAR, read);
                    this.templateCache.remove(file.basename);
                    this.templateFrontmatters.delete(file.basename);
                    failureCount++;
                    return Promise.reject();
                }
                this.templateFailures.delete(file.basename);
                this.templateCache.define(file.basename, compiled);
                if (fileFrontmatter)
                    this.templateFrontmatters.set(file.basename, withoutKey(fileFrontmatter, 'position'));
                successCount++;
                return Promise.resolve();
            }));
            yield Promise.allSettled(readPromises);
            if ((!this.plugin.initLoaded) && files.length) {
                let str = `${successCount} template${(successCount == 1) ? '' : 's'}`;
                if (failureCount)
                    str += `\n Of ${files.length} total templates, ${failureCount} failed to compile.`;
                console.log(`Skribi: Loaded ` + str);
            }
            else if (this.plugin.initLoaded) {
                vLog(`Updated template '${files[0].basename}' in ${roundTo(window.performance.now() - startTime, 4)}ms`);
            }
            return Promise.resolve();
        });
    }
    /* Deletes cache entries by string name or file of origin */
    deletePartial(...items) {
        for (let item of items) {
            let name = isFile(item) ? item.basename : item;
            this.templateCache.remove(name);
        }
    }
    reload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.templateCache.reset();
            return this.definePartials(...getFiles(this.plugin.app, this.directory));
        });
    }
    /* These functions are registered to the appropriate events by handler */
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in template directory modified, updating...`);
        this.definePartials(file);
    }
    fileDeleted(file) {
        let isf = isFile(file);
        if ((!isf && !(String.isString(file) && this.templateCache.get(file))))
            return;
        vLog(`File '${isf ? file.name : file}' removed from template directory, unloading...`);
        this.deletePartial(file);
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to template directory, loading...`);
        this.definePartials(file);
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Template file '${oldName}' renamed to '${file.name}', updating...`);
        this.deletePartial(oldName);
        this.definePartials(file);
    }
    directoryChanged() {
        vLog(`Template directory changed, reloading templates...`);
        this.reload();
    }
}

class EtaHandler {
    constructor(plugin) {
        this.templatesDirty = false;
        this.baseContext = {};
        this.isInTemplates = (e) => isInFolder(e, this.plugin.settings.templateFolder);
        this.isInScripts = (e) => isInFolder(e, this.plugin.settings.scriptFolder);
        this.plugin = plugin;
        this.bus = new ProviderBus(this);
        this.loader = new TemplateLoader(this);
        if (!this.plugin.app.workspace.layoutReady)
            this.plugin.app.workspace.onLayoutReady(() => this.init.bind(this)());
        else
            this.init();
    }
    get templates() { return this.loader.templateCache; }
    get failedTemplates() { return this.loader.templateFailures; }
    get templateFrontmatters() { return this.loader.templateFrontmatters; }
    init() {
        this.initLoad().then(() => {
            this.plugin.registerEvent(this.plugin.app.vault.on('modify', e => {
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileUpdated(e);
                if (this.isInTemplates(e))
                    this.loader.fileUpdated(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('delete', e => {
                // console.log(e)
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileDeleted(e);
                if (this.isInTemplates(e))
                    this.loader.fileDeleted(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('create', e => {
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileAdded(e);
                if (this.isInTemplates(e))
                    this.loader.fileAdded(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('rename', (file, oldPath) => {
                for (let obj of [this.bus.scriptLoader, this.loader]) {
                    let ourDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath(obj.directory));
                    let oldDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath((/.+\//g).exec(oldPath)[0]));
                    // console.log(oldDir, ourDir)
                    if (file.parent == ourDir) {
                        // New location of file is in our directory
                        if (file.parent == oldDir) {
                            // File did not move but was renamed
                            obj.fileRenamed(file, (/([a-zA-Z0-9-_.]+\..*)/g).exec(oldPath)[0]);
                        }
                        else {
                            // File was moved from elsewhere into the template directory
                            obj.fileAdded(file);
                        }
                    }
                    else if (oldDir == ourDir) {
                        // File used to be in templates directory and is no longer
                        obj.fileDeleted(file);
                    }
                }
            }));
        }).catch((err) => {
            console.error(`Skribi: EtaHandler failed to initialize!`, EBAR, err);
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            let { a: a, b: b } = yield this.bus.preInit().then(() => {
                return { a: this.bus.init(), b: this.loader.init() };
            });
            return Promise.all([a, b]);
        });
    }
    unload() {
        this.bus.unload();
    }
    recompileTemplates() {
        // If the bus scope changes, the templates must be recompiled. 
        // The bus scope should not change post-init unless an external source modifies the provider list.
        this.loader.reload();
    }
    getPartial(id) {
        return this.loader.templateCache.get(id);
    }
    hasPartial(id) {
        return isExtant(this.loader.templateCache.get(id));
    }
    getCacheKeys() {
        //@ts-ignore
        return Object.keys(this.templates.cache);
    }
    /**
    * Primary skribi render function. Renders asynchronously (TemplateFunction may or may not be async)
    * @param content String or scoped template function to render
    * @param ctxIn Context object to be added to `sk` object
    * @param file File in which the skribi is being rendered
    * @returns [rendered string, returned packet (currently unused)] */
    renderAsync(content, ctxIn, file) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!isFile(file))
                return Promise.reject(`Could not identify current file: ${file}`);
            let z = {};
            function p() {
                return function (x, y) {
                    z[x] = y;
                };
            }
            let cfg = getConfig({ varName: VAR_NAME });
            /* the 'this' object of the sk context*/
            let binder = {
                file: file,
                plugin: this.plugin,
                app: this.plugin.app
            };
            /* The 'sk' object */
            let sk = Object.assign({}, this.baseContext, ctxIn || {}, { up: p(), this: binder }, this.bus.getScopeSK());
            /* scope of the tfunc env */
            let scope = Object.assign({ 'sk': sk, 'E': cfg, 'cb': null }, this.bus.getScope());
            let ren = (content.toString().contains('await')) // This will catch strings containing await as well, maybe a flag should be used instead
                ? renderEtaAsync(this, content, {}, cfg, null, scope, binder)
                : renderEta(this, content, {}, cfg, null, scope, binder);
            // console.log("psuedo post:", sk)
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve([r, z]); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve([ren, z]);
            }
            else
                return Promise.reject("EtaHandler.renderAsync: Unknown Error");
        });
    }
    /* this is somehow 1.3x slower than renderAsync */
    renderAsyncNaive(content, ctxIn, varName) {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribos: renderAsyncNaive invoked', content, ctxIn);
            let context = Object.assign({}, this.baseContext, ctxIn || {});
            let ren = renderAsync(content, context, { varName: varName !== null && varName !== void 0 ? varName : VAR_NAME });
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve(r); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve(ren);
            }
            else
                return Promise.reject("Unknown error");
        });
    }
    render(content, ctxIn) {
        let context = ctxIn || {};
        content = render(content, context, {
            varName: VAR_NAME
        });
        return content;
    }
    /** TemplateFunction handler, will return cached or compiled function, appropriately bound and scoped
     * @param template String or scoped template function
     * @param options EtaConfig
     * @param scope Object containing objects that should be available in the returned function's scope
     * @param binder Object to which the returned function will be bound */
    getCached(template, options, scope, binder) {
        if (options.name && this.templates.get(options.name)) {
            return (binder) ? this.templates.get(options.name).bind(binder) : this.templates.get(options.name);
        }
        const templateFunc = typeof template === 'function' ? template : compileWith(compileToString(template, options), Object.keys(scope), options.async);
        if (options.name)
            this.templates.define(options.name, templateFunc);
        return (binder) ? templateFunc.bind(binder) : templateFunc;
    }
}

class SkribosSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.saveSetting = obsidian.debounce((setting, value, cb, ...args) => __awaiter(this, void 0, void 0, function* () {
            // console.log("saving: " + setting + " = " + value)
            this.plugin.settings[setting] = value;
            this.plugin.saveSettings().then(() => { if (isExtant(cb) && isFunc(cb))
                cb(...args || null); });
        }), 2000, true);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.addClass("skribi-settings");
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Skribi Settings' });
        new obsidian.Setting(containerEl)
            .setName('Template Directory')
            .setDesc('Skribi will look for templates in this folder.')
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.templateFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.templateFolder = value;
                yield this.plugin.saveSettings();
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName('Skript Directory')
            .setDesc('Skribi will look for JS files in this folder.')
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.scriptFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.saveSetting('scriptFolder', value, () => this.plugin.eta.bus.scriptLoader.directoryChanged());
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName('Error Logging')
            .setDesc('Enable to dump any errored renders to the console.'
            + 'If false, will still add the error as tooltip on the errored element. \n'
            + 'Will spam your console if typing into a skribi with a preview window open.')
            .addToggle((toggle) => {
            toggle
                .setValue(this.plugin.settings.errorLogging)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.errorLogging = value;
                yield this.plugin.saveSettings();
            }));
        });
        new obsidian.Setting(containerEl)
            .setName('Verbose Logging')
            .setDesc('Enable to get more detailed logs in the console.')
            .addToggle((toggle) => {
            toggle
                .setValue(this.plugin.settings.verboseLogging)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.verboseLogging = value;
                yield this.plugin.saveSettings();
            }));
        });
    }
}
const DEFAULT_SETTINGS = {
    templateFolder: "",
    scriptFolder: "",
    verboseLogging: false,
    devLogging: false,
    errorLogging: false,
};

function renderError(el, e) {
    return __awaiter(this, void 0, void 0, function* () {
        if ((e === null || e === void 0 ? void 0 : e.flag) && e.flag == "abort") {
            renderRegent(el, Object.assign({}, {
                class: 'abort',
                label: 'sk',
                hover: 'Render Aborted'
            }, e));
        }
        else {
            renderRegent(el, { class: 'error', label: 'sk', hover: (e === null || e === void 0 ? void 0 : e.msg) || "Unknown Error", clear: true });
        }
    });
}
function renderWait(el) {
    const pre = createEl("code", { cls: "skribi-wait", text: "sk" });
    el.replaceWith(pre);
    return pre;
}
function renderState(el, dataIn) {
    return __awaiter(this, void 0, void 0, function* () {
        let data = Object.assign({
            class: "state",
            label: "sk",
            clear: false,
            hover: ""
        }, dataIn || {});
        el.className = `skribi-regent ${data.class}`;
        el.setAttribute("title", data.hover);
    });
}
function createRegent(dataIn) {
    let data = Object.assign({
        class: "generic",
        label: "sk",
        clear: false,
        hover: ""
    }, dataIn || {});
    const pre = createEl("code", { cls: `skribi-regent ${data.class}`, text: data.label });
    pre.setAttribute("title", data.hover);
    return [pre, data];
}
function renderRegent(el, dataIn) {
    let [pre, data] = createRegent(dataIn);
    if (data.clear)
        el.className = "";
    el.replaceWith(pre);
    return pre;
}

const extImg = ["bmp", "png", "jpg", "jpeg", "gif", "svg"];
const extAud = ["mp3", "wav", "m4a", "3gp", "flac", "ogg", "oga"];
const extVid = ["mp4", "webm", "ogv"];
const extTxt = ["md"];
/* Repairs media embeds that have been rendered to markdown */
function embedMedia(el, srcPath, plugin, depth, self) {
    return __awaiter(this, void 0, void 0, function* () {
        dLog("embed self:", self);
        dLog("embed:", el);
        var proms = [];
        const catches = el.querySelectorAll("span.internal-embed");
        let elDepth = el.getAttribute("depth");
        let d = (isExtant(elDepth) ? parseInt(elDepth) : isExtant(depth) ? depth : 0);
        dLog("embedder depth:", d);
        for (let fish of Array.from(catches)) {
            if (fish.hasClass("is-loaded"))
                continue;
            let src = obsidian.normalizePath(fish.getAttribute("src"));
            let dest = plugin.app.metadataCache.getFirstLinkpathDest(src, srcPath);
            if (dest) {
                let path = plugin.app.vault.adapter.getResourcePath(dest.path);
                let ext = dest.extension;
                if (extImg.contains(ext)) { // Embed Image
                    fish.addClass("image-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("img");
                    nel.setAttribute("src", path);
                }
                else if (extAud.contains(ext)) { // Embed Audio
                    fish.addClass("media-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("audio", { "attr": { "controls": true } });
                    nel.setAttribute("src", path);
                }
                else if (extVid.contains(ext)) { // Embed Video
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let vidiv = fish.createEl("video", { "attr": { "controls": true } });
                    vidiv.setAttribute("src", path);
                }
                else if (extTxt.contains(ext)) {
                    /* Embed Transclusion */
                    const createEmbedPromise = () => {
                        return new Promise(() => __awaiter(this, void 0, void 0, function* () {
                            dLog("new embed prom");
                            fish.childNodes.forEach((n) => { fish.removeChild(n); });
                            let cache = plugin.app.metadataCache.getCache(dest.path);
                            let read = yield plugin.app.vault.cachedRead(dest);
                            let classes = obsidian.parseFrontMatterStringArray(cache === null || cache === void 0 ? void 0 : cache.frontmatter, "cssclass");
                            let div = fish.createDiv({ cls: "markdown-embed" });
                            div.createDiv({ cls: "markdown-embed-title", text: dest.basename });
                            let content = div.createDiv({ cls: "markdown-embed-content" });
                            let link = div.createDiv({ cls: "markdown-embed-link" });
                            obsidian.setIcon(link, "link");
                            link.onClickEvent((e) => {
                                e.preventDefault();
                                plugin.app.workspace.openLinkText(src, srcPath);
                            });
                            let pv = content.createDiv({ cls: "markdown-preview-view" });
                            pv.addClazz(classes);
                            let ps = pv.createDiv({ cls: "markdown-preview-sizer markdown-preview-section" });
                            let mkh = createDiv({ attr: { "depth": depth.toString() } });
                            yield obsidian.MarkdownRenderer.renderMarkdown(read, mkh, srcPath, null);
                            const mke = (Array.from((mkh === null || mkh === void 0 ? void 0 : mkh.childNodes) || []).map((n) => {
                                // if (n.childNodes.length > 0) { let d = createDiv(); d.append(n.cloneNode(true)); return d;} else return n;}));
                                if (n.childNodes.length > 0) {
                                    let d = createDiv();
                                    d.append(n);
                                    return d;
                                }
                                else
                                    return n;
                            }));
                            ps.append(...mke); //ps.setAttribute("depth", d.toString())
                            return embedMedia(ps, srcPath, plugin, d - 1, true);
                        }));
                    };
                    if (d <= 0) {
                        let [l] = createRegent({ class: "depth-limit", hover: "It goes on forever..." });
                        fish.replaceWith(l);
                        dLog("embedder hit limit");
                    }
                    else {
                        proms.push(createEmbedPromise());
                    }
                }
            }
        }
        return Promise.allSettled(proms).then(values => {
            dLog("embedder done", proms);
            return Promise.resolve(proms.length);
        });
    });
}

var promptTypes;
(function (promptTypes) {
    promptTypes["string"] = "string";
})(promptTypes || (promptTypes = {}));

class InsertionModal extends obsidian.Modal {
    constructor(plugin, editor, id) {
        super(plugin.app);
        this.valFields = {};
        this.plugin = plugin;
        this.editor = editor;
        this.currentID = id.toString();
        this.containerEl.addClass("skribi-insertion-modal");
        this.titleEl.setText("Insert Skribi Template");
    }
    onOpen() {
        this.create();
    }
    create() {
        let s = new obsidian.Setting(this.contentEl);
        s.addDropdown((drop) => {
            drop
                .addOptions(toDupeRecord(this.plugin.eta.getCacheKeys()))
                .setValue(this.currentID)
                .onChange((v) => {
                this.currentID = v;
                let f = this.generateFields(fieldsDiv, this.currentID);
                ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
            });
        });
        let fieldsDiv = this.contentEl.createDiv({ cls: "skribi-modal-fields" });
        let t = new obsidian.Setting(this.contentEl);
        t.addText((te) => { this.textInput = te; return te; });
        t.setName("Append");
        t.settingEl.addClass("skribi-modal-field-append");
        let f = this.generateFields(fieldsDiv, this.currentID);
        ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
        let confirm = new obsidian.Setting(this.contentEl);
        confirm.addButton((button) => button
            .setButtonText("Insert")
            .onClick(() => this.doInsert()));
        this.keypressRef = this.scope.register([], "Enter", this.doInsert.bind(this));
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    generateFields(el, id) {
        el.empty();
        var arr = [];
        if (this.plugin.eta.templateFrontmatters.has(id)) {
            let fm = this.plugin.eta.templateFrontmatters.get(id);
            for (let v of Object.keys(fm)) {
                if (v.charAt(0) == "_") {
                    let vn = v.substring(1);
                    let fma = this.parsePromptVal(vn, fm[v]);
                    let s = new obsidian.Setting(el);
                    s.settingEl.addClass("skribi-modal-template-field");
                    if (fma.type == promptTypes.string) {
                        arr.push(this.createTextField(s, fma));
                    }
                    s.setName(fma.name);
                }
            }
        }
        return arr;
    }
    createTextField(set, fma) {
        let t;
        set.addText((text) => {
            text
                .setValue(fma.default)
                .setPlaceholder(fma.placeholder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.valFields[fma.id] = value;
            }));
            text.inputEl.addClass("skribi-text-input");
            t = text;
        });
        if (fma.default.length > 0)
            this.valFields[fma.id] = fma.default;
        return t;
    }
    parsePromptVal(k, val) {
        let v = {
            id: k,
            type: promptTypes.string,
            name: isExtant(val === null || val === void 0 ? void 0 : val.name) ? val.name : k,
            placeholder: isExtant(val === null || val === void 0 ? void 0 : val.placeholder) ? val.placeholder : "",
            default: isExtant(val === null || val === void 0 ? void 0 : val.default) ? val.default : isExtant(val === null || val === void 0 ? void 0 : val.def) ? val.def : "",
        };
        return v;
    }
    doInsert() {
        let id = this.currentID;
        let osel = this.editor.listSelections();
        let toInsert = `\`{:${id}`;
        for (let e of Object.entries(this.valFields)) {
            toInsert += ` | ${e[0]}: ${e[1]}`;
        }
        toInsert += ((this === null || this === void 0 ? void 0 : this.textInput.getValue().length) > 0) ? " | " + this.textInput.getValue() : "";
        toInsert += `}\``;
        this.editor.getDoc().replaceSelection(toInsert);
        let nsel = [];
        for (let p of osel) {
            nsel.push({ from: { line: p.anchor.line, ch: p.anchor.ch + (toInsert.length) } });
        }
        this.editor.transaction({ selections: nsel });
        this.close();
    }
}
class SuggestionModal extends obsidian.FuzzySuggestModal {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
    }
    getItems() {
        return this.plugin.eta.getCacheKeys();
    }
    getItemText(item) { return item; }
    onChooseItem(item, evt) {
        this.resolve(item);
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}

class SkribiChild extends obsidian.MarkdownRenderChild {
    constructor(el) {
        super(el);
        this.intervals = [];
        this.cbOnUnload = [];
    }
    provideContext() {
        return {
            el: this.containerEl,
            registerInterval: this.skRegisterInterval.bind(this),
            registerUnload: this.skRegisterUnload.bind(this),
            registerEvent: this.skRegisterEvent.bind(this),
            reload: this.rerender,
            c: this
        };
    }
    setPacket(packet) {
        if (this.packet == null) {
            this.packet = packet;
        }
    }
    onload() { }
    clear() {
        dLog("skreeb clear");
        for (let i of this.intervals)
            window.clearInterval(i); // there might be cases where this doesn't get called properly
        for (let cb of this.cbOnUnload)
            cb[0](cb[1]);
    }
    onunload() {
        dLog("skreeb unload");
        this.clear();
    }
    /* Provider Functions */
    skRegisterInterval(cb, time, ...args) {
        //@ts-ignore
        let x = window.setInterval((...a) => {
            if (this._loaded == false) {
                window.clearInterval(x);
            }
            cb(...a);
        }, time * 1000, ...args);
        this.intervals.push(x);
        return x;
    }
    skRegisterEvent(event) {
        dLog('SkChild registered event:', event);
        this.registerEvent(event);
    }
    skRegisterUnload(cb, ...args) {
        this.cbOnUnload.push([(...x) => cb(...x), args]);
    }
    // Assigned in renderSkribi()
    rerender() { }
}

/* Check if code block is that good good and if so what type of good good */
function preparseSkribi(el, str, flg) {
    return __awaiter(this, void 0, void 0, function* () {
        let text = isExtant(str) ? str : el.textContent;
        if (text.length < 3)
            return;
        let e = text.substr(text.length - 2);
        let s = text.substr(0, 2);
        if (s.startsWith("{") && e.endsWith("}")) {
            let f = s[1];
            let flag = (f == ":") ? 1 : (f == "=") ? 2 : (f == "~") ? 3 : (f == "{") ? 4 : (f == ".") ? 5 : -1;
            if ((flag > 0) && (flag != 4 || (e == "}}"))) {
                return { flag: flag, text: text.substring(2, text.length - (flag == 4 ? 2 : 1)) };
            }
            else
                return;
        }
        else
            return;
    });
}
/* Parse variables in template invocations */
function parseSkribi(src) {
    return __awaiter(this, void 0, void 0, function* () {
        let sa = src.split(/(?<![\\])\|/);
        let id = sa.splice(0, 1)[0].trim();
        let args = {};
        for (let seg of sa) {
            let si = seg.indexOf(":");
            if (si == -1)
                continue;
            args[seg.slice(0, si).trim()] = seg.slice(si + 1).trim();
        }
        return { id: id, args: { v: args } };
    });
}

class SkribosPlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        this.varName = "sk";
        this.loadEvents = new obsidian.Events();
        this.initLoaded = false;
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribi: Loading...');
            yield this.loadSettings();
            this.addSettingTab(new SkribosSettingTab(this.app, this));
            this.eta = new EtaHandler(this);
            let process = (el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processor({ srcType: "GENERAL" /* general */ }, el, ctx); });
            // process.sortOrder = -50
            this.registerMarkdownPostProcessor((el, ctx) => process(el, ctx));
            let processBlock = (mode, str, el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processor(mode, el, ctx, null, null, str.trimEnd()); });
            ([["normal", "", 0 /* none */], ["raw", "-raw", 3 /* raw */], ["literal", "-lit", 4 /* literal */], ["interpolate", "-int", 2 /* interp */], ["evaluate", "-eval", 5 /* eval */]])
                .forEach((v) => {
                this.registerMarkdownCodeBlockProcessor(`skribi${v[1]}`, processBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
                this.registerMarkdownCodeBlockProcessor(`sk${v[1]}`, processBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
            });
            this.registerEvent(this.app.metadataCache.on('changed', e => {
                // if (e?.parent.path.contains(this.settings.templateFolder)) { bUpdate(e); }
            }));
            this.initLoadRef = this.loadEvents.on('init-load-complete', () => { this.initLoaded = true; dLog("init-load-complete"); });
            this.addCommand({ id: "insert-skribi", name: "Insert Skribi",
                editorCallback: (editor, view) => {
                    if (!this.initLoaded)
                        return;
                    let x = new SuggestionModal(this);
                    new Promise((resolve, reject) => x.openAndGetValue(resolve, reject))
                        .then(result => {
                        if (this.eta.hasPartial(result)) {
                            let i = new InsertionModal(this, editor, result);
                            i.open();
                        }
                    }, (r) => { });
                } });
            this.addCommand({ id: "skribi-reload-scripts", name: "Reload Scripts",
                callback: () => {
                    this.eta.bus.scriptLoader.reload().then(() => console.log("Skribi: Reloaded Scripts"));
                } });
            // registerMirror(this);
        });
    }
    onunload() {
        this.eta.unload();
        this.loadEvents.offref(this.initLoadRef);
        console.log('Skribi: Unloading...');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
    processor(mode, // 0: codespan; 1: codeblock;
    doc, ctx, depth, self, srcIn) {
        return __awaiter(this, void 0, void 0, function* () {
            let nestExtant = isExtant(ctx.remainingNestLevel);
            let nestLevel = nestExtant ? ctx.remainingNestLevel : null;
            /* nestExtant means that we are inside of a natural transclusion */
            self = isExtant(self);
            depth = self ? depth : null;
            /* self means that we have been called by renderSkribi, to look for codeblocks */
            let elHasDepth = isExtant(doc.getAttribute("depth"));
            let elElHasDepth = isExtant(ctx.el.getAttribute("depth"));
            let elDepth = elHasDepth ? parseInt(doc.getAttribute("depth")) : elElHasDepth ? parseInt(ctx.el.getAttribute("depth")) : null;
            /* Used for passing depth to virtual elements (we may be in one even as we speak...)*/
            /* determine our depth condition type */
            let d = self ? depth : (elHasDepth || elElHasDepth) ? elDepth : nestExtant ? nestLevel : 0;
            if (!nestExtant && !(elHasDepth || elElHasDepth))
                dLog("processor sees no depth");
            if (elHasDepth) {
                dLog("elDepth", elDepth, "doc", doc, "el", ctx.el, "conEl", ctx.containerEl);
            }
            else {
                dLog("processor: ", "doc", doc, "el", ctx.el, "conEl", ctx.containerEl, "nest", ctx.remainingNestLevel);
            }
            /* Dispatch render promises */
            var proms = [];
            var temps = 0;
            const elCodes = (mode.srcType == "BLOCK" /* block */) ? [doc] : doc.querySelectorAll("code");
            if (!(d <= 0)) {
                let tm = window.performance.now();
                const elProms = Array.from(elCodes).map((el) => __awaiter(this, void 0, void 0, function* () {
                    let t = window.performance.now();
                    dLog("start:", t);
                    let src = (isExtant(mode.flag) && mode.flag != 0 /* none */) ?
                        { text: srcIn || doc.textContent, flag: mode.flag } : yield preparseSkribi(el);
                    try {
                        if (src != null) {
                            let nel = renderRegent(el, { class: 'sk-loading', hover: 'Evaluating...' });
                            if (src.flag == 1) {
                                proms.push(this.predicate({ el: nel, src: src.text, mdCtx: ctx, skCtx: { time: window.performance.now(), depth: d, flag: src.flag } }));
                                temps++;
                            }
                            else {
                                proms.push(this.processSkribi(nel, src.text, ctx, { time: window.performance.now(), depth: d, flag: src.flag }));
                            }
                        }
                    }
                    catch (e) {
                        if (!e.flags.noRender) {
                            renderError(el, e);
                        }
                    }
                    return Promise.resolve();
                }));
                if ( /*!self && */!doc.hasClass("skribi-render-virtual")) {
                    let aps = Promise.all(elProms);
                    aps.then(() => {
                        Promise.allSettled(proms).then(() => {
                            if (proms.length > 0) {
                                if (this.initLoaded) {
                                    vLog(`Processed ${proms.length} skribis (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                                else {
                                    let str = "";
                                    if (temps > 0) {
                                        if (proms.length - temps > 0) {
                                            str = `Processed ${proms.length - temps} and queued ${temps} skribis`;
                                        }
                                        else
                                            str = `Queued ${temps} skribis`;
                                    }
                                    else
                                        str = `Processed ${proms.length - temps} skribis`;
                                    vLog(str + ` (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                            }
                        });
                    });
                }
                yield Promise.allSettled(elProms);
                return proms;
            }
            else {
                /* Depth too high! */
                elCodes.forEach((el) => __awaiter(this, void 0, void 0, function* () {
                    preparseSkribi(el).then((src) => __awaiter(this, void 0, void 0, function* () {
                        if (src != null)
                            renderState(el, { hover: "Recursion limit reached!", class: 'stasis' });
                    }));
                }));
                dLog("processor hit limit");
                return Promise.resolve('Depth Limit');
            }
        });
    }
    /* Await initial loading of templates */
    predicate(args) {
        return __awaiter(this, void 0, void 0, function* () {
            let el = renderWait(args.el);
            if (!this.initLoaded) {
                dLog("not yet loaded");
                this.initLoadRef = this.loadEvents.on('init-load-complete', () => __awaiter(this, void 0, void 0, function* () {
                    this.initLoaded = true;
                    return yield this.processSkribiTemplate(el, args.src, args.mdCtx, Object.assign(args.skCtx, { time: window.performance.now() }));
                }));
            }
            else
                return yield this.processSkribiTemplate(el, args.src, args.mdCtx, args.skCtx);
        });
    }
    processSkribiTemplate(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let parsed = null;
            try {
                parsed = yield parseSkribi(src);
            }
            catch (e) {
                renderError(el, e);
                return null;
            }
            if (this.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath).basename == parsed.id) {
                renderRegent(el, { class: 'self', hover: 'Self Render Prohibited' });
                return null;
            }
            let template = this.eta.getPartial(parsed.id);
            if (!isExtant(template)) {
                if (this.eta.failedTemplates.has(parsed.id)) {
                    renderError(el, { msg: `Template ${parsed.id} failed to compile, error: \n` + this.eta.failedTemplates.get(parsed.id) });
                }
                else {
                    renderError(el, { msg: `No such template "${parsed.id}"` });
                }
                return null;
            }
            return this.renderSkribi(el, template, parsed.id, mdCtx, Object.assign({}, skCtx, { ctx: parsed.args }));
        });
    }
    processSkribi(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            const prep = function (str, flag) {
                switch (flag) {
                    case 2: return `<%=${src}%>`;
                    case 3: return `<%~${src}%>`;
                    case 4: return str;
                    case 5: return `<%${src}%>`;
                }
            };
            return this.renderSkribi(el, prep(src, skCtx.flag), "literal", mdCtx, skCtx);
        });
    }
    renderSkribi(el, con, id, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let file = this.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath);
            let e = createDiv({ cls: "skribi-render-virtual" });
            let c = new SkribiChild(e);
            Object.assign(c, { rerender: (() => {
                    console.log("e");
                    c.clear();
                    this.renderSkribi(e, con, id, mdCtx, skCtx);
                }).bind(this)
            });
            let ctx = Object.assign({}, (skCtx === null || skCtx === void 0 ? void 0 : skCtx.ctx) || {}, { child: c.provideContext() });
            let [rendered, packet] = yield this.eta.renderAsync(con, ctx, file).catch((err) => {
                if (this.settings.errorLogging)
                    console.warn(`Skribi render threw error! Displaying content and error...`, EBAR, con, EBAR, err);
                renderError(el, (err === null || err === void 0 ? void 0 : err.hasData) ? err : { msg: (err === null || err === void 0 ? void 0 : err.msg) || err || "Render Error" });
                c.unload();
                return Promise.resolve(null);
            });
            dLog("renderSkrib:", el, mdCtx, skCtx, id);
            if (isExtant(rendered)) {
                let d = isExtant(mdCtx.remainingNestLevel) ? mdCtx.remainingNestLevel : (skCtx.depth);
                let r = obsidian.MarkdownRenderer.renderMarkdown(rendered, e, mdCtx.sourcePath, null).then(() => {
                    e.setAttribute("skribi", id); //e.setAttribute("depth", d.toString());
                    e.removeClass("skribi-render-virtual");
                    el.replaceWith(e);
                    dLog("finish: ", skCtx.time, window.performance.now());
                    if (skCtx.flag == 1) {
                        vLog(`Rendered template "${id}" (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, e);
                    }
                    else
                        vLog(`Rendered literal (f: ${skCtx.flag}) (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, e);
                    return Promise.resolve(e);
                });
                c.setPacket(packet);
                mdCtx.addChild(c);
                r.then((e) => {
                    // TODO: only restrict depth for transclusions
                    if (isExtant(mdCtx.remainingNestLevel) && (mdCtx.remainingNestLevel > 0) || !isExtant(mdCtx.remainingNestLevel)) {
                        return embedMedia(e, mdCtx.sourcePath, this, skCtx.depth);
                    }
                    else
                        return Promise.resolve();
                    //e.setAttribute("depth", d.toString())
                })
                    .then((x) => {
                    dLog("renderer final: ", d);
                    // e.setAttribute("depth", d.toString())
                    this.processor({ srcType: "GENERAL" /* general */ }, e, mdCtx, skCtx.depth - 1, true); /* Recurse the processor to parse skreeblings */
                });
                return r;
            }
            else {
                c.clear();
                return Promise.reject("Render Error");
            }
        });
    }
}

module.exports = SkribosPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5vZGVfbW9kdWxlcy9ldGEvZGlzdC9ldGEuZXMuanMiLCJzcmMvdHlwZXMvY29uc3QudHMiLCJzcmMvdXRpbC50cyIsInNyYy9ldGEvY29tcC50cyIsInNyYy9ldGEvcHJvdmlkZXJfYWJzLnRzIiwic3JjL2V0YS9wcm92aWRlcnMvYmFzZS50cyIsInNyYy9ldGEvcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2LnRzIiwic3JjL2V0YS9wcm92aWRlcnMvaW50ZWdyYXRpb24vd2VhdGhlci50cyIsInNyYy9ldGEvcHJvdmlkZXJzL3NjcmlwdGxvYWRlci50cyIsInNyYy9ldGEvcHJvdmlkZXJfYnVzLnRzIiwic3JjL2V0YS9jYWNoZXIudHMiLCJzcmMvZXRhL3RlbXBsYXRlcy50cyIsInNyYy9ldGEvZXRhLnRzIiwic3JjL3NldHRpbmdzLnRzIiwic3JjL3JlbmRlci9yZWdlbnQudHMiLCJzcmMvcmVuZGVyL2VtYmVkLnRzIiwic3JjL3R5cGVzL3R5cGVzLnRzIiwic3JjL21vZGFsLnRzIiwic3JjL3JlbmRlci9jaGlsZC50cyIsInNyYy9yZW5kZXIvcGFyc2UudHMiLCJzcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcbiIsImltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IHJlc29sdmUsIGRpcm5hbWUsIGV4dG5hbWUgfSBmcm9tICdwYXRoJztcblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuXHJcbnZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn07XG5cbmZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKG9iaiwgcHJvdG8pIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihvYmosIHByb3RvKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIG9iai5fX3Byb3RvX18gPSBwcm90bztcclxuICAgIH1cclxufVxyXG4vLyBUaGlzIGlzIHByZXR0eSBtdWNoIHRoZSBvbmx5IHdheSB0byBnZXQgbmljZSwgZXh0ZW5kZWQgRXJyb3JzXHJcbi8vIHdpdGhvdXQgdXNpbmcgRVM2XHJcbi8qKlxyXG4gKiBUaGlzIHJldHVybnMgYSBuZXcgRXJyb3Igd2l0aCBhIGN1c3RvbSBwcm90b3R5cGUuIE5vdGUgdGhhdCBpdCdzIF9ub3RfIGEgY29uc3RydWN0b3JcclxuICpcclxuICogQHBhcmFtIG1lc3NhZ2UgRXJyb3IgbWVzc2FnZVxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiB0aHJvdyBFdGFFcnIoXCJ0ZW1wbGF0ZSBub3QgZm91bmRcIilcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBFdGFFcnIobWVzc2FnZSkge1xyXG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuICAgIHNldFByb3RvdHlwZU9mKGVyciwgRXRhRXJyLnByb3RvdHlwZSk7XHJcbiAgICByZXR1cm4gZXJyO1xyXG59XHJcbkV0YUVyci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSwge1xyXG4gICAgbmFtZTogeyB2YWx1ZTogJ0V0YSBFcnJvcicsIGVudW1lcmFibGU6IGZhbHNlIH1cclxufSk7XHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gRXRhRXJyIHdpdGggYSBuaWNlbHkgZm9ybWF0dGVkIGVycm9yIGFuZCBtZXNzYWdlIHNob3dpbmcgd2hlcmUgaW4gdGhlIHRlbXBsYXRlIHRoZSBlcnJvciBvY2N1cnJlZC5cclxuICovXHJcbmZ1bmN0aW9uIFBhcnNlRXJyKG1lc3NhZ2UsIHN0ciwgaW5keCkge1xyXG4gICAgdmFyIHdoaXRlc3BhY2UgPSBzdHIuc2xpY2UoMCwgaW5keCkuc3BsaXQoL1xcbi8pO1xyXG4gICAgdmFyIGxpbmVObyA9IHdoaXRlc3BhY2UubGVuZ3RoO1xyXG4gICAgdmFyIGNvbE5vID0gd2hpdGVzcGFjZVtsaW5lTm8gLSAxXS5sZW5ndGggKyAxO1xyXG4gICAgbWVzc2FnZSArPVxyXG4gICAgICAgICcgYXQgbGluZSAnICtcclxuICAgICAgICAgICAgbGluZU5vICtcclxuICAgICAgICAgICAgJyBjb2wgJyArXHJcbiAgICAgICAgICAgIGNvbE5vICtcclxuICAgICAgICAgICAgJzpcXG5cXG4nICtcclxuICAgICAgICAgICAgJyAgJyArXHJcbiAgICAgICAgICAgIHN0ci5zcGxpdCgvXFxuLylbbGluZU5vIC0gMV0gK1xyXG4gICAgICAgICAgICAnXFxuJyArXHJcbiAgICAgICAgICAgICcgICcgK1xyXG4gICAgICAgICAgICBBcnJheShjb2xObykuam9pbignICcpICtcclxuICAgICAgICAgICAgJ14nO1xyXG4gICAgdGhyb3cgRXRhRXJyKG1lc3NhZ2UpO1xyXG59XG5cbi8qKlxyXG4gKiBAcmV0dXJucyBUaGUgZ2xvYmFsIFByb21pc2UgZnVuY3Rpb25cclxuICovXHJcbnZhciBwcm9taXNlSW1wbCA9IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLlByb21pc2U7XHJcbi8qKlxyXG4gKiBAcmV0dXJucyBBIG5ldyBBc3luY0Z1bmN0aW9uIGNvbnN0dWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIGdldEFzeW5jRnVuY3Rpb25Db25zdHJ1Y3RvcigpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigncmV0dXJuIChhc3luYyBmdW5jdGlvbigpe30pLmNvbnN0cnVjdG9yJykoKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoXCJUaGlzIGVudmlyb25tZW50IGRvZXNuJ3Qgc3VwcG9ydCBhc3luYy9hd2FpdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBzdHIudHJpbUxlZnQgcG9seWZpbGxcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHN0cmluZ1xyXG4gKiBAcmV0dXJucyBUaGUgc3RyaW5nIHdpdGggbGVmdCB3aGl0ZXNwYWNlIHJlbW92ZWRcclxuICpcclxuICovXHJcbmZ1bmN0aW9uIHRyaW1MZWZ0KHN0cikge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV4dHJhLWJvb2xlYW4tY2FzdFxyXG4gICAgaWYgKCEhU3RyaW5nLnByb3RvdHlwZS50cmltTGVmdCkge1xyXG4gICAgICAgIHJldHVybiBzdHIudHJpbUxlZnQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvXlxccysvLCAnJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIHN0ci50cmltUmlnaHQgcG9seWZpbGxcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHN0cmluZ1xyXG4gKiBAcmV0dXJucyBUaGUgc3RyaW5nIHdpdGggcmlnaHQgd2hpdGVzcGFjZSByZW1vdmVkXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmltUmlnaHQoc3RyKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXh0cmEtYm9vbGVhbi1jYXN0XHJcbiAgICBpZiAoISFTdHJpbmcucHJvdG90eXBlLnRyaW1SaWdodCkge1xyXG4gICAgICAgIHJldHVybiBzdHIudHJpbVJpZ2h0KCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1xccyskLywgJycpOyAvLyBUT0RPOiBkbyB3ZSByZWFsbHkgbmVlZCB0byByZXBsYWNlIEJPTSdzP1xyXG4gICAgfVxyXG59XG5cbi8vIFRPRE86IGFsbG93ICctJyB0byB0cmltIHVwIHVudGlsIG5ld2xpbmUuIFVzZSBbXlxcU1xcblxccl0gaW5zdGVhZCBvZiBcXHNcclxuLyogRU5EIFRZUEVTICovXHJcbmZ1bmN0aW9uIGhhc093blByb3Aob2JqLCBwcm9wKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XHJcbn1cclxuZnVuY3Rpb24gY29weVByb3BzKHRvT2JqLCBmcm9tT2JqKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gZnJvbU9iaikge1xyXG4gICAgICAgIGlmIChoYXNPd25Qcm9wKGZyb21PYmosIGtleSkpIHtcclxuICAgICAgICAgICAgdG9PYmpba2V5XSA9IGZyb21PYmpba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG9PYmo7XHJcbn1cclxuLyoqXHJcbiAqIFRha2VzIGEgc3RyaW5nIHdpdGhpbiBhIHRlbXBsYXRlIGFuZCB0cmltcyBpdCwgYmFzZWQgb24gdGhlIHByZWNlZGluZyB0YWcncyB3aGl0ZXNwYWNlIGNvbnRyb2wgYW5kIGBjb25maWcuYXV0b1RyaW1gXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmltV1Moc3RyLCBjb25maWcsIHdzTGVmdCwgd3NSaWdodCkge1xyXG4gICAgdmFyIGxlZnRUcmltO1xyXG4gICAgdmFyIHJpZ2h0VHJpbTtcclxuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZy5hdXRvVHJpbSkpIHtcclxuICAgICAgICAvLyBraW5kYSBjb25mdXNpbmdcclxuICAgICAgICAvLyBidXQgX319IHdpbGwgdHJpbSB0aGUgbGVmdCBzaWRlIG9mIHRoZSBmb2xsb3dpbmcgc3RyaW5nXHJcbiAgICAgICAgbGVmdFRyaW0gPSBjb25maWcuYXV0b1RyaW1bMV07XHJcbiAgICAgICAgcmlnaHRUcmltID0gY29uZmlnLmF1dG9UcmltWzBdO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbGVmdFRyaW0gPSByaWdodFRyaW0gPSBjb25maWcuYXV0b1RyaW07XHJcbiAgICB9XHJcbiAgICBpZiAod3NMZWZ0IHx8IHdzTGVmdCA9PT0gZmFsc2UpIHtcclxuICAgICAgICBsZWZ0VHJpbSA9IHdzTGVmdDtcclxuICAgIH1cclxuICAgIGlmICh3c1JpZ2h0IHx8IHdzUmlnaHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcmlnaHRUcmltID0gd3NSaWdodDtcclxuICAgIH1cclxuICAgIGlmICghcmlnaHRUcmltICYmICFsZWZ0VHJpbSkge1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBpZiAobGVmdFRyaW0gPT09ICdzbHVycCcgJiYgcmlnaHRUcmltID09PSAnc2x1cnAnKSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci50cmltKCk7XHJcbiAgICB9XHJcbiAgICBpZiAobGVmdFRyaW0gPT09ICdfJyB8fCBsZWZ0VHJpbSA9PT0gJ3NsdXJwJykge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmltbWluZyBsZWZ0JyArIGxlZnRUcmltKVxyXG4gICAgICAgIC8vIGZ1bGwgc2x1cnBcclxuICAgICAgICBzdHIgPSB0cmltTGVmdChzdHIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobGVmdFRyaW0gPT09ICctJyB8fCBsZWZ0VHJpbSA9PT0gJ25sJykge1xyXG4gICAgICAgIC8vIG5sIHRyaW1cclxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvXig/OlxcclxcbnxcXG58XFxyKS8sICcnKTtcclxuICAgIH1cclxuICAgIGlmIChyaWdodFRyaW0gPT09ICdfJyB8fCByaWdodFRyaW0gPT09ICdzbHVycCcpIHtcclxuICAgICAgICAvLyBmdWxsIHNsdXJwXHJcbiAgICAgICAgc3RyID0gdHJpbVJpZ2h0KHN0cik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChyaWdodFRyaW0gPT09ICctJyB8fCByaWdodFRyaW0gPT09ICdubCcpIHtcclxuICAgICAgICAvLyBubCB0cmltXHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoLyg/OlxcclxcbnxcXG58XFxyKSQvLCAnJyk7IC8vIFRPRE86IG1ha2Ugc3VyZSB0aGlzIGdldHMgXFxyXFxuXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyO1xyXG59XHJcbi8qKlxyXG4gKiBBIG1hcCBvZiBzcGVjaWFsIEhUTUwgY2hhcmFjdGVycyB0byB0aGVpciBYTUwtZXNjYXBlZCBlcXVpdmFsZW50c1xyXG4gKi9cclxudmFyIGVzY01hcCA9IHtcclxuICAgICcmJzogJyZhbXA7JyxcclxuICAgICc8JzogJyZsdDsnLFxyXG4gICAgJz4nOiAnJmd0OycsXHJcbiAgICAnXCInOiAnJnF1b3Q7JyxcclxuICAgIFwiJ1wiOiAnJiMzOTsnXHJcbn07XHJcbmZ1bmN0aW9uIHJlcGxhY2VDaGFyKHMpIHtcclxuICAgIHJldHVybiBlc2NNYXBbc107XHJcbn1cclxuLyoqXHJcbiAqIFhNTC1lc2NhcGVzIGFuIGlucHV0IHZhbHVlIGFmdGVyIGNvbnZlcnRpbmcgaXQgdG8gYSBzdHJpbmdcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHZhbHVlICh1c3VhbGx5IGEgc3RyaW5nKVxyXG4gKiBAcmV0dXJucyBYTUwtZXNjYXBlZCBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIFhNTEVzY2FwZShzdHIpIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgLy8gVG8gZGVhbCB3aXRoIFhTUy4gQmFzZWQgb24gRXNjYXBlIGltcGxlbWVudGF0aW9ucyBvZiBNdXN0YWNoZS5KUyBhbmQgTWFya28sIHRoZW4gY3VzdG9taXplZC5cclxuICAgIHZhciBuZXdTdHIgPSBTdHJpbmcoc3RyKTtcclxuICAgIGlmICgvWyY8PlwiJ10vLnRlc3QobmV3U3RyKSkge1xyXG4gICAgICAgIHJldHVybiBuZXdTdHIucmVwbGFjZSgvWyY8PlwiJ10vZywgcmVwbGFjZUNoYXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N0cjtcclxuICAgIH1cclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxudmFyIHRlbXBsYXRlTGl0UmVnID0gL2AoPzpcXFxcW1xcc1xcU118XFwkeyg/Oltee31dfHsoPzpbXnt9XXx7W159XSp9KSp9KSp9fCg/IVxcJHspW15cXFxcYF0pKmAvZztcclxudmFyIHNpbmdsZVF1b3RlUmVnID0gLycoPzpcXFxcW1xcc1xcd1wiJ1xcXFxgXXxbXlxcblxccidcXFxcXSkqPycvZztcclxudmFyIGRvdWJsZVF1b3RlUmVnID0gL1wiKD86XFxcXFtcXHNcXHdcIidcXFxcYF18W15cXG5cXHJcIlxcXFxdKSo/XCIvZztcclxuLyoqIEVzY2FwZSBzcGVjaWFsIHJlZ3VsYXIgZXhwcmVzc2lvbiBjaGFyYWN0ZXJzIGluc2lkZSBhIHN0cmluZyAqL1xyXG5mdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyaW5nKSB7XHJcbiAgICAvLyBGcm9tIE1ETlxyXG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bLiorXFwtP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpOyAvLyAkJiBtZWFucyB0aGUgd2hvbGUgbWF0Y2hlZCBzdHJpbmdcclxufVxyXG5mdW5jdGlvbiBwYXJzZShzdHIsIGNvbmZpZykge1xyXG4gICAgdmFyIGJ1ZmZlciA9IFtdO1xyXG4gICAgdmFyIHRyaW1MZWZ0T2ZOZXh0U3RyID0gZmFsc2U7XHJcbiAgICB2YXIgbGFzdEluZGV4ID0gMDtcclxuICAgIHZhciBwYXJzZU9wdGlvbnMgPSBjb25maWcucGFyc2U7XHJcbiAgICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwbHVnaW4gPSBjb25maWcucGx1Z2luc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBsdWdpbi5wcm9jZXNzVGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9IHBsdWdpbi5wcm9jZXNzVGVtcGxhdGUoc3RyLCBjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyogQWRkaW5nIGZvciBFSlMgY29tcGF0aWJpbGl0eSAqL1xyXG4gICAgaWYgKGNvbmZpZy5ybVdoaXRlc3BhY2UpIHtcclxuICAgICAgICAvLyBDb2RlIHRha2VuIGRpcmVjdGx5IGZyb20gRUpTXHJcbiAgICAgICAgLy8gSGF2ZSB0byB1c2UgdHdvIHNlcGFyYXRlIHJlcGxhY2VzIGhlcmUgYXMgYF5gIGFuZCBgJGAgb3BlcmF0b3JzIGRvbid0XHJcbiAgICAgICAgLy8gd29yayB3ZWxsIHdpdGggYFxccmAgYW5kIGVtcHR5IGxpbmVzIGRvbid0IHdvcmsgd2VsbCB3aXRoIHRoZSBgbWAgZmxhZy5cclxuICAgICAgICAvLyBFc3NlbnRpYWxseSwgdGhpcyByZXBsYWNlcyB0aGUgd2hpdGVzcGFjZSBhdCB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2ZcclxuICAgICAgICAvLyBlYWNoIGxpbmUgYW5kIHJlbW92ZXMgbXVsdGlwbGUgbmV3bGluZXMuXHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL1tcXHJcXG5dKy9nLCAnXFxuJykucmVwbGFjZSgvXlxccyt8XFxzKyQvZ20sICcnKTtcclxuICAgIH1cclxuICAgIC8qIEVuZCBybVdoaXRlc3BhY2Ugb3B0aW9uICovXHJcbiAgICB0ZW1wbGF0ZUxpdFJlZy5sYXN0SW5kZXggPSAwO1xyXG4gICAgc2luZ2xlUXVvdGVSZWcubGFzdEluZGV4ID0gMDtcclxuICAgIGRvdWJsZVF1b3RlUmVnLmxhc3RJbmRleCA9IDA7XHJcbiAgICBmdW5jdGlvbiBwdXNoU3RyaW5nKHN0cm5nLCBzaG91bGRUcmltUmlnaHRPZlN0cmluZykge1xyXG4gICAgICAgIGlmIChzdHJuZykge1xyXG4gICAgICAgICAgICAvLyBpZiBzdHJpbmcgaXMgdHJ1dGh5IGl0IG11c3QgYmUgb2YgdHlwZSAnc3RyaW5nJ1xyXG4gICAgICAgICAgICBzdHJuZyA9IHRyaW1XUyhzdHJuZywgY29uZmlnLCB0cmltTGVmdE9mTmV4dFN0ciwgLy8gdGhpcyB3aWxsIG9ubHkgYmUgZmFsc2Ugb24gdGhlIGZpcnN0IHN0ciwgdGhlIG5leHQgb25lcyB3aWxsIGJlIG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIHNob3VsZFRyaW1SaWdodE9mU3RyaW5nKTtcclxuICAgICAgICAgICAgaWYgKHN0cm5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXBsYWNlIFxcIHdpdGggXFxcXCwgJyB3aXRoIFxcJ1xyXG4gICAgICAgICAgICAgICAgLy8gd2UncmUgZ29pbmcgdG8gY29udmVydCBhbGwgQ1JMRiB0byBMRiBzbyBpdCBkb2Vzbid0IHRha2UgbW9yZSB0aGFuIG9uZSByZXBsYWNlXHJcbiAgICAgICAgICAgICAgICBzdHJuZyA9IHN0cm5nLnJlcGxhY2UoL1xcXFx8Jy9nLCAnXFxcXCQmJykucmVwbGFjZSgvXFxyXFxufFxcbnxcXHIvZywgJ1xcXFxuJyk7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIucHVzaChzdHJuZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgcHJlZml4ZXMgPSBbcGFyc2VPcHRpb25zLmV4ZWMsIHBhcnNlT3B0aW9ucy5pbnRlcnBvbGF0ZSwgcGFyc2VPcHRpb25zLnJhd10ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bXVsYXRvciwgcHJlZml4KSB7XHJcbiAgICAgICAgaWYgKGFjY3VtdWxhdG9yICYmIHByZWZpeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW11bGF0b3IgKyAnfCcgKyBlc2NhcGVSZWdFeHAocHJlZml4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJlZml4KSB7XHJcbiAgICAgICAgICAgIC8vIGFjY3VtdWxhdG9yIGlzIGZhbHN5XHJcbiAgICAgICAgICAgIHJldHVybiBlc2NhcGVSZWdFeHAocHJlZml4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHByZWZpeCBhbmQgYWNjdW11bGF0b3IgYXJlIGJvdGggZmFsc3lcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xyXG4gICAgICAgIH1cclxuICAgIH0sICcnKTtcclxuICAgIHZhciBwYXJzZU9wZW5SZWcgPSBuZXcgUmVnRXhwKCcoW15dKj8pJyArIGVzY2FwZVJlZ0V4cChjb25maWcudGFnc1swXSkgKyAnKC18Xyk/XFxcXHMqKCcgKyBwcmVmaXhlcyArICcpP1xcXFxzKicsICdnJyk7XHJcbiAgICB2YXIgcGFyc2VDbG9zZVJlZyA9IG5ldyBSZWdFeHAoJ1xcJ3xcInxgfFxcXFwvXFxcXCp8KFxcXFxzKigtfF8pPycgKyBlc2NhcGVSZWdFeHAoY29uZmlnLnRhZ3NbMV0pICsgJyknLCAnZycpO1xyXG4gICAgLy8gVE9ETzogYmVuY2htYXJrIGhhdmluZyB0aGUgXFxzKiBvbiBlaXRoZXIgc2lkZSB2cyB1c2luZyBzdHIudHJpbSgpXHJcbiAgICB2YXIgbTtcclxuICAgIHdoaWxlICgobSA9IHBhcnNlT3BlblJlZy5leGVjKHN0cikpKSB7XHJcbiAgICAgICAgbGFzdEluZGV4ID0gbVswXS5sZW5ndGggKyBtLmluZGV4O1xyXG4gICAgICAgIHZhciBwcmVjZWRpbmdTdHJpbmcgPSBtWzFdO1xyXG4gICAgICAgIHZhciB3c0xlZnQgPSBtWzJdO1xyXG4gICAgICAgIHZhciBwcmVmaXggPSBtWzNdIHx8ICcnOyAvLyBieSBkZWZhdWx0IGVpdGhlciB+LCA9LCBvciBlbXB0eVxyXG4gICAgICAgIHB1c2hTdHJpbmcocHJlY2VkaW5nU3RyaW5nLCB3c0xlZnQpO1xyXG4gICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gbGFzdEluZGV4O1xyXG4gICAgICAgIHZhciBjbG9zZVRhZyA9IHZvaWQgMDtcclxuICAgICAgICB2YXIgY3VycmVudE9iaiA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlICgoY2xvc2VUYWcgPSBwYXJzZUNsb3NlUmVnLmV4ZWMoc3RyKSkpIHtcclxuICAgICAgICAgICAgaWYgKGNsb3NlVGFnWzFdKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHN0ci5zbGljZShsYXN0SW5kZXgsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgIHBhcnNlT3BlblJlZy5sYXN0SW5kZXggPSBsYXN0SW5kZXggPSBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleDtcclxuICAgICAgICAgICAgICAgIHRyaW1MZWZ0T2ZOZXh0U3RyID0gY2xvc2VUYWdbMl07XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFR5cGUgPSBwcmVmaXggPT09IHBhcnNlT3B0aW9ucy5leGVjXHJcbiAgICAgICAgICAgICAgICAgICAgPyAnZSdcclxuICAgICAgICAgICAgICAgICAgICA6IHByZWZpeCA9PT0gcGFyc2VPcHRpb25zLnJhd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICdyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHByZWZpeCA9PT0gcGFyc2VPcHRpb25zLmludGVycG9sYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdpJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnJztcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmogPSB7IHQ6IGN1cnJlbnRUeXBlLCB2YWw6IGNvbnRlbnQgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoYXIgPSBjbG9zZVRhZ1swXTtcclxuICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnLyonKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW1lbnRDbG9zZUluZCA9IHN0ci5pbmRleE9mKCcqLycsIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWVudENsb3NlSW5kID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgY29tbWVudCcsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IGNvbW1lbnRDbG9zZUluZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoYXIgPT09IFwiJ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2luZ2xlUXVvdGVSZWcubGFzdEluZGV4ID0gY2xvc2VUYWcuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpbmdsZVF1b3RlTWF0Y2ggPSBzaW5nbGVRdW90ZVJlZy5leGVjKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpbmdsZVF1b3RlTWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSBzaW5nbGVRdW90ZVJlZy5sYXN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgc3RyaW5nJywgc3RyLCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZVF1b3RlUmVnLmxhc3RJbmRleCA9IGNsb3NlVGFnLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb3VibGVRdW90ZU1hdGNoID0gZG91YmxlUXVvdGVSZWcuZXhlYyhzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb3VibGVRdW90ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gZG91YmxlUXVvdGVSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHN0cmluZycsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoYXIgPT09ICdgJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlTGl0UmVnLmxhc3RJbmRleCA9IGNsb3NlVGFnLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZUxpdE1hdGNoID0gdGVtcGxhdGVMaXRSZWcuZXhlYyhzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZUxpdE1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gdGVtcGxhdGVMaXRSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHN0cmluZycsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudE9iaikge1xyXG4gICAgICAgICAgICBidWZmZXIucHVzaChjdXJyZW50T2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCB0YWcnLCBzdHIsIG0uaW5kZXggKyBwcmVjZWRpbmdTdHJpbmcubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdXNoU3RyaW5nKHN0ci5zbGljZShsYXN0SW5kZXgsIHN0ci5sZW5ndGgpLCBmYWxzZSk7XHJcbiAgICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwbHVnaW4gPSBjb25maWcucGx1Z2luc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBsdWdpbi5wcm9jZXNzQVNUKSB7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBwbHVnaW4ucHJvY2Vzc0FTVChidWZmZXIsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYnVmZmVyO1xyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogQ29tcGlsZXMgYSB0ZW1wbGF0ZSBzdHJpbmcgdG8gYSBmdW5jdGlvbiBzdHJpbmcuIE1vc3Qgb2Z0ZW4gdXNlcnMganVzdCB1c2UgYGNvbXBpbGUoKWAsIHdoaWNoIGNhbGxzIGBjb21waWxlVG9TdHJpbmdgIGFuZCBjcmVhdGVzIGEgbmV3IGZ1bmN0aW9uIHVzaW5nIHRoZSByZXN1bHRcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogY29tcGlsZVRvU3RyaW5nKFwiSGkgPCU9IGl0LnVzZXIgJT5cIiwgZXRhLmNvbmZpZylcclxuICogLy8gXCJ2YXIgdFI9JycsaW5jbHVkZT1FLmluY2x1ZGUuYmluZChFKSxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSk7dFIrPSdIaSAnO3RSKz1FLmUoaXQudXNlcik7aWYoY2Ipe2NiKG51bGwsdFIpfSByZXR1cm4gdFJcIlxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGVUb1N0cmluZyhzdHIsIGNvbmZpZykge1xyXG4gICAgdmFyIGJ1ZmZlciA9IHBhcnNlKHN0ciwgY29uZmlnKTtcclxuICAgIHZhciByZXMgPSBcInZhciB0Uj0nJyxfX2wsX19sUFwiICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGUgPyAnLGluY2x1ZGU9RS5pbmNsdWRlLmJpbmQoRSknIDogJycpICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGVGaWxlID8gJyxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSknIDogJycpICtcclxuICAgICAgICAnXFxuZnVuY3Rpb24gbGF5b3V0KHAsZCl7X19sPXA7X19sUD1kfVxcbicgK1xyXG4gICAgICAgIChjb25maWcudXNlV2l0aCA/ICd3aXRoKCcgKyBjb25maWcudmFyTmFtZSArICd8fHt9KXsnIDogJycpICtcclxuICAgICAgICBjb21waWxlU2NvcGUoYnVmZmVyLCBjb25maWcpICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGVGaWxlXHJcbiAgICAgICAgICAgID8gJ2lmKF9fbCl0Uj0nICtcclxuICAgICAgICAgICAgICAgIChjb25maWcuYXN5bmMgPyAnYXdhaXQgJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAoXCJpbmNsdWRlRmlsZShfX2wsT2JqZWN0LmFzc2lnbihcIiArIGNvbmZpZy52YXJOYW1lICsgXCIse2JvZHk6dFJ9LF9fbFApKVxcblwiKVxyXG4gICAgICAgICAgICA6IGNvbmZpZy5pbmNsdWRlXHJcbiAgICAgICAgICAgICAgICA/ICdpZihfX2wpdFI9JyArXHJcbiAgICAgICAgICAgICAgICAgICAgKGNvbmZpZy5hc3luYyA/ICdhd2FpdCAnIDogJycpICtcclxuICAgICAgICAgICAgICAgICAgICAoXCJpbmNsdWRlKF9fbCxPYmplY3QuYXNzaWduKFwiICsgY29uZmlnLnZhck5hbWUgKyBcIix7Ym9keTp0Un0sX19sUCkpXFxuXCIpXHJcbiAgICAgICAgICAgICAgICA6ICcnKSArXHJcbiAgICAgICAgJ2lmKGNiKXtjYihudWxsLHRSKX0gcmV0dXJuIHRSJyArXHJcbiAgICAgICAgKGNvbmZpZy51c2VXaXRoID8gJ30nIDogJycpO1xyXG4gICAgaWYgKGNvbmZpZy5wbHVnaW5zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWcucGx1Z2lucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcGx1Z2luID0gY29uZmlnLnBsdWdpbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChwbHVnaW4ucHJvY2Vzc0ZuU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXMgPSBwbHVnaW4ucHJvY2Vzc0ZuU3RyaW5nKHJlcywgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuLyoqXHJcbiAqIExvb3BzIHRocm91Z2ggdGhlIEFTVCBnZW5lcmF0ZWQgYnkgYHBhcnNlYCBhbmQgdHJhbnNmb3JtIGVhY2ggaXRlbSBpbnRvIEpTIGNhbGxzXHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIC8vIEFTVCB2ZXJzaW9uIG9mICdIaSA8JT0gaXQudXNlciAlPidcclxuICogbGV0IHRlbXBsYXRlQVNUID0gWydIaSAnLCB7IHZhbDogJ2l0LnVzZXInLCB0OiAnaScgfV1cclxuICogY29tcGlsZVNjb3BlKHRlbXBsYXRlQVNULCBldGEuY29uZmlnKVxyXG4gKiAvLyBcInRSKz0nSGkgJzt0Uis9RS5lKGl0LnVzZXIpO1wiXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gY29tcGlsZVNjb3BlKGJ1ZmYsIGNvbmZpZykge1xyXG4gICAgdmFyIGkgPSAwO1xyXG4gICAgdmFyIGJ1ZmZMZW5ndGggPSBidWZmLmxlbmd0aDtcclxuICAgIHZhciByZXR1cm5TdHIgPSAnJztcclxuICAgIGZvciAoaTsgaSA8IGJ1ZmZMZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjdXJyZW50QmxvY2sgPSBidWZmW2ldO1xyXG4gICAgICAgIGlmICh0eXBlb2YgY3VycmVudEJsb2NrID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gY3VycmVudEJsb2NrO1xyXG4gICAgICAgICAgICAvLyB3ZSBrbm93IHN0cmluZyBleGlzdHNcclxuICAgICAgICAgICAgcmV0dXJuU3RyICs9IFwidFIrPSdcIiArIHN0ciArIFwiJ1xcblwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBjdXJyZW50QmxvY2sudDsgLy8gfiwgcywgISwgPywgclxyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IGN1cnJlbnRCbG9jay52YWwgfHwgJyc7XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAncicpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJhd1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5maWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJ0UuZmlsdGVyKCcgKyBjb250ZW50ICsgJyknO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuU3RyICs9ICd0Uis9JyArIGNvbnRlbnQgKyAnXFxuJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnaScpIHtcclxuICAgICAgICAgICAgICAgIC8vIGludGVycG9sYXRlXHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAnRS5maWx0ZXIoJyArIGNvbnRlbnQgKyAnKSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmF1dG9Fc2NhcGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJ0UuZSgnICsgY29udGVudCArICcpJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVyblN0ciArPSAndFIrPScgKyBjb250ZW50ICsgJ1xcbic7XHJcbiAgICAgICAgICAgICAgICAvLyByZWZlcmVuY2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnZScpIHtcclxuICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGVcclxuICAgICAgICAgICAgICAgIHJldHVyblN0ciArPSBjb250ZW50ICsgJ1xcbic7IC8vIHlvdSBuZWVkIGEgXFxuIGluIGNhc2UgeW91IGhhdmUgPCUgfSAlPlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldHVyblN0cjtcclxufVxuXG4vKipcclxuICogSGFuZGxlcyBzdG9yYWdlIGFuZCBhY2Nlc3Npbmcgb2YgdmFsdWVzXHJcbiAqXHJcbiAqIEluIHRoaXMgY2FzZSwgd2UgdXNlIGl0IHRvIHN0b3JlIGNvbXBpbGVkIHRlbXBsYXRlIGZ1bmN0aW9uc1xyXG4gKiBJbmRleGVkIGJ5IHRoZWlyIGBuYW1lYCBvciBgZmlsZW5hbWVgXHJcbiAqL1xyXG52YXIgQ2FjaGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ2FjaGVyKGNhY2hlKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xyXG4gICAgfVxyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5kZWZpbmUgPSBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcclxuICAgICAgICB0aGlzLmNhY2hlW2tleV0gPSB2YWw7XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgLy8gc3RyaW5nIHwgYXJyYXkuXHJcbiAgICAgICAgLy8gVE9ETzogYWxsb3cgYXJyYXkgb2Yga2V5cyB0byBsb29rIGRvd25cclxuICAgICAgICAvLyBUT0RPOiBjcmVhdGUgcGx1Z2luIHRvIGFsbG93IHJlZmVyZW5jaW5nIGhlbHBlcnMsIGZpbHRlcnMgd2l0aCBkb3Qgbm90YXRpb25cclxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZVtrZXldO1xyXG4gICAgfTtcclxuICAgIENhY2hlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmNhY2hlW2tleV07XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNhY2hlID0ge307XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGNhY2hlT2JqKSB7XHJcbiAgICAgICAgY29weVByb3BzKHRoaXMuY2FjaGUsIGNhY2hlT2JqKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ2FjaGVyO1xyXG59KCkpO1xuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIEV0YSdzIHRlbXBsYXRlIHN0b3JhZ2VcclxuICpcclxuICogU3RvcmVzIHBhcnRpYWxzIGFuZCBjYWNoZWQgdGVtcGxhdGVzXHJcbiAqL1xyXG52YXIgdGVtcGxhdGVzID0gbmV3IENhY2hlcih7fSk7XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogSW5jbHVkZSBhIHRlbXBsYXRlIGJhc2VkIG9uIGl0cyBuYW1lIChvciBmaWxlcGF0aCwgaWYgaXQncyBhbHJlYWR5IGJlZW4gY2FjaGVkKS5cclxuICpcclxuICogQ2FsbGVkIGxpa2UgYGluY2x1ZGUodGVtcGxhdGVOYW1lT3JQYXRoLCBkYXRhKWBcclxuICovXHJcbmZ1bmN0aW9uIGluY2x1ZGVIZWxwZXIodGVtcGxhdGVOYW1lT3JQYXRoLCBkYXRhKSB7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQodGVtcGxhdGVOYW1lT3JQYXRoKTtcclxuICAgIGlmICghdGVtcGxhdGUpIHtcclxuICAgICAgICB0aHJvdyBFdGFFcnIoJ0NvdWxkIG5vdCBmZXRjaCB0ZW1wbGF0ZSBcIicgKyB0ZW1wbGF0ZU5hbWVPclBhdGggKyAnXCInKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wbGF0ZShkYXRhLCB0aGlzKTtcclxufVxyXG4vKiogRXRhJ3MgYmFzZSAoZ2xvYmFsKSBjb25maWd1cmF0aW9uICovXHJcbnZhciBjb25maWcgPSB7XHJcbiAgICBhc3luYzogZmFsc2UsXHJcbiAgICBhdXRvRXNjYXBlOiB0cnVlLFxyXG4gICAgYXV0b1RyaW06IFtmYWxzZSwgJ25sJ10sXHJcbiAgICBjYWNoZTogZmFsc2UsXHJcbiAgICBlOiBYTUxFc2NhcGUsXHJcbiAgICBpbmNsdWRlOiBpbmNsdWRlSGVscGVyLFxyXG4gICAgcGFyc2U6IHtcclxuICAgICAgICBleGVjOiAnJyxcclxuICAgICAgICBpbnRlcnBvbGF0ZTogJz0nLFxyXG4gICAgICAgIHJhdzogJ34nXHJcbiAgICB9LFxyXG4gICAgcGx1Z2luczogW10sXHJcbiAgICBybVdoaXRlc3BhY2U6IGZhbHNlLFxyXG4gICAgdGFnczogWyc8JScsICclPiddLFxyXG4gICAgdGVtcGxhdGVzOiB0ZW1wbGF0ZXMsXHJcbiAgICB1c2VXaXRoOiBmYWxzZSxcclxuICAgIHZhck5hbWU6ICdpdCdcclxufTtcclxuLyoqXHJcbiAqIFRha2VzIG9uZSBvciB0d28gcGFydGlhbCAobm90IG5lY2Vzc2FyaWx5IGNvbXBsZXRlKSBjb25maWd1cmF0aW9uIG9iamVjdHMsIG1lcmdlcyB0aGVtIDEgbGF5ZXIgZGVlcCBpbnRvIGV0YS5jb25maWcsIGFuZCByZXR1cm5zIHRoZSByZXN1bHRcclxuICpcclxuICogQHBhcmFtIG92ZXJyaWRlIFBhcnRpYWwgY29uZmlndXJhdGlvbiBvYmplY3RcclxuICogQHBhcmFtIGJhc2VDb25maWcgUGFydGlhbCBjb25maWd1cmF0aW9uIG9iamVjdCB0byBtZXJnZSBiZWZvcmUgYG92ZXJyaWRlYFxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBsZXQgY3VzdG9tQ29uZmlnID0gZ2V0Q29uZmlnKHt0YWdzOiBbJyEjJywgJyMhJ119KVxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGdldENvbmZpZyhvdmVycmlkZSwgYmFzZUNvbmZpZykge1xyXG4gICAgLy8gVE9ETzogcnVuIG1vcmUgdGVzdHMgb24gdGhpc1xyXG4gICAgdmFyIHJlcyA9IHt9OyAvLyBMaW5rZWRcclxuICAgIGNvcHlQcm9wcyhyZXMsIGNvbmZpZyk7IC8vIENyZWF0ZXMgZGVlcCBjbG9uZSBvZiBldGEuY29uZmlnLCAxIGxheWVyIGRlZXBcclxuICAgIGlmIChiYXNlQ29uZmlnKSB7XHJcbiAgICAgICAgY29weVByb3BzKHJlcywgYmFzZUNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAob3ZlcnJpZGUpIHtcclxuICAgICAgICBjb3B5UHJvcHMocmVzLCBvdmVycmlkZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qKiBVcGRhdGUgRXRhJ3MgYmFzZSBjb25maWcgKi9cclxuZnVuY3Rpb24gY29uZmlndXJlKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBjb3B5UHJvcHMoY29uZmlnLCBvcHRpb25zKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIFRha2VzIGEgdGVtcGxhdGUgc3RyaW5nIGFuZCByZXR1cm5zIGEgdGVtcGxhdGUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHdpdGggKGRhdGEsIGNvbmZpZywgW2NiXSlcclxuICpcclxuICogQHBhcmFtIHN0ciAtIFRoZSB0ZW1wbGF0ZSBzdHJpbmdcclxuICogQHBhcmFtIGNvbmZpZyAtIEEgY3VzdG9tIGNvbmZpZ3VyYXRpb24gb2JqZWN0IChvcHRpb25hbClcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogbGV0IGNvbXBpbGVkRm4gPSBldGEuY29tcGlsZShcIkhpIDwlPSBpdC51c2VyICU+XCIpXHJcbiAqIC8vIGZ1bmN0aW9uIGFub255bW91cygpXHJcbiAqIGxldCBjb21waWxlZEZuU3RyID0gY29tcGlsZWRGbi50b1N0cmluZygpXHJcbiAqIC8vIFwiZnVuY3Rpb24gYW5vbnltb3VzKGl0LEUsY2JcXG4pIHtcXG52YXIgdFI9JycsaW5jbHVkZT1FLmluY2x1ZGUuYmluZChFKSxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSk7dFIrPSdIaSAnO3RSKz1FLmUoaXQudXNlcik7aWYoY2Ipe2NiKG51bGwsdFIpfSByZXR1cm4gdFJcXG59XCJcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjb21waWxlKHN0ciwgY29uZmlnKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGdldENvbmZpZyhjb25maWcgfHwge30pO1xyXG4gICAgLyogQVNZTkMgSEFORExJTkcgKi9cclxuICAgIC8vIFRoZSBiZWxvdyBjb2RlIGlzIG1vZGlmaWVkIGZyb20gbWRlL2Vqcy4gQWxsIGNyZWRpdCBzaG91bGQgZ28gdG8gdGhlbS5cclxuICAgIHZhciBjdG9yID0gb3B0aW9ucy5hc3luYyA/IGdldEFzeW5jRnVuY3Rpb25Db25zdHJ1Y3RvcigpIDogRnVuY3Rpb247XHJcbiAgICAvKiBFTkQgQVNZTkMgSEFORExJTkcgKi9cclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBjdG9yKG9wdGlvbnMudmFyTmFtZSwgJ0UnLCAvLyBFdGFDb25maWdcclxuICAgICAgICAnY2InLCAvLyBvcHRpb25hbCBjYWxsYmFja1xyXG4gICAgICAgIGNvbXBpbGVUb1N0cmluZyhzdHIsIG9wdGlvbnMpKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXctZnVuY1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFN5bnRheEVycm9yKSB7XHJcbiAgICAgICAgICAgIHRocm93IEV0YUVycignQmFkIHRlbXBsYXRlIHN5bnRheFxcblxcbicgK1xyXG4gICAgICAgICAgICAgICAgZS5tZXNzYWdlICtcclxuICAgICAgICAgICAgICAgICdcXG4nICtcclxuICAgICAgICAgICAgICAgIEFycmF5KGUubWVzc2FnZS5sZW5ndGggKyAxKS5qb2luKCc9JykgK1xyXG4gICAgICAgICAgICAgICAgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgY29tcGlsZVRvU3RyaW5nKHN0ciwgb3B0aW9ucykgK1xyXG4gICAgICAgICAgICAgICAgJ1xcbicgLy8gVGhpcyB3aWxsIHB1dCBhbiBleHRyYSBuZXdsaW5lIGJlZm9yZSB0aGUgY2FsbHN0YWNrIGZvciBleHRyYSByZWFkYWJpbGl0eVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxudmFyIF9CT00gPSAvXlxcdUZFRkYvO1xyXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIEdldCB0aGUgcGF0aCB0byB0aGUgaW5jbHVkZWQgZmlsZSBmcm9tIHRoZSBwYXJlbnQgZmlsZSBwYXRoIGFuZCB0aGVcclxuICogc3BlY2lmaWVkIHBhdGguXHJcbiAqXHJcbiAqIElmIGBuYW1lYCBkb2VzIG5vdCBoYXZlIGFuIGV4dGVuc2lvbiwgaXQgd2lsbCBkZWZhdWx0IHRvIGAuZXRhYFxyXG4gKlxyXG4gKiBAcGFyYW0gbmFtZSBzcGVjaWZpZWQgcGF0aFxyXG4gKiBAcGFyYW0gcGFyZW50ZmlsZSBwYXJlbnQgZmlsZSBwYXRoXHJcbiAqIEBwYXJhbSBpc0RpcmVjdG9yeSB3aGV0aGVyIHBhcmVudGZpbGUgaXMgYSBkaXJlY3RvcnlcclxuICogQHJldHVybiBhYnNvbHV0ZSBwYXRoIHRvIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRXaG9sZUZpbGVQYXRoKG5hbWUsIHBhcmVudGZpbGUsIGlzRGlyZWN0b3J5KSB7XHJcbiAgICB2YXIgaW5jbHVkZVBhdGggPSByZXNvbHZlKGlzRGlyZWN0b3J5ID8gcGFyZW50ZmlsZSA6IGRpcm5hbWUocGFyZW50ZmlsZSksIC8vIHJldHVybnMgZGlyZWN0b3J5IHRoZSBwYXJlbnQgZmlsZSBpcyBpblxyXG4gICAgbmFtZSAvLyBmaWxlXHJcbiAgICApICsgKGV4dG5hbWUobmFtZSkgPyAnJyA6ICcuZXRhJyk7XHJcbiAgICByZXR1cm4gaW5jbHVkZVBhdGg7XHJcbn1cclxuLyoqXHJcbiAqIEdldCB0aGUgYWJzb2x1dGUgcGF0aCB0byBhbiBpbmNsdWRlZCB0ZW1wbGF0ZVxyXG4gKlxyXG4gKiBJZiB0aGlzIGlzIGNhbGxlZCB3aXRoIGFuIGFic29sdXRlIHBhdGggKGZvciBleGFtcGxlLCBzdGFydGluZyB3aXRoICcvJyBvciAnQzpcXCcpXHJcbiAqIHRoZW4gRXRhIHdpbGwgYXR0ZW1wdCB0byByZXNvbHZlIHRoZSBhYnNvbHV0ZSBwYXRoIHdpdGhpbiBvcHRpb25zLnZpZXdzLiBJZiBpdCBjYW5ub3QsXHJcbiAqIEV0YSB3aWxsIGZhbGxiYWNrIHRvIG9wdGlvbnMucm9vdCBvciAnLydcclxuICpcclxuICogSWYgdGhpcyBpcyBjYWxsZWQgd2l0aCBhIHJlbGF0aXZlIHBhdGgsIEV0YSB3aWxsOlxyXG4gKiAtIExvb2sgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgdGVtcGxhdGUgKGlmIHRoZSBjdXJyZW50IHRlbXBsYXRlIGhhcyB0aGUgYGZpbGVuYW1lYCBwcm9wZXJ0eSlcclxuICogLSBMb29rIGluc2lkZSBlYWNoIGRpcmVjdG9yeSBpbiBvcHRpb25zLnZpZXdzXHJcbiAqXHJcbiAqIE5vdGU6IGlmIEV0YSBpcyB1bmFibGUgdG8gZmluZCBhIHRlbXBsYXRlIHVzaW5nIHBhdGggYW5kIG9wdGlvbnMsIGl0IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqXHJcbiAqIEBwYXJhbSBwYXRoICAgIHNwZWNpZmllZCBwYXRoXHJcbiAqIEBwYXJhbSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHJldHVybiBhYnNvbHV0ZSBwYXRoIHRvIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRQYXRoKHBhdGgsIG9wdGlvbnMpIHtcclxuICAgIHZhciBpbmNsdWRlUGF0aCA9IGZhbHNlO1xyXG4gICAgdmFyIHZpZXdzID0gb3B0aW9ucy52aWV3cztcclxuICAgIHZhciBzZWFyY2hlZFBhdGhzID0gW107XHJcbiAgICAvLyBJZiB0aGVzZSBmb3VyIHZhbHVlcyBhcmUgdGhlIHNhbWUsXHJcbiAgICAvLyBnZXRQYXRoKCkgd2lsbCByZXR1cm4gdGhlIHNhbWUgcmVzdWx0IGV2ZXJ5IHRpbWUuXHJcbiAgICAvLyBXZSBjYW4gY2FjaGUgdGhlIHJlc3VsdCB0byBhdm9pZCBleHBlbnNpdmVcclxuICAgIC8vIGZpbGUgb3BlcmF0aW9ucy5cclxuICAgIHZhciBwYXRoT3B0aW9ucyA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBmaWxlbmFtZTogb3B0aW9ucy5maWxlbmFtZSxcclxuICAgICAgICBwYXRoOiBwYXRoLFxyXG4gICAgICAgIHJvb3Q6IG9wdGlvbnMucm9vdCxcclxuICAgICAgICB2aWV3czogb3B0aW9ucy52aWV3c1xyXG4gICAgfSk7XHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLmZpbGVwYXRoQ2FjaGUgJiYgb3B0aW9ucy5maWxlcGF0aENhY2hlW3BhdGhPcHRpb25zXSkge1xyXG4gICAgICAgIC8vIFVzZSB0aGUgY2FjaGVkIGZpbGVwYXRoXHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZmlsZXBhdGhDYWNoZVtwYXRoT3B0aW9uc107XHJcbiAgICB9XHJcbiAgICAvKiogQWRkIGEgZmlsZXBhdGggdG8gdGhlIGxpc3Qgb2YgcGF0aHMgd2UndmUgY2hlY2tlZCBmb3IgYSB0ZW1wbGF0ZSAqL1xyXG4gICAgZnVuY3Rpb24gYWRkUGF0aFRvU2VhcmNoZWQocGF0aFNlYXJjaGVkKSB7XHJcbiAgICAgICAgaWYgKCFzZWFyY2hlZFBhdGhzLmluY2x1ZGVzKHBhdGhTZWFyY2hlZCkpIHtcclxuICAgICAgICAgICAgc2VhcmNoZWRQYXRocy5wdXNoKHBhdGhTZWFyY2hlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUYWtlIGEgZmlsZXBhdGggKGxpa2UgJ3BhcnRpYWxzL215cGFydGlhbC5ldGEnKS4gQXR0ZW1wdCB0byBmaW5kIHRoZSB0ZW1wbGF0ZSBmaWxlIGluc2lkZSBgdmlld3NgO1xyXG4gICAgICogcmV0dXJuIHRoZSByZXN1bHRpbmcgdGVtcGxhdGUgZmlsZSBwYXRoLCBvciBgZmFsc2VgIHRvIGluZGljYXRlIHRoYXQgdGhlIHRlbXBsYXRlIHdhcyBub3QgZm91bmQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZpZXdzIHRoZSBmaWxlcGF0aCB0aGF0IGhvbGRzIHRlbXBsYXRlcywgb3IgYW4gYXJyYXkgb2YgZmlsZXBhdGhzIHRoYXQgaG9sZCB0ZW1wbGF0ZXNcclxuICAgICAqIEBwYXJhbSBwYXRoIHRoZSBwYXRoIHRvIHRoZSB0ZW1wbGF0ZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzZWFyY2hWaWV3cyh2aWV3cywgcGF0aCkge1xyXG4gICAgICAgIHZhciBmaWxlUGF0aDtcclxuICAgICAgICAvLyBJZiB2aWV3cyBpcyBhbiBhcnJheSwgdGhlbiBsb29wIHRocm91Z2ggZWFjaCBkaXJlY3RvcnlcclxuICAgICAgICAvLyBBbmQgYXR0ZW1wdCB0byBmaW5kIHRoZSB0ZW1wbGF0ZVxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZpZXdzKSAmJlxyXG4gICAgICAgICAgICB2aWV3cy5zb21lKGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlUGF0aCA9IGdldFdob2xlRmlsZVBhdGgocGF0aCwgdiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhpc3RzU3luYyhmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIH0pKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBhYm92ZSByZXR1cm5lZCB0cnVlLCB3ZSBrbm93IHRoYXQgdGhlIGZpbGVQYXRoIHdhcyBqdXN0IHNldCB0byBhIHBhdGhcclxuICAgICAgICAgICAgLy8gVGhhdCBleGlzdHMgKEFycmF5LnNvbWUoKSByZXR1cm5zIGFzIHNvb24gYXMgaXQgZmluZHMgYSB2YWxpZCBlbGVtZW50KVxyXG4gICAgICAgICAgICByZXR1cm4gZmlsZVBhdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2aWV3cyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gU2VhcmNoIGZvciB0aGUgZmlsZSBpZiB2aWV3cyBpcyBhIHNpbmdsZSBkaXJlY3RvcnlcclxuICAgICAgICAgICAgZmlsZVBhdGggPSBnZXRXaG9sZUZpbGVQYXRoKHBhdGgsIHZpZXdzLCB0cnVlKTtcclxuICAgICAgICAgICAgYWRkUGF0aFRvU2VhcmNoZWQoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlUGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBVbmFibGUgdG8gZmluZCBhIGZpbGVcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBQYXRoIHN0YXJ0cyB3aXRoICcvJywgJ0M6XFwnLCBldGMuXHJcbiAgICB2YXIgbWF0Y2ggPSAvXltBLVphLXpdKzpcXFxcfF5cXC8vLmV4ZWMocGF0aCk7XHJcbiAgICAvLyBBYnNvbHV0ZSBwYXRoLCBsaWtlIC9wYXJ0aWFscy9wYXJ0aWFsLmV0YVxyXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCkge1xyXG4gICAgICAgIC8vIFdlIGhhdmUgdG8gdHJpbSB0aGUgYmVnaW5uaW5nICcvJyBvZmYgdGhlIHBhdGgsIG9yIGVsc2VcclxuICAgICAgICAvLyBwYXRoLnJlc29sdmUoZGlyLCBwYXRoKSB3aWxsIGFsd2F5cyByZXNvbHZlIHRvIGp1c3QgcGF0aFxyXG4gICAgICAgIHZhciBmb3JtYXR0ZWRQYXRoID0gcGF0aC5yZXBsYWNlKC9eXFwvKi8sICcnKTtcclxuICAgICAgICAvLyBGaXJzdCwgdHJ5IHRvIHJlc29sdmUgdGhlIHBhdGggd2l0aGluIG9wdGlvbnMudmlld3NcclxuICAgICAgICBpbmNsdWRlUGF0aCA9IHNlYXJjaFZpZXdzKHZpZXdzLCBmb3JtYXR0ZWRQYXRoKTtcclxuICAgICAgICBpZiAoIWluY2x1ZGVQYXRoKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoYXQgZmFpbHMsIHNlYXJjaFZpZXdzIHdpbGwgcmV0dXJuIGZhbHNlLiBUcnkgdG8gZmluZCB0aGUgcGF0aFxyXG4gICAgICAgICAgICAvLyBpbnNpZGUgb3B0aW9ucy5yb290IChieSBkZWZhdWx0ICcvJywgdGhlIGJhc2Ugb2YgdGhlIGZpbGVzeXN0ZW0pXHJcbiAgICAgICAgICAgIHZhciBwYXRoRnJvbVJvb3QgPSBnZXRXaG9sZUZpbGVQYXRoKGZvcm1hdHRlZFBhdGgsIG9wdGlvbnMucm9vdCB8fCAnLycsIHRydWUpO1xyXG4gICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChwYXRoRnJvbVJvb3QpO1xyXG4gICAgICAgICAgICBpbmNsdWRlUGF0aCA9IHBhdGhGcm9tUm9vdDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBSZWxhdGl2ZSBwYXRoc1xyXG4gICAgICAgIC8vIExvb2sgcmVsYXRpdmUgdG8gYSBwYXNzZWQgZmlsZW5hbWUgZmlyc3RcclxuICAgICAgICBpZiAob3B0aW9ucy5maWxlbmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZVBhdGggPSBnZXRXaG9sZUZpbGVQYXRoKHBhdGgsIG9wdGlvbnMuZmlsZW5hbWUpO1xyXG4gICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIGlmIChleGlzdHNTeW5jKGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgaW5jbHVkZVBhdGggPSBmaWxlUGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUaGVuIGxvb2sgZm9yIHRoZSB0ZW1wbGF0ZSBpbiBvcHRpb25zLnZpZXdzXHJcbiAgICAgICAgaWYgKCFpbmNsdWRlUGF0aCkge1xyXG4gICAgICAgICAgICBpbmNsdWRlUGF0aCA9IHNlYXJjaFZpZXdzKHZpZXdzLCBwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpbmNsdWRlUGF0aCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoJ0NvdWxkIG5vdCBmaW5kIHRoZSB0ZW1wbGF0ZSBcIicgKyBwYXRoICsgJ1wiLiBQYXRocyB0cmllZDogJyArIHNlYXJjaGVkUGF0aHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIElmIGNhY2hpbmcgYW5kIGZpbGVwYXRoQ2FjaGUgYXJlIGVuYWJsZWQsXHJcbiAgICAvLyBjYWNoZSB0aGUgaW5wdXQgJiBvdXRwdXQgb2YgdGhpcyBmdW5jdGlvbi5cclxuICAgIGlmIChvcHRpb25zLmNhY2hlICYmIG9wdGlvbnMuZmlsZXBhdGhDYWNoZSkge1xyXG4gICAgICAgIG9wdGlvbnMuZmlsZXBhdGhDYWNoZVtwYXRoT3B0aW9uc10gPSBpbmNsdWRlUGF0aDtcclxuICAgIH1cclxuICAgIHJldHVybiBpbmNsdWRlUGF0aDtcclxufVxyXG4vKipcclxuICogUmVhZHMgYSBmaWxlIHN5bmNocm9ub3VzbHlcclxuICovXHJcbmZ1bmN0aW9uIHJlYWRGaWxlKGZpbGVQYXRoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiByZWFkRmlsZVN5bmMoZmlsZVBhdGgpLnRvU3RyaW5nKCkucmVwbGFjZShfQk9NLCAnJyk7IC8vIFRPRE86IGlzIHJlcGxhY2luZyBCT00ncyBuZWNlc3Nhcnk/XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICB0aHJvdyBFdGFFcnIoXCJGYWlsZWQgdG8gcmVhZCB0ZW1wbGF0ZSBhdCAnXCIgKyBmaWxlUGF0aCArIFwiJ1wiKTtcclxuICAgIH1cclxufVxuXG4vLyBleHByZXNzIGlzIHNldCBsaWtlOiBhcHAuZW5naW5lKCdodG1sJywgcmVxdWlyZSgnZXRhJykucmVuZGVyRmlsZSlcclxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBSZWFkcyBhIHRlbXBsYXRlLCBjb21waWxlcyBpdCBpbnRvIGEgZnVuY3Rpb24sIGNhY2hlcyBpdCBpZiBjYWNoaW5nIGlzbid0IGRpc2FibGVkLCByZXR1cm5zIHRoZSBmdW5jdGlvblxyXG4gKlxyXG4gKiBAcGFyYW0gZmlsZVBhdGggQWJzb2x1dGUgcGF0aCB0byB0ZW1wbGF0ZSBmaWxlXHJcbiAqIEBwYXJhbSBvcHRpb25zIEV0YSBjb25maWd1cmF0aW9uIG92ZXJyaWRlc1xyXG4gKiBAcGFyYW0gbm9DYWNoZSBPcHRpb25hbGx5LCBtYWtlIEV0YSBub3QgY2FjaGUgdGhlIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBsb2FkRmlsZShmaWxlUGF0aCwgb3B0aW9ucywgbm9DYWNoZSkge1xyXG4gICAgdmFyIGNvbmZpZyA9IGdldENvbmZpZyhvcHRpb25zKTtcclxuICAgIHZhciB0ZW1wbGF0ZSA9IHJlYWRGaWxlKGZpbGVQYXRoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGNvbXBpbGVkVGVtcGxhdGUgPSBjb21waWxlKHRlbXBsYXRlLCBjb25maWcpO1xyXG4gICAgICAgIGlmICghbm9DYWNoZSkge1xyXG4gICAgICAgICAgICBjb25maWcudGVtcGxhdGVzLmRlZmluZShjb25maWcuZmlsZW5hbWUsIGNvbXBpbGVkVGVtcGxhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29tcGlsZWRUZW1wbGF0ZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgRXRhRXJyKCdMb2FkaW5nIGZpbGU6ICcgKyBmaWxlUGF0aCArICcgZmFpbGVkOlxcblxcbicgKyBlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBHZXQgdGhlIHRlbXBsYXRlIGZyb20gYSBzdHJpbmcgb3IgYSBmaWxlLCBlaXRoZXIgY29tcGlsZWQgb24tdGhlLWZseSBvclxyXG4gKiByZWFkIGZyb20gY2FjaGUgKGlmIGVuYWJsZWQpLCBhbmQgY2FjaGUgdGhlIHRlbXBsYXRlIGlmIG5lZWRlZC5cclxuICpcclxuICogSWYgYG9wdGlvbnMuY2FjaGVgIGlzIHRydWUsIHRoaXMgZnVuY3Rpb24gcmVhZHMgdGhlIGZpbGUgZnJvbVxyXG4gKiBgb3B0aW9ucy5maWxlbmFtZWAgc28gaXQgbXVzdCBiZSBzZXQgcHJpb3IgdG8gY2FsbGluZyB0aGlzIGZ1bmN0aW9uLlxyXG4gKlxyXG4gKiBAcGFyYW0gb3B0aW9ucyAgIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHJldHVybiBFdGEgdGVtcGxhdGUgZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZUNhY2hlKG9wdGlvbnMpIHtcclxuICAgIHZhciBmaWxlbmFtZSA9IG9wdGlvbnMuZmlsZW5hbWU7XHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSkge1xyXG4gICAgICAgIHZhciBmdW5jID0gb3B0aW9ucy50ZW1wbGF0ZXMuZ2V0KGZpbGVuYW1lKTtcclxuICAgICAgICBpZiAoZnVuYykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuYztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGxvYWRGaWxlKGZpbGVuYW1lLCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIC8vIENhY2hpbmcgaXMgZGlzYWJsZWQsIHNvIHBhc3Mgbm9DYWNoZSA9IHRydWVcclxuICAgIHJldHVybiBsb2FkRmlsZShmaWxlbmFtZSwgb3B0aW9ucywgdHJ1ZSk7XHJcbn1cclxuLyoqXHJcbiAqIFRyeSBjYWxsaW5nIGhhbmRsZUNhY2hlIHdpdGggdGhlIGdpdmVuIG9wdGlvbnMgYW5kIGRhdGEgYW5kIGNhbGwgdGhlXHJcbiAqIGNhbGxiYWNrIHdpdGggdGhlIHJlc3VsdC4gSWYgYW4gZXJyb3Igb2NjdXJzLCBjYWxsIHRoZSBjYWxsYmFjayB3aXRoXHJcbiAqIHRoZSBlcnJvci4gVXNlZCBieSByZW5kZXJGaWxlKCkuXHJcbiAqXHJcbiAqIEBwYXJhbSBkYXRhIHRlbXBsYXRlIGRhdGFcclxuICogQHBhcmFtIG9wdGlvbnMgY29tcGlsYXRpb24gb3B0aW9uc1xyXG4gKiBAcGFyYW0gY2IgY2FsbGJhY2tcclxuICovXHJcbmZ1bmN0aW9uIHRyeUhhbmRsZUNhY2hlKGRhdGEsIG9wdGlvbnMsIGNiKSB7XHJcbiAgICBpZiAoY2IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBOb3RlOiBpZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSByZW5kZXJpbmcgdGhlIHRlbXBsYXRlLFxyXG4gICAgICAgICAgICAvLyBJdCB3aWxsIGJ1YmJsZSB1cCBhbmQgYmUgY2F1Z2h0IGhlcmVcclxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZShvcHRpb25zKTtcclxuICAgICAgICAgICAgdGVtcGxhdGVGbihkYXRhLCBvcHRpb25zLCBjYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gTm8gY2FsbGJhY2ssIHRyeSByZXR1cm5pbmcgYSBwcm9taXNlXHJcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlSW1wbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IHByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZShvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGVtcGxhdGVGbihkYXRhLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgRXRhRXJyKFwiUGxlYXNlIHByb3ZpZGUgYSBjYWxsYmFjayBmdW5jdGlvbiwgdGhpcyBlbnYgZG9lc24ndCBzdXBwb3J0IFByb21pc2VzXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IHRoZSB0ZW1wbGF0ZSBmdW5jdGlvbi5cclxuICpcclxuICogSWYgYG9wdGlvbnMuY2FjaGVgIGlzIGB0cnVlYCwgdGhlbiB0aGUgdGVtcGxhdGUgaXMgY2FjaGVkLlxyXG4gKlxyXG4gKiBUaGlzIHJldHVybnMgYSB0ZW1wbGF0ZSBmdW5jdGlvbiBhbmQgdGhlIGNvbmZpZyBvYmplY3Qgd2l0aCB3aGljaCB0aGF0IHRlbXBsYXRlIGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqXHJcbiAqIEl0J3MgaW1wb3J0YW50IHRoYXQgdGhpcyByZXR1cm5zIGEgY29uZmlnIG9iamVjdCB3aXRoIGBmaWxlbmFtZWAgc2V0LlxyXG4gKiBPdGhlcndpc2UsIHRoZSBpbmNsdWRlZCBmaWxlIHdvdWxkIG5vdCBiZSBhYmxlIHRvIHVzZSByZWxhdGl2ZSBwYXRoc1xyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aCBwYXRoIGZvciB0aGUgc3BlY2lmaWVkIGZpbGUgKGlmIHJlbGF0aXZlLCBzcGVjaWZ5IGB2aWV3c2Agb24gYG9wdGlvbnNgKVxyXG4gKiBAcGFyYW0gb3B0aW9ucyBjb21waWxhdGlvbiBvcHRpb25zXHJcbiAqIEByZXR1cm4gW0V0YSB0ZW1wbGF0ZSBmdW5jdGlvbiwgbmV3IGNvbmZpZyBvYmplY3RdXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlRmlsZShwYXRoLCBvcHRpb25zKSB7XHJcbiAgICAvLyB0aGUgYmVsb3cgY3JlYXRlcyBhIG5ldyBvcHRpb25zIG9iamVjdCwgdXNpbmcgdGhlIHBhcmVudCBmaWxlcGF0aCBvZiB0aGUgb2xkIG9wdGlvbnMgb2JqZWN0IGFuZCB0aGUgcGF0aFxyXG4gICAgdmFyIG5ld0ZpbGVPcHRpb25zID0gZ2V0Q29uZmlnKHsgZmlsZW5hbWU6IGdldFBhdGgocGF0aCwgb3B0aW9ucykgfSwgb3B0aW9ucyk7XHJcbiAgICAvLyBUT0RPOiBtYWtlIHN1cmUgcHJvcGVydGllcyBhcmUgY3VycmVjdGx5IGNvcGllZCBvdmVyXHJcbiAgICByZXR1cm4gW2hhbmRsZUNhY2hlKG5ld0ZpbGVPcHRpb25zKSwgbmV3RmlsZU9wdGlvbnNdO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckZpbGUoZmlsZW5hbWUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIC8qXHJcbiAgICBIZXJlIHdlIGhhdmUgc29tZSBmdW5jdGlvbiBvdmVybG9hZGluZy5cclxuICAgIEVzc2VudGlhbGx5LCB0aGUgZmlyc3QgMiBhcmd1bWVudHMgdG8gcmVuZGVyRmlsZSBzaG91bGQgYWx3YXlzIGJlIHRoZSBmaWxlbmFtZSBhbmQgZGF0YVxyXG4gICAgSG93ZXZlciwgd2l0aCBFeHByZXNzLCBjb25maWd1cmF0aW9uIG9wdGlvbnMgd2lsbCBiZSBwYXNzZWQgYWxvbmcgd2l0aCB0aGUgZGF0YS5cclxuICAgIFRodXMsIEV4cHJlc3Mgd2lsbCBjYWxsIHJlbmRlckZpbGUgd2l0aCAoZmlsZW5hbWUsIGRhdGFBbmRPcHRpb25zLCBjYilcclxuICAgIEFuZCB3ZSB3YW50IHRvIGFsc28gbWFrZSAoZmlsZW5hbWUsIGRhdGEsIG9wdGlvbnMsIGNiKSBhdmFpbGFibGVcclxuICAgICovXHJcbiAgICB2YXIgcmVuZGVyQ29uZmlnO1xyXG4gICAgdmFyIGNhbGxiYWNrO1xyXG4gICAgZGF0YSA9IGRhdGEgfHwge307IC8vIElmIGRhdGEgaXMgdW5kZWZpbmVkLCB3ZSBkb24ndCB3YW50IGFjY2Vzc2luZyBkYXRhLnNldHRpbmdzIHRvIGVycm9yXHJcbiAgICAvLyBGaXJzdCwgYXNzaWduIG91ciBjYWxsYmFjayBmdW5jdGlvbiB0byBgY2FsbGJhY2tgXHJcbiAgICAvLyBXZSBjYW4gbGVhdmUgaXQgdW5kZWZpbmVkIGlmIG5laXRoZXIgcGFyYW1ldGVyIGlzIGEgZnVuY3Rpb247XHJcbiAgICAvLyBDYWxsYmFja3MgYXJlIG9wdGlvbmFsXHJcbiAgICBpZiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgLy8gVGhlIDR0aCBhcmd1bWVudCBpcyB0aGUgY2FsbGJhY2tcclxuICAgICAgICBjYWxsYmFjayA9IGNiO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIC8vIFRoZSAzcmQgYXJnIGlzIHRoZSBjYWxsYmFja1xyXG4gICAgICAgIGNhbGxiYWNrID0gY29uZmlnO1xyXG4gICAgfVxyXG4gICAgLy8gSWYgdGhlcmUgaXMgYSBjb25maWcgb2JqZWN0IHBhc3NlZCBpbiBleHBsaWNpdGx5LCB1c2UgaXRcclxuICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIHJlbmRlckNvbmZpZyA9IGdldENvbmZpZyhjb25maWcgfHwge30pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBnZXQgdGhlIGNvbmZpZyBmcm9tIHRoZSBkYXRhIG9iamVjdFxyXG4gICAgICAgIC8vIEFuZCB0aGVuIGdyYWIgc29tZSBjb25maWcgb3B0aW9ucyBmcm9tIGRhdGEuc2V0dGluZ3NcclxuICAgICAgICAvLyBXaGljaCBpcyB3aGVyZSBFeHByZXNzIHNvbWV0aW1lcyBzdG9yZXMgdGhlbVxyXG4gICAgICAgIHJlbmRlckNvbmZpZyA9IGdldENvbmZpZyhkYXRhKTtcclxuICAgICAgICBpZiAoZGF0YS5zZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBQdWxsIGEgZmV3IHRoaW5ncyBmcm9tIGtub3duIGxvY2F0aW9uc1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5ncy52aWV3cykge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyQ29uZmlnLnZpZXdzID0gZGF0YS5zZXR0aW5ncy52aWV3cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5nc1sndmlldyBjYWNoZSddKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJDb25maWcuY2FjaGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFVuZG9jdW1lbnRlZCBhZnRlciBFeHByZXNzIDIsIGJ1dCBzdGlsbCB1c2FibGUsIGVzcC4gZm9yXHJcbiAgICAgICAgICAgIC8vIGl0ZW1zIHRoYXQgYXJlIHVuc2FmZSB0byBiZSBwYXNzZWQgYWxvbmcgd2l0aCBkYXRhLCBsaWtlIGByb290YFxyXG4gICAgICAgICAgICB2YXIgdmlld09wdHMgPSBkYXRhLnNldHRpbmdzWyd2aWV3IG9wdGlvbnMnXTtcclxuICAgICAgICAgICAgaWYgKHZpZXdPcHRzKSB7XHJcbiAgICAgICAgICAgICAgICBjb3B5UHJvcHMocmVuZGVyQ29uZmlnLCB2aWV3T3B0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBTZXQgdGhlIGZpbGVuYW1lIG9wdGlvbiBvbiB0aGUgdGVtcGxhdGVcclxuICAgIC8vIFRoaXMgd2lsbCBmaXJzdCB0cnkgdG8gcmVzb2x2ZSB0aGUgZmlsZSBwYXRoIChzZWUgZ2V0UGF0aCBmb3IgZGV0YWlscylcclxuICAgIHJlbmRlckNvbmZpZy5maWxlbmFtZSA9IGdldFBhdGgoZmlsZW5hbWUsIHJlbmRlckNvbmZpZyk7XHJcbiAgICByZXR1cm4gdHJ5SGFuZGxlQ2FjaGUoZGF0YSwgcmVuZGVyQ29uZmlnLCBjYWxsYmFjayk7XHJcbn1cclxuZnVuY3Rpb24gcmVuZGVyRmlsZUFzeW5jKGZpbGVuYW1lLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICByZXR1cm4gcmVuZGVyRmlsZShmaWxlbmFtZSwgdHlwZW9mIGNvbmZpZyA9PT0gJ2Z1bmN0aW9uJyA/IF9fYXNzaWduKF9fYXNzaWduKHt9LCBkYXRhKSwgeyBhc3luYzogdHJ1ZSB9KSA6IGRhdGEsIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnID8gX19hc3NpZ24oX19hc3NpZ24oe30sIGNvbmZpZyksIHsgYXN5bmM6IHRydWUgfSkgOiBjb25maWcsIGNiKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIENhbGxlZCB3aXRoIGBpbmNsdWRlRmlsZShwYXRoLCBkYXRhKWBcclxuICovXHJcbmZ1bmN0aW9uIGluY2x1ZGVGaWxlSGVscGVyKHBhdGgsIGRhdGEpIHtcclxuICAgIHZhciB0ZW1wbGF0ZUFuZENvbmZpZyA9IGluY2x1ZGVGaWxlKHBhdGgsIHRoaXMpO1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlQW5kQ29uZmlnWzBdKGRhdGEsIHRlbXBsYXRlQW5kQ29uZmlnWzFdKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuZnVuY3Rpb24gaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUgJiYgb3B0aW9ucy5uYW1lICYmIG9wdGlvbnMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRlbXBsYXRlRnVuYyA9IHR5cGVvZiB0ZW1wbGF0ZSA9PT0gJ2Z1bmN0aW9uJyA/IHRlbXBsYXRlIDogY29tcGlsZSh0ZW1wbGF0ZSwgb3B0aW9ucyk7XHJcbiAgICAvLyBOb3RlIHRoYXQgd2UgZG9uJ3QgaGF2ZSB0byBjaGVjayBpZiBpdCBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgY2FjaGU7XHJcbiAgICAvLyBpdCB3b3VsZCBoYXZlIHJldHVybmVkIGVhcmxpZXIgaWYgaXQgaGFkXHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLm5hbWUpIHtcclxuICAgICAgICBvcHRpb25zLnRlbXBsYXRlcy5kZWZpbmUob3B0aW9ucy5uYW1lLCB0ZW1wbGF0ZUZ1bmMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBsYXRlRnVuYztcclxufVxyXG4vKipcclxuICogUmVuZGVyIGEgdGVtcGxhdGVcclxuICpcclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIHN0cmluZywgRXRhIHdpbGwgY29tcGlsZSBpdCB0byBhIGZ1bmN0aW9uIGFuZCB0aGVuIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIHRlbXBsYXRlIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIGl0IHdpdGggdGhlIHByb3ZpZGVkIGRhdGEuXHJcbiAqXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGBmYWxzZWAsIEV0YSB3aWxsIHJldHVybiB0aGUgcmVuZGVyZWQgdGVtcGxhdGUuXHJcbiAqXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGB0cnVlYCBhbmQgdGhlcmUncyBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIHRoZSBjYWxsYmFjayB3aXRoIGAoZXJyLCByZW5kZXJlZFRlbXBsYXRlKWAuXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGB0cnVlYCBhbmQgdGhlcmUncyBub3QgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZW5kZXJlZCB0ZW1wbGF0ZS5cclxuICpcclxuICogSWYgYGNvbmZpZy5jYWNoZWAgaXMgYHRydWVgIGFuZCBgY29uZmlnYCBoYXMgYSBgbmFtZWAgb3IgYGZpbGVuYW1lYCBwcm9wZXJ0eSwgRXRhIHdpbGwgY2FjaGUgdGhlIHRlbXBsYXRlIG9uIHRoZSBmaXJzdCByZW5kZXIgYW5kIHVzZSB0aGUgY2FjaGVkIHRlbXBsYXRlIGZvciBhbGwgc3Vic2VxdWVudCByZW5kZXJzLlxyXG4gKlxyXG4gKiBAcGFyYW0gdGVtcGxhdGUgVGVtcGxhdGUgc3RyaW5nIG9yIHRlbXBsYXRlIGZ1bmN0aW9uXHJcbiAqIEBwYXJhbSBkYXRhIERhdGEgdG8gcmVuZGVyIHRoZSB0ZW1wbGF0ZSB3aXRoXHJcbiAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlnIG9wdGlvbnNcclxuICogQHBhcmFtIGNiIENhbGxiYWNrIGZ1bmN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXIodGVtcGxhdGUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIHZhciBvcHRpb25zID0gZ2V0Q29uZmlnKGNvbmZpZyB8fCB7fSk7XHJcbiAgICBpZiAob3B0aW9ucy5hc3luYykge1xyXG4gICAgICAgIGlmIChjYikge1xyXG4gICAgICAgICAgICAvLyBJZiB1c2VyIHBhc3NlcyBjYWxsYmFja1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gTm90ZTogaWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcmVuZGVyaW5nIHRoZSB0ZW1wbGF0ZSxcclxuICAgICAgICAgICAgICAgIC8vIEl0IHdpbGwgYnViYmxlIHVwIGFuZCBiZSBjYXVnaHQgaGVyZVxyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlRm4oZGF0YSwgb3B0aW9ucywgY2IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYihlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBObyBjYWxsYmFjaywgdHJ5IHJldHVybmluZyBhIHByb21pc2VcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlSW1wbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBwcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKShkYXRhLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFdGFFcnIoXCJQbGVhc2UgcHJvdmlkZSBhIGNhbGxiYWNrIGZ1bmN0aW9uLCB0aGlzIGVudiBkb2Vzbid0IHN1cHBvcnQgUHJvbWlzZXNcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucykoZGF0YSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFJlbmRlciBhIHRlbXBsYXRlIGFzeW5jaHJvbm91c2x5XHJcbiAqXHJcbiAqIElmIGB0ZW1wbGF0ZWAgaXMgYSBzdHJpbmcsIEV0YSB3aWxsIGNvbXBpbGUgaXQgdG8gYSBmdW5jdGlvbiBhbmQgY2FsbCBpdCB3aXRoIHRoZSBwcm92aWRlZCBkYXRhLlxyXG4gKiBJZiBgdGVtcGxhdGVgIGlzIGEgZnVuY3Rpb24sIEV0YSB3aWxsIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICpcclxuICogSWYgdGhlcmUgaXMgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgY2FsbCBpdCB3aXRoIGAoZXJyLCByZW5kZXJlZFRlbXBsYXRlKWAuXHJcbiAqIElmIHRoZXJlIGlzIG5vdCBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlbmRlcmVkIHRlbXBsYXRlXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZW1wbGF0ZSBUZW1wbGF0ZSBzdHJpbmcgb3IgdGVtcGxhdGUgZnVuY3Rpb25cclxuICogQHBhcmFtIGRhdGEgRGF0YSB0byByZW5kZXIgdGhlIHRlbXBsYXRlIHdpdGhcclxuICogQHBhcmFtIGNvbmZpZyBPcHRpb25hbCBjb25maWcgb3B0aW9uc1xyXG4gKiBAcGFyYW0gY2IgQ2FsbGJhY2sgZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIHJlbmRlckFzeW5jKHRlbXBsYXRlLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICAvLyBVc2luZyBPYmplY3QuYXNzaWduIHRvIGxvd2VyIGJ1bmRsZSBzaXplLCB1c2luZyBzcHJlYWQgb3BlcmF0b3IgbWFrZXMgaXQgbGFyZ2VyIGJlY2F1c2Ugb2YgdHlwZXNjcmlwdCBpbmplY3RlZCBwb2x5ZmlsbHNcclxuICAgIHJldHVybiByZW5kZXIodGVtcGxhdGUsIGRhdGEsIE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZywgeyBhc3luYzogdHJ1ZSB9KSwgY2IpO1xyXG59XG5cbi8vIEBkZW5vaWZ5LWlnbm9yZVxyXG5jb25maWcuaW5jbHVkZUZpbGUgPSBpbmNsdWRlRmlsZUhlbHBlcjtcclxuY29uZmlnLmZpbGVwYXRoQ2FjaGUgPSB7fTtcblxuZXhwb3J0IHsgcmVuZGVyRmlsZSBhcyBfX2V4cHJlc3MsIGNvbXBpbGUsIGNvbXBpbGVUb1N0cmluZywgY29uZmlnLCBjb25maWd1cmUsIGNvbmZpZyBhcyBkZWZhdWx0Q29uZmlnLCBnZXRDb25maWcsIGxvYWRGaWxlLCBwYXJzZSwgcmVuZGVyLCByZW5kZXJBc3luYywgcmVuZGVyRmlsZSwgcmVuZGVyRmlsZUFzeW5jLCB0ZW1wbGF0ZXMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV0YS5lcy5qcy5tYXBcbiIsImltcG9ydCB7IEFyZ1NldCB9IGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgVkFSX05BTUU6IHN0cmluZyA9ICdzaydcclxuXHJcbmV4cG9ydCBjb25zdCBERUxJTUlURVJTOiBBcmdTZXQgPSB7XHJcblx0XCJQQVNTX1ZBTFVFXCI6IFtcIjpcIl1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFNLX0RFUFRIX0xJTUlUID0gNTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbnVtIE1vZGVzIHtcclxuXHRnZW5lcmFsID0gXCJHRU5FUkFMXCIsXHJcblx0YmxvY2sgPSBcIkJMT0NLXCIsXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlbnVtIEZsYWdzIHtcclxuXHRub25lID0gMCxcclxuXHR0ZW1wbGF0ZSA9IDEsXHJcblx0aW50ZXJwID0gMixcclxuXHRyYXcgPSAzLFxyXG5cdGxpdGVyYWwgPSA0LFxyXG5cdGV2YWwgPSA1XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBFQkFSID0gYFxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbmAiLCJpbXBvcnQgeyBBcHAsIE1hcmtkb3duVmlldywgbm9ybWFsaXplUGF0aCwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IHR5cGUgfSBmcm9tIFwib3NcIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4LCBTdHJpbmdkZXhlZCB9IGZyb20gXCIuL3R5cGVzL3R5cGVzXCI7XHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcblx0aW50ZXJmYWNlIEVsZW1lbnQge1xyXG5cdFx0YWRkQ2xhenoodGhpczogRWxlbWVudCwgc3RyOiBzdHJpbmcgfCBzdHJpbmdbXSk6IHZvaWQ7XHJcblx0XHRhZGRDbGF6eih0aGlzOiBFbGVtZW50LCAuLi5zdHI6IHN0cmluZ1tdKTogdm9pZDtcclxuXHR9XHJcbn1cclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLmFkZENsYXp6ID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuXHRpZiAoQXJyYXkuaXNBcnJheShzdHIpKSB7XHJcblx0XHR0aGlzLmFkZENsYXNzKC4uLnN0cilcclxuXHR9IGVsc2UgdGhpcy5hZGRDbGFzcyhzdHIpXHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsZXMoYXBwOiBBcHAsIGRpcjogc3RyaW5nKTogVEZpbGVbXSB7XHJcblx0bGV0IGRpclBhdGggPSBub3JtYWxpemVQYXRoKGRpcilcclxuXHRsZXQgZm8gPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRpclBhdGgpO1xyXG5cclxuXHQvLyBjb25zb2xlLmxvZyhkaXJQYXRoKSwgY29uc29sZS5sb2coZm8pO1xyXG5cdGlmICghZm8gfHwgIShmbyBpbnN0YW5jZW9mIFRGb2xkZXIpKSB0aHJvdyBgU2tyaWJpOiBDb3VsZCBub3QgZmluZCBmb2xkZXIgJyR7ZGlyUGF0aH0nYDtcclxuXHJcblx0bGV0IGZpbGVzOiBURmlsZVtdID0gW107XHJcblx0VmF1bHQucmVjdXJzZUNoaWxkcmVuKGZvLCAoZmkpID0+IHtcclxuXHRcdGlmIChmaSBpbnN0YW5jZW9mIFRGaWxlKSBmaWxlcy5wdXNoKGZpKVxyXG5cdH0pXHJcblxyXG5cdHJldHVybiBmaWxlcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrRmlsZUV4dChmaWxlczogVEZpbGVbXSB8IFRGaWxlLCBleHRzOiBzdHJpbmdbXSB8IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGV4dHMgPSB0b0FycmF5KGV4dHMpOyBcclxuXHRyZXR1cm4gdG9BcnJheShmaWxlcykuZXZlcnkoKGYpID0+IHtyZXR1cm4gZXh0cy5jb250YWlucyhmLmV4dGVuc2lvbil9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyRmlsZUV4dChmaWxlczogVEZpbGVbXSB8IFRGaWxlLCBleHRzOiBzdHJpbmdbXSB8IHN0cmluZyk6IFRGaWxlW10ge1xyXG5cdGV4dHMgPSB0b0FycmF5KGV4dHMpXHJcblx0cmV0dXJuIHRvQXJyYXkoZmlsZXMpLmZpbHRlcigoZikgPT4ge2lmIChjaGVja0ZpbGVFeHQoZiwgZXh0cykpIHJldHVybiBmfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQXJyYXkoYXJnczogYW55IHwgYW55W10pOiBhbnlbXSB7XHJcblx0cmV0dXJuIChBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6IFthcmdzXSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSW5Gb2xkZXIoZTogVEFic3RyYWN0RmlsZSwgZGlyOiBzdHJpbmcpIHtcclxuXHRsZXQgYm9vID0gKG5vcm1hbGl6ZVBhdGgoKC8uK1xcLy9nKS5leGVjKGUucGF0aClbMF0pID09IG5vcm1hbGl6ZVBhdGgoZGlyKSlcclxuXHJcblx0cmV0dXJuIGJvb1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRhbnQob2JqOiBhbnkpIHtcclxuXHRyZXR1cm4gISgob2JqID09PSBudWxsICkgfHwgKG9iaiA9PT0gdW5kZWZpbmVkKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJvdW5kVG8oeDogYW55LCB0bz86IG51bWJlcik6IG51bWJlciB7XHJcbiAgcmV0dXJuIHBhcnNlRmxvYXQocGFyc2VGbG9hdCh4KS50b1ByZWNpc2lvbih0byA/PyA0KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFZlcmJvc2l0eSgpIHtcclxuXHQvL0B0cy1pZ25vcmVcclxuXHRyZXR1cm4gd2luZG93LmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJvYnNpZGlhbi1za3JpYmlcIl0/LnNldHRpbmdzLnZlcmJvc2VMb2dnaW5nIHx8IGZhbHNlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdkxvZyguLi5hcmdzOiBhbnlbXSkge1xyXG5cdGlmIChnZXRWZXJib3NpdHkoKSkge1xyXG5cdFx0Y29uc29sZS5sb2coXCJTa3JpYmk6XCIsIC4uLmFyZ3MgKVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRMb2coLi4uYXJnczogYW55W10pIHtcclxuXHQvL0B0cy1pZ25vcmVcclxuXHRpZiAod2luZG93Py5hcHAucGx1Z2lucy5wbHVnaW5zW1wib2JzaWRpYW4tc2tyaWJpXCJdPy5zZXR0aW5ncz8uZGV2TG9nZ2luZyB8fCBmYWxzZSkge1xyXG5cdFx0Y29uc29sZS5sb2coLi4uYXJncylcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0b0R1cGVSZWNvcmQoYXJyOiBzdHJpbmdbXSk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xyXG4gIHJldHVybiBhcnIucmVkdWNlKChhLCBpKSA9PiAoey4uLmEsIFtpXTogaX0pLCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gd2l0aG91dEtleTxUIGV4dGVuZHMgeyBbSyBpbiBrZXlvZiBUXTogc3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sIH0+KGlucHV0OiB7W2luZGV4OiBzdHJpbmddOiBhbnl9LCBrZXk6IHN0cmluZyB8IHN0cmluZ1tdKSB7XHJcbiAgY29uc3QgY2xvbmUgPSB7IC4uLmlucHV0IH07XHJcbiAgaWYgKEFycmF5LmlzQXJyYXkoa2V5KSkge1xyXG4gICAgICAoa2V5IGFzIHN0cmluZ1tdKS5mb3JFYWNoKChrKSA9PiB7XHJcbiAgICAgICAgICBkZWxldGUgY2xvbmVba11cclxuICAgICAgfSlcclxuICB9IGVsc2UgeyBkZWxldGUgY2xvbmVba2V5XSB9XHJcbiAgcmV0dXJuIGNsb25lO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgYXN5bmNGdW5jID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGFzeW5jIGZ1bmN0aW9uKCl7fSkuY29uc3RydWN0b3JcclxuZXhwb3J0IGNvbnN0IHByb21pc2VJbXBsOiBQcm9taXNlQ29uc3RydWN0b3IgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5Qcm9taXNlXHJcblxyXG5cclxuXHJcbi8qIFdpbGwgZ2V0IGFjdGl2ZSB2aWV3LCBvciBmaXJzdCBwcmV2aWV3IHZpZXcgd2l0aCBzYW1lIGZpbGUgYXMgYWN0aXZlIHZpZXcgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXZpZXdWaWV3KGFwcDogQXBwLCBmbGlwPzogYm9vbGVhbik6IE1hcmtkb3duVmlldyB7XHJcblx0bGV0IHQxID0gZmxpcCA/IFwicHJldmlld1wiIDogXCJzb3VyY2VcIlxyXG5cdGxldCB0MiA9IGZsaXAgPyBcInNvdXJjZVwiIDogXCJwcmV2aWV3XCJcclxuXHJcblx0dmFyIHZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRpZiAodmlldy5nZXRNb2RlKCkgPT0gdDEpIHtcclxuXHRcdGFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIikuZm9yRWFjaCgobGVhZikgPT4ge1xyXG5cdFx0XHRpZiAoKGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLmdldE1vZGUoKSA9PSB0Mikge1xyXG5cdFx0XHRcdGxldCB6ID0gKGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLnByZXZpZXdNb2RlXHJcblx0XHRcdFx0aWYgKHouZ2V0RmlsZSgpID09IHZpZXcuZmlsZSkge1xyXG5cdFx0XHRcdFx0dmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXdcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdmlldztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBpc0Z1bmMgPSAoZnVuYzogYW55KTogZnVuYyBpcyBGdW5jdGlvbiA9PiAoZnVuYyBpbnN0YW5jZW9mIEZ1bmN0aW9uKVxyXG5leHBvcnQgY29uc3QgaXNGaWxlID0gKGl0ZW06IGFueSk6IGl0ZW0gaXMgVEZpbGUgPT4gKGl0ZW0pIGluc3RhbmNlb2YgVEZpbGU7IFxyXG5cclxuZnVuY3Rpb24gaW52b2tlTWV0aG9kT2ZBbmRSZXR1cm48VD4oZnVuYzoga2V5b2YgVCwgb2JqZWN0czogU3RyaW5nZGV4ZWQ8VD4pIHtcclxuICBsZXQgcmV0czogU3RyaW5nZGV4ID0ge307XHJcbiAgZm9yIChsZXQgbyBvZiBPYmplY3QuZW50cmllcyhvYmplY3RzKSkge1xyXG4gICAgaWYgKChvICE9IG51bGwpICYmIChpc0Z1bmMob1tmdW5jXSkpKSB7XHJcbiAgICAgIHJldHNbb1swXV0gPSAob1sxXVtmdW5jXSBhcyBGdW5jdGlvbikoKVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gcmV0c1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbnZva2VNZXRob2RPZjxUPihmdW5jOiBrZXlvZiBULCAuLi5vYmplY3RzOiBUW10pIHtcclxuICBmb3IgKGxldCBvIG9mIG9iamVjdHMpIHtcclxuICAgIGlmICgobyAhPSBudWxsKSAmJiAoaXNGdW5jKG9bZnVuY10pKSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIChvW2Z1bmNdIGFzIHVua25vd24gYXMgRnVuY3Rpb24pKClcclxuICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYGludm9rZU1ldGhvZE9mOiBjYXVnaHQgZXJyb3IhIFxcbmAsIGBLZXkgY2FsbGVkIGFzIG1ldGhvZDpgLCBmdW5jLCAgYENhbGxlZCBvbjpgLCBvLCBgRXJyb3I6YCwgZXJyKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0QXN5bmNDb25zdHJ1Y3RvciA9ICgpOiBGdW5jdGlvbkNvbnN0cnVjdG9yID0+IG5ldyBGdW5jdGlvbigncmV0dXJuIChhc3luYyBmdW5jdGlvbigpe30pLmNvbnN0cnVjdG9yJykoKVxyXG4iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBQYXJ0aWFsQ29uZmlnIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbmZpZ1wiXHJcbmltcG9ydCB7IENhbGxiYWNrRm4gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvZmlsZS1oYW5kbGVyc1wiXHJcbmltcG9ydCB7IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIHNjb3BlZFZhcnMgfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCJcclxuaW1wb3J0IHsgZExvZywgZ2V0QXN5bmNDb25zdHJ1Y3RvciwgcHJvbWlzZUltcGwgfSBmcm9tIFwic3JjL3V0aWxcIlxyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCJcclxuXHJcbi8qKiBBZGRzIHRoZSBlbnRyaWVzIG9mIHNjb3BlIHRvIGEgZnVuY3Rpb24gc3RyaW5nLiBcclxuKiBAcGFyYW0gZnVuY3Rpb25TdHJpbmcgQSBzdHJpbmcgZnVuY3Rpb24gY29tcGlsZWQgYnkgRXRhJ3MgY29tcGlsZVRvU3RyaW5nKCkgXHJcbiogQHBhcmFtIGtleXMgQXJyYXkgb2Yga2V5cyB0aGF0IHRoZSByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGV4cGVjdCB0byBiZSBwcmVzZW50IGluIGl0cyBzY29wZSBhcmd1bWVudFxyXG4qIEBwYXJhbSBhc3luYyBJZiB0cnVlLCByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGJlIGFzeW5jaHJvbm91cyAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVdpdGgoZnVuY3Rpb25TdHJpbmc6IHN0cmluZywga2V5czogc3RyaW5nW10sIGFzeW5jPzogYm9vbGVhbik6IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQge1xyXG4gIHZhciBhID0gXCJcIjsgdmFyIGIgPSBcIlwiO1xyXG4gIGZvciAobGV0IGsgb2Yga2V5cykge1xyXG4gICAgYSArPSBgJHtrfSxgXHJcbiAgICBiICs9IGAnJHtrfScsYFxyXG4gIH1cclxuICBsZXQgZnVuYyA9IGB2YXIgeyR7YS5zdWJzdHIoMCwgYS5sZW5ndGgtMSl9fSA9IHNjb3BlO1xcbmAgKyBmdW5jdGlvblN0cmluZ1xyXG4gIGxldCBjb25zdHJ1Y3RvciA9IChhc3luYykgPyBnZXRBc3luY0NvbnN0cnVjdG9yKCkgOiBGdW5jdGlvbiBcclxuICBsZXQgY29tcGlsZWQgPSBuZXcgY29uc3RydWN0b3IoJ3Njb3BlJywgZnVuYylcclxuICByZXR1cm4gY29tcGlsZWQgYXMgVGVtcGxhdGVGdW5jdGlvblNjb3BlZFxyXG59XHJcblxyXG4vKiBWZXJzaW9uIG9mIEV0YSdzIHJlbmRlciBmdW5jdGlvbiwgbW9kaWZpZWQgdG8gaGFuZGxlIHNjb3BlZCB0ZW1wbGF0ZXMgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckV0YShcclxuICBoYW5kbGVyOiBFdGFIYW5kbGVyLFxyXG4gIHRlbXBsYXRlOiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLFxyXG4gIGRhdGE6IG9iamVjdCxcclxuICBjb25maWc/OiBQYXJ0aWFsQ29uZmlnLFxyXG4gIGNiPzogQ2FsbGJhY2tGbixcclxuICBzY29wZT86IHNjb3BlZFZhcnMsXHJcbiAgYmluZGVyPzogYW55XHJcbiAgKTogc3RyaW5nIHwgUHJvbWlzZTxzdHJpbmc+IHwgdm9pZCB7XHJcbiAgY29uc3Qgb3B0aW9ucyA9IEV0YS5nZXRDb25maWcoY29uZmlnIHx8IHt9KVxyXG5cclxuICBpZiAob3B0aW9ucy5hc3luYykge1xyXG4gICAgLy8gaWYgKGNiKSB7XHJcbiAgICAgIC8vIHRyeSB7IFxyXG4gICAgICAgIC8vIGNvbnN0IHRlbXBsYXRlRm4gPSBoYW5kbGVyLmdldENhY2hlZCh0ZW1wbGF0ZSwgb3B0aW9ucywgc2NvcGUsIGJpbmRlcilcclxuICAgICAgICAvLyB0ZW1wbGF0ZUZuKHNjb3BlKVxyXG4gICAgICAvLyB9IGNhdGNoKGUpIHtcclxuICAgICAgICAvLyByZXR1cm4gY2IoZSlcclxuICAgICAgLy8gfVxyXG4gICAgLy8gfSBlbHNlIHtcclxuXHJcbiAgICAgIC8vIHJldHVybiAoYXN5bmMgKCkgPT4gaGFuZGxlci5nZXRDYWNoZWQodGVtcGxhdGUsIG9wdGlvbnMsIHNjb3BlLCBiaW5kZXIpKHNjb3BlKSkoKVxyXG4gICAgICByZXR1cm4gbmV3IHByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlOiBGdW5jdGlvbiwgcmVqZWN0OiBGdW5jdGlvbikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICByZXNvbHZlKGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKShzY29wZSkpXHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgcmVqZWN0KGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgLy8gfVxyXG4gIH0gZWxzZSB7XHJcbiAgICBsZXQgZnVuYyA9IGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKVxyXG4gICAgZExvZyhgUmVuZGVyaW5nIGZ1bmN0aW9uYCwgZnVuYylcclxuICAgIHJldHVybiBmdW5jKHNjb3BlKVxyXG4gIH1cclxufVxyXG5cclxuLyogVmVyc2lvbiBvZiBFdGEncyBhc3luYyByZW5kZXIgZnVuY3Rpb24sIGp1c3Qgc2V0cyBhc3luYyB0byB0cnVlICovXHJcbi8qIE5vdGU6IHBlcmYgaW1wYWN0IG9mIHVzaW5nIGFzeW5jIHRlbXBsYXRlZnVuY3Rpb25zIGlzIG5lZ2xpZ2libGUgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckV0YUFzeW5jKFxyXG4gIGhhbmRsZXI6IEV0YUhhbmRsZXIsXHJcbiAgdGVtcGxhdGU6IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsXHJcbiAgZGF0YTogb2JqZWN0LFxyXG4gIGNvbmZpZz86IFBhcnRpYWxDb25maWcsXHJcbiAgY2I/OiBDYWxsYmFja0ZuLFxyXG4gIHNjb3BlPzogc2NvcGVkVmFycyxcclxuICBiaW5kZXI/OiBhbnlcclxuICApOiBzdHJpbmcgfCBQcm9taXNlPHN0cmluZz4gfCB2b2lkIHtcclxuICAgIHJldHVybiByZW5kZXJFdGEoaGFuZGxlciwgdGVtcGxhdGUsIGRhdGEsIE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZywge2FzeW5jOiB0cnVlfSksIGNiLCBzY29wZSwgYmluZGVyKVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBpc0V4dGFudCB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBQcm92aWRlckJ1cyB9IGZyb20gXCIuL3Byb3ZpZGVyX2J1c1wiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJUHJvdmlkZXIge1xyXG4gIGlkOiBzdHJpbmdcclxuICBidXM6IFByb3ZpZGVyQnVzXHJcbiAgZnVuY3Rpb25zOiBNYXA8c3RyaW5nLCBhbnk+O1xyXG4gIGNyZWF0ZU9iamVjdCgpOiBTdHJpbmdkZXg7XHJcbiAgaW5pdCgpOiBQcm9taXNlPHZvaWQ+OyAgICAgICAgICAgICAgICAgICAvLyBDYWxsZWQgb25jZSwgb24gYnVzIGxvYWRcclxuICB1bmxvYWQoKTogdm9pZDsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGVkIG9uY2UsIG9uIGJ1cyB1bmxvYWRcclxuICByZWxvYWQoKTogUHJvbWlzZTxhbnk+OyAgICAgICAgICAgICAgICAgLy8gTWF5IGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lc1xyXG5cclxuICBzZXREaXJ0eSgpOiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgUHJvdmlkZXIgaW1wbGVtZW50cyBJUHJvdmlkZXIge1xyXG4gIGlkOiBzdHJpbmdcclxuICBidXM6IFByb3ZpZGVyQnVzO1xyXG4gIGZ1bmN0aW9uczogTWFwPHN0cmluZywgYW55PiA9IG5ldyBNYXAoKVxyXG4gIGluaXRMb2FkZWQgPSBmYWxzZTtcclxuICBpc0RpcnR5OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGJ1czogUHJvdmlkZXJCdXMsIGlkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuYnVzID0gYnVzXHJcbiAgICB0aGlzLmlkID0gaWRcclxuICB9XHJcblxyXG4gIFtpbmRleDogc3RyaW5nXTogYW55O1xyXG5cclxuICBjcmVhdGVPYmplY3QoKTogU3RyaW5nZGV4IHtcclxuICAgIHJldHVybiB7Li4uT2JqZWN0LmZyb21FbnRyaWVzKHRoaXMuZnVuY3Rpb25zKX1cclxuICB9XHJcblxyXG4gIGluaXQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLmluaXRMb2FkZWQgPSB0cnVlXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIHVubG9hZCgpOiB2b2lkIHt9XHJcbiAgcmVsb2FkKCk6IFByb21pc2U8YW55PiB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBjbGVhbiBJZiB0cnVlLCBwcm92aWRlci5pc0RpcnR5ID0gZmFsc2UgKi9cclxuICBzZXREaXJ0eShkaXJ0eT86IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuaXNEaXJ0eSA9IGlzRXh0YW50KGRpcnR5KSA/IGRpcnR5IDogdHJ1ZVxyXG4gICAgdGhpcy5idXMucHJvdmlkZXJOb3RpZmljYXRpb25EaXJ0eSh0aGlzLCB0aGlzLmlzRGlydHkpXHJcbiAgfVxyXG59XHJcblxyXG4vKiogXHJcbiAqIFByZWRpY2F0ZWQgcHJvdmlkZXJzIGFyZSByZXNwb25zaWJsZSBmb3IgbW9kdWxlcyB0aGF0IHJlcXVpcmUgY2VydGFpbiBjb25kaXRpb25zIHRvIGZ1bmN0aW9uICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVByb3ZpZGVyUHJlZGljYXRlZCBleHRlbmRzIElQcm92aWRlciB7XHJcbiAgcHJlZGljYXRlQ2hlY2soKTogYm9vbGVhblxyXG4gIHByZWRpY2F0ZUVycm9yKCk6IHN0cmluZ1xyXG4gIGdldFByZWRpY2F0ZSgpOiBQbHVnaW5cclxufVxyXG4gXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQcm92aWRlclByZWRpY2F0ZWQgZXh0ZW5kcyBQcm92aWRlciBpbXBsZW1lbnRzIElQcm92aWRlclByZWRpY2F0ZWQge1xyXG4gIHByZWRpY2F0ZVBsdWdpbk5hbWU6IHN0cmluZyA9ICcnXHJcbiAgXHJcbiAgZ2V0UHJlZGljYXRlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zPy5bdGhpcy5wcmVkaWNhdGVQbHVnaW5OYW1lXSB8fCBudWxsXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJucyB0cnVlIG9ubHkgd2hlbiB0aGUgcHJlZGljYXRlIGNvbmRpdGlvbiBpcyBtZXQgKi9cclxuICBwcmVkaWNhdGVDaGVjaygpIHtcclxuICAgIHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uYXBwLnBsdWdpbnMuZW5hYmxlZFBsdWdpbnMuaGFzKHRoaXMucHJlZGljYXRlUGx1Z2luTmFtZSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm5zIEFuIGVycm9yIHN0cmluZyBkZXNjcmliaW5nIHRoZSB1bm1ldCBwcmVkaWNhdGUgY29uZGl0aW9uICovXHJcbiAgcHJlZGljYXRlRXJyb3IoKSB7XHJcbiAgICByZXR1cm4gYEludGVncmF0aW9uIE1vZHVsZSAnJHt0aGlzLmlkfScgbm90IGF2YWlsYWJsZSwgY291bGQgbm90IGZpbmQgcmVxdWlyZWQgcGx1Z2luOiAnJHt0aGlzLnByZWRpY2F0ZVBsdWdpbk5hbWV9J2BcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcInNyYy9ldGEvcHJvdmlkZXJfYWJzXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyQnVzIH0gZnJvbSBcInNyYy9ldGEvcHJvdmlkZXJfYnVzXCI7XHJcbmltcG9ydCB7IFN0cmluZ2RleCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlclNLIGV4dGVuZHMgUHJvdmlkZXIge1xyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICBjcmVhdGVPYmplY3QoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZW5kZXI6IGZ1bmN0aW9uKHN0cjogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGUgPSBjcmVhdGVEaXYoe2NsczogXCJza3JpYmktcmVuZGVyLXZpcnR1YWxcIn0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMpXHJcbiAgICAgICAgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihzdHIsIGUsIHRoaXMudGhpcy5maWxlLnBhdGgsIG51bGwpO1xyXG4gICAgICAgIHJldHVybiBlLmlubmVySFRNTFxyXG4gICAgICB9LFxyXG4gICAgICBoYXM6IGZ1bmN0aW9uKHY6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiAhKCh0aGlzLnY/Llt2XSA9PSBudWxsKSB8fCAodGhpcy52Py5bdl0gPT0gdW5kZWZpbmVkKSlcclxuICAgICAgfSxcclxuICAgICAgYWJvcnQ6IGZ1bmN0aW9uKHM6IHN0cmluZyB8IFN0cmluZ2RleCkge1xyXG4gICAgICAgIGxldCBhYm9ydFBhY2tldCA9IFN0cmluZy5pc1N0cmluZyhzKSBcclxuICAgICAgICA/IHtoYXNEYXRhOiB0cnVlLCBmbGFnOiAnYWJvcnQnLCBob3Zlcjogc30gXHJcbiAgICAgICAgOiBPYmplY3QuYXNzaWduKHtoYXNEYXRhOiB0cnVlLCBmbGFnOiAnYWJvcnQnfSwgcylcclxuICAgICAgICB0aHJvdyBhYm9ydFBhY2tldFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG4gIH1cclxufSIsImltcG9ydCB7IEV2ZW50UmVmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbi8vIGltcG9ydCB7IERhdGF2aWV3SW5saW5lQXBpIH0gZnJvbSBcIm9ic2lkaWFuLWRhdGF2aWV3L2xpYi9hcGkvaW5saW5lLWFwaVwiO1xyXG5pbXBvcnQgeyBQcm92aWRlclByZWRpY2F0ZWQgfSBmcm9tIFwic3JjL2V0YS9wcm92aWRlcl9hYnNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlckRhdGF2aWV3IGV4dGVuZHMgUHJvdmlkZXJQcmVkaWNhdGVkIHtcclxuICBwcmVkaWNhdGVQbHVnaW5OYW1lID0gJ2RhdGF2aWV3J1xyXG4gIC8vIGR2cDogRGF0YXZpZXdQbHVnaW4gPSBudWxsXHJcblxyXG4gIGV2ZW50UmVmX0FQSV9SRUFEWTogRXZlbnRSZWZcclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIC8vIHRoaXMuZHZwID0gdGhpcy5idXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXcgYXMgRGF0YXZpZXdQbHVnaW4gfHwgbnVsbFxyXG5cclxuICAgIHRoaXMuZXZlbnRSZWZfQVBJX1JFQURZID0gdGhpcy5idXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdkYXRhdmlldzphcGktcmVhZHknLCAoYXBpKSA9PiB7dGhpcy5hcGlSZWFkeSgpfSlcclxuXHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmJ1cy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub2ZmcmVmKHRoaXMuZXZlbnRSZWZfQVBJX1JFQURZKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlT2JqZWN0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zPy5kYXRhdmlldz8uYXBpIHx8IG51bGxcclxuICB9XHJcblxyXG4gIGFwaVJlYWR5KCkge1xyXG5cclxuICB9XHJcblxyXG4gIC8vIGNyZWF0ZUR5bmFtaWMoc3RhdGU6IER5bmFtaWNTdGF0ZSkge1xyXG4gICAgLy8gbGV0IGFwaSA9IG5ldyBEYXRhdmlld0lubGluZUFwaSh0aGlzLmR2cC5pbmRleCwgc3RhdGUuY2hpbGQsIHN0YXRlLmVsLCB0aGlzLmJ1cy5wbHVnaW4uYXBwLCB0aGlzLmR2cC5zZXR0aW5ncywgc3RhdGUuZmlsZS5wYXRoKVxyXG5cclxuICAgIC8vIHJldHVybiB0aGlzPy5kdnA/LmFwaSB8fCBudWxsXHJcbiAgLy8gfVxyXG59XHJcbiIsImltcG9ydCB7IFByb3ZpZGVyUHJlZGljYXRlZCB9IGZyb20gXCIuLi8uLi9wcm92aWRlcl9hYnNcIjtcclxuaW1wb3J0IHR5cGUgV2VhdGhlckFQSSBmcm9tIFwiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4td2VhdGhlci9zcmMvYXBpXCI7XHJcbmltcG9ydCB7IEV2ZW50UmVmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJXZWF0aGVyIGV4dGVuZHMgUHJvdmlkZXJQcmVkaWNhdGVkIHtcclxuICBwcmVkaWNhdGVQbHVnaW5OYW1lOiBzdHJpbmcgPSAnb2JzaWRpYW4td2VhdGhlcidcclxuXHJcbiAgcHJpdmF0ZSBldmVudFJlZnM6IHtcclxuICAgIHJlYWR5OiBFdmVudFJlZiBcclxuICAgIHVubG9hZDogRXZlbnRSZWZcclxuICAgIHRpY2s6IEV2ZW50UmVmXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgdGhpcy5ldmVudFJlZnMgPSB7XHJcbiAgICAgIHJlYWR5OiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXJlYWR5XCIsICgpID0+IHt9KSxcclxuICAgICAgdW5sb2FkOiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXVubG9hZFwiLCAoKSA9PiB7fSksXHJcbiAgICAgIHRpY2s6IHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwiYXotd2VhdGhlcjphcGktdGlja1wiLCAoKSA9PiB7fSlcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmZ1bmN0aW9ucy5zZXQoXCJjaGVja1wiLCB0aGlzLnByb3ZpZGVfcHJlZGljYXRlKCkpXHJcbiAgICB0aGlzLmZ1bmN0aW9ucy5zZXQoXCJjYWNoZVwiLCB0aGlzLnByb3ZpZGVfZGlzcGVuc2VDYWNoZSgpKVxyXG4gICAgdGhpcy5mdW5jdGlvbnMuc2V0KFwidGlja0V2ZW50UmVmXCIsIHRoaXMucHJvdmlkZV90aWNrRXZlbnRSZWYoKSlcclxuXHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICBmb3IgKGxldCByIG9mIE9iamVjdC52YWx1ZXModGhpcy5ldmVudFJlZnMpKSB7XHJcbiAgICAgIHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9mZnJlZihyKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyogUHJvdmlzaW9ucyAqL1xyXG5cclxuICBwcm92aWRlX3ByZWRpY2F0ZSgpOiBGdW5jdGlvbiB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gKCEhdGhpcy53ZWF0aGVyQVBJKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJvdmlkZV9kaXNwZW5zZUNhY2hlKCk6IEZ1bmN0aW9uIHtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIGxldCBwOiBhbnkgPSB0aGlzLmdldFByZWRpY2F0ZSgpO1xyXG4gICAgICByZXR1cm4gcD8uQVBJPy5kaXNwZW5zZUNhY2hlLmJpbmQocC5BUEkpKClcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICBwcm92aWRlX3RpY2tFdmVudFJlZigpOiBGdW5jdGlvbiB7XHJcbiAgICByZXR1cm4gKGNiOiBGdW5jdGlvbikgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJhei13ZWF0aGVyOmFwaS10aWNrXCIsICguLi5hOiBhbnkpID0+IGNiKC4uLmEpKVxyXG4gICAgfVxyXG4gIH1cclxufSIsImltcG9ydCB7IEZpbGVTeXN0ZW1BZGFwdGVyLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXgsIFN0cmluZ2RleGVkIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBkTG9nLCBmaWx0ZXJGaWxlRXh0LCBnZXRGaWxlcywgaXNFeHRhbnQsIGlzRmlsZSwgdkxvZywgd2l0aG91dEtleSB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gXCIuLi9wcm92aWRlcl9hYnNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlclNjcmlwdGxvYWRlciBleHRlbmRzIFByb3ZpZGVyIHtcclxuICBsb2FkZWRNb2R1bGVzOiBNYXA8c3RyaW5nLCB7bmFtZT86IHN0cmluZywgcHJvcGVydGllczogU3RyaW5nZGV4fT4gPSBuZXcgTWFwKClcclxuXHJcbiAgZ2V0IGRpcmVjdG9yeSgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5idXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlciB9XHJcblxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pbml0TG9hZCgpLnRoZW4oKCkgPT4gc3VwZXIuaW5pdCgpKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5sb2FkQW5kU2V0KC4uLmdldEZpbGVzKHRoaXMuYnVzLnBsdWdpbi5hcHAsIHRoaXMuYnVzLnBsdWdpbi5zZXR0aW5ncy5zY3JpcHRGb2xkZXIpKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZEFuZFNldCguLi5maWxlOiBURmlsZVtdKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZWFkRmlsZXMoLi4uZmlsZSlcclxuICAgIC50aGVuKChyZXQpID0+IHsvKnZMb2coJ0xvYWRpbmcgSlMgbW9kdWxlcy4uLicsIHJldCk7Ki8gdGhpcy5zdGFzaE1vZHVsZShyZXQpOyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KTtcclxuICB9XHJcblxyXG4gIHN0YXNoTW9kdWxlKG1vZHVsZXM6IFtzdHJpbmcsIFN0cmluZ2RleF1bXSkge1xyXG4gICAgZExvZygnU2NyaXB0bG9hZGVyOiBzdGFzaE1vZHVsZScsIG1vZHVsZXMpXHJcblxyXG4gICAgbW9kdWxlcy5tYXAoKHIpID0+IHtcclxuICAgICAgaWYgKHIpIHtcclxuICAgICAgICB0aGlzLmxvYWRlZE1vZHVsZXMuZGVsZXRlKHJbMF0pXHJcbiAgICAgICAgdGhpcy5sb2FkZWRNb2R1bGVzLnNldChyWzBdLCB7XHJcbiAgICAgICAgICBuYW1lOiAoU3RyaW5nLmlzU3RyaW5nKHJbMV0/Ll9uYW1lID8/IG51bGwpID8gclsxXS5fbmFtZSA6IG51bGwpLCBcclxuICAgICAgICAgIHByb3BlcnRpZXM6IHdpdGhvdXRLZXkoclsxXSwgJ19uYW1lJylcclxuICAgICAgICAgIH0gICAgICAgICAgXHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlT2JqZWN0KCk6IFN0cmluZ2RleCB7XHJcbiAgICBsZXQgZXhwb3J0czogTWFwPHN0cmluZywgYW55PiA9IG5ldyBNYXAoKVxyXG4gICAgdGhpcy5sb2FkZWRNb2R1bGVzLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcclxuICAgICAgbGV0IHNpbmdsZSA9IChPYmplY3Qua2V5cyh2YWx1ZS5wcm9wZXJ0aWVzKS5sZW5ndGggPT0gMSkgXHJcblxyXG4gICAgICBleHBvcnRzLnNldCgodmFsdWUubmFtZSA/PyAoc2luZ2xlID8gT2JqZWN0LmtleXModmFsdWUucHJvcGVydGllcylbMF0gOiBrZXkpKSxcclxuICAgICAgICBzaW5nbGUgPyBPYmplY3QudmFsdWVzKHZhbHVlLnByb3BlcnRpZXMpWzBdIDogdmFsdWUucHJvcGVydGllc1xyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiB7Li4uT2JqZWN0LmZyb21FbnRyaWVzKGV4cG9ydHMpfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVhZEZpbGVzKC4uLmZpbGVzOiBURmlsZVtdKTogUHJvbWlzZTxbc3RyaW5nLCBTdHJpbmdkZXhdW10+IHtcclxuICAgIGxldCBmaWx0ZXJlZCA9IGZpbHRlckZpbGVFeHQoZmlsZXMsIFwianNcIilcclxuICAgIGNvbnN0IHJlYWRzID0gZmlsdGVyZWQubWFwKGFzeW5jIChmKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKCEodGhpcy5idXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyIGluc3RhbmNlb2YgRmlsZVN5c3RlbUFkYXB0ZXIpKSByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICBsZXQgcGF0aCA9IHRoaXMuYnVzLnBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5nZXRCYXNlUGF0aCgpICsgXCIvXCIgKyBmLnBhdGhcclxuICAgICAgICBcclxuICAgICAgICBsZXQgcmVzUGF0aCA9IHdpbmRvdy5yZXF1aXJlLnJlc29sdmUocGF0aClcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXMod2luZG93LnJlcXVpcmUuY2FjaGUpLmNvbnRhaW5zKHJlc1BhdGgpKSBkZWxldGUgd2luZG93LnJlcXVpcmUuY2FjaGVbd2luZG93LnJlcXVpcmUucmVzb2x2ZShyZXNQYXRoKV1cclxuXHJcbiAgICAgICAgY29uc3QgbW9kID0gcmVxdWlyZShwYXRoKVxyXG5cclxuICAgICAgICByZXR1cm4gKGlzRXh0YW50KG1vZCkpIFxyXG4gICAgICAgICAgPyBQcm9taXNlLnJlc29sdmUoW2YuYmFzZW5hbWUsIG1vZF0pXHJcbiAgICAgICAgICA6IFByb21pc2UucmVqZWN0KClcclxuICAgICAgfSBjYXRjaChlKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGUpXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KClcclxuICAgICAgfSAgICAgIFxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHJlYWRzKVxyXG4gICAgLnRoZW4oKHNldHRsZWQpID0+IHsgcmV0dXJuIHNldHRsZWRcclxuICAgICAgLmZpbHRlcigocikgPT4ge3JldHVybiByLnN0YXR1cyA9PSBcImZ1bGZpbGxlZFwifSlcclxuICAgICAgLm1hcCgodikgPT4ge3JldHVybiAodiBhcyBQcm9taXNlRnVsZmlsbGVkUmVzdWx0PFtzdHJpbmcsIFN0cmluZ2RleF0+KS52YWx1ZX0pXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY2xlYXJKUyguLi5pdGVtczogQXJyYXk8VEZpbGUgfCBzdHJpbmc+KTogdm9pZCB7XHJcbiAgICBsZXQgbmFtZXMgPSBpdGVtcy5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgaWYgKGlzRmlsZShpdGVtKSkgcmV0dXJuIGZpbHRlckZpbGVFeHQoaXRlbSwgJ2pzJylbMF0uYmFzZW5hbWVcclxuICAgICAgZWxzZSBpZiAoU3RyaW5nLmlzU3RyaW5nKGl0ZW0pKSByZXR1cm4gaXRlbSBcclxuICAgIH0pXHJcblxyXG4gICAgZm9yIChsZXQgbmFtZSBvZiBuYW1lcykgdGhpcy5sb2FkZWRNb2R1bGVzLmRlbGV0ZShuYW1lKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVsb2FkKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdGhpcy5sb2FkZWRNb2R1bGVzLmNsZWFyKClcclxuICAgIGF3YWl0IHRoaXMuaW5pdExvYWQoKVxyXG4gICAgcmV0dXJuIHN1cGVyLnJlbG9hZCgpXHJcbiAgfVxyXG5cclxuICAvLyBFdmVudCBsaXN0ZW5lcnMgZm9yIGZpbGUgZXZlbnRzIHJlZ2lzdGVyZWQgYnkgRXRhSGFuZGVyXHJcbiAgZmlsZVVwZGF0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgaW4gc2NyaXB0IGRpcmVjdG9yeSBtb2RpZmllZCwgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5jbGVhckpTKGZpbGUpXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB0aGlzLmNsZWFySlMoZmlsZSkpXHJcbiAgfVxyXG5cclxuICBmaWxlRGVsZXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyByZW1vdmVkIGZyb20gc2NyaXB0IGRpcmVjdG9yeSwgdW5sb2FkaW5nLi4uYClcclxuICAgIHRoaXMuY2xlYXJKUyhmaWxlKVxyXG4gICAgdGhpcy5zZXREaXJ0eSgpXHJcbiAgfVxyXG5cclxuICBmaWxlQWRkZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgYWRkZWQgdG8gc2NyaXB0IGRpcmVjdG9yeSwgbG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB0aGlzLmNsZWFySlMoZmlsZSkpXHJcbiAgfVxyXG5cclxuICBmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBTY3JpcHQgZmlsZSAnJHtvbGROYW1lfScgcmVuYW1lZCB0byAnJHtmaWxlLm5hbWV9JywgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5jbGVhckpTKG9sZE5hbWUpXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB7fSlcclxuICB9XHJcblxyXG4gIGRpcmVjdG9yeUNoYW5nZWQoKTogdm9pZCB7XHJcbiAgICB2TG9nKGBTY3JpcHQgZGlyZWN0b3J5IGNoYW5nZWQsIHJlbG9hZGluZyBzY3JpcHRzLi4uYClcclxuICAgIHRoaXMucmVsb2FkKCkudGhlbigoKSA9PiB0aGlzLnNldERpcnR5KCksIChlKSA9PiB7Y29uc29sZS53YXJuKGUpfSlcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQXBwLCBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xyXG5pbXBvcnQgeyBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IHsgRHluYW1pY1N0YXRlLCBTdHJpbmdkZXgsIFN0cmluZ2RleGVkIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBpc0Z1bmMgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gXCIuL2V0YVwiO1xyXG5pbXBvcnQgeyBQcm92aWRlclNLIH0gZnJvbSBcIi4vcHJvdmlkZXJzL2Jhc2VcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJEYXRhdmlldyB9IGZyb20gXCIuL3Byb3ZpZGVycy9pbnRlZ3JhdGlvbi9kdlwiO1xyXG5pbXBvcnQgeyBQcm92aWRlcldlYXRoZXIgfSBmcm9tIFwiLi9wcm92aWRlcnMvaW50ZWdyYXRpb24vd2VhdGhlclwiO1xyXG5pbXBvcnQgeyBQcm92aWRlclNjcmlwdGxvYWRlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9zY3JpcHRsb2FkZXJcIjtcclxuaW1wb3J0IHsgSVByb3ZpZGVyLCBQcm92aWRlciwgUHJvdmlkZXJQcmVkaWNhdGVkIH0gZnJvbSBcIi4vcHJvdmlkZXJfYWJzXCI7XHJcblxyXG5jb25zdCBvYnNpZGlhbk1vZHVsZSA9IHJlcXVpcmUoXCJvYnNpZGlhblwiKTtcclxuXHJcbmNvbnN0IE1PRFVMRV9OQU1FX0lOVEVHUkFUSU9OUzogc3RyaW5nID0gJ2ludCc7XHJcblxyXG50eXBlIFByb3ZpZGVyaXNoID0gSVByb3ZpZGVyXHJcblxyXG4vKiBIYW5kbGVzIGFsbCBzY3JpcHQgZnVuY3Rpb24gcHJvdmlkZXJzICovXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlckJ1cyB7XHJcblxyXG4gIGhhbmRsZXI6IEV0YUhhbmRsZXJcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuXHJcbiAgcHJvdmlkZXJzOiBNYXA8c3RyaW5nLCBQcm92aWRlcj4gPSBuZXcgTWFwKClcclxuICBwcm92aWRlcnNQcmVkaWNhdGVkOiBNYXA8c3RyaW5nLCBQcm92aWRlclByZWRpY2F0ZWQ+ID0gbmV3IE1hcCgpXHJcblxyXG4gIC8qIEhhcyBhIHJlZmVyZW5jZSBzbyB0aGF0IGl0IGNhbiBiZSBub3RpZmllZCBieSB1cGRhdGUgZXZlbnRzICovXHJcbiAgc2NyaXB0TG9hZGVyOiBQcm92aWRlclNjcmlwdGxvYWRlcjtcclxuXHJcbiAgc2tCYXNlOiBQcm92aWRlclNLO1xyXG5cclxuICBwcml2YXRlIHNjb3BlU3RhdGljOiBTdHJpbmdkZXggPSB7fVxyXG5cclxuICAvLyBJbmRpY2F0ZXMgdGhhdCBhIHByb3ZpZGVyIGhhcyBiZWVuIGFkZGVkIG9yIHJlbW92ZWQsIGFuZCB0aGUgc3RhdGljIHNjb3BlIHNob3VsZCBiZSByZWdlbmVyYXRlZC5cclxuICBpc1N0YXRpY1Njb3BlRGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoaGFuZGxlcjogRXRhSGFuZGxlcikge1xyXG4gICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlclxyXG4gICAgdGhpcy5wbHVnaW4gPSBoYW5kbGVyLnBsdWdpblxyXG5cclxuICAgIHRoaXMuc2NyaXB0TG9hZGVyID0gbmV3IFByb3ZpZGVyU2NyaXB0bG9hZGVyKHRoaXMsICdqcycpOyAvLyBhc3NpZ25lZCBoZXJlIHNvIHRoYXQgd2UgY2FuIHJlZ2lzdGVyIGZpbGUgZXZlbnRzIGluIGhhbmRsZXJcclxuICB9XHJcblxyXG4gIC8qIENvbnN0cnVjdCBhbGwgcHJvdmlkZXJzIGJ1dCBkbyBub3QgaW5pdGlhbGl6ZSB0aGVtIHlldCwgc28gdGhhdCB3ZSBjYW4gY29tcGlsZSBhbmQgY2FjaGUgdGVtcGxhdGVzIEFTQVAgKi9cclxuICBhc3luYyBwcmVJbml0KCkge1xyXG4gICAgdGhpcy5hZGRUbyh0aGlzLnByb3ZpZGVycywgdGhpcy5zY3JpcHRMb2FkZXIpXHJcbiAgICB0aGlzLmFkZFRvKHRoaXMucHJvdmlkZXJzUHJlZGljYXRlZCwgbmV3IFByb3ZpZGVyRGF0YXZpZXcodGhpcywgJ2R2JykpXHJcbiAgICB0aGlzLmFkZFRvKHRoaXMucHJvdmlkZXJzUHJlZGljYXRlZCwgbmV3IFByb3ZpZGVyV2VhdGhlcih0aGlzLCAnd2VhdGhlcicpKVxyXG4gICAgdGhpcy5za0Jhc2UgPSBuZXcgUHJvdmlkZXJTSyh0aGlzLCBWQVJfTkFNRSlcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIGNvbnN0IGluaXRzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmV4ZWNPblByb3ZpZGVycygnaW5pdCcpKVxyXG5cclxuICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChpbml0cylcclxuICAgIHRoaXMuY3JlYXRlU3RhdGljU2NvcGUoKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZFRvKHByb3ZpZGVyczogTWFwPHN0cmluZywgSVByb3ZpZGVyPiwgcHJvdmlkZXI6IFByb3ZpZGVyKSB7XHJcbiAgICBwcm92aWRlcnMuc2V0KHByb3ZpZGVyLmlkLCBwcm92aWRlcilcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEludGVncmF0aW9uIHBvaW50IGZvciBvdGhlciBwbHVnaW5zIHRvIGFkZCBhIHByb3ZpZGVyIFxyXG4gICAqIEBwYXJhbSBwcm92aWRlciBQcm92aWRlciBpbXBsZW1lbnRhdGlvbiB0byBhZGQgKi9cclxuICBwdWJsaWMgYWRkUHJvdmlkZXIgPSAocHJvdmlkZXI6IFByb3ZpZGVyKSA9PiB7XHJcbiAgICB0aGlzLnByb3ZpZGVycy5zZXQocHJvdmlkZXIuaWQsIHByb3ZpZGVyKVxyXG4gICAgdGhpcy5pc1N0YXRpY1Njb3BlRGlydHkgPSB0cnVlXHJcbiAgICB0aGlzLmhhbmRsZXIucmVjb21waWxlVGVtcGxhdGVzKClcclxuICB9XHJcbiAgXHJcbiAgLyoqXHJcbiAgICogSW50ZWdyYXRpb24gcG9pbnQgZm9yIG90aGVyIHBsdWdpbnMgdG8gYWRkIGEgcHJlZGljYXRlZCBwcm92aWRlclxyXG4gICAqIEBwYXJhbSBwcm92aWRlciBQcm92aWRlclByZWRpY2F0ZWQgaW1wbGVtZW50YXRpb24gdG8gYWRkICovXHJcbiAgYWRkUHJvdmlkZXJQcmVkaWNhdGVkID0gKHByb3ZpZGVyOiBQcm92aWRlclByZWRpY2F0ZWQpID0+IHtcclxuICAgIHRoaXMucHJvdmlkZXJzUHJlZGljYXRlZC5zZXQocHJvdmlkZXIuaWQsIHByb3ZpZGVyKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCkge1xyXG4gICAgdGhpcy5leGVjT25Qcm92aWRlcnMoJ3VubG9hZCcpXHJcbiAgfVxyXG5cclxuICAvKiBJbnZva2VkIGJ5IHByb3ZpZGVycyB0byBpbmRpY2F0ZSB0aGVpciBwcm92aXNpb24gbXVzdCBiZSByZWdlbmVyYXRlZCAqL1xyXG4gIHByb3ZpZGVyTm90aWZpY2F0aW9uRGlydHkocHJvdmlkZXI6IFByb3ZpZGVyLCBpc0RpcnR5OiBib29sZWFuKSB7XHJcbiAgICBpZiAoaXNEaXJ0eSkgdGhpcy5yZWZyZXNoUHJvdmlkZXIocHJvdmlkZXIpXHJcbiAgfVxyXG5cclxuICAvKiBDbGVhbiBkaXJ0eSBwcm92aWRlcnMgYnkgcmVnZW5lcmF0aW5nIHRoZWlyIHByb3Zpc2lvbiAqL1xyXG4gIHJlZnJlc2hQcm92aWRlciguLi5wcm92aWRlcnM6IFByb3ZpZGVyW10pIHtcclxuICAgIGxldCBwcm94eTogYW55ID0ge307XHJcblxyXG4gICAgZm9yIChsZXQgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7XHJcbiAgICAgIHByb3h5W3Byb3ZpZGVyLmlkXSA9IHByb3ZpZGVyLmNyZWF0ZU9iamVjdCgpXHJcbiAgICAgIHByb3ZpZGVyLnNldERpcnR5KGZhbHNlKVxyXG4gICAgfVxyXG5cclxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5zY29wZVN0YXRpYywgcHJveHkpXHJcbiAgfVxyXG5cclxuICAvKiBSZWxvYWRzIGFsbCBwcm92aWRlcnMgKi9cclxuICBhc3luYyByZWxvYWRQcm92aWRlcnMoKSB7XHJcbiAgICBsZXQgcHJvbXMgPSB0aGlzLmV4ZWNPblByb3ZpZGVycygncmVsb2FkJylcclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGxTZXR0bGVkKE9iamVjdC52YWx1ZXMocHJvbXMpKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFNjb3BlS2V5cygpIHtcclxuICAgIHJldHVybiBbLi4udGhpcy5wcm92aWRlcnMua2V5cygpLCBNT0RVTEVfTkFNRV9JTlRFR1JBVElPTlMsICdtb21lbnQnLCAnb2JzaWRpYW4nXVxyXG4gIH1cclxuXHJcbiAgLyogUmV0cmlldmVzIHByb3ZpZGVycyBvYmplY3QgKi9cclxuICBwdWJsaWMgZ2V0U2NvcGUoY3R4PzogRHluYW1pY1N0YXRlLCByZWZyZXNoPzogYm9vbGVhbikge1xyXG4gICAgbGV0IGRpcnRpZXMgPSBPYmplY3QudmFsdWVzKHRoaXMucHJvdmlkZXJzKS5maWx0ZXIoKHA6IFByb3ZpZGVyKSA9PiB7cmV0dXJuIHAuaXNEaXJ0eX0pXHJcbiAgICBpZiAoZGlydGllcykgdGhpcy5yZWZyZXNoUHJvdmlkZXIoLi4uZGlydGllcylcclxuXHJcbiAgICBpZiAodGhpcy5pc1N0YXRpY1Njb3BlRGlydHkpIHRoaXMuY3JlYXRlU3RhdGljU2NvcGUoKVxyXG5cclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNjb3BlU3RhdGljLCB7W01PRFVMRV9OQU1FX0lOVEVHUkFUSU9OU106IHRoaXMuY3JlYXRlUHJlZGljYXRlZFNjb3BlKGN0eCB8fCBudWxsKX0pXHJcbiAgfVxyXG5cclxuICAvKiBDcmVhdGVzIHNjb3BlIG9iamVjdC4gU2hvdWxkIG5vdCBiZSB1c2VkIHRvIGdldCB0aGUgc2NvcGUuICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVTdGF0aWNTY29wZSgpIHtcclxuICAgIGxldCBzcGFjZXM6IHtba2V5OiBzdHJpbmddOiBhbnl9ID0ge307XHJcbiAgICBcclxuICAgIGZvciAobGV0IHAgb2YgdGhpcy5wcm92aWRlcnMpIHNwYWNlc1twWzBdXSA9IHBbMV0uY3JlYXRlT2JqZWN0KCk7XHJcblxyXG4gICAgc3BhY2VzWydtb21lbnQnXSA9IHdpbmRvdy5tb21lbnRcclxuICAgIHNwYWNlc1snb2JzaWRpYW4nXSA9IG9ic2lkaWFuTW9kdWxlXHJcbiAgICBcclxuICAgIHRoaXMuc2NvcGVTdGF0aWMgPSBzcGFjZXNcclxuICAgIHRoaXMuaXNTdGF0aWNTY29wZURpcnR5ID0gZmFsc2VcclxuICAgIHJldHVybiB0aGlzLnNjb3BlU3RhdGljXHJcbiAgfVxyXG5cclxuICAvKiBQcmVkaWNhdGVkIHByb3ZpZGVycyAqL1xyXG4gIGNyZWF0ZVByZWRpY2F0ZWRTY29wZShjdHg/OiBEeW5hbWljU3RhdGUpIHtcclxuICAgIGxldCBzcGFjZXM6IHtba2V5OiBzdHJpbmddOiBhbnl9ID0ge307XHJcbiAgIFxyXG4gICAgZm9yIChsZXQgcCBvZiB0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNwYWNlcywgcFswXSwgeyBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKHBbMV0ucHJlZGljYXRlQ2hlY2soKSkgcmV0dXJuIHBbMV0uY3JlYXRlT2JqZWN0KClcclxuICAgICAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKHBbMV0ucHJlZGljYXRlRXJyb3IoKSlcclxuICAgICAgICB9IFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gc3BhY2VzXHJcbiAgfVxyXG5cclxuICAvKiBHZXQgdGhlIGJhc2UgcHJvdmlkZXIgc2NvcGUgKi9cclxuICBnZXRTY29wZVNLKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2tCYXNlLmNyZWF0ZU9iamVjdCgpXHJcbiAgfVxyXG5cclxuICAvKiBJbnZva2UgZnVuY3Rpb24gb24gYWxsIHByb3ZpZGVycyBhbmQgcmV0dXJuIGFycmF5IG9mIHJlc3VsdHMgKi9cclxuICBleGVjT25Qcm92aWRlcnMoZnVuYzogKGtleW9mIElQcm92aWRlcikpOiBTdHJpbmdkZXgge1xyXG4gICAgbGV0IHJldHM6IFN0cmluZ2RleCA9IHt9O1xyXG5cclxuICAgIGNvbnN0IGludm9rZSA9IChwcm92aWRlcnM6IE1hcDxzdHJpbmcsIFByb3ZpZGVyPikgPT4ge1xyXG4gICAgICBmb3IgKGxldCBwIG9mIHByb3ZpZGVycykgaWYgKChwICE9IG51bGwpICYmIChpc0Z1bmMocFsxXVtmdW5jXSkpKSB7cmV0c1twWzBdXSA9IChwWzFdW2Z1bmNdIGFzIEZ1bmN0aW9uKSgpfVxyXG4gICAgfVxyXG5cclxuICAgIGludm9rZSh0aGlzLnByb3ZpZGVycylcclxuICAgIGludm9rZSh0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQpXHJcblxyXG4gICAgcmV0dXJuIHJldHNcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmlkZXJCdXMge1xyXG4gIGV4ZWNPblByb3ZpZGVycyhmdW5jOiAncmVsb2FkJyk6IHtbaW5kZXg6IHN0cmluZ106IFByb21pc2U8dm9pZD59XHJcbiAgZXhlY09uUHJvdmlkZXIoZnVuYzogJ2luaXQnKToge1tpbmRleDogc3RyaW5nXTogUHJvbWlzZTx2b2lkPn1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgQ2FjaGVyPFQ+IHtcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhY2hlOiBSZWNvcmQ8c3RyaW5nLCBUPikge31cclxuICBkZWZpbmUoa2V5OiBzdHJpbmcsIHZhbDogVCk6IHZvaWQge3RoaXMuY2FjaGVba2V5XSA9IHZhbH1cclxuICBnZXQoa2V5OiBzdHJpbmcpOiBUIHtyZXR1cm4gdGhpcy5jYWNoZVtrZXldfVxyXG4gIHJlbW92ZShrZXk6IHN0cmluZyk6IHZvaWQge2RlbGV0ZSB0aGlzLmNhY2hlW2tleV19XHJcbiAgcmVzZXQoKTogdm9pZCB7dGhpcy5jYWNoZSA9IHt9fVxyXG4gIGxvYWQoY2FjaGVPYmo6IFJlY29yZDxzdHJpbmcsIFQ+KTogdm9pZCB7Y29weVByb3BzKHRoaXMuY2FjaGUsIGNhY2hlT2JqKX1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlQcm9wczxUPih0b09iajogVCwgZnJvbU9iajogVCk6IFQge1xyXG4gIGZvciAoY29uc3Qga2V5IGluIGZyb21PYmopIHtcclxuICAgIGlmIChoYXNPd25Qcm9wKChmcm9tT2JqIGFzIHVua25vd24pIGFzIG9iamVjdCwga2V5KSkge1xyXG4gICAgICB0b09ialtrZXldID0gZnJvbU9ialtrZXldXHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB0b09ialxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duUHJvcChvYmo6IG9iamVjdCwgcHJvcDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApXHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBGcm9udE1hdHRlckNhY2hlLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcclxuaW1wb3J0IHsgRUJBUiwgVkFSX05BTUUgfSBmcm9tIFwic3JjL3R5cGVzL2NvbnN0XCI7XHJcbmltcG9ydCB7IGNoZWNrRmlsZUV4dCwgZ2V0RmlsZXMsIGlzRXh0YW50LCBpc0ZpbGUsIHJvdW5kVG8sIHZMb2csIHdpdGhvdXRLZXkgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gXCIuL2V0YVwiO1xyXG5pbXBvcnQgeyBDYWNoZXIgfSBmcm9tIFwiLi9jYWNoZXJcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgY29tcGlsZVdpdGggfSBmcm9tIFwiLi9jb21wXCI7XHJcblxyXG4vKiBSZXNwb25zaWJsZSBmb3IgdGhlIGNhY2hpbmcgYW5kIG1hbmFnZW1lbnQgb2YgdGVtcGxhdGVzLiAqL1xyXG5leHBvcnQgY2xhc3MgVGVtcGxhdGVMb2FkZXIge1xyXG4gIHByaXZhdGUgaGFuZGxlcjogRXRhSGFuZGxlclxyXG4gIHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG4gIHRlbXBsYXRlQ2FjaGU6IENhY2hlcjxUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkPiA9IG5ldyBDYWNoZXI8VGVtcGxhdGVGdW5jdGlvblNjb3BlZD4oe30pXHJcbiAgdGVtcGxhdGVGYWlsdXJlczogTWFwPHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXAoKTtcclxuICB0ZW1wbGF0ZUZyb250bWF0dGVyczogTWFwPHN0cmluZywgRnJvbnRNYXR0ZXJDYWNoZT4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGdldCBkaXJlY3RvcnkoKTogc3RyaW5nIHsgcmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlRm9sZGVyIH1cclxuXHJcbiAgY29uc3RydWN0b3IoaGFuZGxlcjogRXRhSGFuZGxlcikge1xyXG4gICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlclxyXG4gICAgdGhpcy5wbHVnaW4gPSBoYW5kbGVyLnBsdWdpblxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdCgpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5pdExvYWQoKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmRlZmluZVBhcnRpYWxzKC4uLmdldEZpbGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5kaXJlY3RvcnkpKSBcclxuICAgIHRoaXMucGx1Z2luLmxvYWRFdmVudHMudHJpZ2dlcignaW5pdC1sb2FkLWNvbXBsZXRlJykgLy9UT0RPOiB1c2UgbmF0aXZlIGV2ZW50cz9cclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIC8qIExvYWQgYW5kIGNvbXBpbGUgZmlsZXMgaW50byB0aGUgdGVtcGxhdGUgY2FjaGUgKi9cclxuICBhc3luYyBkZWZpbmVQYXJ0aWFscyguLi5maWxlczogVEZpbGVbXSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXHJcbiAgICB2YXIgZmFpbHVyZUNvdW50ID0gMFxyXG4gICAgdmFyIHN1Y2Nlc3NDb3VudCA9IDBcclxuXHJcbiAgICBjb25zdCBzY29wZUtleXMgPSB0aGlzLmhhbmRsZXIuYnVzLmdldFNjb3BlS2V5cygpXHJcblxyXG4gICAgY29uc3QgcmVhZFByb21pc2VzID0gZmlsZXMubWFwKGFzeW5jIGZpbGUgPT4ge1xyXG4gICAgICBpZiAoIWNoZWNrRmlsZUV4dChmaWxlLCBbXCJtZFwiLCBcImV0YVwiLCBcInR4dFwiXSkpIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xyXG5cclxuICAgICAgbGV0IHJlYWQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxyXG5cclxuICAgICAgbGV0IGZpbGVGcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXJcclxuICAgICAgaWYgKGZpbGVGcm9udG1hdHRlcikge1xyXG4gICAgICAgIGxldCBmbVNlYXJjaCA9ICgvKD88ZnJvbnRtYXR0ZXI+Xi0tLS4qPyg/PVxcbi0tLSlcXG4tLS0pL3MpLmV4ZWMocmVhZCk7XHJcbiAgICAgICAgbGV0IGZtVGV4dCA9IGZtU2VhcmNoPy5ncm91cHM/LmZyb250bWF0dGVyID8/IG51bGxcclxuICAgICAgICBpZiAoaXNFeHRhbnQoZm1UZXh0KSkgeyByZWFkID0gcmVhZC5zdWJzdHIoZm1UZXh0Lmxlbmd0aCl9ICAgICAgXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgbGV0IGNvbXBpbGVkU3RyaW5nID0gRXRhLmNvbXBpbGVUb1N0cmluZyhyZWFkLCBFdGEuZ2V0Q29uZmlnKHt2YXJOYW1lOiBWQVJfTkFNRSwgbmFtZTogZmlsZS5iYXNlbmFtZX0pKVxyXG4gICAgICAgIHZhciBjb21waWxlZCA9IGNvbXBpbGVXaXRoKGNvbXBpbGVkU3RyaW5nLCBbVkFSX05BTUUsICdFJywgJ2NiJywgLi4uc2NvcGVLZXlzXSlcclxuICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlRmFpbHVyZXMuc2V0KGZpbGUuYmFzZW5hbWUsIGVyciB8fCBgVGVtcGxhdGUgZmFpbGVkIHRvIGNvbXBpbGU6IFVua25vd24gRXJyb3JgKVxyXG4gICAgICAgIGNvbnNvbGUud2FybihgU2tyaWJpOiB0ZW1wbGF0ZSAnJHtmaWxlLmJhc2VuYW1lfScgZmFpbGVkIHRvIGNvbXBpbGVgLCBFQkFSLCBlcnIsIEVCQVIsIHJlYWQpXHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlbW92ZShmaWxlLmJhc2VuYW1lKVxyXG4gICAgICAgIHRoaXMudGVtcGxhdGVGcm9udG1hdHRlcnMuZGVsZXRlKGZpbGUuYmFzZW5hbWUpXHJcbiAgICAgICAgZmFpbHVyZUNvdW50KytcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnRlbXBsYXRlRmFpbHVyZXMuZGVsZXRlKGZpbGUuYmFzZW5hbWUpXHJcbiAgICAgIHRoaXMudGVtcGxhdGVDYWNoZS5kZWZpbmUoZmlsZS5iYXNlbmFtZSwgY29tcGlsZWQpXHJcbiAgICAgIGlmIChmaWxlRnJvbnRtYXR0ZXIpIHRoaXMudGVtcGxhdGVGcm9udG1hdHRlcnMuc2V0KGZpbGUuYmFzZW5hbWUsIHdpdGhvdXRLZXkoZmlsZUZyb250bWF0dGVyLCAncG9zaXRpb24nKSBhcyBGcm9udE1hdHRlckNhY2hlKVxyXG4gICAgICBzdWNjZXNzQ291bnQrK1xyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgICB9KVxyXG5cclxuICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChyZWFkUHJvbWlzZXMpXHJcblxyXG4gICAgaWYgKCghdGhpcy5wbHVnaW4uaW5pdExvYWRlZCkgJiYgZmlsZXMubGVuZ3RoKSB7XHJcbiAgICAgIGxldCBzdHIgPSBgJHtzdWNjZXNzQ291bnR9IHRlbXBsYXRlJHsoc3VjY2Vzc0NvdW50ID09IDEpID8gJycgOiAncyd9YFxyXG4gICAgICBpZiAoZmFpbHVyZUNvdW50KSBzdHIgKz0gYFxcbiBPZiAke2ZpbGVzLmxlbmd0aH0gdG90YWwgdGVtcGxhdGVzLCAke2ZhaWx1cmVDb3VudH0gZmFpbGVkIHRvIGNvbXBpbGUuYFxyXG4gICAgICBjb25zb2xlLmxvZyhgU2tyaWJpOiBMb2FkZWQgYCArIHN0cilcclxuICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uaW5pdExvYWRlZCkge1xyXG4gICAgICB2TG9nKGBVcGRhdGVkIHRlbXBsYXRlICcke2ZpbGVzWzBdLmJhc2VuYW1lfScgaW4gJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSwgNCl9bXNgKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgLyogRGVsZXRlcyBjYWNoZSBlbnRyaWVzIGJ5IHN0cmluZyBuYW1lIG9yIGZpbGUgb2Ygb3JpZ2luICovXHJcbiAgZGVsZXRlUGFydGlhbCguLi5pdGVtczogQXJyYXk8VEZpbGUgfCBzdHJpbmc+KTogdm9pZCB7XHJcbiAgICBmb3IgKGxldCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGxldCBuYW1lID0gaXNGaWxlKGl0ZW0pID8gaXRlbS5iYXNlbmFtZSA6IGl0ZW1cclxuICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlbW92ZShuYW1lKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVsb2FkKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlc2V0KClcclxuICAgIHJldHVybiB0aGlzLmRlZmluZVBhcnRpYWxzKC4uLmdldEZpbGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5kaXJlY3RvcnkpKVxyXG4gIH1cclxuXHJcbiAgLyogVGhlc2UgZnVuY3Rpb25zIGFyZSByZWdpc3RlcmVkIHRvIHRoZSBhcHByb3ByaWF0ZSBldmVudHMgYnkgaGFuZGxlciAqL1xyXG5cclxuICBmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBpbiB0ZW1wbGF0ZSBkaXJlY3RvcnkgbW9kaWZpZWQsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuZGVmaW5lUGFydGlhbHMoZmlsZSlcclxuICB9XHJcblxyXG4gIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUgfCBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGxldCBpc2YgPSBpc0ZpbGUoZmlsZSlcclxuICAgIGlmICgoIWlzZiAmJiAhKFN0cmluZy5pc1N0cmluZyhmaWxlKSAmJiB0aGlzLnRlbXBsYXRlQ2FjaGUuZ2V0KGZpbGUpKSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7aXNmID8gKGZpbGUgYXMgVEZpbGUpLm5hbWUgOiBmaWxlfScgcmVtb3ZlZCBmcm9tIHRlbXBsYXRlIGRpcmVjdG9yeSwgdW5sb2FkaW5nLi4uYClcclxuICAgIHRoaXMuZGVsZXRlUGFydGlhbChmaWxlIGFzIChURmlsZSB8IHN0cmluZykpXHJcbiAgfVxyXG5cclxuICBmaWxlQWRkZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgYWRkZWQgdG8gdGVtcGxhdGUgZGlyZWN0b3J5LCBsb2FkaW5nLi4uYClcclxuICAgIHRoaXMuZGVmaW5lUGFydGlhbHMoZmlsZSlcclxuICB9XHJcblxyXG4gIGZpbGVSZW5hbWVkKGZpbGU6IFRBYnN0cmFjdEZpbGUsIG9sZE5hbWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYFRlbXBsYXRlIGZpbGUgJyR7b2xkTmFtZX0nIHJlbmFtZWQgdG8gJyR7ZmlsZS5uYW1lfScsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuZGVsZXRlUGFydGlhbChvbGROYW1lKVxyXG4gICAgdGhpcy5kZWZpbmVQYXJ0aWFscyhmaWxlKVxyXG4gIH1cclxuXHJcbiAgZGlyZWN0b3J5Q2hhbmdlZCgpOiB2b2lkIHtcclxuICAgIHZMb2coYFRlbXBsYXRlIGRpcmVjdG9yeSBjaGFuZ2VkLCByZWxvYWRpbmcgdGVtcGxhdGVzLi4uYClcclxuICAgIHRoaXMucmVsb2FkKClcclxuICB9XHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZUZ1bmN0aW9uIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbXBpbGVcIjtcclxuaW1wb3J0IHsgRXRhQ29uZmlnIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbmZpZ1wiO1xyXG5pbXBvcnQgeyBub3JtYWxpemVQYXRoLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBub3JtYWxpemUgfSBmcm9tIFwicGF0aFwiO1xyXG5pbXBvcnQgeyBFQkFSLCBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgc2NvcGVkVmFycywgU3RyaW5nZGV4LCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcIi4uL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCBpc0ZpbGUsIGlzSW5Gb2xkZXIgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5pbXBvcnQgeyByZW5kZXJFdGFBc3luYywgcmVuZGVyRXRhLCBjb21waWxlV2l0aCB9IGZyb20gXCIuL2NvbXBcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJCdXMgfSBmcm9tIFwiLi9wcm92aWRlcl9idXNcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVMb2FkZXIgfSBmcm9tIFwiLi90ZW1wbGF0ZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBFdGFIYW5kbGVyIHtcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW47XHJcbiAgYnVzOiBQcm92aWRlckJ1cztcclxuICBsb2FkZXI6IFRlbXBsYXRlTG9hZGVyO1xyXG5cclxuICB0ZW1wbGF0ZXNEaXJ0eTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBiYXNlQ29udGV4dDoge1tpbmRleDogc3RyaW5nXTogYW55fSA9IHt9XHJcblxyXG4gIGdldCB0ZW1wbGF0ZXMoKSB7cmV0dXJuIHRoaXMubG9hZGVyLnRlbXBsYXRlQ2FjaGV9XHJcbiAgZ2V0IGZhaWxlZFRlbXBsYXRlcygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVGYWlsdXJlc31cclxuICBnZXQgdGVtcGxhdGVGcm9udG1hdHRlcnMoKSB7cmV0dXJuIHRoaXMubG9hZGVyLnRlbXBsYXRlRnJvbnRtYXR0ZXJzfVxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFNrcmlib3NQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgdGhpcy5idXMgPSBuZXcgUHJvdmlkZXJCdXModGhpcylcclxuICAgIHRoaXMubG9hZGVyID0gbmV3IFRlbXBsYXRlTG9hZGVyKHRoaXMpXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmxheW91dFJlYWR5KVxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4gdGhpcy5pbml0LmJpbmQodGhpcykoKSlcclxuICAgIGVsc2UgdGhpcy5pbml0KClcclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICB0aGlzLmluaXRMb2FkKCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCBlID0+IHtcclxuICAgICAgICBpZiAodGhpcy5pc0luU2NyaXB0cyhlKSkgdGhpcy5idXMuc2NyaXB0TG9hZGVyLmZpbGVVcGRhdGVkKGUpXHJcbiAgICAgICAgaWYgKHRoaXMuaXNJblRlbXBsYXRlcyhlKSkgdGhpcy5sb2FkZXIuZmlsZVVwZGF0ZWQoZSlcclxuICAgICAgfSkpXHJcbiAgXHJcbiAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCBlID0+IHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhlKVxyXG4gICAgICAgIGlmICh0aGlzLmlzSW5TY3JpcHRzKGUpKSB0aGlzLmJ1cy5zY3JpcHRMb2FkZXIuZmlsZURlbGV0ZWQoZSlcclxuICAgICAgICBpZiAodGhpcy5pc0luVGVtcGxhdGVzKGUpKSB0aGlzLmxvYWRlci5maWxlRGVsZXRlZChlKVxyXG4gICAgICB9KSlcclxuICBcclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ2NyZWF0ZScsIGUgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5TY3JpcHRzKGUpKSB0aGlzLmJ1cy5zY3JpcHRMb2FkZXIuZmlsZUFkZGVkKGUpXHJcbiAgICAgICAgaWYgKHRoaXMuaXNJblRlbXBsYXRlcyhlKSkgdGhpcy5sb2FkZXIuZmlsZUFkZGVkKGUpXHJcbiAgICAgIH0pKVxyXG5cclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XHJcbiAgICAgICAgZm9yIChsZXQgb2JqIG9mIFt0aGlzLmJ1cy5zY3JpcHRMb2FkZXIsIHRoaXMubG9hZGVyXSkge1xyXG4gICAgICAgICAgbGV0IG91ckRpciA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplUGF0aChvYmouZGlyZWN0b3J5KSlcclxuICAgICAgICAgIGxldCBvbGREaXIgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5vcm1hbGl6ZVBhdGgoKC8uK1xcLy9nKS5leGVjKG9sZFBhdGgpWzBdKSlcclxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG9sZERpciwgb3VyRGlyKVxyXG4gICAgICAgICAgaWYgKGZpbGUucGFyZW50ID09IG91ckRpcikge1xyXG4gICAgICAgICAgICAvLyBOZXcgbG9jYXRpb24gb2YgZmlsZSBpcyBpbiBvdXIgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnBhcmVudCA9PSBvbGREaXIpIHtcclxuICAgICAgICAgICAgICAvLyBGaWxlIGRpZCBub3QgbW92ZSBidXQgd2FzIHJlbmFtZWRcclxuICAgICAgICAgICAgICBvYmouZmlsZVJlbmFtZWQoZmlsZSwgKC8oW2EtekEtWjAtOS1fLl0rXFwuLiopL2cpLmV4ZWMob2xkUGF0aClbMF0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gRmlsZSB3YXMgbW92ZWQgZnJvbSBlbHNld2hlcmUgaW50byB0aGUgdGVtcGxhdGUgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgICAgb2JqLmZpbGVBZGRlZChmaWxlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG9sZERpciA9PSBvdXJEaXIpIHtcclxuICAgICAgICAgICAgLy8gRmlsZSB1c2VkIHRvIGJlIGluIHRlbXBsYXRlcyBkaXJlY3RvcnkgYW5kIGlzIG5vIGxvbmdlclxyXG4gICAgICAgICAgICBvYmouZmlsZURlbGV0ZWQoZmlsZSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pKVxyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBTa3JpYmk6IEV0YUhhbmRsZXIgZmFpbGVkIHRvIGluaXRpYWxpemUhYCwgRUJBUiwgZXJyKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlzSW5UZW1wbGF0ZXMgPSAoZTogVEFic3RyYWN0RmlsZSkgPT4gaXNJbkZvbGRlcihlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlcilcclxuXHRpc0luU2NyaXB0cyA9IChlOiBUQWJzdHJhY3RGaWxlKSA9PiBpc0luRm9sZGVyKGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlcilcclxuXHJcbiAgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICBsZXQge2E6IGEsIGI6IGJ9ID0gYXdhaXQgdGhpcy5idXMucHJlSW5pdCgpLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZXR1cm4ge2E6IHRoaXMuYnVzLmluaXQoKSwgYjogdGhpcy5sb2FkZXIuaW5pdCgpfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW2EsIGJdKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCkge1xyXG4gICAgdGhpcy5idXMudW5sb2FkKClcclxuICB9XHJcblxyXG4gIHJlY29tcGlsZVRlbXBsYXRlcygpIHtcclxuICAgIC8vIElmIHRoZSBidXMgc2NvcGUgY2hhbmdlcywgdGhlIHRlbXBsYXRlcyBtdXN0IGJlIHJlY29tcGlsZWQuIFxyXG4gICAgLy8gVGhlIGJ1cyBzY29wZSBzaG91bGQgbm90IGNoYW5nZSBwb3N0LWluaXQgdW5sZXNzIGFuIGV4dGVybmFsIHNvdXJjZSBtb2RpZmllcyB0aGUgcHJvdmlkZXIgbGlzdC5cclxuICAgIHRoaXMubG9hZGVyLnJlbG9hZCgpXHJcbiAgfVxyXG5cclxuICBnZXRQYXJ0aWFsKGlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiB0aGlzLmxvYWRlci50ZW1wbGF0ZUNhY2hlLmdldChpZClcclxuICB9XHJcblxyXG4gIGhhc1BhcnRpYWwoaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGlzRXh0YW50KHRoaXMubG9hZGVyLnRlbXBsYXRlQ2FjaGUuZ2V0KGlkKSlcclxuICB9XHJcblxyXG4gIGdldENhY2hlS2V5cygpOiBzdHJpbmdbXSB7XHJcbiAgICAvL0B0cy1pZ25vcmVcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRlbXBsYXRlcy5jYWNoZSlcclxuICB9XHJcblxyXG4gIC8qKiAgIFxyXG4gICogUHJpbWFyeSBza3JpYmkgcmVuZGVyIGZ1bmN0aW9uLiBSZW5kZXJzIGFzeW5jaHJvbm91c2x5IChUZW1wbGF0ZUZ1bmN0aW9uIG1heSBvciBtYXkgbm90IGJlIGFzeW5jKVxyXG4gICogQHBhcmFtIGNvbnRlbnQgU3RyaW5nIG9yIHNjb3BlZCB0ZW1wbGF0ZSBmdW5jdGlvbiB0byByZW5kZXJcclxuICAqIEBwYXJhbSBjdHhJbiBDb250ZXh0IG9iamVjdCB0byBiZSBhZGRlZCB0byBgc2tgIG9iamVjdFxyXG4gICogQHBhcmFtIGZpbGUgRmlsZSBpbiB3aGljaCB0aGUgc2tyaWJpIGlzIGJlaW5nIHJlbmRlcmVkICBcclxuICAqIEByZXR1cm5zIFtyZW5kZXJlZCBzdHJpbmcsIHJldHVybmVkIHBhY2tldCAoY3VycmVudGx5IHVudXNlZCldICovXHJcbiAgYXN5bmMgcmVuZGVyQXN5bmMoY29udGVudDogc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCwgY3R4SW4/OiBhbnksIGZpbGU/OiBURmlsZSk6IFByb21pc2U8W3N0cmluZywgU3RyaW5nZGV4XT4ge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybiBQcm9taXNlLnJlamVjdChgQ291bGQgbm90IGlkZW50aWZ5IGN1cnJlbnQgZmlsZTogJHtmaWxlfWApO1xyXG5cclxuICAgIGxldCB6OiBTdHJpbmdkZXggPSB7fTtcclxuICAgIGZ1bmN0aW9uIHAoKSB7XHJcbiAgICAgIHJldHVybiBmdW5jdGlvbih4OiBzdHJpbmcsIHk6IGFueSkge1xyXG4gICAgICAgIHpbeF0gPSB5XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBsZXQgY2ZnID0gRXRhLmdldENvbmZpZyh7dmFyTmFtZTogVkFSX05BTUV9KVxyXG5cclxuICAgIC8qIHRoZSAndGhpcycgb2JqZWN0IG9mIHRoZSBzayBjb250ZXh0Ki9cclxuICAgIGxldCBiaW5kZXIgPSB7XHJcbiAgICAgIGZpbGU6IGZpbGUsXHJcbiAgICAgIHBsdWdpbjogdGhpcy5wbHVnaW4sXHJcbiAgICAgIGFwcDogdGhpcy5wbHVnaW4uYXBwXHJcbiAgICB9XHJcblxyXG4gICAgLyogVGhlICdzaycgb2JqZWN0ICovXHJcbiAgICBsZXQgc2sgPSBPYmplY3QuYXNzaWduKHt9LFxyXG4gICAgICB0aGlzLmJhc2VDb250ZXh0LFxyXG4gICAgICBjdHhJbiB8fCB7fSwgXHJcbiAgICAgIHt1cDogcCgpLCB0aGlzOiBiaW5kZXJ9LFxyXG4gICAgICB0aGlzLmJ1cy5nZXRTY29wZVNLKClcclxuICAgIClcclxuXHJcbiAgICAvKiBzY29wZSBvZiB0aGUgdGZ1bmMgZW52ICovXHJcbiAgICBsZXQgc2NvcGU6IHNjb3BlZFZhcnMgPSB7XHJcbiAgICAgICdzayc6IHNrLFxyXG4gICAgICAnRSc6IGNmZyxcclxuICAgICAgJ2NiJzogbnVsbCxcclxuICAgICAgLi4udGhpcy5idXMuZ2V0U2NvcGUoKSxcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVuID0gKGNvbnRlbnQudG9TdHJpbmcoKS5jb250YWlucygnYXdhaXQnKSkgLy8gVGhpcyB3aWxsIGNhdGNoIHN0cmluZ3MgY29udGFpbmluZyBhd2FpdCBhcyB3ZWxsLCBtYXliZSBhIGZsYWcgc2hvdWxkIGJlIHVzZWQgaW5zdGVhZFxyXG4gICAgICA/IHJlbmRlckV0YUFzeW5jKHRoaXMsIGNvbnRlbnQsIHt9LCBjZmcsIG51bGwsIHNjb3BlLCBiaW5kZXIpXHJcbiAgICAgIDogcmVuZGVyRXRhKHRoaXMsIGNvbnRlbnQsIHt9LCBjZmcsIG51bGwsIHNjb3BlLCBiaW5kZXIpXHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coXCJwc3VlZG8gcG9zdDpcIiwgc2spXHJcbiAgICBpZiAocmVuIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICByZXR1cm4gYXdhaXQgcmVuLnRoZW4oKHIpID0+IHtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyLCB6XSl9LCAocikgPT4ge3JldHVybiBQcm9taXNlLnJlamVjdChyKX0pXHJcbiAgICB9IGVsc2UgaWYgKFN0cmluZy5pc1N0cmluZyhyZW4pKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUoW3JlbiBhcyBzdHJpbmcsIHpdKSB9XHJcbiAgICBlbHNlIHJldHVybiBQcm9taXNlLnJlamVjdChcIkV0YUhhbmRsZXIucmVuZGVyQXN5bmM6IFVua25vd24gRXJyb3JcIilcclxuICB9XHJcblxyXG4gIC8qIHRoaXMgaXMgc29tZWhvdyAxLjN4IHNsb3dlciB0aGFuIHJlbmRlckFzeW5jICovXHJcbiAgYXN5bmMgcmVuZGVyQXN5bmNOYWl2ZShjb250ZW50OiBzdHJpbmcgfCBGdW5jdGlvbiwgY3R4SW4/OiBhbnksIHZhck5hbWU/OiBhbnkpIHtcclxuICAgIGNvbnNvbGUubG9nKCdTa3JpYm9zOiByZW5kZXJBc3luY05haXZlIGludm9rZWQnLCBjb250ZW50LCBjdHhJbilcclxuICAgIGxldCBjb250ZXh0ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5iYXNlQ29udGV4dCwgY3R4SW4gfHwge30pXHJcbiAgICBsZXQgcmVuID0gRXRhLnJlbmRlckFzeW5jKGNvbnRlbnQgYXMgKHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb24pLCBjb250ZXh0LCB7dmFyTmFtZTogdmFyTmFtZSA/PyBWQVJfTkFNRX0pXHJcblxyXG4gICAgaWYgKHJlbiBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgcmV0dXJuIGF3YWl0IHJlbi50aGVuKChyKSA9PiB7cmV0dXJuIFByb21pc2UucmVzb2x2ZShyKX0sIChyKSA9PiB7cmV0dXJuIFByb21pc2UucmVqZWN0KHIpfSlcclxuICAgIH0gZWxzZSBpZiAoU3RyaW5nLmlzU3RyaW5nKHJlbikpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZW4gYXMgc3RyaW5nKSB9XHJcbiAgICBlbHNlIHJldHVybiBQcm9taXNlLnJlamVjdChcIlVua25vd24gZXJyb3JcIilcclxuICB9XHJcblxyXG4gIHJlbmRlcihjb250ZW50OiBzdHJpbmcsIGN0eEluPzogYW55KSB7XHJcbiAgICBsZXQgY29udGV4dCA9IGN0eEluIHx8IHt9O1xyXG5cclxuICAgIGNvbnRlbnQgPSBFdGEucmVuZGVyKGNvbnRlbnQsIGNvbnRleHQsIHsgXHJcbiAgICAgIHZhck5hbWU6IFZBUl9OQU1FXHJcbiAgICB9KSBhcyBzdHJpbmc7XHJcblxyXG4gICAgcmV0dXJuIGNvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICAvKiogVGVtcGxhdGVGdW5jdGlvbiBoYW5kbGVyLCB3aWxsIHJldHVybiBjYWNoZWQgb3IgY29tcGlsZWQgZnVuY3Rpb24sIGFwcHJvcHJpYXRlbHkgYm91bmQgYW5kIHNjb3BlZFxyXG4gICAqIEBwYXJhbSB0ZW1wbGF0ZSBTdHJpbmcgb3Igc2NvcGVkIHRlbXBsYXRlIGZ1bmN0aW9uXHJcbiAgICogQHBhcmFtIG9wdGlvbnMgRXRhQ29uZmlnIFxyXG4gICAqIEBwYXJhbSBzY29wZSBPYmplY3QgY29udGFpbmluZyBvYmplY3RzIHRoYXQgc2hvdWxkIGJlIGF2YWlsYWJsZSBpbiB0aGUgcmV0dXJuZWQgZnVuY3Rpb24ncyBzY29wZSBcclxuICAgKiBAcGFyYW0gYmluZGVyIE9iamVjdCB0byB3aGljaCB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gd2lsbCBiZSBib3VuZCAqL1xyXG4gIGdldENhY2hlZCh0ZW1wbGF0ZTogc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCwgb3B0aW9uczogRXRhQ29uZmlnLCBzY29wZT86IFN0cmluZ2RleCwgYmluZGVyPzogYW55KTogVGVtcGxhdGVGdW5jdGlvblNjb3BlZCB7XHJcbiAgICBpZiAob3B0aW9ucy5uYW1lICYmIHRoaXMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpKSB7XHJcbiAgICAgIHJldHVybiAoYmluZGVyKSA/IHRoaXMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpLmJpbmQoYmluZGVyKSA6IHRoaXMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpXHJcbiAgICB9XHJcbiAgXHJcbiAgICBjb25zdCB0ZW1wbGF0ZUZ1bmMgPSB0eXBlb2YgdGVtcGxhdGUgPT09ICdmdW5jdGlvbicgPyB0ZW1wbGF0ZSA6IGNvbXBpbGVXaXRoKEV0YS5jb21waWxlVG9TdHJpbmcodGVtcGxhdGUsIG9wdGlvbnMpLCBPYmplY3Qua2V5cyhzY29wZSksIG9wdGlvbnMuYXN5bmMpXHJcbiAgXHJcbiAgICBpZiAob3B0aW9ucy5uYW1lKSB0aGlzLnRlbXBsYXRlcy5kZWZpbmUob3B0aW9ucy5uYW1lLCB0ZW1wbGF0ZUZ1bmMpO1xyXG4gIFxyXG4gICAgcmV0dXJuIChiaW5kZXIpID8gdGVtcGxhdGVGdW5jLmJpbmQoYmluZGVyKSA6IHRlbXBsYXRlRnVuY1xyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgQXBwLCBTZXR0aW5nLCBUZXh0QXJlYUNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBkZWJvdW5jZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCBpc0ZpbGUsIGlzRnVuYyB9IGZyb20gXCIuL3V0aWxcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTa3JpYm9zU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogU2tyaWJvc1BsdWdpbjtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0fVxyXG5cclxuXHRkaXNwbGF5KCk6IHZvaWQge1xyXG5cdFx0bGV0IHtjb250YWluZXJFbH0gPSB0aGlzO1xyXG4gXHJcblx0XHRjb250YWluZXJFbC5hZGRDbGFzcyhcInNrcmliaS1zZXR0aW5nc1wiKTtcclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1NrcmliaSBTZXR0aW5ncyd9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ1RlbXBsYXRlIERpcmVjdG9yeScpXHJcblx0XHRcdC5zZXREZXNjKCdTa3JpYmkgd2lsbCBsb29rIGZvciB0ZW1wbGF0ZXMgaW4gdGhpcyBmb2xkZXIuJylcclxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0OiBUZXh0QXJlYUNvbXBvbmVudCkgPT4ge3RleHRcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pOyB0ZXh0LmlucHV0RWwuY29scyA9IDMwOyByZXR1cm4gdGV4dH0pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnU2tyaXB0IERpcmVjdG9yeScpXHJcblx0XHRcdC5zZXREZXNjKCdTa3JpYmkgd2lsbCBsb29rIGZvciBKUyBmaWxlcyBpbiB0aGlzIGZvbGRlci4nKVxyXG5cdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQ6IFRleHRBcmVhQ29tcG9uZW50KSA9PiB7dGV4dFxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zY3JpcHRGb2xkZXIpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5zYXZlU2V0dGluZygnc2NyaXB0Rm9sZGVyJywgdmFsdWUsICgpID0+IHRoaXMucGx1Z2luLmV0YS5idXMuc2NyaXB0TG9hZGVyLmRpcmVjdG9yeUNoYW5nZWQoKSlcclxuXHRcdFx0XHR9KTsgdGV4dC5pbnB1dEVsLmNvbHMgPSAzMDsgcmV0dXJuIHRleHR9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ0Vycm9yIExvZ2dpbmcnKVxyXG5cdFx0XHQuc2V0RGVzYygnRW5hYmxlIHRvIGR1bXAgYW55IGVycm9yZWQgcmVuZGVycyB0byB0aGUgY29uc29sZS4nIFxyXG5cdFx0XHQrICdJZiBmYWxzZSwgd2lsbCBzdGlsbCBhZGQgdGhlIGVycm9yIGFzIHRvb2x0aXAgb24gdGhlIGVycm9yZWQgZWxlbWVudC4gXFxuJyBcclxuXHRcdFx0KyAnV2lsbCBzcGFtIHlvdXIgY29uc29sZSBpZiB0eXBpbmcgaW50byBhIHNrcmliaSB3aXRoIGEgcHJldmlldyB3aW5kb3cgb3Blbi4nKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGU6IFRvZ2dsZUNvbXBvbmVudCkgPT4geyB0b2dnbGVcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXJyb3JMb2dnaW5nKVxyXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVycm9yTG9nZ2luZyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSl9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ1ZlcmJvc2UgTG9nZ2luZycpXHJcblx0XHRcdC5zZXREZXNjKCdFbmFibGUgdG8gZ2V0IG1vcmUgZGV0YWlsZWQgbG9ncyBpbiB0aGUgY29uc29sZS4nKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGU6IFRvZ2dsZUNvbXBvbmVudCkgPT4geyB0b2dnbGVcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyYm9zZUxvZ2dpbmcpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyYm9zZUxvZ2dpbmcgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pfSk7XHJcblx0fVxyXG5cclxuXHRzYXZlU2V0dGluZyA9IGRlYm91bmNlKGFzeW5jIChzZXR0aW5nOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuLCBjYj86IEZ1bmN0aW9uLCAuLi5hcmdzOiBhbnlbXSkgPT4ge1xyXG5cdFx0Ly8gY29uc29sZS5sb2coXCJzYXZpbmc6IFwiICsgc2V0dGluZyArIFwiID0gXCIgKyB2YWx1ZSlcclxuXHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmddID0gdmFsdWU7XHJcblx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKS50aGVuKCgpID0+IHtpZiAoaXNFeHRhbnQoY2IpICYmIGlzRnVuYyhjYikpIGNiKC4uLmFyZ3MgfHwgbnVsbCl9KVxyXG5cdH0sIDIwMDAsIHRydWUpXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2tyaWJvc1NldHRpbmdzIHtcclxuXHRba2V5OiBzdHJpbmddIDogYm9vbGVhbiB8IHN0cmluZyB8IHN0cmluZ1tdIHwgbnVtYmVyO1xyXG5cclxuXHR0ZW1wbGF0ZUZvbGRlcjogc3RyaW5nO1xyXG5cdHNjcmlwdEZvbGRlcjogc3RyaW5nO1xyXG5cdHZlcmJvc2VMb2dnaW5nOiBib29sZWFuO1xyXG5cdGRldkxvZ2dpbmc6IGJvb2xlYW47XHJcblx0ZXJyb3JMb2dnaW5nOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU2tyaWJvc1NldHRpbmdzID0ge1xyXG5cdHRlbXBsYXRlRm9sZGVyOiBcIlwiLFxyXG5cdHNjcmlwdEZvbGRlcjogXCJcIixcclxuXHR2ZXJib3NlTG9nZ2luZzogZmFsc2UsXHJcblx0ZGV2TG9nZ2luZzogZmFsc2UsXHJcblx0ZXJyb3JMb2dnaW5nOiBmYWxzZSxcclxufSIsImV4cG9ydCBpbnRlcmZhY2UgUmVnZW50RGF0YSB7XHJcblx0W2luZGV4OiBzdHJpbmddOiBhbnksXHJcblx0Y2xhc3M/OiBzdHJpbmcsXHJcblx0bGFiZWw/OiBzdHJpbmcsXHJcblx0Y2xlYXI/OiBib29sZWFuLFxyXG5cdGhvdmVyPzogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyRXJyb3IoZWw6IEhUTUxFbGVtZW50LCBlOiBSZWdlbnREYXRhKSB7XHJcblx0aWYgKGU/LmZsYWcgJiYgZS5mbGFnID09IFwiYWJvcnRcIikge1xyXG5cdFx0cmVuZGVyUmVnZW50KGVsLCBPYmplY3QuYXNzaWduKHt9LCB7XHJcblx0XHRcdGNsYXNzOiAnYWJvcnQnLFxyXG5cdFx0XHRsYWJlbDogJ3NrJyxcclxuXHRcdFx0aG92ZXI6ICdSZW5kZXIgQWJvcnRlZCdcclxuXHRcdH0sIGUpKVxyXG5cdH0gZWxzZSB7XHJcblx0XHRyZW5kZXJSZWdlbnQoZWwsIHtjbGFzczogJ2Vycm9yJywgbGFiZWw6ICdzaycsIGhvdmVyOiBlPy5tc2cgfHwgXCJVbmtub3duIEVycm9yXCIsIGNsZWFyOiB0cnVlfSlcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJXYWl0KGVsOiBIVE1MRWxlbWVudCkge1xyXG5cdGNvbnN0IHByZSA9IGNyZWF0ZUVsKFwiY29kZVwiLCB7Y2xzOiBcInNrcmliaS13YWl0XCIsIHRleHQ6IFwic2tcIn0pXHJcblx0ZWwucmVwbGFjZVdpdGgocHJlKVxyXG5cdHJldHVybiBwcmVcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlclN0YXRlKGVsOiBIVE1MRWxlbWVudCwgZGF0YUluOiBSZWdlbnREYXRhKSB7XHJcblx0bGV0IGRhdGEgPSBPYmplY3QuYXNzaWduKHtcclxuXHRcdGNsYXNzOiBcInN0YXRlXCIsXHJcblx0XHRsYWJlbDogXCJza1wiLFxyXG5cdFx0Y2xlYXI6IGZhbHNlLFxyXG5cdFx0aG92ZXI6IFwiXCJcclxuXHR9LCBkYXRhSW4gfHwge30pXHJcblxyXG5cdGVsLmNsYXNzTmFtZSA9IGBza3JpYmktcmVnZW50ICR7ZGF0YS5jbGFzc31gXHJcblx0ZWwuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgZGF0YS5ob3ZlcilcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlZ2VudChkYXRhSW4/OiBSZWdlbnREYXRhKTogW0hUTUxFbGVtZW50LCBSZWdlbnREYXRhXSB7XHJcblx0bGV0IGRhdGEgPSBPYmplY3QuYXNzaWduKHtcclxuXHRcdGNsYXNzOiBcImdlbmVyaWNcIixcclxuXHRcdGxhYmVsOiBcInNrXCIsXHJcblx0XHRjbGVhcjogZmFsc2UsXHJcblx0XHRob3ZlcjogXCJcIlxyXG5cdH0sIGRhdGFJbiB8fCB7fSlcclxuXHJcblx0Y29uc3QgcHJlID0gY3JlYXRlRWwoXCJjb2RlXCIsIHtjbHM6IGBza3JpYmktcmVnZW50ICR7ZGF0YS5jbGFzc31gLCB0ZXh0OiBkYXRhLmxhYmVsfSlcclxuXHRwcmUuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgZGF0YS5ob3ZlcilcclxuXHJcblx0cmV0dXJuIFtwcmUsIGRhdGFdXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJSZWdlbnQoZWw6IEhUTUxFbGVtZW50LCBkYXRhSW4/OiBSZWdlbnREYXRhKSB7XHJcblx0bGV0IFtwcmUsIGRhdGFdID0gY3JlYXRlUmVnZW50KGRhdGFJbilcclxuXHRpZiAoZGF0YS5jbGVhcikgZWwuY2xhc3NOYW1lID0gXCJcIjtcclxuXHRlbC5yZXBsYWNlV2l0aChwcmUpXHJcblxyXG5cdHJldHVybiBwcmVcclxufSIsImltcG9ydCB7IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIG5vcm1hbGl6ZVBhdGgsIHBhcnNlRnJvbnRNYXR0ZXJTdHJpbmdBcnJheSwgTWFya2Rvd25SZW5kZXJlciwgc2V0SWNvbiwgTWFya2Rvd25QcmV2aWV3VmlldyB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IGNyZWF0ZVJlZ2VudCB9IGZyb20gXCIuL3JlZ2VudFwiXHJcbmltcG9ydCB7IGRMb2csIGlzRXh0YW50IH0gZnJvbSBcIi4uL3V0aWxcIlxyXG5cclxuY29uc3QgZXh0SW1nID0gW1wiYm1wXCIsIFwicG5nXCIsIFwianBnXCIsIFwianBlZ1wiLCBcImdpZlwiLCBcInN2Z1wiXVxyXG5jb25zdCBleHRBdWQgPSBbXCJtcDNcIiwgXCJ3YXZcIiwgXCJtNGFcIiwgXCIzZ3BcIiwgXCJmbGFjXCIsIFwib2dnXCIsIFwib2dhXCJdXHJcbmNvbnN0IGV4dFZpZCA9IFtcIm1wNFwiLCBcIndlYm1cIiwgXCJvZ3ZcIl1cclxuY29uc3QgZXh0VHh0ID0gW1wibWRcIl1cclxuY29uc3QgZXh0UGRmID0gW1wicGRmXCJdXHJcblxyXG4vKiBSZXBhaXJzIG1lZGlhIGVtYmVkcyB0aGF0IGhhdmUgYmVlbiByZW5kZXJlZCB0byBtYXJrZG93biAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1iZWRNZWRpYSAoXHJcbiAgZWw6IEhUTUxFbGVtZW50LCBcclxuICBzcmNQYXRoOiBzdHJpbmcsXHJcbiAgcGx1Z2luOiBTa3JpYm9zUGx1Z2luLFxyXG4gIGRlcHRoPzogbnVtYmVyLFxyXG4gIHNlbGY/OiBib29sZWFuXHJcbikge1xyXG4gIGRMb2coXCJlbWJlZCBzZWxmOlwiLCBzZWxmKVxyXG4gIGRMb2coXCJlbWJlZDpcIiwgZWwpXHJcbiAgdmFyIHByb21zOiBQcm9taXNlPHZvaWQ+W10gPSBbXVxyXG5cclxuICBjb25zdCBjYXRjaGVzID0gZWwucXVlcnlTZWxlY3RvckFsbChcInNwYW4uaW50ZXJuYWwtZW1iZWRcIikgXHJcblxyXG4gIGxldCBlbERlcHRoID0gZWwuZ2V0QXR0cmlidXRlKFwiZGVwdGhcIik7XHJcbiAgbGV0IGQgPSAoaXNFeHRhbnQoZWxEZXB0aCkgPyBwYXJzZUludChlbERlcHRoKSA6IGlzRXh0YW50KGRlcHRoKSA/IGRlcHRoIDogMClcclxuXHJcbiAgZExvZyhcImVtYmVkZGVyIGRlcHRoOlwiLCBkKVxyXG5cclxuXHJcbiAgZm9yIChsZXQgZmlzaCBvZiBBcnJheS5mcm9tKGNhdGNoZXMpKSB7XHJcbiAgICBpZiAoZmlzaC5oYXNDbGFzcyhcImlzLWxvYWRlZFwiKSkgY29udGludWU7XHJcblxyXG4gICAgbGV0IHNyYyA9IG5vcm1hbGl6ZVBhdGgoZmlzaC5nZXRBdHRyaWJ1dGUoXCJzcmNcIikpXHJcblxyXG4gICAgbGV0IGRlc3QgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3Qoc3JjLCBzcmNQYXRoKVxyXG4gICAgXHJcbiAgICBpZiAoZGVzdCkge1xyXG4gICAgICBsZXQgcGF0aCA9IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5nZXRSZXNvdXJjZVBhdGgoZGVzdC5wYXRoKVxyXG5cclxuICAgICAgbGV0IGV4dCA9IGRlc3QuZXh0ZW5zaW9uO1xyXG5cclxuICAgICAgaWYgKGV4dEltZy5jb250YWlucyhleHQpKSB7Ly8gRW1iZWQgSW1hZ2VcclxuICAgICAgICBmaXNoLmFkZENsYXNzKFwiaW1hZ2UtZW1iZWRcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuICAgICAgICBsZXQgbmVsID0gZmlzaC5jcmVhdGVFbChcImltZ1wiKTtcclxuICAgICAgICBuZWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcbiAgICAgICAgXHJcbiAgICAgIH0gZWxzZSBpZiAoZXh0QXVkLmNvbnRhaW5zKGV4dCkpIHsgLy8gRW1iZWQgQXVkaW9cclxuICAgICAgICBmaXNoLmFkZENsYXNzKFwibWVkaWEtZW1iZWRcIik7XHJcbiAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuICAgICAgICBsZXQgbmVsID0gZmlzaC5jcmVhdGVFbChcImF1ZGlvXCIsIHtcImF0dHJcIjoge1wiY29udHJvbHNcIiA6IHRydWV9fSk7XHJcbiAgICAgICAgbmVsLnNldEF0dHJpYnV0ZShcInNyY1wiLCBwYXRoKVxyXG5cclxuICAgICAgfSBlbHNlIGlmIChleHRWaWQuY29udGFpbnMoZXh0KSkgeyAvLyBFbWJlZCBWaWRlb1xyXG4gICAgICAgIGZpc2guY2hpbGROb2Rlcy5mb3JFYWNoKChuKSA9PiB7ZmlzaC5yZW1vdmVDaGlsZChuKX0pXHJcblxyXG4gICAgICAgIGxldCB2aWRpdiA9IGZpc2guY3JlYXRlRWwoXCJ2aWRlb1wiLCB7XCJhdHRyXCIgOiB7XCJjb250cm9sc1wiIDogdHJ1ZX19KVxyXG4gICAgICAgIHZpZGl2LnNldEF0dHJpYnV0ZShcInNyY1wiLCBwYXRoKVxyXG5cclxuICAgICAgfSBlbHNlIGlmIChleHRUeHQuY29udGFpbnMoZXh0KSkgeyBcclxuICAgICAgICAvKiBFbWJlZCBUcmFuc2NsdXNpb24gKi9cclxuXHJcbiAgICAgICAgY29uc3QgY3JlYXRlRW1iZWRQcm9taXNlOiAoKT0+UHJvbWlzZTx2b2lkPiA9ICgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBkTG9nKFwibmV3IGVtYmVkIHByb21cIilcclxuXHJcbiAgICAgICAgICAgIGZpc2guY2hpbGROb2Rlcy5mb3JFYWNoKChuKSA9PiB7ZmlzaC5yZW1vdmVDaGlsZChuKX0pXHJcbiAgXHJcbiAgICAgICAgICAgICAgbGV0IGNhY2hlID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKGRlc3QucGF0aClcclxuICAgICAgICAgICAgICBsZXQgcmVhZCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChkZXN0KVxyXG4gICAgICAgICAgICAgIGxldCBjbGFzc2VzID0gcGFyc2VGcm9udE1hdHRlclN0cmluZ0FycmF5KGNhY2hlPy5mcm9udG1hdHRlciwgXCJjc3NjbGFzc1wiKVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgbGV0IGRpdiA9IGZpc2guY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWRcIn0pXHJcbiAgICAgICAgICAgICAgbGV0IGRpdnRpdGxlID0gZGl2LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLWVtYmVkLXRpdGxlXCIsIHRleHQ6IGRlc3QuYmFzZW5hbWV9KVxyXG4gICAgICAgICAgICAgIGxldCBjb250ZW50ID0gZGl2LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLWVtYmVkLWNvbnRlbnRcIn0pXHJcbiAgICAgICAgICAgICAgbGV0IGxpbmsgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtbGlua1wifSlcclxuICAgICAgICAgICAgICBzZXRJY29uKGxpbmssIFwibGlua1wiKVxyXG4gICAgICAgICAgICAgIGxpbmsub25DbGlja0V2ZW50KChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBwbHVnaW4uYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoc3JjLCBzcmNQYXRoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgbGV0IHB2ID0gY29udGVudC5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1wcmV2aWV3LXZpZXdcIn0pOyBwdi5hZGRDbGF6eihjbGFzc2VzKTtcclxuICAgICAgICAgICAgICBsZXQgcHMgPSBwdi5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1wcmV2aWV3LXNpemVyIG1hcmtkb3duLXByZXZpZXctc2VjdGlvblwifSlcclxuICAgIFxyXG4gICAgICAgICAgICAgIGxldCBta2ggPSBjcmVhdGVEaXYoe2F0dHI6IHtcImRlcHRoXCI6IGRlcHRoLnRvU3RyaW5nKCl9fSlcclxuICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHJlYWQsIG1raCwgc3JjUGF0aCwgbnVsbClcclxuICAgICAgICAgICAgICBjb25zdCBta2U6IENoaWxkTm9kZVtdID0gKEFycmF5LmZyb20obWtoPy5jaGlsZE5vZGVzIHx8IFtdKS5tYXAoKG4pID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIChuLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyBsZXQgZCA9IGNyZWF0ZURpdigpOyBkLmFwcGVuZChuLmNsb25lTm9kZSh0cnVlKSk7IHJldHVybiBkO30gZWxzZSByZXR1cm4gbjt9KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHsgbGV0IGQgPSBjcmVhdGVEaXYoKTsgZC5hcHBlbmQobik7IHJldHVybiBkO30gZWxzZSByZXR1cm4gbjt9KSk7XHJcblxyXG4gICAgICAgICAgICAgIHBzLmFwcGVuZCguLi5ta2UpOyAvL3BzLnNldEF0dHJpYnV0ZShcImRlcHRoXCIsIGQudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIHJldHVybiBlbWJlZE1lZGlhKHBzLCBzcmNQYXRoLCBwbHVnaW4sIGQtMSwgdHJ1ZSlcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZCA8PSAwKSAge1xyXG4gICAgICAgICAgbGV0IFtsXSA9IGNyZWF0ZVJlZ2VudCh7Y2xhc3M6IFwiZGVwdGgtbGltaXRcIiwgaG92ZXI6IFwiSXQgZ29lcyBvbiBmb3JldmVyLi4uXCJ9KVxyXG4gICAgICAgICAgZmlzaC5yZXBsYWNlV2l0aChsKVxyXG5cclxuICAgICAgICAgIGRMb2coXCJlbWJlZGRlciBoaXQgbGltaXRcIilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcHJvbXMucHVzaChjcmVhdGVFbWJlZFByb21pc2UoKSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBQcm9taXNlLmFsbFNldHRsZWQocHJvbXMpLnRoZW4odmFsdWVzID0+IHtcclxuICAgIGRMb2coXCJlbWJlZGRlciBkb25lXCIsIHByb21zKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShwcm9tcy5sZW5ndGgpXHJcbiAgfSlcclxufSIsImltcG9ydCB7IEV0YUNvbmZpZyB9IGZyb20gXCJldGEvZGlzdC90eXBlcy9jb25maWdcIjtcclxuaW1wb3J0IHsgQ2FsbGJhY2tGbiB9IGZyb20gXCJldGEvZGlzdC90eXBlcy9maWxlLWhhbmRsZXJzXCI7XHJcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFNrcmliaUNoaWxkIH0gZnJvbSBcInNyYy9yZW5kZXIvY2hpbGRcIjtcclxuaW1wb3J0IHsgTW9kZXMsIEZsYWdzIH0gZnJvbSBcIi4vY29uc3RcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2tDb250ZXh0IHtcclxuXHR0aW1lOiBudW1iZXIsXHJcblx0ZmxhZzogbnVtYmVyLFxyXG5cdGRlcHRoOiBudW1iZXIsXHJcblx0Y3R4PzogYW55XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvY2Vzc29yTW9kZSB7XHJcblx0c3JjVHlwZTogTW9kZXNcclxuXHRmbGFnPzogRmxhZ3NcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZSB7XHJcblx0ZmlsZTogVEZpbGVcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTdHJpbmdkZXgge1xyXG5cdFtpbmRleDogc3RyaW5nXTogYW55XHJcbn1cclxuXHJcbmV4cG9ydCBkZWNsYXJlIHR5cGUgU3RyaW5nZGV4ZWQ8VD4gPSB7W2luZGV4OiBzdHJpbmddOiBUfVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBcmdTZXQge1tpbmRleDogc3RyaW5nXTogc3RyaW5nIHwgc3RyaW5nW119O1xyXG5cclxuZXhwb3J0IGVudW0gcHJvbXB0VHlwZXMge1xyXG4gIHN0cmluZyA9IFwic3RyaW5nXCJcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBmaWVsZFByb21wdCB7XHJcblx0W2luZGV4OiBzdHJpbmddOiBhbnlcclxuXHRpZDogc3RyaW5nXHJcblx0dHlwZTogcHJvbXB0VHlwZXNcclxuXHRuYW1lOiBzdHJpbmdcclxuXHRwbGFjZWhvbGRlcjogc3RyaW5nXHJcblx0ZGVmYXVsdDogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2Ugc2NvcGVkVmFycyBleHRlbmRzIFN0cmluZ2RleCB7XHJcbiAgc2s6IG9iamVjdCwgXHJcbiAgRTogRXRhQ29uZmlnLCBcclxuICBjYj86IENhbGxiYWNrRm4sIFxyXG4gIHNjb3BlPzogU3RyaW5nZGV4XHJcbn1cclxuXHJcbmV4cG9ydCBkZWNsYXJlIHR5cGUgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCA9IChzY29wZTogc2NvcGVkVmFycykgPT4gUHJvbWlzZTxzdHJpbmc+O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEeW5hbWljU3RhdGUge1xyXG4gIGVsOiBIVE1MRWxlbWVudCxcclxuICBmaWxlOiBURmlsZSxcclxuICBjaGlsZDogU2tyaWJpQ2hpbGRcclxufSIsImltcG9ydCB7IEFic3RyYWN0VGV4dENvbXBvbmVudCwgQXBwLCBFZGl0b3IsIEVkaXRvclJhbmdlT3JDYXJldCwgRWRpdG9yU2VsZWN0aW9uLCBGdXp6eVN1Z2dlc3RNb2RhbCwgS2V5bWFwRXZlbnRIYW5kbGVyLCBNb2RhbCwgU2V0dGluZywgVGV4dENvbXBvbmVudCwgVmFsdWVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBmaWVsZFByb21wdCwgcHJvbXB0VHlwZXMsIFN0cmluZ2RleCB9IGZyb20gXCIuL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCB0b0R1cGVSZWNvcmQgfSBmcm9tIFwiLi91dGlsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSW5zZXJ0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW47XHJcbiAgcHJpdmF0ZSBlZGl0b3I6IEVkaXRvcjtcclxuICBwcml2YXRlIGtleXByZXNzUmVmOiBLZXltYXBFdmVudEhhbmRsZXI7XHJcblxyXG4gIGN1cnJlbnRJRDogc3RyaW5nO1xyXG4gIHRleHRJbnB1dDogQWJzdHJhY3RUZXh0Q29tcG9uZW50PGFueT5cclxuXHJcbiAgdmFsRmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luLCBlZGl0b3I6IEVkaXRvciwgaWQ6IHN0cmluZykge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcClcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XHJcblxyXG4gICAgdGhpcy5jdXJyZW50SUQgPSBpZC50b1N0cmluZygpXHJcblxyXG4gICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcInNrcmliaS1pbnNlcnRpb24tbW9kYWxcIilcclxuICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiSW5zZXJ0IFNrcmliaSBUZW1wbGF0ZVwiKVxyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgdGhpcy5jcmVhdGUoKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlKCkge1xyXG5cclxuICAgIGxldCBzID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBzLmFkZERyb3Bkb3duKChkcm9wKSA9PiB7IGRyb3BcclxuICAgICAgLmFkZE9wdGlvbnModG9EdXBlUmVjb3JkKHRoaXMucGx1Z2luLmV0YS5nZXRDYWNoZUtleXMoKSkpXHJcbiAgICAgIC5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRJRClcclxuICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SUQgPSB2XHJcbiAgICAgICAgbGV0IGYgPSB0aGlzLmdlbmVyYXRlRmllbGRzKGZpZWxkc0RpdiwgdGhpcy5jdXJyZW50SUQpO1xyXG4gICAgICAgICgoZi5sZW5ndGggPiAwKSA/IGZbMF0gOiB0aGlzLnRleHRJbnB1dCkuaW5wdXRFbC5mb2N1cygpO1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgZmllbGRzRGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLW1vZGFsLWZpZWxkc1wifSlcclxuXHJcbiAgICBsZXQgdCA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgdC5hZGRUZXh0KCh0ZSkgPT4ge3RoaXMudGV4dElucHV0ID0gdGU7IHJldHVybiB0ZTt9KVxyXG4gICAgdC5zZXROYW1lKFwiQXBwZW5kXCIpXHJcbiAgICB0LnNldHRpbmdFbC5hZGRDbGFzcyhcInNrcmliaS1tb2RhbC1maWVsZC1hcHBlbmRcIilcclxuXHJcbiAgICBsZXQgZiA9IHRoaXMuZ2VuZXJhdGVGaWVsZHMoZmllbGRzRGl2LCB0aGlzLmN1cnJlbnRJRCk7XHJcbiAgICAoKGYubGVuZ3RoID4gMCkgPyBmWzBdIDogdGhpcy50ZXh0SW5wdXQpLmlucHV0RWwuZm9jdXMoKTtcclxuXHJcbiAgICBsZXQgY29uZmlybSA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgbGV0IGNiID0gY29uZmlybS5hZGRCdXR0b24oKGJ1dHRvbikgPT4gYnV0dG9uXHJcbiAgICAgIC5zZXRCdXR0b25UZXh0KFwiSW5zZXJ0XCIpXHJcbiAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuZG9JbnNlcnQoKSkpXHJcblxyXG4gICAgdGhpcy5rZXlwcmVzc1JlZiA9IHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgdGhpcy5kb0luc2VydC5iaW5kKHRoaXMpKVxyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHRoaXMuc2NvcGUudW5yZWdpc3Rlcih0aGlzLmtleXByZXNzUmVmKVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVGaWVsZHMoZWw6IEhUTUxFbGVtZW50LCBpZDogc3RyaW5nKSB7XHJcbiAgICBlbC5lbXB0eSgpO1xyXG5cclxuICAgIHZhciBhcnI6IEFic3RyYWN0VGV4dENvbXBvbmVudDxhbnk+W10gPSBbXTtcclxuXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uZXRhLnRlbXBsYXRlRnJvbnRtYXR0ZXJzLmhhcyhpZCkpIHtcclxuICAgICAgbGV0IGZtID0gdGhpcy5wbHVnaW4uZXRhLnRlbXBsYXRlRnJvbnRtYXR0ZXJzLmdldChpZClcclxuICAgICAgbGV0IHB2ID0gW11cclxuICAgICAgZm9yIChsZXQgdiBvZiBPYmplY3Qua2V5cyhmbSkpIHtcclxuICAgICAgICBpZiAodi5jaGFyQXQoMCk9PVwiX1wiKSB7XHJcbiAgICAgICAgICBsZXQgdm4gPSB2LnN1YnN0cmluZygxKVxyXG4gICAgICAgICAgbGV0IGZtYSA9IHRoaXMucGFyc2VQcm9tcHRWYWwodm4sIGZtW3ZdKVxyXG5cclxuICAgICAgICAgIGxldCBzID0gbmV3IFNldHRpbmcoZWwpXHJcbiAgICAgICAgICBzLnNldHRpbmdFbC5hZGRDbGFzcyhcInNrcmliaS1tb2RhbC10ZW1wbGF0ZS1maWVsZFwiKVxyXG4gICAgICAgICAgaWYgKGZtYS50eXBlID09IHByb21wdFR5cGVzLnN0cmluZykge1xyXG4gICAgICAgICAgICBhcnIucHVzaCh0aGlzLmNyZWF0ZVRleHRGaWVsZChzLCBmbWEpKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcy5zZXROYW1lKGZtYS5uYW1lKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhcnI7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVUZXh0RmllbGQoc2V0OiBTZXR0aW5nLCBmbWE6IGZpZWxkUHJvbXB0KSB7XHJcbiAgICBsZXQgdDtcclxuICAgIHNldC5hZGRUZXh0KCh0ZXh0KSA9PiB7IFxyXG4gICAgICB0ZXh0XHJcbiAgICAgIC5zZXRWYWx1ZShmbWEuZGVmYXVsdClcclxuICAgICAgLnNldFBsYWNlaG9sZGVyKGZtYS5wbGFjZWhvbGRlcilcclxuICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgIHRoaXMudmFsRmllbGRzW2ZtYS5pZF0gPSB2YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgICB0ZXh0LmlucHV0RWwuYWRkQ2xhc3MoXCJza3JpYmktdGV4dC1pbnB1dFwiKVxyXG4gICAgICB0ID0gdGV4dFxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoZm1hLmRlZmF1bHQubGVuZ3RoID4gMCkgdGhpcy52YWxGaWVsZHNbZm1hLmlkXSA9IGZtYS5kZWZhdWx0XHJcblxyXG4gICAgcmV0dXJuIHRcclxuICB9XHJcblxyXG4gIHBhcnNlUHJvbXB0VmFsKGs6IGFueSwgdmFsOiBhbnkpOiBmaWVsZFByb21wdCB7XHJcbiAgICBsZXQgdjogZmllbGRQcm9tcHQgPSB7XHJcbiAgICAgIGlkOiBrLFxyXG4gICAgICB0eXBlOiBwcm9tcHRUeXBlcy5zdHJpbmcsXHJcbiAgICAgIG5hbWU6IGlzRXh0YW50KHZhbD8ubmFtZSkgPyB2YWwubmFtZSA6IGssXHJcbiAgICAgIHBsYWNlaG9sZGVyOiBpc0V4dGFudCh2YWw/LnBsYWNlaG9sZGVyKSA/IHZhbC5wbGFjZWhvbGRlciA6IFwiXCIsXHJcbiAgICAgIGRlZmF1bHQ6IGlzRXh0YW50KHZhbD8uZGVmYXVsdCkgPyB2YWwuZGVmYXVsdCA6IGlzRXh0YW50KHZhbD8uZGVmKSA/IHZhbC5kZWYgOiBcIlwiLFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB2XHJcbiAgfVxyXG5cclxuICBkb0luc2VydCgpIHtcclxuICAgIGxldCBpZCA9IHRoaXMuY3VycmVudElEXHJcblxyXG4gICAgbGV0IG9zZWwgPSB0aGlzLmVkaXRvci5saXN0U2VsZWN0aW9ucygpXHJcbiAgICBcclxuICAgIGxldCB0b0luc2VydCA9IGBcXGB7OiR7aWR9YFxyXG5cclxuICAgIGZvciAobGV0IGUgb2YgT2JqZWN0LmVudHJpZXModGhpcy52YWxGaWVsZHMpKSB7XHJcbiAgICAgIHRvSW5zZXJ0ICs9IGAgfCAke2VbMF19OiAke2VbMV19YFxyXG4gICAgfVxyXG5cclxuICAgIHRvSW5zZXJ0ICs9ICh0aGlzPy50ZXh0SW5wdXQuZ2V0VmFsdWUoKS5sZW5ndGggPiAwKSA/IFwiIHwgXCIgKyB0aGlzLnRleHRJbnB1dC5nZXRWYWx1ZSgpIDogXCJcIlxyXG4gICAgdG9JbnNlcnQgKz0gYH1cXGBgXHJcblxyXG4gICAgdGhpcy5lZGl0b3IuZ2V0RG9jKCkucmVwbGFjZVNlbGVjdGlvbih0b0luc2VydClcclxuXHJcbiAgICBsZXQgbnNlbDogRWRpdG9yUmFuZ2VPckNhcmV0W10gPSBbXSBcclxuICAgIGZvciAobGV0IHAgb2Ygb3NlbCkge25zZWwucHVzaCh7ZnJvbToge2xpbmU6IHAuYW5jaG9yLmxpbmUsIGNoOiBwLmFuY2hvci5jaCArICh0b0luc2VydC5sZW5ndGgpfX0pfVxyXG4gICAgdGhpcy5lZGl0b3IudHJhbnNhY3Rpb24oe3NlbGVjdGlvbnM6IG5zZWx9KVxyXG5cclxuICAgIHRoaXMuY2xvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTdWdnZXN0aW9uTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxzdHJpbmc+IHtcclxuICBwcml2YXRlIHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcmVqZWN0OiAocmVhc29uPzogYW55KSA9PiB2b2lkO1xyXG5cclxuICBwcml2YXRlIHBsdWdpbjogU2tyaWJvc1BsdWdpblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcClcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcbiAgfVxyXG5cclxuICBnZXRJdGVtcygpIHtcclxuICAgIHJldHVybiB0aGlzLnBsdWdpbi5ldGEuZ2V0Q2FjaGVLZXlzKClcclxuICB9XHJcblxyXG4gIGdldEl0ZW1UZXh0KGl0ZW06IHN0cmluZyk6IHN0cmluZyB7cmV0dXJuIGl0ZW19XHJcblxyXG4gIG9uQ2hvb3NlSXRlbShpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuICAgIHRoaXMucmVzb2x2ZShpdGVtKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgb3BlbkFuZEdldFZhbHVlKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6ICgpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmVcclxuICAgIHRoaXMucmVqZWN0ID0gcmVqZWN0XHJcbiAgICB0aGlzLm9wZW4oKVxyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0IHsgRXZlbnRSZWYsIE1hcmtkb3duUmVuZGVyQ2hpbGQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBkTG9nIH0gZnJvbSBcInNyYy91dGlsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2tyaWJpQ2hpbGQgZXh0ZW5kcyBNYXJrZG93blJlbmRlckNoaWxkIHtcclxuXHRwYWNrZXQ6IFN0cmluZ2RleFxyXG5cdGludGVydmFsczogbnVtYmVyW10gPSBbXTtcclxuXHJcblx0Y2JPblVubG9hZDogW0Z1bmN0aW9uLCBhbnldW10gPSBbXVxyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKGVsOiBIVE1MRWxlbWVudCkge1xyXG5cdFx0c3VwZXIoZWwpXHJcblx0fVxyXG5cclxuICBwcm92aWRlQ29udGV4dCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGVsOiB0aGlzLmNvbnRhaW5lckVsLFxyXG4gICAgICByZWdpc3RlckludGVydmFsOiB0aGlzLnNrUmVnaXN0ZXJJbnRlcnZhbC5iaW5kKHRoaXMpLFxyXG4gICAgICByZWdpc3RlclVubG9hZDogdGhpcy5za1JlZ2lzdGVyVW5sb2FkLmJpbmQodGhpcyksXHJcbiAgICAgIHJlZ2lzdGVyRXZlbnQ6IHRoaXMuc2tSZWdpc3RlckV2ZW50LmJpbmQodGhpcyksXHJcbiAgICAgIHJlbG9hZDogdGhpcy5yZXJlbmRlciwgLy8gQm91bmQgb24gYXNzaWdubWVudFxyXG4gICAgICBjOiB0aGlzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHRzZXRQYWNrZXQocGFja2V0OiBTdHJpbmdkZXgpIHtcclxuXHRcdGlmICh0aGlzLnBhY2tldCA9PSBudWxsKSB7XHJcblx0XHRcdHRoaXMucGFja2V0ID0gcGFja2V0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0b25sb2FkKCkge31cclxuXHJcblx0Y2xlYXIoKSB7XHJcblx0XHRkTG9nKFwic2tyZWViIGNsZWFyXCIpXHJcblx0XHRmb3IgKGxldCBpIG9mIHRoaXMuaW50ZXJ2YWxzKSB3aW5kb3cuY2xlYXJJbnRlcnZhbChpKTsgLy8gdGhlcmUgbWlnaHQgYmUgY2FzZXMgd2hlcmUgdGhpcyBkb2Vzbid0IGdldCBjYWxsZWQgcHJvcGVybHlcclxuXHRcdGZvciAobGV0IGNiIG9mIHRoaXMuY2JPblVubG9hZCkgY2JbMF0oY2JbMV0pO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7XHJcblx0XHRkTG9nKFwic2tyZWViIHVubG9hZFwiKVxyXG5cdFx0dGhpcy5jbGVhcigpXHJcblx0fVxyXG5cclxuXHJcbiAgLyogUHJvdmlkZXIgRnVuY3Rpb25zICovXHJcbiAgXHJcblx0c2tSZWdpc3RlckludGVydmFsKGNiOiBGdW5jdGlvbiwgdGltZTogbnVtYmVyLCAuLi5hcmdzOiBhbnlbXSkge1xyXG5cdFx0Ly9AdHMtaWdub3JlXHJcblx0XHRsZXQgeCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoLi4uYTogYW55KSA9PiB7IGlmICh0aGlzLl9sb2FkZWQgPT0gZmFsc2UpIHt3aW5kb3cuY2xlYXJJbnRlcnZhbCh4KX1cclxuXHRcdFx0Y2IoLi4uYSl9LCB0aW1lICogMTAwMCwgLi4uYXJncylcclxuXHRcdHRoaXMuaW50ZXJ2YWxzLnB1c2goeClcclxuXHRcdHJldHVybiB4O1xyXG5cdH1cclxuXHJcbiAgc2tSZWdpc3RlckV2ZW50KGV2ZW50OiBFdmVudFJlZikge1xyXG4gICAgZExvZygnU2tDaGlsZCByZWdpc3RlcmVkIGV2ZW50OicsIGV2ZW50KVxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KGV2ZW50KVxyXG4gIH1cclxuXHJcblx0c2tSZWdpc3RlclVubG9hZChjYjogRnVuY3Rpb24sIC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0XHR0aGlzLmNiT25VbmxvYWQucHVzaChbKC4uLng6IGFueSkgPT4gY2IoLi4ueCksIGFyZ3NdKVxyXG5cdH1cclxuXHJcbiAgLy8gQXNzaWduZWQgaW4gcmVuZGVyU2tyaWJpKClcclxuICByZXJlbmRlcigpIHt9XHJcbn0iLCJpbXBvcnQgeyBpc0V4dGFudCB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5cclxuLyogQ2hlY2sgaWYgY29kZSBibG9jayBpcyB0aGF0IGdvb2QgZ29vZCBhbmQgaWYgc28gd2hhdCB0eXBlIG9mIGdvb2QgZ29vZCAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJlcGFyc2VTa3JpYmkoZWw6IEhUTUxFbGVtZW50LCBzdHI/OiBzdHJpbmcsIGZsZz86IGFueSkge1xyXG5cdGxldCB0ZXh0ID0gaXNFeHRhbnQoc3RyKSA/IHN0ciA6IGVsLnRleHRDb250ZW50XHJcblx0aWYgKHRleHQubGVuZ3RoIDwgMykgcmV0dXJuO1xyXG5cclxuXHRsZXQgZSA9IHRleHQuc3Vic3RyKHRleHQubGVuZ3RoLTIpXHJcblx0bGV0IHMgPSB0ZXh0LnN1YnN0cigwLCAyKVxyXG5cdFxyXG5cdGlmIChzLnN0YXJ0c1dpdGgoXCJ7XCIpICYmIGUuZW5kc1dpdGgoXCJ9XCIpKSB7XHJcblx0XHRsZXQgZiA9IHNbMV07XHJcblx0XHRsZXQgZmxhZyA9IChmID09IFwiOlwiKSA/IDEgOiAoZiA9PSBcIj1cIikgPyAyIDogKGYgPT0gXCJ+XCIpID8gMyA6IChmID09IFwie1wiKSA/IDQgOiAoZiA9PSBcIi5cIikgPyA1IDogLTE7XHJcblx0XHRpZiAoKGZsYWcgPiAwKSAmJiAoZmxhZyAhPSA0IHx8IChlID09IFwifX1cIikpKSB7XHJcblx0XHRcdHJldHVybiB7ZmxhZzogZmxhZywgdGV4dDogdGV4dC5zdWJzdHJpbmcoMiwgdGV4dC5sZW5ndGggLSAoZmxhZyA9PSA0ID8gMiA6IDEgKSl9XHJcblx0XHR9IGVsc2UgcmV0dXJuXHJcblx0fSBlbHNlIHJldHVyblxyXG59XHJcblxyXG4vKiBQYXJzZSB2YXJpYWJsZXMgaW4gdGVtcGxhdGUgaW52b2NhdGlvbnMgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlU2tyaWJpKHNyYzogc3RyaW5nKTogUHJvbWlzZTx7XHJcblx0aWQ6IHN0cmluZyxcclxuXHRhcmdzOiBhbnlcclxufT4ge1xyXG5cdGxldCBzYSA9IHNyYy5zcGxpdCgvKD88IVtcXFxcXSlcXHwvKVxyXG5cdGxldCBpZCA9IHNhLnNwbGljZSgwLCAxKVswXS50cmltKClcclxuXHJcblx0bGV0IGFyZ3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcclxuXHRmb3IgKGxldCBzZWcgb2Ygc2EpIHtcclxuXHRcdGxldCBzaSA9IHNlZy5pbmRleE9mKFwiOlwiKVxyXG5cdFx0aWYgKHNpID09IC0xKSBjb250aW51ZTtcclxuXHRcdGFyZ3Nbc2VnLnNsaWNlKDAsIHNpKS50cmltKCldID0gc2VnLnNsaWNlKHNpKzEpLnRyaW0oKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7aWQ6IGlkLCBhcmdzOiB7djogYXJnc319O1xyXG59IiwiaW1wb3J0IHsgZGVib3VuY2UsIEV2ZW50UmVmLCBFdmVudHMsIE1hcmtkb3duUG9zdFByb2Nlc3NvciwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgTWFya2Rvd25QcmV2aWV3VmlldywgTWFya2Rvd25SZW5kZXJDaGlsZCwgTWFya2Rvd25SZW5kZXJlciwgTWFya2Rvd25TZWN0aW9uSW5mb3JtYXRpb24sIE1hcmtkb3duVmlldywgUGx1Z2luLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gJy4vZXRhL2V0YSc7XHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIFNrcmlib3NTZXR0aW5ncywgU2tyaWJvc1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcclxuaW1wb3J0IHsgZExvZywgZ2V0UHJldmlld1ZpZXcsIGlzRXh0YW50LCBpc0ZpbGUsIHJvdW5kVG8sIHZMb2cgfSBmcm9tICcuL3V0aWwnO1xyXG5pbXBvcnQgeyBlbWJlZE1lZGlhIH0gZnJvbSAnLi9yZW5kZXIvZW1iZWQnO1xyXG5pbXBvcnQgeyBNb2RlcywgRmxhZ3MsIEVCQVIgfSBmcm9tICcuL3R5cGVzL2NvbnN0JztcclxuaW1wb3J0IHsgUHJvY2Vzc29yTW9kZSwgU2tDb250ZXh0LCBTdHJpbmdkZXgsIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcclxuaW1wb3J0IHsgSW5zZXJ0aW9uTW9kYWwsIFN1Z2dlc3Rpb25Nb2RhbCB9IGZyb20gJy4vbW9kYWwnO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gJy4vcmVuZGVyL2NoaWxkJztcclxuaW1wb3J0IHsgcHJlcGFyc2VTa3JpYmksIHBhcnNlU2tyaWJpIH0gZnJvbSAnLi9yZW5kZXIvcGFyc2UnO1xyXG5pbXBvcnQgeyByZW5kZXJFcnJvciwgcmVuZGVyUmVnZW50LCByZW5kZXJTdGF0ZSwgcmVuZGVyV2FpdCB9IGZyb20gJy4vcmVuZGVyL3JlZ2VudCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTa3JpYm9zUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogU2tyaWJvc1NldHRpbmdzO1xyXG5cdGV0YTogRXRhSGFuZGxlcjtcclxuXHR2YXJOYW1lOiBzdHJpbmcgPSBcInNrXCI7XHJcblxyXG5cdGxvYWRFdmVudHMgPSBuZXcgRXZlbnRzKCk7XHJcblx0cHJpdmF0ZSBpbml0TG9hZFJlZjogRXZlbnRSZWZcclxuXHRpbml0TG9hZGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGNvbnNvbGUubG9nKCdTa3JpYmk6IExvYWRpbmcuLi4nKTtcclxuXHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTa3JpYm9zU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xyXG5cclxuXHRcdHRoaXMuZXRhID0gbmV3IEV0YUhhbmRsZXIodGhpcyk7XHJcblxyXG5cdFx0bGV0IHByb2Nlc3M6IE1hcmtkb3duUG9zdFByb2Nlc3NvciA9IGFzeW5jIChlbCwgY3R4KSA9PiB7IHRoaXMucHJvY2Vzc29yKHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgZWwsIGN0eCwgKSB9XHJcblx0XHQvLyBwcm9jZXNzLnNvcnRPcmRlciA9IC01MFxyXG5cdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3NvcigoZWwsIGN0eCkgPT4gcHJvY2VzcyhlbCwgY3R4KSlcclxuXHJcblx0XHRsZXQgcHJvY2Vzc0Jsb2NrID0gYXN5bmMgKG1vZGU6IFByb2Nlc3Nvck1vZGUsIHN0cjogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkgPT4geyB0aGlzLnByb2Nlc3Nvcihtb2RlLCBlbCwgY3R4LCBudWxsLCBudWxsLCBzdHIudHJpbUVuZCgpKSB9XHJcblx0XHRcclxuXHRcdChbW1wibm9ybWFsXCIsIFwiXCIsIEZsYWdzLm5vbmVdLCBbXCJyYXdcIiwgXCItcmF3XCIsIEZsYWdzLnJhd10sIFtcImxpdGVyYWxcIiwgXCItbGl0XCIsIEZsYWdzLmxpdGVyYWxdLCBbXCJpbnRlcnBvbGF0ZVwiLCBcIi1pbnRcIiwgRmxhZ3MuaW50ZXJwXSwgW1wiZXZhbHVhdGVcIiwgXCItZXZhbFwiLCBGbGFncy5ldmFsXV0pXHJcblx0XHQuZm9yRWFjaCgodikgPT4ge1xyXG5cdFx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoYHNrcmliaSR7dlsxXX1gLCBwcm9jZXNzQmxvY2suYmluZCh0aGlzLCB7c3JjVHlwZTogTW9kZXMuYmxvY2ssIGZsYWc6IHZbMl19KSlcclxuXHRcdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKGBzayR7dlsxXX1gLCBwcm9jZXNzQmxvY2suYmluZCh0aGlzLCB7c3JjVHlwZTogTW9kZXMuYmxvY2ssIGZsYWc6IHZbMl19KSlcclxuXHRcdH0pXHJcblxyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCBlID0+IHtcclxuXHRcdFx0Ly8gaWYgKGU/LnBhcmVudC5wYXRoLmNvbnRhaW5zKHRoaXMuc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIpKSB7IGJVcGRhdGUoZSk7IH1cclxuXHRcdH0pKVxyXG5cclxuXHRcdHRoaXMuaW5pdExvYWRSZWYgPSB0aGlzLmxvYWRFdmVudHMub24oJ2luaXQtbG9hZC1jb21wbGV0ZScsICgpID0+IHt0aGlzLmluaXRMb2FkZWQgPSB0cnVlOyBkTG9nKFwiaW5pdC1sb2FkLWNvbXBsZXRlXCIpfSlcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe2lkOiBcImluc2VydC1za3JpYmlcIiwgbmFtZTogXCJJbnNlcnQgU2tyaWJpXCIsIFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvciwgdmlldykgPT4ge1xyXG5cdFx0XHRcdGlmICghdGhpcy5pbml0TG9hZGVkKSByZXR1cm47XHJcblx0XHRcdFx0bGV0IHggPSBuZXcgU3VnZ2VzdGlvbk1vZGFsKHRoaXMpO1xyXG5cdFx0XHRcdG5ldyBQcm9taXNlKChyZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCwgcmVqZWN0OiAocmVhc29uPzogYW55KSA9PiB2b2lkKSA9PiB4Lm9wZW5BbmRHZXRWYWx1ZShyZXNvbHZlLCByZWplY3QpKVxyXG5cdFx0XHRcdC50aGVuKHJlc3VsdCA9PiB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5ldGEuaGFzUGFydGlhbChyZXN1bHQpKSB7XHJcblx0XHRcdFx0XHRcdGxldCBpID0gbmV3IEluc2VydGlvbk1vZGFsKHRoaXMsIGVkaXRvciwgcmVzdWx0KVxyXG5cdFx0XHRcdFx0XHRpLm9wZW4oKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LCAocikgPT4ge30pO1xyXG5cdFx0XHR9fSlcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe2lkOiBcInNrcmliaS1yZWxvYWQtc2NyaXB0c1wiLCBuYW1lOiBcIlJlbG9hZCBTY3JpcHRzXCIsXHJcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5ldGEuYnVzLnNjcmlwdExvYWRlci5yZWxvYWQoKS50aGVuKCgpID0+IGNvbnNvbGUubG9nKFwiU2tyaWJpOiBSZWxvYWRlZCBTY3JpcHRzXCIpKTtcclxuXHRcdFx0fX0pXHJcblxyXG5cdFx0LyogUnVuIGJ1bGsgc2tyaWJpIHJlbmRlcmluZyB0byB0ZXN0IHByb2Nlc3NpbmcgdGltZXMgKi9cclxuXHRcdGlmIChmYWxzZSkgdGhpcy5hZGRDb21tYW5kKHtpZDogXCJza3JpYmktdGVzdFwiLCBuYW1lOiAnU2tyaWJpIFRlc3QnLCBlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvciwgdmlldykgPT4ge1xyXG5cdFx0XHRsZXQgY29udGFpbmVyID0gY3JlYXRlRGl2KClcclxuXHRcdFx0bGV0IGVsID0gY3JlYXRlRGl2KClcclxuXHJcblx0XHRcdGxldCBkID0gY3JlYXRlRGl2KClcclxuXHJcblx0XHRcdGxldCBwcmltZXM6IEhUTUxFbGVtZW50W10gPSBbXVxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7XHJcblx0XHRcdFx0Ly8gbGV0IGQgPSBjcmVhdGVEaXYoKVxyXG5cdFx0XHRcdGQuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogZWRpdG9yLmdldFNlbGVjdGlvbigpfSlcclxuXHRcdFx0XHQvLyBwcmltZXMucHVzaChkKVxyXG5cdFx0XHR9XHJcblx0XHRcdHByaW1lcy5wdXNoKGQpXHJcblx0XHRcdGxldCB0eCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG5cclxuXHRcdFx0Ly8gY29uc29sZS5sb2cocHJpbWVzKVxyXG5cdFx0XHRjb25zdCBwcm9tcyA9IHByaW1lcy5tYXAoYXN5bmMgKGRpdikgPT4ge1xyXG5cdFx0XHRcdGxldCB0MSA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG5cclxuXHRcdFx0XHRsZXQgcCA9IGF3YWl0IHRoaXMucHJvY2Vzc29yKHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgZGl2LCB7XHJcblx0XHRcdFx0XHRyZW1haW5pbmdOZXN0TGV2ZWw6IDQsXHJcblx0XHRcdFx0XHRkb2NJZDogJzU1NTU1NTU1JyxcclxuXHRcdFx0XHRcdGZyb250bWF0dGVyOiBudWxsLFxyXG5cdFx0XHRcdFx0c291cmNlUGF0aDogdmlldy5maWxlLnBhdGgsXHJcblx0XHRcdFx0XHRhZGRDaGlsZDogKGNoaWxkOiBhbnkpID0+IHt9LFxyXG5cdFx0XHRcdFx0Z2V0U2VjdGlvbkluZm86ICgpID0+IHtyZXR1cm4gbnVsbCBhcyBNYXJrZG93blNlY3Rpb25JbmZvcm1hdGlvbn0sXHJcblx0XHRcdFx0XHRjb250YWluZXJFbDogY29udGFpbmVyLFxyXG5cdFx0XHRcdFx0ZWw6IGVsXHJcblx0XHRcdFx0fSwgNCwgZmFsc2UsIG51bGwpLmNhdGNoKCgpID0+IHt9KVxyXG5cclxuXHRcdFx0XHRyZXR1cm4gW3AsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSwgdDFdXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHRsZXQgdmFscyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChwcm9tcylcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKCd0ZXN0cyBzZXR0bGVkIGluOicsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS10eClcclxuXHJcblx0XHRcdGxldCBlbiA9IHZhbHMubWFwKCh2KSA9PiB7aWYgKHYuc3RhdHVzID09ICdmdWxmaWxsZWQnKSByZXR1cm4gdi52YWx1ZX0pXHJcblxyXG5cdFx0XHRsZXQgdGltZXMgPSBbXVxyXG5cdFx0XHRmb3IgKGxldCByZXMgb2YgZW4pIHtcclxuXHRcdFx0XHRsZXQgdGltZURpZmYgPSByZXNbMV0gYXMgbnVtYmVyIC0gKHJlc1syXSBhcyBudW1iZXIpXHJcblx0XHRcdFx0dGltZXMucHVzaCh0aW1lRGlmZilcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IGwgPSB0aW1lcy5sZW5ndGhcclxuXHRcdFx0bGV0IGEgPSB0aW1lcy5yZWR1Y2UoKHYsIGMpID0+IHtyZXR1cm4gditjfSlcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKGBhdmcgdGltZSBvZiAke2x9OiAke2EvbH1gKVxyXG5cdFx0fX0pXHJcblxyXG5cdFx0XHJcblx0XHQvLyByZWdpc3Rlck1pcnJvcih0aGlzKTtcclxuXHR9XHJcblx0XHJcblx0b251bmxvYWQoKSB7XHJcblx0XHR0aGlzLmV0YS51bmxvYWQoKVxyXG5cdFx0dGhpcy5sb2FkRXZlbnRzLm9mZnJlZih0aGlzLmluaXRMb2FkUmVmKVxyXG5cdFx0Y29uc29sZS5sb2coJ1NrcmliaTogVW5sb2FkaW5nLi4uJyk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBwcm9jZXNzb3IgKFxyXG5cdFx0bW9kZTogUHJvY2Vzc29yTW9kZSwgLy8gMDogY29kZXNwYW47IDE6IGNvZGVibG9jaztcclxuXHRcdGRvYzogSFRNTEVsZW1lbnQsXHJcblx0XHRjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsXHJcblx0XHRkZXB0aD86IG51bWJlcixcclxuXHRcdHNlbGY/OiBib29sZWFuLFxyXG5cdFx0c3JjSW4/OiBzdHJpbmdcclxuXHQpIHtcclxuXHRcdGxldCBuZXN0RXh0YW50ID0gaXNFeHRhbnQoY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdGxldCBuZXN0TGV2ZWwgPSBuZXN0RXh0YW50ID8gY3R4LnJlbWFpbmluZ05lc3RMZXZlbCA6IG51bGw7XHJcblx0XHQvKiBuZXN0RXh0YW50IG1lYW5zIHRoYXQgd2UgYXJlIGluc2lkZSBvZiBhIG5hdHVyYWwgdHJhbnNjbHVzaW9uICovXHJcblxyXG5cdFx0c2VsZiA9IGlzRXh0YW50KHNlbGYpXHJcblx0XHRkZXB0aCA9IHNlbGYgPyBkZXB0aCA6IG51bGxcclxuXHRcdC8qIHNlbGYgbWVhbnMgdGhhdCB3ZSBoYXZlIGJlZW4gY2FsbGVkIGJ5IHJlbmRlclNrcmliaSwgdG8gbG9vayBmb3IgY29kZWJsb2NrcyAqL1xyXG5cclxuXHRcdGxldCBlbEhhc0RlcHRoID0gaXNFeHRhbnQoZG9jLmdldEF0dHJpYnV0ZShcImRlcHRoXCIpKVxyXG5cdFx0bGV0IGVsRWxIYXNEZXB0aCA9IGlzRXh0YW50KGN0eC5lbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSlcclxuXHRcdGxldCBlbERlcHRoID0gZWxIYXNEZXB0aCA/IHBhcnNlSW50KGRvYy5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSkgOiBlbEVsSGFzRGVwdGggPyBwYXJzZUludChjdHguZWwuZ2V0QXR0cmlidXRlKFwiZGVwdGhcIikpIDogbnVsbDtcclxuXHRcdC8qIFVzZWQgZm9yIHBhc3NpbmcgZGVwdGggdG8gdmlydHVhbCBlbGVtZW50cyAod2UgbWF5IGJlIGluIG9uZSBldmVuIGFzIHdlIHNwZWFrLi4uKSovXHJcblxyXG5cdFx0LyogZGV0ZXJtaW5lIG91ciBkZXB0aCBjb25kaXRpb24gdHlwZSAqL1xyXG5cdFx0bGV0IGQgPSBzZWxmID8gZGVwdGggOiAoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpID8gZWxEZXB0aCA6IG5lc3RFeHRhbnQgPyBuZXN0TGV2ZWwgOiAwXHJcblxyXG5cdFx0aWYgKCFuZXN0RXh0YW50ICYmICEoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpKSBkTG9nKFwicHJvY2Vzc29yIHNlZXMgbm8gZGVwdGhcIilcclxuXHJcblx0XHRpZiAoZWxIYXNEZXB0aCkgeyBcclxuXHRcdFx0ZExvZyhcImVsRGVwdGhcIiwgZWxEZXB0aCwgXCJkb2NcIiwgZG9jLCBcImVsXCIsIGN0eC5lbCwgXCJjb25FbFwiLCBjdHguY29udGFpbmVyRWwpIFxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZExvZyhcInByb2Nlc3NvcjogXCIsIFwiZG9jXCIsIGRvYywgXCJlbFwiLCBjdHguZWwsIFwiY29uRWxcIiwgY3R4LmNvbnRhaW5lckVsLCBcIm5lc3RcIiwgY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0LyogRGlzcGF0Y2ggcmVuZGVyIHByb21pc2VzICovXHJcblx0XHR2YXIgcHJvbXM6IFByb21pc2U8YW55PltdID0gW11cclxuXHRcdHZhciB0ZW1wcyA9IDA7XHJcblx0XHRjb25zdCBlbENvZGVzID0gKG1vZGUuc3JjVHlwZSA9PSBNb2Rlcy5ibG9jaykgPyBbZG9jXSA6IGRvYy5xdWVyeVNlbGVjdG9yQWxsKFwiY29kZVwiKVxyXG5cdFx0aWYgKCEoZCA8PSAwKSkge1xyXG5cdFx0XHRpZiAoZmFsc2UpIHsgLy8gbm90IHN1cmUgdGhlIHRlbXBsYXRlIHByZXZpZXcgaWRlYSBpcyBmZWFzaWJsZVxyXG5cdFx0XHRcdGxldCBmID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdCgnJywgY3R4LnNvdXJjZVBhdGgpXHJcblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIuY29udGFpbnMoZi5wYXJlbnQucGF0aCkpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdjaGVjaycpXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0XHRsZXQgdmlldyA9IGdldFByZXZpZXdWaWV3KHRoaXMuYXBwKSBhcyBNYXJrZG93blZpZXdcclxuXHRcdFx0XHRcdGxldCBlZGl0b3IgPSBnZXRQcmV2aWV3Vmlldyh0aGlzLmFwcCwgdHJ1ZSk/LmVkaXRvciB8fCBudWxsXHJcblxyXG5cdFx0XHRcdFx0bGV0IHBlID0gdmlldy5wcmV2aWV3TW9kZS5yZW5kZXJlci5wcmV2aWV3RWxcclxuXHRcdFx0XHRcdHBlLmVtcHR5KClcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRcdGxldCBzaGVsbCA9IHBlLmNyZWF0ZURpdih7Y2xzOiAnc2tyaWJpLXRlbXBsYXRlLXByZXZpZXcnLCBhdHRyOiB7J2RlcHRoJzogZH19KVxyXG5cdFx0XHRcdFx0dGhpcy5yZW5kZXJTa3JpYmkoc2hlbGwuY3JlYXRlRGl2KCksIHZpZXcuZ2V0Vmlld0RhdGEoKSwgXCJsaXRlcmFsXCIsIGN0eCwge3RpbWU6IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSwgZGVwdGg6IGQsIGZsYWc6IDR9KVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IHRtID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xyXG5cdFx0XHRjb25zdCBlbFByb21zID0gQXJyYXkuZnJvbShlbENvZGVzKS5tYXAoYXN5bmMgKGVsKSA9PiB7XHJcblx0XHRcdFx0bGV0IHQgPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdFx0ZExvZyhcInN0YXJ0OlwiLCB0KVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxldCBzcmMgPSAoaXNFeHRhbnQobW9kZS5mbGFnKSAmJiBtb2RlLmZsYWcgIT0gRmxhZ3Mubm9uZSkgP1xyXG5cdFx0XHRcdFx0e3RleHQ6IHNyY0luIHx8IGRvYy50ZXh0Q29udGVudCwgZmxhZzogbW9kZS5mbGFnfSA6IGF3YWl0IHByZXBhcnNlU2tyaWJpKGVsKTtcclxuXHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGlmIChzcmMgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0XHRsZXQgbmVsID0gcmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdzay1sb2FkaW5nJywgaG92ZXI6ICdFdmFsdWF0aW5nLi4uJ30pXHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRpZiAoc3JjLmZsYWcgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdHByb21zLnB1c2godGhpcy5wcmVkaWNhdGUoe2VsOiBuZWwsIHNyYzogc3JjLnRleHQsIG1kQ3R4OiBjdHgsIHNrQ3R4OiB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBkZXB0aDogZCwgZmxhZzogc3JjLmZsYWd9fSkpO1xyXG5cdFx0XHRcdFx0XHRcdHRlbXBzKys7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cHJvbXMucHVzaCh0aGlzLnByb2Nlc3NTa3JpYmkobmVsLCBzcmMudGV4dCwgY3R4LCB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBkZXB0aDogZCwgZmxhZzogc3JjLmZsYWd9KSlcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBcclxuXHRcdFx0XHR9IGNhdGNoKGUpIHtcclxuXHRcdFx0XHRcdGlmICghZS5mbGFncy5ub1JlbmRlcikge1xyXG5cdFx0XHRcdFx0XHRyZW5kZXJFcnJvcihlbCwgZSlcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG5cdFx0XHR9KVxyXG5cdFx0XHJcblx0XHRcdGlmICgvKiFzZWxmICYmICovIWRvYy5oYXNDbGFzcyhcInNrcmliaS1yZW5kZXItdmlydHVhbFwiKSkge1xyXG5cdFx0XHRcdGxldCBhcHMgPSBQcm9taXNlLmFsbChlbFByb21zKVxyXG5cdFx0XHRcdGFwcy50aGVuKCgpID0+IHtcclxuXHRcdFx0XHRcdFByb21pc2UuYWxsU2V0dGxlZChwcm9tcykudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0XHRcdGlmIChwcm9tcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuaW5pdExvYWRlZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dkxvZyhgUHJvY2Vzc2VkICR7cHJvbXMubGVuZ3RofSBza3JpYmlzICgke3JvdW5kVG8oKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS10bSksIDQpfSBtcykgaW4gRWxlbWVudGAsIGRvYylcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IHN0ciA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAodGVtcHMgPiAwKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChwcm9tcy5sZW5ndGggLSB0ZW1wcyA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzdHIgPSBgUHJvY2Vzc2VkICR7cHJvbXMubGVuZ3RoLXRlbXBzfSBhbmQgcXVldWVkICR7dGVtcHN9IHNrcmliaXNgO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Ugc3RyID0gYFF1ZXVlZCAke3RlbXBzfSBza3JpYmlzYDtcclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBzdHIgPSBgUHJvY2Vzc2VkICR7cHJvbXMubGVuZ3RoLXRlbXBzfSBza3JpYmlzYDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR2TG9nKHN0ciArIGAgKCR7cm91bmRUbygod2luZG93LnBlcmZvcm1hbmNlLm5vdygpLXRtKSwgNCl9IG1zKSBpbiBFbGVtZW50YCwgZG9jKVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoZWxQcm9tcylcclxuXHJcblx0XHRcdHJldHVybiBwcm9tc1xyXG5cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8qIERlcHRoIHRvbyBoaWdoISAqL1xyXG5cclxuXHRcdFx0ZWxDb2Rlcy5mb3JFYWNoKGFzeW5jIChlbCkgPT4ge1xyXG5cdFx0XHRcdHByZXBhcnNlU2tyaWJpKGVsKS50aGVuKGFzeW5jIChzcmMpID0+IHtcclxuXHRcdFx0XHRcdGlmIChzcmMgIT0gbnVsbCkgcmVuZGVyU3RhdGUoZWwsIHtob3ZlcjogXCJSZWN1cnNpb24gbGltaXQgcmVhY2hlZCFcIiwgY2xhc3M6ICdzdGFzaXMnfSlcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9KVxyXG5cdFx0XHRkTG9nKFwicHJvY2Vzc29yIGhpdCBsaW1pdFwiKTsgXHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCdEZXB0aCBMaW1pdCcpOyBcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIEF3YWl0IGluaXRpYWwgbG9hZGluZyBvZiB0ZW1wbGF0ZXMgKi9cclxuXHRhc3luYyBwcmVkaWNhdGUoYXJnczogYW55KSB7XHJcblx0XHRsZXQgZWwgPSByZW5kZXJXYWl0KGFyZ3MuZWwpXHJcblxyXG5cdFx0aWYgKCF0aGlzLmluaXRMb2FkZWQpIHtcclxuXHRcdFx0ZExvZyhcIm5vdCB5ZXQgbG9hZGVkXCIpXHJcblx0XHRcdHRoaXMuaW5pdExvYWRSZWYgPSB0aGlzLmxvYWRFdmVudHMub24oJ2luaXQtbG9hZC1jb21wbGV0ZScsIGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHR0aGlzLmluaXRMb2FkZWQgPSB0cnVlXHJcblx0XHRcdFx0cmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1NrcmliaVRlbXBsYXRlKGVsLCBhcmdzLnNyYywgYXJncy5tZEN0eCwgT2JqZWN0LmFzc2lnbihhcmdzLnNrQ3R4LCB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpfSkpXHJcblx0XHRcdH0pXHJcblx0XHR9IGVsc2UgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1NrcmliaVRlbXBsYXRlKGVsLCBhcmdzLnNyYywgYXJncy5tZEN0eCwgYXJncy5za0N0eClcclxuXHR9XHJcblxyXG5cdGFzeW5jIHByb2Nlc3NTa3JpYmlUZW1wbGF0ZShcclxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXHJcblx0XHRzcmM6IHN0cmluZywgXHJcblx0XHRtZEN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgXHJcblx0XHRza0N0eDogU2tDb250ZXh0XHJcblx0KTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRsZXQgcGFyc2VkOiB7aWQ6IHN0cmluZywgYXJnczogYW55fSA9IG51bGw7XHJcblx0XHR0cnkgeyBwYXJzZWQgPSBhd2FpdCBwYXJzZVNrcmliaShzcmMpIH1cclxuXHRcdGNhdGNoIChlKSB7IHJlbmRlckVycm9yKGVsLCBlKTsgcmV0dXJuIG51bGwgfVxyXG5cdFx0XHJcblx0XHRpZiAodGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChcIlwiLCBtZEN0eC5zb3VyY2VQYXRoKS5iYXNlbmFtZSA9PSBwYXJzZWQuaWQpIHtcclxuXHRcdFx0cmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdzZWxmJywgaG92ZXI6ICdTZWxmIFJlbmRlciBQcm9oaWJpdGVkJ30pOyByZXR1cm4gbnVsbDsgfVxyXG5cdFx0bGV0IHRlbXBsYXRlID0gdGhpcy5ldGEuZ2V0UGFydGlhbChwYXJzZWQuaWQpXHJcblx0XHRpZiAoIWlzRXh0YW50KHRlbXBsYXRlKSkge1xyXG5cdFx0XHRpZiAodGhpcy5ldGEuZmFpbGVkVGVtcGxhdGVzLmhhcyhwYXJzZWQuaWQpKSB7IHJlbmRlckVycm9yKGVsLCB7bXNnOiBgVGVtcGxhdGUgJHtwYXJzZWQuaWR9IGZhaWxlZCB0byBjb21waWxlLCBlcnJvcjogXFxuYCArIHRoaXMuZXRhLmZhaWxlZFRlbXBsYXRlcy5nZXQocGFyc2VkLmlkKX0pIH1cclxuXHRcdFx0ZWxzZSB7cmVuZGVyRXJyb3IoZWwsIHttc2c6IGBObyBzdWNoIHRlbXBsYXRlIFwiJHtwYXJzZWQuaWR9XCJgfSl9XHJcblx0XHRcdHJldHVybiBudWxsIFxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyU2tyaWJpKGVsLCB0ZW1wbGF0ZSwgcGFyc2VkLmlkLCBtZEN0eCwgT2JqZWN0LmFzc2lnbih7fSwgc2tDdHgsIHtjdHg6IHBhcnNlZC5hcmdzfSkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgcHJvY2Vzc1NrcmliaShcclxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXHJcblx0XHRzcmM6IHN0cmluZywgXHJcblx0XHRtZEN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgXHJcblx0XHRza0N0eDogU2tDb250ZXh0XHJcblx0KTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCBwcmVwID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nLCBmbGFnOiBudW1iZXIpIHtcclxuXHRcdFx0c3dpdGNoIChmbGFnKSB7IFxyXG5cdFx0XHRcdGNhc2UgMjogcmV0dXJuIGA8JT0ke3NyY30lPmA7IFxyXG5cdFx0XHRcdGNhc2UgMzogcmV0dXJuIGA8JX4ke3NyY30lPmA7IFxyXG5cdFx0XHRcdGNhc2UgNDogcmV0dXJuIHN0cjtcclxuXHRcdFx0XHRjYXNlIDU6IHJldHVybiBgPCUke3NyY30lPmA7XHJcblx0XHRcdH0gXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyU2tyaWJpKGVsLCBwcmVwKHNyYywgc2tDdHguZmxhZyksIFwibGl0ZXJhbFwiLCBtZEN0eCwgc2tDdHgpXHJcblx0fVxyXG5cclxuXHRhc3luYyByZW5kZXJTa3JpYmkoXHJcblx0XHRlbDogSFRNTEVsZW1lbnQsIFxyXG5cdFx0Y29uOiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBcclxuXHRcdGlkOiBzdHJpbmcsIFxyXG5cdFx0bWRDdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIFxyXG5cdFx0c2tDdHg6IFNrQ29udGV4dFxyXG5cdCk6IFByb21pc2U8YW55PiB7XHJcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoXCJcIiwgbWRDdHguc291cmNlUGF0aClcclxuXHJcblx0XHRsZXQgZSA9IGNyZWF0ZURpdih7Y2xzOiBcInNrcmliaS1yZW5kZXItdmlydHVhbFwifSk7XHJcblx0XHRsZXQgYyA9IG5ldyBTa3JpYmlDaGlsZChlKVxyXG5cdFx0T2JqZWN0LmFzc2lnbihjLCB7IHJlcmVuZGVyOiAoKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiZVwiKTsgXHJcblx0XHRcdFx0Yy5jbGVhcigpOyBcclxuXHRcdFx0XHR0aGlzLnJlbmRlclNrcmliaShlLCBjb24sIGlkLCBtZEN0eCwgc2tDdHgpfSkuYmluZCh0aGlzKVxyXG5cdFx0XHR9KSBcclxuXHRcdFx0XHJcblx0XHRsZXQgY3R4ID0gT2JqZWN0LmFzc2lnbih7fSwgc2tDdHg/LmN0eCB8fCB7fSwge2NoaWxkOiBjLnByb3ZpZGVDb250ZXh0KCl9KVxyXG5cclxuXHRcdGxldCBbcmVuZGVyZWQsIHBhY2tldF06IFtzdHJpbmcsIFN0cmluZ2RleF0gPSBhd2FpdCB0aGlzLmV0YS5yZW5kZXJBc3luYyhjb24sIGN0eCwgZmlsZSkuY2F0Y2goKGVycikgPT4ge1xyXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5lcnJvckxvZ2dpbmcpIGNvbnNvbGUud2FybihgU2tyaWJpIHJlbmRlciB0aHJldyBlcnJvciEgRGlzcGxheWluZyBjb250ZW50IGFuZCBlcnJvci4uLmAsIEVCQVIsIGNvbiwgRUJBUiwgZXJyKTtcclxuXHRcdFx0cmVuZGVyRXJyb3IoZWwsIChlcnI/Lmhhc0RhdGEpID8gZXJyIDoge21zZzogZXJyPy5tc2cgfHwgZXJyIHx8IFwiUmVuZGVyIEVycm9yXCJ9KVxyXG5cdFx0XHRjLnVubG9hZCgpXHJcblx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbClcclxuXHRcdH0pXHJcblx0XHRcclxuXHRcdGRMb2coXCJyZW5kZXJTa3JpYjpcIiwgZWwsIG1kQ3R4LCBza0N0eCwgaWQpXHJcblx0XHRpZiAoaXNFeHRhbnQocmVuZGVyZWQpKSB7XHJcblx0XHRcdGxldCBkID0gaXNFeHRhbnQobWRDdHgucmVtYWluaW5nTmVzdExldmVsKSA/IG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCA6IChza0N0eC5kZXB0aClcclxuXHRcdFx0bGV0IHIgPSBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHJlbmRlcmVkLCBlLCBtZEN0eC5zb3VyY2VQYXRoLCBudWxsKS50aGVuKCgpID0+IHtcclxuXHRcdFx0XHRlLnNldEF0dHJpYnV0ZShcInNrcmliaVwiLCBpZCk7IC8vZS5zZXRBdHRyaWJ1dGUoXCJkZXB0aFwiLCBkLnRvU3RyaW5nKCkpO1xyXG5cdFx0XHRcdGUucmVtb3ZlQ2xhc3MoXCJza3JpYmktcmVuZGVyLXZpcnR1YWxcIilcclxuXHRcdFx0XHRlbC5yZXBsYWNlV2l0aChlKTsgZExvZyhcImZpbmlzaDogXCIsIHNrQ3R4LnRpbWUsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSlcclxuXHRcdFx0XHRpZiAoc2tDdHguZmxhZyA9PSAxKSB7XHJcblx0XHRcdFx0XHR2TG9nKGBSZW5kZXJlZCB0ZW1wbGF0ZSBcIiR7aWR9XCIgKCR7cm91bmRUbyh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktc2tDdHgudGltZSwgNCl9IG1zKWAsIGUpXHJcblx0XHRcdFx0fSBlbHNlIHZMb2coYFJlbmRlcmVkIGxpdGVyYWwgKGY6ICR7c2tDdHguZmxhZ30pICgke3JvdW5kVG8od2luZG93LnBlcmZvcm1hbmNlLm5vdygpLXNrQ3R4LnRpbWUsIDQpfSBtcylgLCBlKVxyXG5cdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoZSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Yy5zZXRQYWNrZXQocGFja2V0KVxyXG5cdFx0XHRtZEN0eC5hZGRDaGlsZChjKTtcclxuXHRcdFx0XHJcblx0XHRcdHIudGhlbigoZSk6IFByb21pc2U8YW55PiA9PiB7XHJcblx0XHRcdFx0Ly8gVE9ETzogb25seSByZXN0cmljdCBkZXB0aCBmb3IgdHJhbnNjbHVzaW9uc1xyXG5cdFx0XHRcdGlmIChpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpICYmIChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwgPiAwKSB8fCAhaXNFeHRhbnQobWRDdHgucmVtYWluaW5nTmVzdExldmVsKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGVtYmVkTWVkaWEoZSwgbWRDdHguc291cmNlUGF0aCwgdGhpcywgc2tDdHguZGVwdGgpIFxyXG5cdFx0XHRcdH0gZWxzZSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuXHRcdFx0XHQvL2Uuc2V0QXR0cmlidXRlKFwiZGVwdGhcIiwgZC50b1N0cmluZygpKVxyXG5cclxuXHRcdFx0fSlcclxuXHRcdFx0LnRoZW4oKHgpID0+IHtcclxuXHRcdFx0XHRkTG9nKFwicmVuZGVyZXIgZmluYWw6IFwiLCBkKVxyXG5cdFx0XHRcdC8vIGUuc2V0QXR0cmlidXRlKFwiZGVwdGhcIiwgZC50b1N0cmluZygpKVxyXG5cdFx0XHRcdHRoaXMucHJvY2Vzc29yKHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgZSwgbWRDdHgsIHNrQ3R4LmRlcHRoLTEsIHRydWUpIC8qIFJlY3Vyc2UgdGhlIHByb2Nlc3NvciB0byBwYXJzZSBza3JlZWJsaW5ncyAqL1xyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0cmV0dXJuIHI7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjLmNsZWFyKCk7XHJcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChcIlJlbmRlciBFcnJvclwiKTtcclxuXHRcdH1cclxuXHR9XHJcbn0iXSwibmFtZXMiOlsicHJvbWlzZUltcGwiLCJoYXNPd25Qcm9wIiwiY29weVByb3BzIiwiQ2FjaGVyIiwicmVzb2x2ZSIsImRpcm5hbWUiLCJleHRuYW1lIiwiZXhpc3RzU3luYyIsInJlYWRGaWxlU3luYyIsIm5vcm1hbGl6ZVBhdGgiLCJURm9sZGVyIiwiVmF1bHQiLCJURmlsZSIsIkV0YS5nZXRDb25maWciLCJNYXJrZG93blJlbmRlcmVyIiwiRmlsZVN5c3RlbUFkYXB0ZXIiLCJFdGEuY29tcGlsZVRvU3RyaW5nIiwiRXRhLnJlbmRlckFzeW5jIiwiRXRhLnJlbmRlciIsIlBsdWdpblNldHRpbmdUYWIiLCJkZWJvdW5jZSIsIlNldHRpbmciLCJwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkiLCJzZXRJY29uIiwiTW9kYWwiLCJGdXp6eVN1Z2dlc3RNb2RhbCIsIk1hcmtkb3duUmVuZGVyQ2hpbGQiLCJQbHVnaW4iLCJFdmVudHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXVEQTtBQUNPLFNBQVMsU0FBUyxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRTtBQUM3RCxJQUFJLFNBQVMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLE9BQU8sS0FBSyxZQUFZLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsVUFBVSxPQUFPLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRTtBQUNoSCxJQUFJLE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRTtBQUMvRCxRQUFRLFNBQVMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDbkcsUUFBUSxTQUFTLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDdEcsUUFBUSxTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLEVBQUU7QUFDdEgsUUFBUSxJQUFJLENBQUMsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsVUFBVSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFDOUUsS0FBSyxDQUFDLENBQUM7QUFDUDs7QUNoREEsU0FBUyxjQUFjLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRTtBQUNw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
