/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');
var fs = require('fs');
var path = require('path');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function setPrototypeOf(obj, proto) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    if (Object.setPrototypeOf) {
        Object.setPrototypeOf(obj, proto);
    }
    else {
        obj.__proto__ = proto;
    }
}
// This is pretty much the only way to get nice, extended Errors
// without using ES6
/**
 * This returns a new Error with a custom prototype. Note that it's _not_ a constructor
 *
 * @param message Error message
 *
 * **Example**
 *
 * ```js
 * throw EtaErr("template not found")
 * ```
 */
function EtaErr(message) {
    var err = new Error(message);
    setPrototypeOf(err, EtaErr.prototype);
    return err;
}
EtaErr.prototype = Object.create(Error.prototype, {
    name: { value: 'Eta Error', enumerable: false }
});
/**
 * Throws an EtaErr with a nicely formatted error and message showing where in the template the error occurred.
 */
function ParseErr(message, str, indx) {
    var whitespace = str.slice(0, indx).split(/\n/);
    var lineNo = whitespace.length;
    var colNo = whitespace[lineNo - 1].length + 1;
    message +=
        ' at line ' +
            lineNo +
            ' col ' +
            colNo +
            ':\n\n' +
            '  ' +
            str.split(/\n/)[lineNo - 1] +
            '\n' +
            '  ' +
            Array(colNo).join(' ') +
            '^';
    throw EtaErr(message);
}

/**
 * @returns The global Promise function
 */
var promiseImpl$1 = new Function('return this')().Promise;
/**
 * @returns A new AsyncFunction constuctor
 */
function getAsyncFunctionConstructor() {
    try {
        return new Function('return (async function(){}).constructor')();
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr("This environment doesn't support async/await");
        }
        else {
            throw e;
        }
    }
}
/**
 * str.trimLeft polyfill
 *
 * @param str - Input string
 * @returns The string with left whitespace removed
 *
 */
function trimLeft(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimLeft) {
        return str.trimLeft();
    }
    else {
        return str.replace(/^\s+/, '');
    }
}
/**
 * str.trimRight polyfill
 *
 * @param str - Input string
 * @returns The string with right whitespace removed
 *
 */
function trimRight(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimRight) {
        return str.trimRight();
    }
    else {
        return str.replace(/\s+$/, ''); // TODO: do we really need to replace BOM's?
    }
}

// TODO: allow '-' to trim up until newline. Use [^\S\n\r] instead of \s
/* END TYPES */
function hasOwnProp$1(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}
function copyProps$1(toObj, fromObj) {
    for (var key in fromObj) {
        if (hasOwnProp$1(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
/**
 * Takes a string within a template and trims it, based on the preceding tag's whitespace control and `config.autoTrim`
 */
function trimWS(str, config, wsLeft, wsRight) {
    var leftTrim;
    var rightTrim;
    if (Array.isArray(config.autoTrim)) {
        // kinda confusing
        // but _}} will trim the left side of the following string
        leftTrim = config.autoTrim[1];
        rightTrim = config.autoTrim[0];
    }
    else {
        leftTrim = rightTrim = config.autoTrim;
    }
    if (wsLeft || wsLeft === false) {
        leftTrim = wsLeft;
    }
    if (wsRight || wsRight === false) {
        rightTrim = wsRight;
    }
    if (!rightTrim && !leftTrim) {
        return str;
    }
    if (leftTrim === 'slurp' && rightTrim === 'slurp') {
        return str.trim();
    }
    if (leftTrim === '_' || leftTrim === 'slurp') {
        // console.log('trimming left' + leftTrim)
        // full slurp
        str = trimLeft(str);
    }
    else if (leftTrim === '-' || leftTrim === 'nl') {
        // nl trim
        str = str.replace(/^(?:\r\n|\n|\r)/, '');
    }
    if (rightTrim === '_' || rightTrim === 'slurp') {
        // full slurp
        str = trimRight(str);
    }
    else if (rightTrim === '-' || rightTrim === 'nl') {
        // nl trim
        str = str.replace(/(?:\r\n|\n|\r)$/, ''); // TODO: make sure this gets \r\n
    }
    return str;
}
/**
 * A map of special HTML characters to their XML-escaped equivalents
 */
var escMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
};
function replaceChar(s) {
    return escMap[s];
}
/**
 * XML-escapes an input value after converting it to a string
 *
 * @param str - Input value (usually a string)
 * @returns XML-escaped string
 */
function XMLEscape(str) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    // To deal with XSS. Based on Escape implementations of Mustache.JS and Marko, then customized.
    var newStr = String(str);
    if (/[&<>"']/.test(newStr)) {
        return newStr.replace(/[&<>"']/g, replaceChar);
    }
    else {
        return newStr;
    }
}

/* END TYPES */
var templateLitReg = /`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g;
var singleQuoteReg = /'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g;
var doubleQuoteReg = /"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;
/** Escape special regular expression characters inside a string */
function escapeRegExp(string) {
    // From MDN
    return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
}
function parse(str, config) {
    var buffer = [];
    var trimLeftOfNextStr = false;
    var lastIndex = 0;
    var parseOptions = config.parse;
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processTemplate) {
                str = plugin.processTemplate(str, config);
            }
        }
    }
    /* Adding for EJS compatibility */
    if (config.rmWhitespace) {
        // Code taken directly from EJS
        // Have to use two separate replaces here as `^` and `$` operators don't
        // work well with `\r` and empty lines don't work well with the `m` flag.
        // Essentially, this replaces the whitespace at the beginning and end of
        // each line and removes multiple newlines.
        str = str.replace(/[\r\n]+/g, '\n').replace(/^\s+|\s+$/gm, '');
    }
    /* End rmWhitespace option */
    templateLitReg.lastIndex = 0;
    singleQuoteReg.lastIndex = 0;
    doubleQuoteReg.lastIndex = 0;
    function pushString(strng, shouldTrimRightOfString) {
        if (strng) {
            // if string is truthy it must be of type 'string'
            strng = trimWS(strng, config, trimLeftOfNextStr, // this will only be false on the first str, the next ones will be null or undefined
            shouldTrimRightOfString);
            if (strng) {
                // replace \ with \\, ' with \'
                // we're going to convert all CRLF to LF so it doesn't take more than one replace
                strng = strng.replace(/\\|'/g, '\\$&').replace(/\r\n|\n|\r/g, '\\n');
                buffer.push(strng);
            }
        }
    }
    var prefixes = [parseOptions.exec, parseOptions.interpolate, parseOptions.raw].reduce(function (accumulator, prefix) {
        if (accumulator && prefix) {
            return accumulator + '|' + escapeRegExp(prefix);
        }
        else if (prefix) {
            // accumulator is falsy
            return escapeRegExp(prefix);
        }
        else {
            // prefix and accumulator are both falsy
            return accumulator;
        }
    }, '');
    var parseOpenReg = new RegExp('([^]*?)' + escapeRegExp(config.tags[0]) + '(-|_)?\\s*(' + prefixes + ')?\\s*', 'g');
    var parseCloseReg = new RegExp('\'|"|`|\\/\\*|(\\s*(-|_)?' + escapeRegExp(config.tags[1]) + ')', 'g');
    // TODO: benchmark having the \s* on either side vs using str.trim()
    var m;
    while ((m = parseOpenReg.exec(str))) {
        lastIndex = m[0].length + m.index;
        var precedingString = m[1];
        var wsLeft = m[2];
        var prefix = m[3] || ''; // by default either ~, =, or empty
        pushString(precedingString, wsLeft);
        parseCloseReg.lastIndex = lastIndex;
        var closeTag = void 0;
        var currentObj = false;
        while ((closeTag = parseCloseReg.exec(str))) {
            if (closeTag[1]) {
                var content = str.slice(lastIndex, closeTag.index);
                parseOpenReg.lastIndex = lastIndex = parseCloseReg.lastIndex;
                trimLeftOfNextStr = closeTag[2];
                var currentType = prefix === parseOptions.exec
                    ? 'e'
                    : prefix === parseOptions.raw
                        ? 'r'
                        : prefix === parseOptions.interpolate
                            ? 'i'
                            : '';
                currentObj = { t: currentType, val: content };
                break;
            }
            else {
                var char = closeTag[0];
                if (char === '/*') {
                    var commentCloseInd = str.indexOf('*/', parseCloseReg.lastIndex);
                    if (commentCloseInd === -1) {
                        ParseErr('unclosed comment', str, closeTag.index);
                    }
                    parseCloseReg.lastIndex = commentCloseInd;
                }
                else if (char === "'") {
                    singleQuoteReg.lastIndex = closeTag.index;
                    var singleQuoteMatch = singleQuoteReg.exec(str);
                    if (singleQuoteMatch) {
                        parseCloseReg.lastIndex = singleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '"') {
                    doubleQuoteReg.lastIndex = closeTag.index;
                    var doubleQuoteMatch = doubleQuoteReg.exec(str);
                    if (doubleQuoteMatch) {
                        parseCloseReg.lastIndex = doubleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '`') {
                    templateLitReg.lastIndex = closeTag.index;
                    var templateLitMatch = templateLitReg.exec(str);
                    if (templateLitMatch) {
                        parseCloseReg.lastIndex = templateLitReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
            }
        }
        if (currentObj) {
            buffer.push(currentObj);
        }
        else {
            ParseErr('unclosed tag', str, m.index + precedingString.length);
        }
    }
    pushString(str.slice(lastIndex, str.length), false);
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processAST) {
                buffer = plugin.processAST(buffer, config);
            }
        }
    }
    return buffer;
}

/* END TYPES */
/**
 * Compiles a template string to a function string. Most often users just use `compile()`, which calls `compileToString` and creates a new function using the result
 *
 * **Example**
 *
 * ```js
 * compileToString("Hi <%= it.user %>", eta.config)
 * // "var tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR"
 * ```
 */
function compileToString(str, config) {
    var buffer = parse(str, config);
    var res = "var tR='',__l,__lP" +
        (config.include ? ',include=E.include.bind(E)' : '') +
        (config.includeFile ? ',includeFile=E.includeFile.bind(E)' : '') +
        '\nfunction layout(p,d){__l=p;__lP=d}\n' +
        (config.useWith ? 'with(' + config.varName + '||{}){' : '') +
        compileScope(buffer, config) +
        (config.includeFile
            ? 'if(__l)tR=' +
                (config.async ? 'await ' : '') +
                ("includeFile(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
            : config.include
                ? 'if(__l)tR=' +
                    (config.async ? 'await ' : '') +
                    ("include(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
                : '') +
        'if(cb){cb(null,tR)} return tR' +
        (config.useWith ? '}' : '');
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processFnString) {
                res = plugin.processFnString(res, config);
            }
        }
    }
    return res;
}
/**
 * Loops through the AST generated by `parse` and transform each item into JS calls
 *
 * **Example**
 *
 * ```js
 * // AST version of 'Hi <%= it.user %>'
 * let templateAST = ['Hi ', { val: 'it.user', t: 'i' }]
 * compileScope(templateAST, eta.config)
 * // "tR+='Hi ';tR+=E.e(it.user);"
 * ```
 */
function compileScope(buff, config) {
    var i = 0;
    var buffLength = buff.length;
    var returnStr = '';
    for (i; i < buffLength; i++) {
        var currentBlock = buff[i];
        if (typeof currentBlock === 'string') {
            var str = currentBlock;
            // we know string exists
            returnStr += "tR+='" + str + "'\n";
        }
        else {
            var type = currentBlock.t; // ~, s, !, ?, r
            var content = currentBlock.val || '';
            if (type === 'r') {
                // raw
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
            }
            else if (type === 'i') {
                // interpolate
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                if (config.autoEscape) {
                    content = 'E.e(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
                // reference
            }
            else if (type === 'e') {
                // execute
                returnStr += content + '\n'; // you need a \n in case you have <% } %>
            }
        }
    }
    return returnStr;
}

/**
 * Handles storage and accessing of values
 *
 * In this case, we use it to store compiled template functions
 * Indexed by their `name` or `filename`
 */
var Cacher$1 = /** @class */ (function () {
    function Cacher(cache) {
        this.cache = cache;
    }
    Cacher.prototype.define = function (key, val) {
        this.cache[key] = val;
    };
    Cacher.prototype.get = function (key) {
        // string | array.
        // TODO: allow array of keys to look down
        // TODO: create plugin to allow referencing helpers, filters with dot notation
        return this.cache[key];
    };
    Cacher.prototype.remove = function (key) {
        delete this.cache[key];
    };
    Cacher.prototype.reset = function () {
        this.cache = {};
    };
    Cacher.prototype.load = function (cacheObj) {
        copyProps$1(this.cache, cacheObj);
    };
    return Cacher;
}());

/* END TYPES */
/**
 * Eta's template storage
 *
 * Stores partials and cached templates
 */
var templates = new Cacher$1({});

/* END TYPES */
/**
 * Include a template based on its name (or filepath, if it's already been cached).
 *
 * Called like `include(templateNameOrPath, data)`
 */
function includeHelper(templateNameOrPath, data) {
    var template = this.templates.get(templateNameOrPath);
    if (!template) {
        throw EtaErr('Could not fetch template "' + templateNameOrPath + '"');
    }
    return template(data, this);
}
/** Eta's base (global) configuration */
var config = {
    async: false,
    autoEscape: true,
    autoTrim: [false, 'nl'],
    cache: false,
    e: XMLEscape,
    include: includeHelper,
    parse: {
        exec: '',
        interpolate: '=',
        raw: '~'
    },
    plugins: [],
    rmWhitespace: false,
    tags: ['<%', '%>'],
    templates: templates,
    useWith: false,
    varName: 'it'
};
/**
 * Takes one or two partial (not necessarily complete) configuration objects, merges them 1 layer deep into eta.config, and returns the result
 *
 * @param override Partial configuration object
 * @param baseConfig Partial configuration object to merge before `override`
 *
 * **Example**
 *
 * ```js
 * let customConfig = getConfig({tags: ['!#', '#!']})
 * ```
 */
function getConfig(override, baseConfig) {
    // TODO: run more tests on this
    var res = {}; // Linked
    copyProps$1(res, config); // Creates deep clone of eta.config, 1 layer deep
    if (baseConfig) {
        copyProps$1(res, baseConfig);
    }
    if (override) {
        copyProps$1(res, override);
    }
    return res;
}

/* END TYPES */
/**
 * Takes a template string and returns a template function that can be called with (data, config, [cb])
 *
 * @param str - The template string
 * @param config - A custom configuration object (optional)
 *
 * **Example**
 *
 * ```js
 * let compiledFn = eta.compile("Hi <%= it.user %>")
 * // function anonymous()
 * let compiledFnStr = compiledFn.toString()
 * // "function anonymous(it,E,cb\n) {\nvar tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR\n}"
 * ```
 */
function compile(str, config) {
    var options = getConfig(config || {});
    /* ASYNC HANDLING */
    // The below code is modified from mde/ejs. All credit should go to them.
    var ctor = options.async ? getAsyncFunctionConstructor() : Function;
    /* END ASYNC HANDLING */
    try {
        return new ctor(options.varName, 'E', // EtaConfig
        'cb', // optional callback
        compileToString(str, options)); // eslint-disable-line no-new-func
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr('Bad template syntax\n\n' +
                e.message +
                '\n' +
                Array(e.message.length + 1).join('=') +
                '\n' +
                compileToString(str, options) +
                '\n' // This will put an extra newline before the callstack for extra readability
            );
        }
        else {
            throw e;
        }
    }
}

var _BOM = /^\uFEFF/;
/* END TYPES */
/**
 * Get the path to the included file from the parent file path and the
 * specified path.
 *
 * If `name` does not have an extension, it will default to `.eta`
 *
 * @param name specified path
 * @param parentfile parent file path
 * @param isDirectory whether parentfile is a directory
 * @return absolute path to template
 */
function getWholeFilePath(name, parentfile, isDirectory) {
    var includePath = path.resolve(isDirectory ? parentfile : path.dirname(parentfile), // returns directory the parent file is in
    name // file
    ) + (path.extname(name) ? '' : '.eta');
    return includePath;
}
/**
 * Get the absolute path to an included template
 *
 * If this is called with an absolute path (for example, starting with '/' or 'C:\')
 * then Eta will attempt to resolve the absolute path within options.views. If it cannot,
 * Eta will fallback to options.root or '/'
 *
 * If this is called with a relative path, Eta will:
 * - Look relative to the current template (if the current template has the `filename` property)
 * - Look inside each directory in options.views
 *
 * Note: if Eta is unable to find a template using path and options, it will throw an error.
 *
 * @param path    specified path
 * @param options compilation options
 * @return absolute path to template
 */
function getPath(path, options) {
    var includePath = false;
    var views = options.views;
    var searchedPaths = [];
    // If these four values are the same,
    // getPath() will return the same result every time.
    // We can cache the result to avoid expensive
    // file operations.
    var pathOptions = JSON.stringify({
        filename: options.filename,
        path: path,
        root: options.root,
        views: options.views
    });
    if (options.cache && options.filepathCache && options.filepathCache[pathOptions]) {
        // Use the cached filepath
        return options.filepathCache[pathOptions];
    }
    /** Add a filepath to the list of paths we've checked for a template */
    function addPathToSearched(pathSearched) {
        if (!searchedPaths.includes(pathSearched)) {
            searchedPaths.push(pathSearched);
        }
    }
    /**
     * Take a filepath (like 'partials/mypartial.eta'). Attempt to find the template file inside `views`;
     * return the resulting template file path, or `false` to indicate that the template was not found.
     *
     * @param views the filepath that holds templates, or an array of filepaths that hold templates
     * @param path the path to the template
     */
    function searchViews(views, path) {
        var filePath;
        // If views is an array, then loop through each directory
        // And attempt to find the template
        if (Array.isArray(views) &&
            views.some(function (v) {
                filePath = getWholeFilePath(path, v, true);
                addPathToSearched(filePath);
                return fs.existsSync(filePath);
            })) {
            // If the above returned true, we know that the filePath was just set to a path
            // That exists (Array.some() returns as soon as it finds a valid element)
            return filePath;
        }
        else if (typeof views === 'string') {
            // Search for the file if views is a single directory
            filePath = getWholeFilePath(path, views, true);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                return filePath;
            }
        }
        // Unable to find a file
        return false;
    }
    // Path starts with '/', 'C:\', etc.
    var match = /^[A-Za-z]+:\\|^\//.exec(path);
    // Absolute path, like /partials/partial.eta
    if (match && match.length) {
        // We have to trim the beginning '/' off the path, or else
        // path.resolve(dir, path) will always resolve to just path
        var formattedPath = path.replace(/^\/*/, '');
        // First, try to resolve the path within options.views
        includePath = searchViews(views, formattedPath);
        if (!includePath) {
            // If that fails, searchViews will return false. Try to find the path
            // inside options.root (by default '/', the base of the filesystem)
            var pathFromRoot = getWholeFilePath(formattedPath, options.root || '/', true);
            addPathToSearched(pathFromRoot);
            includePath = pathFromRoot;
        }
    }
    else {
        // Relative paths
        // Look relative to a passed filename first
        if (options.filename) {
            var filePath = getWholeFilePath(path, options.filename);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                includePath = filePath;
            }
        }
        // Then look for the template in options.views
        if (!includePath) {
            includePath = searchViews(views, path);
        }
        if (!includePath) {
            throw EtaErr('Could not find the template "' + path + '". Paths tried: ' + searchedPaths);
        }
    }
    // If caching and filepathCache are enabled,
    // cache the input & output of this function.
    if (options.cache && options.filepathCache) {
        options.filepathCache[pathOptions] = includePath;
    }
    return includePath;
}
/**
 * Reads a file synchronously
 */
function readFile(filePath) {
    try {
        return fs.readFileSync(filePath).toString().replace(_BOM, ''); // TODO: is replacing BOM's necessary?
    }
    catch (_a) {
        throw EtaErr("Failed to read template at '" + filePath + "'");
    }
}

// express is set like: app.engine('html', require('eta').renderFile)
/* END TYPES */
/**
 * Reads a template, compiles it into a function, caches it if caching isn't disabled, returns the function
 *
 * @param filePath Absolute path to template file
 * @param options Eta configuration overrides
 * @param noCache Optionally, make Eta not cache the template
 */
function loadFile(filePath, options, noCache) {
    var config = getConfig(options);
    var template = readFile(filePath);
    try {
        var compiledTemplate = compile(template, config);
        if (!noCache) {
            config.templates.define(config.filename, compiledTemplate);
        }
        return compiledTemplate;
    }
    catch (e) {
        throw EtaErr('Loading file: ' + filePath + ' failed:\n\n' + e.message);
    }
}
/**
 * Get the template from a string or a file, either compiled on-the-fly or
 * read from cache (if enabled), and cache the template if needed.
 *
 * If `options.cache` is true, this function reads the file from
 * `options.filename` so it must be set prior to calling this function.
 *
 * @param options   compilation options
 * @return Eta template function
 */
function handleCache(options) {
    var filename = options.filename;
    if (options.cache) {
        var func = options.templates.get(filename);
        if (func) {
            return func;
        }
        return loadFile(filename, options);
    }
    // Caching is disabled, so pass noCache = true
    return loadFile(filename, options, true);
}
/**
 * Get the template function.
 *
 * If `options.cache` is `true`, then the template is cached.
 *
 * This returns a template function and the config object with which that template function should be called.
 *
 * @remarks
 *
 * It's important that this returns a config object with `filename` set.
 * Otherwise, the included file would not be able to use relative paths
 *
 * @param path path for the specified file (if relative, specify `views` on `options`)
 * @param options compilation options
 * @return [Eta template function, new config object]
 */
function includeFile(path, options) {
    // the below creates a new options object, using the parent filepath of the old options object and the path
    var newFileOptions = getConfig({ filename: getPath(path, options) }, options);
    // TODO: make sure properties are currectly copied over
    return [handleCache(newFileOptions), newFileOptions];
}

/* END TYPES */
/**
 * Called with `includeFile(path, data)`
 */
function includeFileHelper(path, data) {
    var templateAndConfig = includeFile(path, this);
    return templateAndConfig[0](data, templateAndConfig[1]);
}

/* END TYPES */
function handleCache$1(template, options) {
    if (options.cache && options.name && options.templates.get(options.name)) {
        return options.templates.get(options.name);
    }
    var templateFunc = typeof template === 'function' ? template : compile(template, options);
    // Note that we don't have to check if it already exists in the cache;
    // it would have returned earlier if it had
    if (options.cache && options.name) {
        options.templates.define(options.name, templateFunc);
    }
    return templateFunc;
}
/**
 * Render a template
 *
 * If `template` is a string, Eta will compile it to a function and then call it with the provided data.
 * If `template` is a template function, Eta will call it with the provided data.
 *
 * If `config.async` is `false`, Eta will return the rendered template.
 *
 * If `config.async` is `true` and there's a callback function, Eta will call the callback with `(err, renderedTemplate)`.
 * If `config.async` is `true` and there's not a callback function, Eta will return a Promise that resolves to the rendered template.
 *
 * If `config.cache` is `true` and `config` has a `name` or `filename` property, Eta will cache the template on the first render and use the cached template for all subsequent renders.
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function render(template, data, config, cb) {
    var options = getConfig(config || {});
    if (options.async) {
        if (cb) {
            // If user passes callback
            try {
                // Note: if there is an error while rendering the template,
                // It will bubble up and be caught here
                var templateFn = handleCache$1(template, options);
                templateFn(data, options, cb);
            }
            catch (err) {
                return cb(err);
            }
        }
        else {
            // No callback, try returning a promise
            if (typeof promiseImpl$1 === 'function') {
                return new promiseImpl$1(function (resolve, reject) {
                    try {
                        resolve(handleCache$1(template, options)(data, options));
                    }
                    catch (err) {
                        reject(err);
                    }
                });
            }
            else {
                throw EtaErr("Please provide a callback function, this env doesn't support Promises");
            }
        }
    }
    else {
        return handleCache$1(template, options)(data, options);
    }
}
/**
 * Render a template asynchronously
 *
 * If `template` is a string, Eta will compile it to a function and call it with the provided data.
 * If `template` is a function, Eta will call it with the provided data.
 *
 * If there is a callback function, Eta will call it with `(err, renderedTemplate)`.
 * If there is not a callback function, Eta will return a Promise that resolves to the rendered template
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function renderAsync(template, data, config, cb) {
    // Using Object.assign to lower bundle size, using spread operator makes it larger because of typescript injected polyfills
    return render(template, data, Object.assign({}, config, { async: true }), cb);
}

// @denoify-ignore
config.includeFile = includeFileHelper;
config.filepathCache = {};

const VAR_NAME = 'sk';
const EBAR = `\n---------------------------\n`;

Element.prototype.addClazz = function (str) {
    if (Array.isArray(str)) {
        this.addClass(...str);
    }
    else
        this.addClass(str);
};
function getFiles(app, dir) {
    let dirPath = obsidian.normalizePath(dir);
    let fo = app.vault.getAbstractFileByPath(dirPath);
    if (!fo || !(fo instanceof obsidian.TFolder))
        throw `Skribi: Could not find folder '${dirPath}'`;
    let files = [];
    obsidian.Vault.recurseChildren(fo, (fi) => {
        if (fi instanceof obsidian.TFile)
            files.push(fi);
    });
    // console.log(files)
    return files;
}
function checkFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).every((f) => { return exts.contains(f.extension); });
}
function filterFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).filter((f) => { if (checkFileExt(f, exts))
        return f; });
}
function toArray(args) {
    return (Array.isArray(args) ? args : [args]);
}
function isInFolder(e, dir) {
    let boo = (obsidian.normalizePath((/.+\//g).exec(e.path)[0]) == obsidian.normalizePath(dir));
    return boo;
}
function isExtant(obj) {
    return !((obj === null) || (obj === undefined));
}
function roundTo(x, to) {
    return parseFloat(parseFloat(x).toPrecision(to !== null && to !== void 0 ? to : 4));
}
function getVerbosity() {
    var _a;
    //@ts-ignore
    return ((_a = window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings.verboseLogging) || false;
}
function vLog(...args) {
    if (getVerbosity()) {
        console.log("Skribi:", ...args);
    }
}
function vWarn(...args) {
    if (getVerbosity()) {
        console.warn("Skribi:", ...args);
    }
}
function dLog(...args) {
    var _a, _b;
    //@ts-ignore
    if (((_b = (_a = window === null || window === void 0 ? void 0 : window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.devLogging) || false) {
        console.log(...args);
    }
}
/* Takes an array of strings and returns a record of key/value pairs for each, where the key and value are the same */
function toDupeRecord(arr) {
    return arr.reduce((a, i) => (Object.assign(Object.assign({}, a), { [i]: i })), {});
}
/**
 * @param input An object to clone
 * @param keys The keys of properties to omit from the clone
 * @returns A clone of 'input' without the omitted properties */
function withoutKey(input, key) {
    const clone = Object.assign({}, input);
    if (Array.isArray(key)) {
        key.forEach((k) => {
            delete clone[k];
        });
    }
    else {
        delete clone[key];
    }
    return clone;
}
Object.getPrototypeOf(function () {
    return __awaiter(this, void 0, void 0, function* () { });
}).constructor;
const promiseImpl = new Function('return this')().Promise;
const getAsyncConstructor = () => new Function('return (async function(){}).constructor')();
const isFunc = (func) => (func instanceof Function);
const isFile = (item) => (item) instanceof obsidian.TFile;
function average(...numbers) {
    return numbers.reduce((val, cur) => val + cur) / numbers.length;
}
/* Get link to documentation page. */
function linkDocs(page) {
    // return `https://azulaloi.net/obsidian-skribi/${page}`
    return `https://azulaloi.github.io/obsidian-skribi/${page}`;
}
/* Prefixes string with plugin name. Makes reusing code across plugins easier. */
function kls(cls) { return `skribi-${cls}`; }
function hash(str) {
    let hash = 5381;
    let i = str.length;
    while (i) {
        hash = (hash * 33) ^ str.charCodeAt(--i);
    }
    return hash >>> 0;
}

/** Adds the entries of scope to a function string.
* @param functionString A string function compiled by Eta's compileToString()
* @param keys Array of keys that the returned function will expect to be present in its scope argument
* @param async If true, returned function will be asynchronous */
function compileWith(functionString, keys, async) {
    var a = "";
    for (let k of keys) {
        a += `${k},`;
    }
    let func = `var {${a.substr(0, a.length - 1)}} = scope;\n` + functionString;
    let constructor = (async) ? getAsyncConstructor() : Function;
    let compiled = new constructor('scope', func);
    return compiled;
}
/* Version of Eta's render function, modified to handle scoped templates */
function renderEta(handler, template, data, config, cb, scope, binder) {
    const options = getConfig(config || {});
    if (options.async) {
        // if (cb) {
        // try { 
        // const templateFn = handler.getCached(template, options, scope, binder)
        // templateFn(scope)
        // } catch(e) {
        // return cb(e)
        // }
        // } else {
        // return (async () => handler.getCached(template, options, scope, binder)(scope))()
        return new promiseImpl(function (resolve, reject) {
            try {
                resolve(handler.getCached(template, options, scope, binder)(scope));
            }
            catch (e) {
                reject(e);
            }
        });
        // }
    }
    else {
        let func = handler.getCached(template, options, scope, binder);
        dLog(`Rendering function`, func);
        return func(scope);
    }
}
/* Version of Eta's async render function, just sets async to true */
/* Note: perf impact of using async templatefunctions is negligible */
function renderEtaAsync(handler, template, data, config, cb, scope, binder) {
    return renderEta(handler, template, data, Object.assign({}, config, { async: true }), cb, scope, binder);
}

class Provider {
    constructor(bus, id) {
        this.functions = new Map();
        this.initLoaded = false;
        this.isDirty = false;
        this.bus = bus;
        this.id = id;
    }
    createObject() {
        return Object.assign({}, Object.fromEntries(this.functions));
    }
    init() {
        this.initLoaded = true;
        return Promise.resolve();
    }
    unload() { }
    reload() {
        return Promise.resolve();
    }
    /**
     * @param clean If true, provider.isDirty = false */
    setDirty(dirty) {
        this.isDirty = isExtant(dirty) ? dirty : true;
        this.bus.providerNotificationDirty(this, this.isDirty);
    }
    /* May be called without data. */
    postDirty(...args) { }
}
class ProviderPredicated extends Provider {
    constructor() {
        super(...arguments);
        this.predicatePluginName = '';
    }
    getPredicate() {
        var _a;
        return ((_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a[this.predicatePluginName]) || null;
    }
    /**
     * @returns true only when the predicate condition is met */
    predicateCheck() {
        return this.bus.plugin.app.plugins.enabledPlugins.has(this.predicatePluginName);
    }
    /**
     * @returns An error string describing the unmet predicate condition */
    predicateError() {
        return `Integration Module '${this.id}' not available, could not find required plugin: '${this.predicatePluginName}'`;
    }
}

class ProviderSK extends Provider {
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return _super.init.call(this);
        });
    }
    createObject() {
        return {
            render: function (str) {
                let e = createDiv({ cls: "skribi-render-virtual" });
                console.log(this);
                obsidian.MarkdownRenderer.renderMarkdown(str, e, this.ctx.file.path, null);
                return e.innerHTML;
            },
            has: function (v) {
                var _a, _b;
                return !((((_a = this.v) === null || _a === void 0 ? void 0 : _a[v]) == null) || (((_b = this.v) === null || _b === void 0 ? void 0 : _b[v]) == undefined));
            },
            abort: function (s) {
                let abortPacket = String.isString(s)
                    ? { hasData: true, flag: 'abort', hover: s }
                    : Object.assign({ hasData: true, flag: 'abort' }, s);
                throw abortPacket;
            },
            getTemplateSource: function (s) {
                return makeInitPromise(this.child, () => {
                    var _a;
                    let has = this.ctx.plugin.eta.loader.styleCache.has(s);
                    if (!has) {
                        console.warn(`Skribi: getTemplateSource()\n Could not find requested template '${s}'\n`, this.child._c);
                    }
                    let c = this.ctx.plugin.eta.loader.templateCache.get(s);
                    if (has && !(c === null || c === void 0 ? void 0 : c.source)) {
                        console.warn(`Skribi: getTemplateSource()\n Template '${s}' found, but has no cached source\n`, this.child._c);
                    }
                    return (_a = c === null || c === void 0 ? void 0 : c.source) !== null && _a !== void 0 ? _a : null;
                });
            },
            getStyle: function (s) {
                return makeInitPromise(this.child, () => {
                    if (!this.ctx.plugin.eta.loader.styleCache.has(s)) {
                        console.warn(`Skribi: getStyle()\n Could not find requested style '${s}.css'\n`, this.child._c);
                    }
                    return this.ctx.plugin.eta.loader.styleCache.get(s);
                });
            },
            /**
             * @param styleSnip The ID of a .css file that is expected to be present in the style cache
             * @returns A promise for the scoped style (resolves on post) */
            includeStyle: function (styleSnip) {
                return __awaiter(this, void 0, void 0, function* () {
                    return makeInitPromise(this.child, () => __awaiter(this, void 0, void 0, function* () {
                        this.child._c.listenFor("style", styleSnip);
                        return this.child.addStyle(yield this.getStyle(styleSnip));
                    }));
                });
            }
        };
    }
}
function makeInitPromise(child, cb) {
    if (window.app.plugins.plugins['obsidian-skribi'].initLoaded) {
        return Promise.resolve(cb());
    }
    else
        return makeEventPromise(child, window.app.workspace, 'skribi:template-init-complete', cb);
}
function makeEventPromise(child, eventConstructor, eventName, cb) {
    return new Promise((resolve, reject) => {
        console.log("makeEventPromise", this);
        let x = eventConstructor.on(eventName, () => {
            eventConstructor.offref(x);
            resolve(cb());
        });
        child.registerEvent(x);
    });
}

class ProviderDataview extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'dataview';
        // createDynamic(state: DynamicState) {
        // let api = new DataviewInlineApi(this.dvp.index, state.child, state.el, this.bus.plugin.app, this.dvp.settings, state.file.path)
        // return this?.dvp?.api || null
        // }
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            // this.dvp = this.bus.plugin.app.plugins.plugins.dataview as DataviewPlugin || null
            this.eventRef_API_READY = this.bus.plugin.app.metadataCache.on('dataview:api-ready', (api) => { this.apiReady(); });
            return _super.init.call(this);
        });
    }
    unload() {
        this.bus.plugin.app.metadataCache.offref(this.eventRef_API_READY);
    }
    createObject() {
        var _a, _b;
        return ((_b = (_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a.dataview) === null || _b === void 0 ? void 0 : _b.api) || null;
    }
    apiReady() {
    }
}

class ProviderWeather extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'obsidian-weather';
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.eventRefs = {
                ready: this.bus.plugin.app.workspace.on("az-weather:api-ready", () => { }),
                unload: this.bus.plugin.app.workspace.on("az-weather:api-unload", () => { }),
                tick: this.bus.plugin.app.workspace.on("az-weather:api-tick", () => { })
            };
            this.functions.set("check", this.provide_predicate());
            this.functions.set("cache", this.provide_dispenseCache());
            this.functions.set("tickEventRef", this.provide_tickEventRef());
            return _super.init.call(this);
        });
    }
    unload() {
        for (let r of Object.values(this.eventRefs)) {
            this.bus.plugin.app.workspace.offref(r);
        }
    }
    /* Provisions */
    provide_predicate() {
        return () => {
            return (!!this.weatherAPI);
        };
    }
    provide_dispenseCache() {
        return () => {
            var _a;
            let p = this.getPredicate();
            return (_a = p === null || p === void 0 ? void 0 : p.API) === null || _a === void 0 ? void 0 : _a.dispenseCache.bind(p.API)();
        };
    }
    provide_tickEventRef() {
        return (cb) => {
            return this.bus.plugin.app.workspace.on("az-weather:api-tick", (...a) => cb(...a));
        };
    }
}

// TODO: add system to auto-reload skribis when module cache changes 
class ProviderScriptloader extends Provider {
    constructor() {
        super(...arguments);
        this.loadedModules = new Map();
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad().then(() => _super.init.call(this));
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.loadAndSet(...getFiles(this.bus.plugin.app, this.bus.plugin.settings.scriptFolder));
        });
    }
    loadAndSet(...file) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.readFiles(...file)
                .then((ret) => { /*vLog('Loading JS modules...', ret);*/ this.stashModule(ret); return Promise.resolve(); });
        });
    }
    stashModule(modules) {
        dLog('Scriptloader: stashModule', modules);
        modules.forEach((r) => {
            var _a, _b;
            if (r) {
                this.loadedModules.delete(r[0]);
                this.loadedModules.set(r[0], {
                    name: (String.isString((_b = (_a = r[1]) === null || _a === void 0 ? void 0 : _a._name) !== null && _b !== void 0 ? _b : null) ? r[1]._name : null),
                    properties: withoutKey(r[1], '_name')
                });
            }
        });
    }
    createObject() {
        let exports = new Map();
        this.loadedModules.forEach((value, key) => {
            var _a;
            let single = (Object.keys(value.properties).length == 1);
            exports.set(((_a = value.name) !== null && _a !== void 0 ? _a : (single ? Object.keys(value.properties)[0] : key)), single ? Object.values(value.properties)[0] : value.properties);
        });
        return Object.assign({}, Object.fromEntries(exports));
    }
    readFiles(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            let filtered = filterFileExt(files, "js");
            const reads = filtered.map((f) => __awaiter(this, void 0, void 0, function* () {
                try {
                    if (!(this.bus.plugin.app.vault.adapter instanceof obsidian.FileSystemAdapter))
                        return Promise.reject();
                    let path = this.bus.plugin.app.vault.adapter.getBasePath() + "/" + f.path;
                    let resPath = window.require.resolve(path);
                    if (Object.keys(window.require.cache).contains(resPath))
                        delete window.require.cache[window.require.resolve(resPath)];
                    const mod = require(path);
                    return (isExtant(mod))
                        ? Promise.resolve([f.basename, mod])
                        : Promise.reject();
                }
                catch (e) {
                    console.warn(e);
                    return Promise.reject();
                }
            }));
            return yield Promise.allSettled(reads)
                .then((settled) => {
                return settled
                    .filter((r) => { return r.status == "fulfilled"; })
                    .map((v) => { return v.value; });
            });
        });
    }
    clearJS(...items) {
        let names = items.map((item) => {
            if (isFile(item))
                return filterFileExt(item, 'js')[0].basename;
            else if (String.isString(item))
                return item;
        });
        for (let name of names)
            this.loadedModules.delete(name);
    }
    reload() {
        const _super = Object.create(null, {
            reload: { get: () => super.reload }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.loadedModules.clear();
            yield this.initLoad();
            return _super.reload.call(this);
        });
    }
    postDirty() {
        if (this.bus.plugin.settings.autoReload) {
            Array.from(this.bus.plugin.children).forEach(child => child.scriptsUpdated());
        }
    }
    /* FileMinder Functions */
    get directory() { return this.bus.plugin.settings.scriptFolder; }
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in script directory modified, updating...`);
        this.clearJS(file);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from script directory, unloading...`);
        this.clearJS(file);
        this.setDirty();
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to script directory, loading...`);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Script file '${oldName}' renamed to '${file.name}', updating...`);
        this.clearJS(oldName);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => { });
    }
    directoryChanged() {
        vLog(`Script directory changed, reloading scripts...`);
        this.reload().then(() => this.setDirty(), (e) => { console.warn(e); });
    }
    isInDomain(file) {
        return isInFolder(file, this.directory);
    }
}

const obsidianModule = require("obsidian");
const MODULE_NAME_INTEGRATIONS = 'int';
/* Handles all script function providers */
class ProviderBus {
    constructor(handler) {
        this.providers = new Map();
        this.providersPredicated = new Map();
        this.scopeStatic = {};
        // Indicates that a provider has been added or removed, and the static scope should be regenerated.
        this.isStaticScopeDirty = false;
        /**
         * Integration point for other plugins to add a provider
         * @param provider Provider implementation to add */
        this.addProvider = (provider) => {
            this.providers.set(provider.id, provider);
            this.isStaticScopeDirty = true;
            this.handler.recompileTemplates();
        };
        /**
         * Integration point for other plugins to add a predicated provider
         * @param provider ProviderPredicated implementation to add */
        this.addProviderPredicated = (provider) => {
            this.providersPredicated.set(provider.id, provider);
        };
        this.handler = handler;
        this.plugin = handler.plugin;
        this.scriptLoader = new ProviderScriptloader(this, 'js'); // assigned here so that we can register file events in handler
    }
    /* Construct all providers but do not initialize them yet, so that we can compile and cache templates ASAP */
    preInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addTo(this.providers, this.scriptLoader);
            this.addTo(this.providersPredicated, new ProviderDataview(this, 'dv'));
            this.addTo(this.providersPredicated, new ProviderWeather(this, 'weather'));
            this.skBase = new ProviderSK(this, VAR_NAME);
            return Promise.resolve();
        });
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            const inits = Object.values(this.execOnProviders('init'));
            yield Promise.allSettled(inits);
            this.createStaticScope();
            return Promise.resolve();
        });
    }
    addTo(providers, provider) {
        providers.set(provider.id, provider);
    }
    unload() {
        this.execOnProviders('unload');
    }
    /* Invoked by providers to indicate their provision must be regenerated */
    providerNotificationDirty(provider, isDirty, ...data) {
        if (isDirty)
            this.refreshProvider(provider, ...data);
    }
    /* Regenerate the provision of a single provider, and pass data to its post function */
    refreshProvider(provider, ...data) {
        provider.setDirty(false);
        Object.assign(this.scopeStatic, { [provider.id]: provider.createObject() });
        provider.postDirty(...data);
    }
    /* Clean dirty providers by regenerating their provision */
    refreshProviders(...providers) {
        let proxy = {};
        for (let provider of providers) {
            proxy[provider.id] = provider.createObject();
            provider.setDirty(false);
        }
        Object.assign(this.scopeStatic, proxy);
        providers.forEach(provider => provider.postDirty());
    }
    /* Reloads all providers */
    reloadProviders() {
        return __awaiter(this, void 0, void 0, function* () {
            let proms = this.execOnProviders('reload');
            return Promise.allSettled(Object.values(proms));
        });
    }
    getScopeKeys() {
        return [...this.providers.keys(), MODULE_NAME_INTEGRATIONS, 'moment', 'obsidian'];
    }
    /* Retrieves providers object */
    getScope(ctx, refresh) {
        let dirties = Object.values(this.providers).filter((p) => { return p.isDirty; });
        if (dirties)
            this.refreshProviders(...dirties);
        if (this.isStaticScopeDirty)
            this.createStaticScope();
        return Object.assign({}, this.scopeStatic, { [MODULE_NAME_INTEGRATIONS]: this.createPredicatedScope(ctx || null) });
    }
    /* Creates scope object. Should not be used to get the scope. */
    createStaticScope() {
        let spaces = {};
        for (let p of this.providers)
            spaces[p[0]] = p[1].createObject();
        spaces['moment'] = window.moment;
        spaces['obsidian'] = obsidianModule;
        this.scopeStatic = spaces;
        this.isStaticScopeDirty = false;
        return this.scopeStatic;
    }
    /* Predicated providers */
    createPredicatedScope(ctx) {
        let spaces = {};
        for (let p of this.providersPredicated) {
            Object.defineProperty(spaces, p[0], { get: function () {
                    if (p[1].predicateCheck())
                        return p[1].createObject();
                    else
                        throw new Error(p[1].predicateError());
                }
            });
        }
        return spaces;
    }
    /* Get the base provider scope */
    getScopeSK() {
        return this.skBase.createObject();
    }
    /* Invoke function on all providers and return array of results */
    execOnProviders(func) {
        let rets = {};
        const invoke = (providers) => {
            for (let p of providers)
                if ((p != null) && (isFunc(p[1][func]))) {
                    rets[p[0]] = p[1][func]();
                }
        };
        invoke(this.providers);
        invoke(this.providersPredicated);
        return rets;
    }
}

/* This is slightly modified from Eta */
class Cacher {
    constructor(cache) {
        this.cache = cache;
    }
    define(key, val) { this.cache[key] = val; }
    get(key) { return this.cache[key]; }
    remove(key) { delete this.cache[key]; }
    reset() { this.cache = {}; }
    load(cacheObj) { copyProps(this.cache, cacheObj); }
    has(key) {
        return !((this.cache[key] === null) || (this.cache[key] === undefined));
    }
}
function copyProps(toObj, fromObj) {
    for (const key in fromObj) {
        if (hasOwnProp(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
function hasOwnProp(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* Responsible for the caching and management of templates. */
// TODO: add system to auto-reload skribis when relevant template cache changes 
class TemplateLoader {
    constructor(handler) {
        this.templateCache = new Cacher({});
        this.templateFailures = new Map();
        this.styleCache = new Cacher({});
        this.handler = handler;
        this.plugin = handler.plugin;
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad();
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.definePartials(...getFiles(this.plugin.app, this.directory));
            this.plugin.app.workspace.trigger('skribi:template-init-complete');
            return Promise.resolve();
        });
    }
    /**
     * Reads passed files and attempts to cache them.
     * Handles templates and styles. Templates are compiled to functions. */
    definePartials(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            const startTime = window.performance.now();
            var failureCount = 0;
            var successCount = 0;
            const scopeKeys = this.handler.bus.getScopeKeys();
            let styleFiles = [];
            let templateFiles = [];
            files.forEach(file => {
                switch (file.extension) {
                    case "md":
                        templateFiles.push(file);
                        break;
                    case "eta":
                        templateFiles.push(file);
                        break;
                    case "css":
                        styleFiles.push(file);
                        break;
                }
            });
            const readTemplates = templateFiles.map((file) => __awaiter(this, void 0, void 0, function* () {
                var _a, _b, _c;
                let read = yield this.plugin.app.vault.cachedRead(file);
                let fileFrontmatter = null;
                if (file.extension == "eta") {
                    let fmSearch = (/^---\n*(?<frontmatter>.*?)\n*---/s).exec(read);
                    if (fmSearch.groups.frontmatter) {
                        try {
                            let yaml = obsidian.parseYaml(fmSearch.groups.frontmatter.trim());
                            fileFrontmatter = yaml;
                            read = read.substr(fmSearch[0].length);
                        }
                        catch (e) {
                            vWarn(`Error parsing frontmatter of ${file.name}, please report.`, EBAR, e);
                        }
                    }
                }
                else {
                    /* Markdown files can check for cached frontmatter which is maybe faster */
                    fileFrontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) === null || _a === void 0 ? void 0 : _a.frontmatter;
                    if (fileFrontmatter) {
                        let fmSearch = (/(?<frontmatter>^---.*?(?=\n---)\n---)/s).exec(read);
                        let fmText = (_c = (_b = fmSearch === null || fmSearch === void 0 ? void 0 : fmSearch.groups) === null || _b === void 0 ? void 0 : _b.frontmatter) !== null && _c !== void 0 ? _c : null;
                        if (isExtant(fmText)) {
                            read = read.substr(fmText.length);
                        }
                    }
                }
                try {
                    let compiledString = compileToString(read, getConfig({ varName: VAR_NAME, name: file.basename }));
                    var compiled = compileWith(compiledString, [VAR_NAME, 'E', 'cb', ...scopeKeys], (read.contains('await')));
                }
                catch (err) {
                    this.templateFailures.set(file.basename, err || `Template failed to compile: Unknown Error`);
                    console.warn(`Skribi: template '${file.basename}' failed to compile`, EBAR, err, EBAR, read);
                    this.templateCache.remove(file.basename);
                    failureCount++;
                    return Promise.reject();
                }
                this.templateFailures.delete(file.basename);
                this.templateCache.define(file.basename, {
                    'source': read,
                    'function': compiled,
                    'frontmatter': fileFrontmatter ? withoutKey(fileFrontmatter, 'position') : null
                });
                successCount++;
                return Promise.resolve();
            }));
            const readStyles = styleFiles.map((file) => __awaiter(this, void 0, void 0, function* () {
                let read = yield this.plugin.app.vault.cachedRead(file);
                this.styleCache.define(file.basename, read);
            }));
            yield Promise.allSettled(readTemplates.concat(readStyles));
            if ((!this.plugin.initLoaded) && files.length) {
                let str = `${successCount} template${(successCount == 1) ? '' : 's'}`;
                if (failureCount)
                    str += `\n Of ${templateFiles.length} total templates, ${failureCount} failed to compile.`;
                console.log(`Skribi: Loaded ` + str);
            }
            else if (this.plugin.initLoaded) {
                /* Other than during init, definePartials is called on single files at a time.  */
                if (templateFiles.length > 0) {
                    Array.from(this.plugin.children).forEach((child) => {
                        child.templatesUpdated(templateFiles[0].basename);
                    });
                    vLog(`Updated template '${templateFiles[0].basename}' in ${roundTo(window.performance.now() - startTime, 4)}ms`);
                }
                if (styleFiles.length > 0) {
                    Array.from(this.plugin.children).forEach((child) => {
                        child.stylesUpdated(styleFiles[0].basename);
                    });
                    vLog(`Update style '${styleFiles[0].basename}'`);
                }
            }
            return Promise.resolve();
        });
    }
    /* Deletes cache entries by string name or file of origin */
    deletePartial(...items) {
        for (let item of items) {
            let name = isFile(item) ? item.basename : item;
            this.templateCache.remove(name);
        }
    }
    deletePartialByName(...items) {
        var _a, _b;
        for (let item of items) {
            let split = (/(?<name>[^]+)\.(?<extension>[^]+)$/g).exec(item);
            if (!((_b = (_a = Object.keys(split === null || split === void 0 ? void 0 : split.groups)) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0 > 0)) {
                console.warn('Skribi: TemplateLoader.deletePartialByName() could not parse name \n', item);
                continue;
            }
            if (split.groups['extension'] == "css") {
                this.styleCache.remove(split.groups['name']);
                Array.from(this.plugin.children).forEach((child) => {
                    child.stylesUpdated(split.groups['name']);
                });
            }
            else {
                this.templateCache.remove(split.groups['name']);
                Array.from(this.plugin.children).forEach((child) => {
                    child.templatesUpdated(split.groups['name']);
                });
            }
        }
    }
    reload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.templateCache.reset();
            return this.definePartials(...getFiles(this.plugin.app, this.directory));
        });
    }
    /* FileMinder Functions */
    get directory() { return this.plugin.settings.templateFolder; }
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in template directory modified, updating...`);
        this.definePartials(file);
    }
    // fileDeleted(file: TAbstractFile | string): void { // never actually called as string I just wrote it to handle it for some reason
    //   let isf = isFile(file)
    //   if ((!isf && !(String.isString(file) && this.templateCache.get(file)))) return;
    //   vLog(`File '${isf ? (file as TFile).name : file}' removed from template directory, unloading...`)
    //   this.deletePartial(file as (TFile | string))
    // }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from template directory, unloading...`);
        this.deletePartialByName(file.name);
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to template directory, loading...`);
        this.definePartials(file);
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Template file '${oldName}' renamed to '${file.name}', updating...`);
        this.deletePartialByName(oldName);
        this.definePartials(file);
    }
    directoryChanged() {
        vLog(`Template directory changed, reloading templates...`);
        this.reload();
    }
    isInDomain(file) {
        return isInFolder(file, this.directory);
    }
}

class EtaHandler {
    // get templateFrontmatters() {return this.loader.templateFrontmatters}
    constructor(plugin) {
        this.templatesDirty = false;
        this.plugin = plugin;
        this.bus = new ProviderBus(this);
        this.loader = new TemplateLoader(this);
        if (!this.plugin.app.workspace.layoutReady)
            this.plugin.app.workspace.onLayoutReady(() => this.init.bind(this)());
        else
            this.init();
    }
    get templates() { return this.loader.templateCache; }
    get failedTemplates() { return this.loader.templateFailures; }
    init() {
        this.initLoad().then(() => {
            this.registerFileEvents();
        }).catch((err) => {
            console.error(`Skribi: EtaHandler failed to initialize!`, EBAR, err);
        });
    }
    registerFileEvents() {
        /* Because the FileMinder index does not change, we don't need the event refs */
        const minders = [this.bus.scriptLoader, this.loader];
        for (let minder of minders) {
            this.plugin.registerEvent(this.plugin.app.vault.on('modify', file => {
                if (minder.isInDomain(file))
                    minder.fileUpdated(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('delete', file => {
                if (minder.isInDomain(file))
                    minder.fileDeleted(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('create', file => {
                if (minder.isInDomain(file))
                    minder.fileAdded(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('rename', (file, oldPath) => {
                let ourDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath(minder.directory));
                let oldDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath((/.+\//g).exec(oldPath)[0]));
                if (file.parent == ourDir) {
                    // New location of file is in our directory
                    if (file.parent == oldDir) {
                        // File did not move but was renamed
                        minder.fileRenamed(file, (/([a-zA-Z0-9-_.]+\..*)/g).exec(oldPath)[0]);
                    }
                    else {
                        // File was moved from elsewhere into the template directory
                        minder.fileAdded(file);
                    }
                }
                else if (oldDir == ourDir) {
                    // File used to be in templates directory and is no longer
                    minder.fileDeleted(file);
                }
            }));
        }
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            let { a: a, b: b } = yield this.bus.preInit().then(() => {
                return { a: this.bus.init(), b: this.loader.init() };
            });
            return Promise.all([a, b]);
        });
    }
    unload() {
        this.bus.unload();
    }
    recompileTemplates() {
        // If the bus scope changes, the templates must be recompiled. 
        // The bus scope should not change post-init unless an external source modifies the provider list.
        this.loader.reload();
    }
    getPartial(id) {
        return this.loader.templateCache.get(id);
    }
    hasPartial(id) {
        return isExtant(this.loader.templateCache.get(id));
    }
    getCacheKeys() {
        //@ts-ignore
        return Object.keys(this.templates.cache);
    }
    /**
    * Primary skribi render function. Renders asynchronously (TemplateFunction may or may not be async)
    * @param content String or scoped template function to render
    * @param ctxIn Context object to be added to `sk` object
    * @param file File in which the skribi is being rendered
    * @returns [rendered string, returned packet (currently unused)] */
    renderAsync(content, ctxIn, file) {
        return __awaiter(this, void 0, void 0, function* () {
            /* Used to pass data up to the render process from the skribi function */
            let packet = {};
            function up() {
                return function (x, y) {
                    packet[x] = y;
                };
            }
            let cfg = getConfig({ varName: VAR_NAME });
            /* the 'this' object of the sk context*/
            let binder = {};
            /* The 'sk' object */
            let sk = Object.assign({}, ctxIn || {}, {
                this: binder,
                getEnv: getEnv,
                up: up(),
                ctx: {
                    file: file || null,
                    plugin: this.plugin,
                    app: this.plugin.app
                }
            }, this.bus.getScopeSK());
            /* Scope to pass to the function. Must contain all keys that function was compiled with. */
            let scope = Object.assign({ 'sk': sk, 'E': cfg, 'cb': null }, this.bus.getScope());
            function getEnv() {
                return scope;
            }
            let ren = (content.toString().contains('await')) // This will catch strings containing await as well, maybe a flag should be used instead
                ? renderEtaAsync(this, content, {}, cfg, null, scope, binder)
                : renderEta(this, content, {}, cfg, null, scope, binder);
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve([r, packet]); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve([ren, packet]);
            }
            else
                return Promise.reject("EtaHandler.renderAsync: Unknown Error");
        });
    }
    /* this is somehow 1.3x slower than renderAsync */
    renderAsyncNaive(content, ctxIn, varName) {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribos: renderAsyncNaive invoked', content, ctxIn);
            let context = Object.assign({}, ctxIn || {});
            let ren = renderAsync(content, context, { varName: varName !== null && varName !== void 0 ? varName : VAR_NAME });
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve(r); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve(ren);
            }
            else
                return Promise.reject("Unknown error");
        });
    }
    render(content, ctxIn) {
        let context = ctxIn || {};
        content = render(content, context, {
            varName: VAR_NAME
        });
        return content;
    }
    /** TemplateFunction handler, will return cached or compiled function, appropriately bound and scoped
     * @param template String or scoped template function
     * @param options EtaConfig
     * @param scope Object containing objects that should be available in the returned function's scope
     * @param binder Object to which the returned function will be bound */
    getCached(template, options, scope, binder) {
        if (options.name && this.templates.get(options.name)) {
            return (binder) ? this.templates.get(options.name).function.bind(binder) : this.templates.get(options.name);
        }
        const templateFunc = typeof template === 'function' ? template : compileWith(compileToString(template, options), Object.keys(scope), options.async);
        if (options.name)
            this.templates.define(options.name, { source: (String.isString(template) ? template : null), function: templateFunc });
        return (binder) ? templateFunc.bind(binder) : templateFunc;
    }
}

var test$1 = "test";
var documentation = "Documentation";
var en = {
	test: test$1,
	documentation: documentation,
	"command.insert": "Insert Skribi",
	"command.reloadScripts": "Reload Scripts",
	"command.perfTest": "Test Performance",
	"regent.loading.hover": "Evaluating...",
	"regent.stasis.hover": "Recursion limit reached!",
	"regent.self.hover": "Self Render Prohibited",
	"setting.title": "Skribi Settings",
	"setting.templateDirectory.name": "Template Directory",
	"setting.templateDirectory.desc": "Skribi will look for templates in this folder.",
	"setting.scriptDirectory.name": "Skript Directory",
	"setting.scriptDirectory.desc": "Skribi will look for JS files in this folder.",
	"setting.errorLog.name": "Error Logging",
	"setting.errorLog.desc": "Enable to dump any errored renders to the console. If false, will still add the error as tooltip on the errored element. \n Will spam your console if typing into a skribi with a preview window open.",
	"setting.verbose.name": "Verbose Logging",
	"setting.verbose.desc": "Enable to get more detailed logs in the console.",
	"setting.autoReload.name": "Auto Reload",
	"setting.autoReload.desc": "Enable to automatically reload rendered skribis when scripts or relevant templates are updated.",
	"setting.templateSuggest.name": "Template Suggestions",
	"setting.templateSuggest.desc": "Displays a suggestion popover when invoking a template that prompts with template names and value keys.",
	"modal.insert.title": "Insert Skribi Template",
	"modal.insert.append": "Append",
	"modal.insert.insert": "Insert",
	"modal.confirm.title": "Please Confirm",
	"modal.confirm.confirm": "Confirm",
	"modal.confirm.cancel": "Cancel",
	"modal.external.title": "Open External Link?",
	"modal.external.desc": "Will open the following address with default program:",
	"modal.external.label": "Open Link",
	"modal.perf.title": "Skribi Performance Test",
	"modal.perf.textToEvaluate.name": "Text To Evaluate",
	"modal.perf.textToEvaluate.desc": "Text is evaluated as the contents of a code span.",
	"modal.perf.textToEvaluate.placeholder": "{~ console.log('Hello World'); }",
	"modal.perf.evalIterations.name": "Evaluation Iterations",
	"modal.perf.evalIterations.desc": "How many times should the text be evaluated?",
	"modal.perf.evalBlocks": "Eval As Individual Blocks?",
	"modal.perf.evaluate": "Evaluate",
	"modal.perf.evaluating": "Evaluating...",
	"modal.perf.results": "Average fulfillment time",
	"modal.perf.resultsBlockCount.single": "%0 block",
	"modal.perf.resultsBlockCount.plural": "%0 blocks",
	"modal.perf.autofill.selection": "Selection",
	"modal.perf.autofill.clipboard": "Clipboard"
};

var test = "test but in a british accent";
var en_gb = {
	test: test
};

const locales = {
    en: en,
    'en-gb': en_gb
};
function make() {
    let out = {
        '_': t
    };
    for (let key of Object.keys(en)) {
        if (String.isString(en[key])) {
            Object.defineProperty(out, key, {
                get: function () {
                    var _a, _b;
                    return (_b = (_a = locale()) === null || _a === void 0 ? void 0 : _a[key]) !== null && _b !== void 0 ? _b : en[key];
                }
            });
        }
    }
    vLog('Locale definitions constructed');
    return out;
}
function locale() { return locales === null || locales === void 0 ? void 0 : locales[window.moment.locale()]; }
/* Pull localized strings from this. */
const l = make();
/**
 * You can pull strings from this.
 * Pro: safely handles undefined keys
 * Contra: you won't get the property definition tooltips in VSC, which was the whole point of this design
 * @param key Lang file string key to return local version of
 * @param args Strings to insert into insertion tags (eg '%0')
 * @returns Localized string */
function t(key, ...args) {
    var _a, _b;
    if (!isExtant(en[key]))
        vWarn(`Babel received undefined key: ${key}`);
    let str = (_b = (_a = l[key]) !== null && _a !== void 0 ? _a : en[key]) !== null && _b !== void 0 ? _b : `$${key}`;
    return str.replace((/%(\d+)/g), (t, n) => (void 0 !== args[n] ? args[n] : t));
}

class confirmationModal extends obsidian.Modal {
    constructor(app, fieldsIn) {
        super(app);
        this.fields = {
            title: l["modal.confirm.title"],
            labelPos: l["modal.confirm.confirm"],
            labelNeg: l["modal.confirm.cancel"],
        };
        Object.assign(this.fields, fieldsIn || {});
    }
    onOpen() {
        this.titleEl.setText(this.fields.title);
        this.containerEl.addClazz(kls('confirmation-modal'), this.fields.class);
        if (this.fields.desc)
            this.contentEl.createDiv({ cls: kls('confirmation-modal-description'), text: this.fields.desc });
        this.contentEl.append(...this.fields.elements);
        let c = this.contentEl.createDiv({ cls: kls('confirm-modal-buttons') });
        c.createEl("button", { text: this.fields.labelPos, cls: kls('modal-button-confirm') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("true");
                this.close();
            });
        });
        c.createEl("button", { text: this.fields.labelNeg, cls: kls('modal-button-cancel') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("false");
                this.close();
            });
        });
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}
function makeExternalLink(linkIn) {
    const link = String.isString(linkIn) ? createEl('a', { attr: { href: linkIn } }) : linkIn;
    link.addEventListener('click', (ev) => {
        ev.preventDefault();
        let p = new confirmationModal(window.app, {
            title: l["modal.external.title"],
            desc: l["modal.external.desc"],
            labelPos: l["modal.external.label"],
            elements: [createDiv({ cls: kls('confirmation-modal-link'), text: link.getAttr('href') })]
        });
        new Promise((resolve, reject) => p.openAndGetValue(resolve, reject))
            .then(res => {
            if (res === "true") {
                window.open(link.getAttr('href'));
            }
        });
    });
    return link;
}

class SkribosSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.saveSetting = obsidian.debounce((setting, value, cb, ...args) => __awaiter(this, void 0, void 0, function* () {
            // console.log("saving: " + setting + " = " + value)
            this.plugin.settings[setting] = value;
            this.plugin.saveSettings().then(() => { if (isExtant(cb) && isFunc(cb))
                cb(...args || null); });
        }), 2000, true);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.addClass("skribi-settings");
        containerEl.empty();
        containerEl.createEl('h2', { text: l["setting.title"] });
        let desc = containerEl.createDiv({ cls: 'skribi-modal-desc', attr: { style: "margin-bottom: 1em;" } });
        makeExternalLink(desc.createEl('a', { text: l['documentation'], attr: { 'href': linkDocs('settings') } }));
        new obsidian.Setting(containerEl)
            .setName(l["setting.templateDirectory.name"])
            .setDesc(l["setting.templateDirectory.desc"])
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.templateFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.templateFolder = value;
                yield this.plugin.saveSettings();
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName(l["setting.scriptDirectory.name"])
            .setDesc(l["setting.scriptDirectory.desc"])
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.scriptFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.saveSetting('scriptFolder', value, () => this.plugin.eta.bus.scriptLoader.directoryChanged());
            }));
            text.inputEl.cols = 30;
            return text;
        });
        this.makeToggle(containerEl, "autoReload", l["setting.autoReload.name"], l["setting.autoReload.desc"]);
        this.makeToggle(containerEl, "errorLogging", l["setting.errorLog.name"], l["setting.errorLog.desc"]);
        this.makeToggle(containerEl, "verboseLogging", l["setting.verbose.name"], l["setting.verbose.desc"]);
        this.makeToggle(containerEl, "templateSuggest", l["setting.templateSuggest.name"], l["setting.templateSuggest.desc"]);
        // this.makeToggle(containerEl, "shadowMode", "Shadow Mode", "Embed skribis in a shadow root", () => invokeMethodOf<SkribiChild>("rerender", ...this.plugin.children)) // hidden for now (this kills the skribichild)
    }
    makeToggle(el, setting, name, desc, cb) {
        return new obsidian.Setting(el)
            .setName(name)
            .setDesc(desc)
            .addToggle((toggle) => {
            toggle
                .setValue(!!this.plugin.settings[setting])
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings[setting] = value;
                yield this.plugin.saveSettings();
                if (cb)
                    cb(value);
            }));
        });
    }
}
const DEFAULT_SETTINGS = {
    templateFolder: "",
    scriptFolder: "",
    verboseLogging: false,
    devLogging: false,
    errorLogging: false,
    autoReload: true,
    templateSuggest: true,
    reflectStyleTagText: true,
    shadowMode: false,
};

/*
 * Copyright 2017 Google Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
/*
 * Modified from https://github.com/samthor/scoped (polyfill for deprecated HTML feature scoped styles)
 */
/** Prefixes all CSS selectors in a selector text string with prefix prefix */
function prefixSelectors(selectorText, prefix) {
    const found = [];
    while (selectorText) {
        const consumed = consumeSelector(selectorText, prefix);
        if (consumed === null) {
            return ':not(*)';
        }
        found.push(consumed.selector);
        selectorText = consumed.rest;
    }
    return found.join(', ');
}
// This monstrosity matches any valid `[foo="bar"]` block, with either quote style. Parenthesis
// have no special meaning within an attribute selector, and the complex regexp below mostly
// exists to allow \" or \' in string parts (e.g. `[foo="b\"ar"]`).
const attrRe = /^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/;
const walkSelectorRe = /([([,]|:scope\b)/; // "interesting" setups
const scopeRe = /^:scope\b/;
/**
 * Consumes a single selector from candidate selector text, which may contain many. */
function consumeSelector(raw, prefix) {
    let i = raw.search(walkSelectorRe);
    if (i === -1) {
        return { selector: `${prefix} ${raw}`, rest: '' };
    }
    else if (raw[i] === ',') {
        return { selector: `${prefix} ${raw.substr(0, i)}`, rest: raw.substr(i + 1) };
    }
    let leftmost = true; // whether we're past a descendant or similar selector
    let scope = false; // whether :scope has been found + replaced
    i = raw.search(/\S/); // place i after initial whitespace only
    let depth = 0;
    outer: for (; i < raw.length; ++i) {
        const char = raw[i];
        switch (char) {
            case '[':
                const match = attrRe.exec(raw.substr(i));
                i += (match ? match[0].length : 1) - 1; // we add 1 every loop
                continue;
            case '(':
                ++depth;
                continue;
            case ':':
                if (!leftmost) {
                    continue; // doesn't matter if :scope is here, it'll always be ignored
                }
                else if (!scopeRe.test(raw.substr(i))) {
                    continue; // not ':scope', ignore
                }
                else if (depth) {
                    return null;
                }
                // Replace ':scope' with our prefix. This can happen many times; ':scope:scope' is valid.
                // It will never apply to a descendant selector (e.g., ".foo :scope") as this is ignored
                // by browsers anyway (invalid).
                raw = raw.substring(0, i) + prefix + raw.substr(i + 6);
                i += prefix.length;
                scope = true;
                --i; // we'd skip over next character otherwise
                continue; // run loop again
            case ')':
                if (depth) {
                    --depth;
                }
                continue;
        }
        if (depth) {
            continue;
        }
        switch (char) {
            case ',':
                break outer;
            case ' ':
            case '>':
            case '~':
            case '+':
                if (!leftmost) {
                    continue;
                }
                leftmost = false;
        }
    }
    const selector = (scope ? '' : `${prefix} `) + raw.substr(0, i);
    return { selector, rest: raw.substr(i + 1) };
}

/* STYLE FUNCTIONS */
function stripStyleFromString(str) {
    let x = createDiv();
    x.innerHTML = str;
    // console.log('prestrip', x)
    let style = x.querySelector('style');
    if (style)
        x.removeChild(style);
    return [x.innerHTML, style !== null && style !== void 0 ? style : null];
}
/* s must be attached to document or s.sheet will be null */
function scopeStyle(child, el, s) {
    var _a;
    child.hash = (_a = child.hash) !== null && _a !== void 0 ? _a : hash(child.source);
    child.containerEl.setAttr('sk-hash', child.hash);
    if (!s.sheet) {
        console.warn("Skribi: Could not scope style because it was not attached to the document!", EBAR, "Style: ", s, EBAR, "In element: ", el, EBAR, "Of child:", child);
        return;
    }
    const l = s.sheet.cssRules.length;
    for (let i = 0; i < l; ++i) {
        const rule = s.sheet.cssRules[i];
        if (!(rule instanceof CSSImportRule)) {
            scopeRule(rule, ['sk-hash', child.hash]);
        }
    }
    /* Changing the rule properties doesn't change the text of the style element, so we do it manually so make the resolved behavior visible for users in element panel */
    if (window.app.plugins.plugins['obsidian-skribi'].settings.reflectStyleTagText) {
        let rules = [];
        for (let i = 0; i < s.sheet.cssRules.length; i++) {
            rules.push(s.sheet.cssRules.item(i));
        }
        let str = rules.reduce((a, b) => { return a + `${b.cssText}` + '\n'; }, "");
        s.textContent = str;
    }
    return s;
}
/** Mutates a CSSRule's selectors to select elements with attribute 'sk-hash' equal to hash
/* @param rule CSSRule to scope
/* @param hash [attrKey, attrVal] to target */
function scopeRule(rule, target) {
    if (!(rule instanceof CSSStyleRule))
        return; // media and import rules ignored
    let b = prefixSelectors(rule.selectorText, `[${target[0]}='${target[1]}']`);
    rule.selectorText = b;
}

class SkribiChild extends obsidian.MarkdownRenderChild {
    constructor(plugin, el) {
        super(el);
        this.intervals = [];
        this.cbOnUnload = [];
        this.cbOnPost = [];
        this.isPost = false; // True when container has attached to document 
        this.state = "pre";
        this.sources = {
            templates: [],
            styles: []
        };
        this.plugin = plugin;
    }
    provideContext() {
        return {
            el: this.containerEl,
            registerInterval: this.skRegisterInterval.bind(this),
            registerUnload: this.skRegisterUnload.bind(this),
            registerEvent: this.skRegisterEvent.bind(this),
            registerPost: this.skRegisterPost.bind(this),
            addStyle: this.skAddStyle.bind(this),
            reload: this.rerender,
            _c: this
        };
    }
    scriptsUpdated() {
        this.rerender();
    }
    templatesUpdated(id, newId) {
        if (((this === null || this === void 0 ? void 0 : this.templateKey) == id) || this.sources.templates.contains(id)) {
            dLog("Child received template update notification that matched one of its sources", id, this);
            this.rerender((id == (this === null || this === void 0 ? void 0 : this.templateKey)) ? id : null);
        }
    }
    stylesUpdated(id) {
        if ((this.sources.styles).contains(id)) {
            dLog("Child received style update notification that matched one of its sources", id, this);
            this.rerender();
        }
    }
    listenFor(type, id) {
        let l = (type == "style" ? this.sources.styles : type == "template" ? this.sources.templates : null);
        if (l)
            l.push(id);
    }
    setPacket(packet) {
        if (this.packet == null) {
            this.packet = packet;
        }
    }
    onload() { }
    /* NOT called by child.unload() (except sometimes it is) */
    onunload() {
        dLog("skreeb unload", this.containerEl);
        this.clear();
    }
    /* Called by rerender. */
    clear() {
        vLog("clear", this.containerEl);
        for (let i of this.intervals)
            window.clearInterval(i); // there might be cases where this doesn't get called properly (?)
        for (let cb of this.cbOnUnload)
            cb[0](cb[1]);
        // this.containerEl.parentNode.removeChild(this.containerEl)
        this.plugin.children.remove(this);
    }
    /* Called after render fulfillment */
    onPost() {
        this.isPost = true;
        this.state = "post";
        for (let cb of this.cbOnPost)
            cb[0](cb[1]);
    }
    /*-- Provider Functions --*/
    // Asynchronously adds a scoped style element to the container, from string str
    // Will not resolve until post (when element is attached to document, which is required for scopeStyle())
    // Returns reference to the created element
    // TODO: if aborted before post, will promise persist in memory?
    skAddStyle(str) {
        let s = createEl('style');
        s.innerHTML = str;
        this.containerEl.prepend(s);
        let p = () => {
            return new Promise((resolve, reject) => {
                this.skRegisterPost(() => {
                    resolve(scopeStyle(this, this.containerEl, s));
                });
            });
        };
        return p();
    }
    skRegisterInterval(cb, time, ...args) {
        //@ts-ignore
        let x = window.setInterval((...a) => {
            if (this._loaded == false) {
                window.clearInterval(x);
            }
            cb(...a);
        }, time * 1000, ...args);
        this.intervals.push(x);
        return x;
    }
    skRegisterEvent(event) {
        dLog('SkChild registered event:', event);
        this.registerEvent(event);
    }
    skRegisterUnload(cb, ...args) {
        this.cbOnUnload.push([(...x) => cb(...x), args]);
    }
    skRegisterPost(cb, ...args) {
        if (!this.isPost) {
            this.cbOnPost.push([(...x) => cb(...x), args]);
        }
        else {
            ((...x) => cb(...x))(args);
        }
    }
    // Assigned in renderSkribi()
    rerender(...args) { }
}

class SuggestionModal extends obsidian.FuzzySuggestModal {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
    }
    getItems() {
        return this.plugin.eta.getCacheKeys();
    }
    getItemText(item) { return item; }
    onChooseItem(item, evt) {
        this.resolve(item);
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}

var promptTypes;
(function (promptTypes) {
    promptTypes["string"] = "string";
})(promptTypes || (promptTypes = {}));

class InsertionModal extends obsidian.Modal {
    constructor(plugin, editor, id) {
        super(plugin.app);
        this.valFields = {};
        this.plugin = plugin;
        this.editor = editor;
        this.currentID = id.toString();
        this.containerEl.addClass("skribi-insertion-modal");
        this.titleEl.setText(l["modal.insert.title"]);
    }
    onOpen() {
        this.create();
    }
    create() {
        let s = new obsidian.Setting(this.contentEl);
        s.addDropdown((drop) => {
            drop
                .addOptions(toDupeRecord(this.plugin.eta.getCacheKeys()))
                .setValue(this.currentID)
                .onChange((v) => {
                this.currentID = v;
                let f = this.generateFields(fieldsDiv, this.currentID);
                ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
            });
        });
        let fieldsDiv = this.contentEl.createDiv({ cls: "skribi-modal-fields" });
        let t = new obsidian.Setting(this.contentEl);
        t.addText((te) => { this.textInput = te; return te; });
        t.setName(l["modal.insert.append"]);
        t.settingEl.addClass("skribi-modal-field-append");
        let f = this.generateFields(fieldsDiv, this.currentID);
        ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
        let confirm = new obsidian.Setting(this.contentEl);
        confirm.addButton((button) => button
            .setButtonText(l["modal.insert.insert"])
            .onClick(() => this.doInsert()));
        this.keypressRef = this.scope.register([], "Enter", this.doInsert.bind(this));
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    generateFields(el, id) {
        var _a;
        el.empty();
        var arr = [];
        if ((_a = this.plugin.eta.templates.get(id)) === null || _a === void 0 ? void 0 : _a.frontmatter) {
            let fm = this.plugin.eta.templates.get(id).frontmatter;
            for (let v of Object.keys(fm)) {
                if (v.charAt(0) == "_") {
                    let vn = v.substring(1);
                    let fma = this.parsePromptVal(vn, fm[v]);
                    let s = new obsidian.Setting(el);
                    s.settingEl.addClass("skribi-modal-template-field");
                    if (fma.type == promptTypes.string) {
                        arr.push(this.createTextField(s, fma));
                    }
                    s.setName(fma.name);
                }
            }
        }
        return arr;
    }
    createTextField(set, fma) {
        let t;
        set.addText((text) => {
            text
                .setValue(fma.default)
                .setPlaceholder(fma.placeholder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.valFields[fma.id] = value;
            }));
            text.inputEl.addClass("skribi-text-input");
            t = text;
        });
        if (fma.default.length > 0)
            this.valFields[fma.id] = fma.default;
        return t;
    }
    parsePromptVal(k, val) {
        let v = {
            id: k,
            type: promptTypes.string,
            name: isExtant(val === null || val === void 0 ? void 0 : val.name) ? val.name : k,
            placeholder: isExtant(val === null || val === void 0 ? void 0 : val.placeholder) ? val.placeholder : "",
            default: isExtant(val === null || val === void 0 ? void 0 : val.default) ? val.default : isExtant(val === null || val === void 0 ? void 0 : val.def) ? val.def : "",
        };
        return v;
    }
    doInsert() {
        let id = this.currentID;
        let osel = this.editor.listSelections();
        let toInsert = `\`{:${id}`;
        for (let e of Object.entries(this.valFields)) {
            toInsert += ` | ${e[0]}: ${e[1]}`;
        }
        toInsert += ((this === null || this === void 0 ? void 0 : this.textInput.getValue().length) > 0) ? " | " + this.textInput.getValue() : "";
        toInsert += `}\``;
        this.editor.getDoc().replaceSelection(toInsert);
        let nsel = [];
        for (let p of osel) {
            nsel.push({ from: { line: p.anchor.line, ch: p.anchor.ch + (toInsert.length) } });
        }
        this.editor.transaction({ selections: nsel });
        this.close();
    }
}

const maximumIterations = 10000;
class TestModal extends obsidian.Modal {
    constructor(plugin, autofill) {
        super(plugin.app);
        this.iterations = 10;
        this.multiBlock = false;
        this.valFields = {};
        this.autofill = null;
        this.plugin = plugin;
        this.autofill = autofill;
        this.containerEl.addClass("skribi-test-modal");
        this.titleEl.setText(l['modal.perf.title']);
        let desc = createDiv({ cls: 'skribi-modal-desc' });
        makeExternalLink(desc.createEl('a', { text: l['documentation'], attr: { 'href': linkDocs('commands/performance') } }));
        desc.insertAfter(this.titleEl);
    }
    onOpen() {
        this.create();
    }
    create() {
        let fieldTextToEval = new obsidian.Setting(this.contentEl);
        fieldTextToEval.addTextArea((text) => { this.textFieldToEval = text; return text; });
        fieldTextToEval.setName(l["modal.perf.textToEvaluate.name"]);
        fieldTextToEval.setDesc(l["modal.perf.textToEvaluate.desc"]);
        this.textFieldToEval.setPlaceholder(l["modal.perf.textToEvaluate.placeholder"]);
        if (this.autofill) {
            fieldTextToEval.infoEl.append(createDiv({ text: `Autofilled from ${this.autofill.type}`, cls: 'setting-item-description skribi-autofill-notification' }));
            this.textFieldToEval.setValue(this.autofill.value);
        }
        let fieldIterations = new obsidian.Setting(this.contentEl);
        let iters = fieldIterations.controlEl.createEl('input', { attr: { type: 'number' } });
        iters.defaultValue = this.iterations.toString();
        iters.onchange = (ev) => { this.iterations = iters.valueAsNumber; };
        fieldIterations.setName(l["modal.perf.evalIterations.name"]);
        fieldIterations.setDesc(l["modal.perf.textToEvaluate.desc"]);
        let blockSetting = new obsidian.Setting(this.contentEl);
        blockSetting.addToggle((tog) => {
            tog.setValue(this.multiBlock);
            tog.onChange((v) => this.multiBlock = v);
            return tog;
        });
        blockSetting.setName(l["modal.perf.evalBlocks"]);
        let confirm = new obsidian.Setting(this.contentEl).setClass('skribi-button-eval');
        confirm.addButton((button) => button
            .setButtonText(l["modal.perf.evaluate"])
            .onClick(() => this.doEval()));
        this.keypressRef = this.scope.register([], "Enter", this.doEval.bind(this));
        this.contentEl.createEl('hr');
        this.resultsField = this.contentEl.createDiv({ cls: "skribi-test-results-field" });
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    doEval() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.plugin.initLoaded) {
                this.resultsField.setText("Template cache not ready!");
                return;
            }
            let container = createDiv();
            let el = createDiv();
            let blocksToProcess = [];
            let toIter = Math.min(this.iterations, maximumIterations);
            if (this.multiBlock) {
                for (let i = 0; i < toIter; i++) {
                    let d = createDiv();
                    d.createEl('code', { text: this.textFieldToEval.getValue() });
                    blocksToProcess.push(d);
                }
            }
            else {
                let singleDiv = createDiv();
                for (let i = 0; i < toIter; i++) {
                    singleDiv.createEl('code', { text: this.textFieldToEval.getValue() });
                }
                blocksToProcess.push(singleDiv);
            }
            let timeStart = window.performance.now();
            const proms = blocksToProcess.map((div) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                let promiseStartTime = window.performance.now();
                let promise = yield this.plugin.processor.processEntry({ srcType: "GENERAL" /* general */ }, div, {
                    remainingNestLevel: 4,
                    docId: '55555555',
                    frontmatter: null,
                    sourcePath: ((_a = this.plugin.app.workspace.getActiveFile()) === null || _a === void 0 ? void 0 : _a.path) || "",
                    addChild: (child) => { },
                    getSectionInfo: () => { return null; },
                    containerEl: container,
                    el: el
                }, 4, false, null).catch(() => { });
                return [promise, window.performance.now(), promiseStartTime];
            }));
            this.resultsField.setText(l["modal.perf.evaluating"]);
            let settledValues = yield Promise.allSettled(proms);
            vLog(`Performance test settled in: ${roundTo(window.performance.now() - timeStart, 3)}ms`);
            let fullfilled = settledValues.map((v) => { if (v.status == 'fulfilled')
                return v.value; });
            let times = fullfilled.map((result) => (result[1] - result[2]));
            let avg = average(...times);
            let p = [];
            fullfilled.map(res => res[0].map((a) => p.push(a)));
            let children = (yield Promise.allSettled(p)).map((rez) => { if (rez.status == "fulfilled")
                return rez.value[1]; });
            this.resultsField.setText(`${l["modal.perf.results"]} (${children.length} children in ${l._((times.length > 1 ? "modal.perf.resultsBlockCount.plural" : "modal.perf.resultsBlockCount.single"), times.length.toString())}): ${roundTo(avg, 3)}ms`);
            // invokeMethodOf<SkribiChild>("clear", ...children) // Unload doesn't seem to be invoked consistently so let's just make sure everything is cleared
            Array.from(children).forEach((child) => child.clear());
            blocksToProcess.map(block => block.remove()); // Children are easier to collect when they lack shelter
            container.remove();
            el.remove(); // One day, the last person who remembers you will die, and you will be forgotten forever
        });
    }
}

function renderError(el, e) {
    return __awaiter(this, void 0, void 0, function* () {
        if ((e === null || e === void 0 ? void 0 : e.flag) && e.flag == "abort") {
            return renderRegent(el, Object.assign({}, {
                class: 'abort',
                label: 'sk',
                hover: 'Render Aborted'
            }, e));
        }
        else {
            return renderRegent(el, { class: 'error', label: 'sk', hover: (e === null || e === void 0 ? void 0 : e.msg) || "Unknown Error", clear: true });
        }
    });
}
function renderState(el, dataIn) {
    return __awaiter(this, void 0, void 0, function* () {
        let data = Object.assign({
            class: "state",
            label: "sk",
            clear: false,
            hover: ""
        }, dataIn || {});
        el.className = `skribi-regent ${data.class}`;
        el.setAttribute("title", data.hover);
    });
}
function createRegent(dataIn) {
    let data = Object.assign({
        class: "generic",
        label: "sk",
        clear: false,
        hover: ""
    }, dataIn || {});
    const pre = createEl("code", { cls: `skribi-regent ${data.class}`, text: data.label });
    pre.setAttribute("title", data.hover);
    return [pre, data];
}
function renderRegent(el, dataIn) {
    let [pre, data] = createRegent(dataIn);
    if (data.clear)
        el.className = "";
    el.replaceWith(pre);
    return pre;
}

const extImg = ["bmp", "png", "jpg", "jpeg", "gif", "svg"];
const extAud = ["mp3", "wav", "m4a", "3gp", "flac", "ogg", "oga"];
const extVid = ["mp4", "webm", "ogv"];
const extTxt = ["md"];
/* Repairs media embeds that have been rendered to markdown */
function embedMedia(el, srcPath, plugin, depth, self) {
    return __awaiter(this, void 0, void 0, function* () {
        dLog("embed self:", self);
        dLog("embed:", el);
        var proms = [];
        const catches = el.querySelectorAll("span.internal-embed");
        let elDepth = el.getAttribute("depth");
        let d = (isExtant(elDepth) ? parseInt(elDepth) : isExtant(depth) ? depth : 0);
        dLog("embedder depth:", d);
        for (let fish of Array.from(catches)) {
            if (fish.hasClass("is-loaded"))
                continue;
            let src = obsidian.normalizePath(fish.getAttribute("src"));
            let dest = plugin.app.metadataCache.getFirstLinkpathDest(src, srcPath);
            if (dest) {
                let path = plugin.app.vault.adapter.getResourcePath(dest.path);
                let ext = dest.extension;
                if (extImg.contains(ext)) { // Embed Image
                    fish.addClass("image-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("img");
                    nel.setAttribute("src", path);
                }
                else if (extAud.contains(ext)) { // Embed Audio
                    fish.addClass("media-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("audio", { "attr": { "controls": true } });
                    nel.setAttribute("src", path);
                }
                else if (extVid.contains(ext)) { // Embed Video
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let vidiv = fish.createEl("video", { "attr": { "controls": true } });
                    vidiv.setAttribute("src", path);
                }
                else if (extTxt.contains(ext)) {
                    /* Embed Transclusion */
                    const createEmbedPromise = () => {
                        return new Promise(() => __awaiter(this, void 0, void 0, function* () {
                            dLog("new embed prom");
                            fish.childNodes.forEach((n) => { fish.removeChild(n); });
                            let cache = plugin.app.metadataCache.getCache(dest.path);
                            let read = yield plugin.app.vault.cachedRead(dest);
                            let classes = obsidian.parseFrontMatterStringArray(cache === null || cache === void 0 ? void 0 : cache.frontmatter, "cssclass");
                            let div = fish.createDiv({ cls: "markdown-embed" });
                            div.createDiv({ cls: "markdown-embed-title", text: dest.basename });
                            let content = div.createDiv({ cls: "markdown-embed-content" });
                            let link = div.createDiv({ cls: "markdown-embed-link" });
                            obsidian.setIcon(link, "link");
                            link.onClickEvent((e) => {
                                e.preventDefault();
                                plugin.app.workspace.openLinkText(src, srcPath);
                            });
                            let pv = content.createDiv({ cls: "markdown-preview-view" });
                            pv.addClazz(classes);
                            let ps = pv.createDiv({ cls: "markdown-preview-sizer markdown-preview-section" });
                            let mkh = createDiv({ attr: { "depth": depth.toString() } });
                            yield obsidian.MarkdownRenderer.renderMarkdown(read, mkh, srcPath, null);
                            const mke = (Array.from((mkh === null || mkh === void 0 ? void 0 : mkh.childNodes) || []).map((n) => {
                                // if (n.childNodes.length > 0) { let d = createDiv(); d.append(n.cloneNode(true)); return d;} else return n;}));
                                if (n.childNodes.length > 0) {
                                    let d = createDiv();
                                    d.append(n);
                                    return d;
                                }
                                else
                                    return n;
                            }));
                            ps.append(...mke); //ps.setAttribute("depth", d.toString())
                            return embedMedia(ps, srcPath, plugin, d - 1, true);
                        }));
                    };
                    if (d <= 0) {
                        let [l] = createRegent({ class: "depth-limit", hover: "It goes on forever..." });
                        fish.replaceWith(l);
                        dLog("embedder hit limit");
                    }
                    else {
                        proms.push(createEmbedPromise());
                    }
                }
            }
        }
        return Promise.allSettled(proms).then(values => {
            dLog("embedder done", proms);
            return Promise.resolve(proms.length);
        });
    });
}

/* Check if code block is that good good and if so what type of good good */
function preparseSkribi(el, str, flg) {
    return __awaiter(this, void 0, void 0, function* () {
        let text = isExtant(str) ? str : el.textContent;
        if (text.length < 3)
            return;
        let e = text.substr(text.length - 2);
        let s = text.substr(0, 2);
        if (s.startsWith("{") && e.endsWith("}")) {
            let f = s[1];
            let flag = (f == ":") ? 1 : (f == "=") ? 2 : (f == "~") ? 3 : (f == "{") ? 4 : (f == ".") ? 5 : -1;
            if ((flag > 0) && (flag != 4 || (e == "}}"))) {
                return { flag: flag, text: text.substring(2, text.length - (flag == 4 ? 2 : 1)) };
            }
            else
                return;
        }
        else
            return;
    });
}
/* Parse variables in template invocations */
function parseSkribi(src) {
    return __awaiter(this, void 0, void 0, function* () {
        let sa = src.split(/(?<![\\])\|/);
        let id = sa.splice(0, 1)[0].trim();
        let args = {};
        for (let seg of sa) {
            let si = seg.indexOf(":");
            if (si == -1)
                continue;
            args[seg.slice(0, si).trim()] = seg.slice(si + 1).trim();
        }
        return { id: id, args: { v: args } };
    });
}

class SkribiProcessor {
    constructor(plugin) {
        this.queuedTemplates = [];
        this.plugin = plugin;
        this.eta = plugin.eta;
    }
    /**
     * Register our markdown processors. */
    registerProcessors() {
        const processCodeSpan = (el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processEntry({ srcType: "GENERAL" /* general */ }, el, ctx); });
        this.plugin.registerMarkdownPostProcessor((el, ctx) => processCodeSpan(el, ctx));
        const processCodeBlock = (mode, str, el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processEntry(mode, el, ctx, null, null, str.trimEnd()); });
        ([["normal", "", 0 /* none */], ["raw", "-raw", 3 /* raw */], ["literal", "-lit", 4 /* literal */], ["interpolate", "-int", 2 /* interp */], ["evaluate", "-eval", 5 /* eval */]])
            .forEach((v) => {
            this.plugin.registerMarkdownCodeBlockProcessor(`skribi${v[1]}`, processCodeBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
            this.plugin.registerMarkdownCodeBlockProcessor(`sk${v[1]}`, processCodeBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
        });
    }
    /** Entry to the Skribi process chain. Called:
     * - By MarkdownView on each block of a markdown preview
     * - By MarkdownView on code blocks of our register language types
     * - By renderSkribi to recurse nested skribis */
    processEntry(mode, // 0: codespan; 1: codeblock;
    doc, ctx, depth, self, srcIn) {
        return __awaiter(this, void 0, void 0, function* () {
            let nestExtant = isExtant(ctx.remainingNestLevel);
            let nestLevel = nestExtant ? ctx.remainingNestLevel : null;
            /* nestExtant means that we are inside of a natural transclusion */
            self = isExtant(self);
            depth = self ? depth : null;
            /* self means that we have been called by renderSkribi, to look for codeblocks */
            let elHasDepth = isExtant(doc.getAttribute("depth"));
            let elElHasDepth = isExtant(ctx.el.getAttribute("depth"));
            let elDepth = elHasDepth ? parseInt(doc.getAttribute("depth")) : elElHasDepth ? parseInt(ctx.el.getAttribute("depth")) : null;
            /* Used for passing depth to virtual elements (we may be in one even as we speak...)*/
            /* determine our depth condition type */
            let d = self ? depth : (elHasDepth || elElHasDepth) ? elDepth : nestExtant ? nestLevel : 0;
            if (!nestExtant && !(elHasDepth || elElHasDepth))
                dLog("processor sees no depth");
            if (elHasDepth) {
                dLog("elDepth", elDepth, "doc", doc, "el", ctx.el, "conEl", ctx.containerEl);
            }
            else {
                dLog("processor: ", "doc", doc, "el", ctx.el, "conEl", ctx.containerEl, "nest", ctx.remainingNestLevel);
            }
            /* Dispatch render promises */
            var proms = [];
            var temps = 0;
            const elCodes = (mode.srcType == "BLOCK" /* block */) ? [doc] : doc.querySelectorAll("code");
            if (!(d <= 0)) {
                window.performance.now();
                const elProms = Array.from(elCodes).map((el) => __awaiter(this, void 0, void 0, function* () {
                    let t = window.performance.now();
                    dLog("start:", t);
                    let src = (isExtant(mode.flag) && mode.flag != 0 /* none */) ?
                        { text: srcIn || doc.textContent, flag: mode.flag } : yield preparseSkribi(el);
                    let originalText = (mode.srcType == "BLOCK" /* block */) ? srcIn : el.textContent;
                    try {
                        if (src != null) {
                            let skCtx = { time: window.performance.now(), depth: d, flag: src.flag, source: originalText };
                            let nel = renderRegent(el, { class: 'sk-loading', hover: l['regent.loading.hover'] });
                            if (src.flag == 1) {
                                proms.push(this.awaitTemplatesLoaded({ el: nel, src: src.text, mdCtx: ctx, skCtx: skCtx })
                                    .catch(e => { console.warn(`Skribi: Dispatch Errored (Template)`, EBAR, e); }));
                                temps++;
                            }
                            else {
                                proms.push(this.processSkribi(nel, src.text, ctx, skCtx)
                                    .catch(e => { console.warn(`Skribi: Dispatch Errored`, EBAR, e); }));
                            }
                        }
                    }
                    catch (e) {
                        if (!e.flags.noRender) {
                            renderError(el, e);
                        }
                    }
                    return Promise.resolve();
                }));
                //TODO: Rewrite the logging logic for the new template queue
                yield Promise.allSettled(elProms);
                if (proms.length > 0) ;
                return proms;
            }
            else {
                /* Depth too high! */
                elCodes.forEach((el) => __awaiter(this, void 0, void 0, function* () {
                    preparseSkribi(el).then((src) => __awaiter(this, void 0, void 0, function* () {
                        if (src != null)
                            renderState(el, { hover: l['regent.stasis.hover'], class: 'stasis' });
                    }));
                }));
                dLog("processor hit limit");
                return Promise.resolve(null); // Postprocessor calls are not caught so we can't reject neatly.
            }
        });
    }
    /** Queues templates to process on initial template load completion, or processes them immediately if ready. */
    awaitTemplatesLoaded(args) {
        return __awaiter(this, void 0, void 0, function* () {
            let el = renderRegent(args.el, { class: 'wait', label: 'sk', hover: 'Awaiting Template Cache', clear: true });
            return (this.plugin.initLoaded)
                ? yield this.processSkribiTemplate(el, args.src, args.mdCtx, args.skCtx)
                : new Promise((resolve, reject) => {
                    let activate = (ele, time) => {
                        resolve(this.processSkribiTemplate(ele, args.src, args.mdCtx, Object.assign(args.skCtx, { time: time })));
                    };
                    this.queuedTemplates.push({ function: activate, element: el });
                });
        });
    }
    /** Called on template init load complete. Fires off all of the queued templates. */
    templatesReady() {
        let proms = this.queuedTemplates.map((queued) => {
            let el = renderRegent(queued.element, { class: 'sk-loading', hover: l['regent.loading.hover'] });
            return queued.function(el, window.performance.now());
        });
        Promise.allSettled(proms).then(() => { this.queuedTemplates = []; });
    }
    /** Parse variables and prep the template */
    processSkribiTemplate(el, src, mdCtx, skCtx) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            let parsed = null;
            try {
                parsed = yield parseSkribi(src);
            }
            catch (e) {
                renderError(el, e);
                return Promise.reject('Parsing Error');
            }
            /* Abort if being rendered in its own definition */
            if (this.plugin.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath).basename == parsed.id) {
                renderRegent(el, { class: 'self', hover: l['regent.stasis.hover'] });
                return Promise.reject('Within Self Definition');
            }
            let template = (_a = this.eta.getPartial(parsed.id)) === null || _a === void 0 ? void 0 : _a.function;
            if (!isExtant(template)) {
                if (this.eta.failedTemplates.has(parsed.id)) {
                    el = yield renderError(el, { msg: `Template ${parsed.id} exists but failed to compile, with error:` + EBAR + this.eta.failedTemplates.get(parsed.id) });
                }
                else {
                    el = yield renderError(el, { msg: `SkribiError: Cannot read undefined template '${parsed.id}' (no such template exists)` });
                }
                /* We intentionally attempt to render the template even though we know it doesn't exist,
                because it will be caught and converted into a ghost listener. */
            }
            return this.renderSkribi(el, template, parsed.id, mdCtx, Object.assign({}, skCtx, { ctx: parsed.args }));
        });
    }
    /** Wrap non-template skribis in tags as determined by their type flag */
    processSkribi(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            const prep = function (str, flag) {
                switch (flag) {
                    case 2: return `<%=${src}%>`;
                    case 3: return `<%~${src}%>`;
                    case 4: return str;
                    case 5: return `<%${src}%>`;
                }
            };
            return this.renderSkribi(el, prep(src, skCtx.flag), "literal", mdCtx, skCtx);
        });
    }
    /** Main skribi rendering function */
    renderSkribi(el, con, id, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let handled = false;
            let file = this.plugin.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath);
            let newElement = createDiv({ cls: "skribi-render-virtual" });
            let child = new SkribiChild(this.plugin, newElement);
            Object.assign(child, {
                /* We assign rerender here for the closure */
                rerender: ((templateToRetrieve) => {
                    var _a;
                    let nskCtx = Object.assign({}, skCtx, { time: window.performance.now() });
                    if (skCtx.flag == 1 && isExtant(templateToRetrieve)) {
                        let template = (_a = this.eta.getPartial(templateToRetrieve)) === null || _a === void 0 ? void 0 : _a.function;
                        child.unload();
                        this.renderSkribi(newElement, template, templateToRetrieve, mdCtx, nskCtx);
                    }
                    else {
                        child.unload();
                        this.renderSkribi(newElement, con, id, mdCtx, nskCtx);
                    }
                }).bind(this),
                templateKey: (skCtx.flag == 1) ? id : null,
                source: skCtx.source
            });
            let ctx = Object.assign({}, (skCtx === null || skCtx === void 0 ? void 0 : skCtx.ctx) || {}, { child: child.provideContext() });
            let [rendered, packet] = yield this.eta.renderAsync(con, ctx, file)
                .catch((err) => {
                /* If a template skribi's template does not exist (intentionally not caught until this point) */
                if (con === undefined && !this.eta.hasPartial(id)) {
                    con = skCtx.source;
                    err = `SkribiError: Cannot read undefined template '${id}'\n`;
                    let info = mdCtx.getSectionInfo(mdCtx.el);
                    if (info)
                        err += `   at (MarkdownSectionInfo) lineStart: ${info.lineStart}, lineEnd: ${info.lineEnd} (zero-indexed)`;
                }
                if (this.plugin.settings.errorLogging) {
                    console.warn(`Skribi render threw error! Displaying content and error...`, EBAR, con, EBAR, err);
                }
                renderError(el, (err === null || err === void 0 ? void 0 : err.hasData) ? err : { msg: (err === null || err === void 0 ? void 0 : err.msg) || err || "Render Error" }).then(errEl => {
                    /* Alter the child so that it may yet live (and listen for source updates) */
                    Object.assign(child, {
                        containerEl: errEl,
                        state: "error",
                        rerender: ((templateToRetrieve) => {
                            let nskCtx = Object.assign({}, skCtx, { time: window.performance.now() });
                            if (skCtx.flag == 1 && isExtant(templateToRetrieve)) {
                                let template = this.eta.getPartial(templateToRetrieve).function;
                                child.unload();
                                this.renderSkribi(errEl, template, templateToRetrieve, mdCtx, nskCtx);
                            }
                            else {
                                child.unload();
                                this.renderSkribi(errEl, con, id, mdCtx, nskCtx);
                            }
                        }).bind(this),
                    });
                    mdCtx.addChild(child);
                    this.plugin.children.push(child);
                });
                handled = true;
                return Promise.resolve([null, null]);
            });
            /* RENDERING */
            dLog("renderSkribi:", el, mdCtx, skCtx, id);
            if (isExtant(rendered)) {
                let d = isExtant(mdCtx.remainingNestLevel) ? mdCtx.remainingNestLevel : (skCtx.depth);
                let style = stripStyleFromString(rendered); // renderMarkdown ignores style nodes so we'll just yoink em 
                if (style[1]) {
                    rendered = style[0];
                }
                let render = ((packet === null || packet === void 0 ? void 0 : packet['noMarkdown'])
                    ? this.simpleRender(rendered, newElement)
                    : obsidian.MarkdownRenderer.renderMarkdown(rendered, newElement, mdCtx.sourcePath, null))
                    .then(() => {
                    /* this bit disabled because it kills other skribis rendering in the same block */
                    // if (el?.parentElement?.nodeName == "P") { // true when (mode == Mode.block)
                    // el.parentElement.replaceWith(el) // strip the superfluous P element
                    // }
                    newElement.setAttribute("skribi", (skCtx.flag == 1) ? 'template' : id);
                    if (skCtx.flag == 1) {
                        newElement.setAttribute("skribi-template", id);
                    }
                    newElement.removeClass("skribi-render-virtual");
                    if (!newElement.getAttr("class")) {
                        newElement.removeAttribute("class");
                    }
                    let shade;
                    if (this.plugin.settings.shadowMode) {
                        /* it seems that non-codeblock skribis do not survive this process */
                        let nel = createDiv();
                        el === null || el === void 0 ? void 0 : el.parentElement.prepend(nel);
                        nel.setAttr('skribi-host', '');
                        console.log(el);
                        shade = nel.attachShadow({ mode: 'open' });
                        shade.append(newElement);
                        el.remove();
                    }
                    else {
                        el.replaceWith(newElement);
                    }
                    dLog("finish: ", skCtx.time, window.performance.now());
                    if (style[1]) {
                        if (this.plugin.settings.shadowMode) {
                            shade.append(style[1]);
                            // newElement.prepend(style[1])
                        }
                        else {
                            newElement.prepend(style[1]);
                            scopeStyle(child, newElement, style[1]);
                        }
                    }
                    if (skCtx.flag == 1) {
                        vLog(`Rendered template "${id}" (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, newElement);
                    }
                    else
                        vLog(`Rendered literal (f: ${skCtx.flag}) (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, newElement);
                    return Promise.resolve(newElement);
                });
                child.setPacket(packet);
                mdCtx.addChild(child);
                this.plugin.children.push(child);
                render.then((e) => {
                    child.onPost();
                    // TODO: only restrict depth for transclusions
                    if (isExtant(mdCtx.remainingNestLevel) && (mdCtx.remainingNestLevel > 0) || !isExtant(mdCtx.remainingNestLevel)) {
                        return embedMedia(e, mdCtx.sourcePath, this.plugin, skCtx.depth);
                    }
                    else
                        return Promise.resolve();
                })
                    .then((x) => {
                    dLog("renderer final: ", d);
                    this.processEntry({ srcType: "GENERAL" /* general */ }, newElement, mdCtx, skCtx.depth - 1, true); /* Recurse the processor to parse skreeblings */
                });
                return [render, child];
            }
            else if (!handled) {
                child.clear();
                return Promise.reject("Unknown Render Error");
            }
        });
    }
    /* End of processor chain */
    simpleRender(content, el) {
        return __awaiter(this, void 0, void 0, function* () {
            el.innerHTML = content;
            console.log(el);
            return Promise.resolve();
        });
    }
}

class TemplateSuggest extends obsidian.EditorSuggest {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
    }
    onTrigger(cursor, editor, file) {
        var _a, _b, _c;
        if (this.plugin.settings.templateSuggest) {
            let soFar = editor.getLine(cursor.line).substr(0, cursor.ch);
            let match = (/^.*`{:([^}]*)$/gs).exec(soFar);
            // console.log(match)
            if (match === null || match === void 0 ? void 0 : match[0]) {
                let m = match[1].match(/\|([^\|]*)$/);
                // console.log("m", m)
                return {
                    end: cursor,
                    start: {
                        ch: isExtant(m === null || m === void 0 ? void 0 : m[1]) ? (cursor.ch - m[1].length) : (match[0].length - ((_b = (_a = match[1]) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0)),
                        line: cursor.line
                    },
                    query: (_c = match === null || match === void 0 ? void 0 : match[1]) !== null && _c !== void 0 ? _c : ""
                };
            }
        }
    }
    getSuggestions(context) {
        var _a;
        let has = context.query.match(/^(.*)\|([^\:]*$)/s);
        // console.log(has)
        if (has) {
            let ind = context.query.indexOf("|");
            let key = context.query.substr(0, ind).trim();
            let tp = this.plugin.eta.templates.get(key);
            if (tp === null || tp === void 0 ? void 0 : tp.frontmatter) {
                (_a = has === null || has === void 0 ? void 0 : has[2]) === null || _a === void 0 ? void 0 : _a.trim();
                // console.log(pk)
                return Object.keys(tp.frontmatter)
                    .filter(k => { var _a; return (k.substr(1).startsWith((_a = has === null || has === void 0 ? void 0 : has[2]) === null || _a === void 0 ? void 0 : _a.trimStart()) && !(k.substring(1).trim() == (has === null || has === void 0 ? void 0 : has[2].trim()))); })
                    .map((v) => v.substr(1));
            }
        }
        else {
            let keys = this.plugin.eta.getCacheKeys();
            // console.log('query:', context?.query)
            let ret = (context === null || context === void 0 ? void 0 : context.query) ? keys.filter(key => (key.startsWith(context.query) && !(key == context.query))) : keys;
            // console.log(ret)
            return ret;
        }
    }
    renderSuggestion(value, el) {
        el.addClass("skribi-suggestion");
        el.createSpan({ text: value });
        // console.log(el.cloneNode(true))
        // console.log(el.parentElement.parentElement.cloneNode(true))
    }
    selectSuggestion(value, evt) {
        var _a;
        if (this.context) {
            // let conLength = this.context.end.ch - this.context.start.ch
            // let preLength = conLength - (this.context.query.length + 3)
            let line = this.context.editor.getLine(this.context.start.line);
            let bar = line.match(/^.*(\`\{\:([^\|]*\|)*)/s);
            // console.log('bar\n', bar)
            // console.log('query\n', this.context.query)
            // console.log('pre\n', line.substr(preLength, preLength + bar?.[0].length))
            // console.log('line\n', line)
            let ch = (_a = ((bar && (bar === null || bar === void 0 ? void 0 : bar[0])) ? bar[0].length : null)) !== null && _a !== void 0 ? _a : this.context.start.ch;
            // console.log(line.charAt(ch-1))
            this.context.editor.replaceRange(((line.charAt(ch - 1) == ":") ? "" : " ") + value, {
                line: this.context.start.line,
                ch: ch
            }, this.context.end);
        }
    }
}

class SkribosPlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        this.varName = "sk";
        this.initLoaded = false;
        this.l = l;
        this.children = [];
        this.childProto = SkribiChild; // for dev memory querying 
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribi: Loading...');
            yield this.loadSettings();
            this.addSettingTab(new SkribosSettingTab(this.app, this));
            this.eta = new EtaHandler(this);
            this.processor = new SkribiProcessor(this);
            this.processor.registerProcessors();
            this.registerEvent(this.app.workspace.on('skribi:template-init-complete', () => {
                this.initLoaded = true;
                this.processor.templatesReady();
            }));
            this.defineCommands();
            this.registerExtensions(['eta'], 'markdown');
            this.suggest = new TemplateSuggest(this);
            this.registerEditorSuggest(this.suggest);
            // registerMirror(this);
            /* Rerender preview views */
            this.app.workspace.onLayoutReady(() => {
                this.app.workspace.getLeavesOfType("markdown").forEach((leaf) => {
                    if (leaf.view.currentMode.type == "preview") {
                        leaf.view.previewMode.rerender(true);
                    }
                });
            });
        });
    }
    /** Register our commands. */
    defineCommands() {
        this.addCommand({ id: "insert-skribi", name: l['command.insert'],
            editorCallback: (editor, view) => {
                if (!this.initLoaded)
                    return;
                let x = new SuggestionModal(this);
                new Promise((resolve, reject) => x.openAndGetValue(resolve, reject))
                    .then(result => {
                    if (this.eta.hasPartial(result)) {
                        let i = new InsertionModal(this, editor, result);
                        i.open();
                    }
                }, (r) => { });
            } });
        this.addCommand({ id: "reload-scripts", name: l['command.reloadScripts'], callback: () => {
                this.eta.bus.scriptLoader.reload().then(() => console.log("Skribi: Reloaded Scripts"));
            } });
        this.addCommand({ id: "reload-skribis", name: "Reload Skribis", callback: () => {
                Array.from(this.children).forEach(child => child.rerender(child === null || child === void 0 ? void 0 : child.templateKey));
            } });
        this.addCommand({ id: "test-performance", name: l['command.perfTest'], callback: () => __awaiter(this, void 0, void 0, function* () {
                var _a, _b;
                let sel = (_b = (_a = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView)) === null || _a === void 0 ? void 0 : _a.editor) === null || _b === void 0 ? void 0 : _b.getSelection();
                let clip = yield window.navigator.clipboard.readText();
                let fill = (sel || clip) ? {
                    type: l[sel ? 'modal.perf.autofill.selection' : 'modal.perf.autofill.clipboard'],
                    value: sel ? sel : clip
                } : null;
                new TestModal(this, fill).open();
            }) });
    }
    onunload() {
        this.eta.unload();
        console.log('Skribi: Unloading...', this.children);
        Array.from(this.children).forEach((child) => {
            let pre = createEl('code', { text: child.source });
            child.containerEl.replaceWith(pre);
            child.unload();
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = SkribosPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5vZGVfbW9kdWxlcy9ldGEvZGlzdC9ldGEuZXMuanMiLCJzcmMvdHlwZXMvY29uc3QudHMiLCJzcmMvdXRpbC50cyIsInNyYy9ldGEvY29tcC50cyIsInNyYy9ldGEvcHJvdmlkZXJfYWJzLnRzIiwic3JjL2V0YS9wcm92aWRlcnMvYmFzZS50cyIsInNyYy9ldGEvcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2LnRzIiwic3JjL2V0YS9wcm92aWRlcnMvaW50ZWdyYXRpb24vd2VhdGhlci50cyIsInNyYy9ldGEvcHJvdmlkZXJzL3NjcmlwdGxvYWRlci50cyIsInNyYy9ldGEvcHJvdmlkZXJfYnVzLnRzIiwic3JjL2V0YS9jYWNoZXIudHMiLCJzcmMvZXRhL3RlbXBsYXRlcy50cyIsInNyYy9ldGEvZXRhLnRzIiwic3JjL2xhbmcvYmFiZWwudHMiLCJzcmMvbW9kYWwvY29uZmlybWF0aW9uTW9kYWwudHMiLCJzcmMvc2V0dGluZ3MudHMiLCJzcmMvcmVuZGVyL3N0eWxlL3BvbHlmaWxsLnRzIiwic3JjL3JlbmRlci9zdHlsZS9zdHlsZS50cyIsInNyYy9yZW5kZXIvY2hpbGQudHMiLCJzcmMvbW9kYWwvc3VnZ2VzdGlvbk1vZGFsLnRzIiwic3JjL3R5cGVzL3R5cGVzLnRzIiwic3JjL21vZGFsL2luc2VydGlvbk1vZGFsLnRzIiwic3JjL21vZGFsL3Rlc3RNb2RhbC50cyIsInNyYy9yZW5kZXIvcmVnZW50LnRzIiwic3JjL3JlbmRlci9lbWJlZC50cyIsInNyYy9yZW5kZXIvcGFyc2UudHMiLCJzcmMvcmVuZGVyL3Byb2Nlc3Nvci50cyIsInNyYy9zdWdnZXN0LnRzIiwic3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcclxufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBvW2syXSA9IG1ba107XHJcbn0pO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcclxuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xyXG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xyXG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcclxufSkgOiBmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIHNldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcclxufVxyXG4iLCJpbXBvcnQgeyBleGlzdHNTeW5jLCByZWFkRmlsZVN5bmMgfSBmcm9tICdmcyc7XG5pbXBvcnQgeyByZXNvbHZlLCBkaXJuYW1lLCBleHRuYW1lIH0gZnJvbSAncGF0aCc7XG5cbi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcblxyXG52YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xuXG5mdW5jdGlvbiBzZXRQcm90b3R5cGVPZihvYmosIHByb3RvKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yob2JqLCBwcm90byk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBvYmouX19wcm90b19fID0gcHJvdG87XHJcbiAgICB9XHJcbn1cclxuLy8gVGhpcyBpcyBwcmV0dHkgbXVjaCB0aGUgb25seSB3YXkgdG8gZ2V0IG5pY2UsIGV4dGVuZGVkIEVycm9yc1xyXG4vLyB3aXRob3V0IHVzaW5nIEVTNlxyXG4vKipcclxuICogVGhpcyByZXR1cm5zIGEgbmV3IEVycm9yIHdpdGggYSBjdXN0b20gcHJvdG90eXBlLiBOb3RlIHRoYXQgaXQncyBfbm90XyBhIGNvbnN0cnVjdG9yXHJcbiAqXHJcbiAqIEBwYXJhbSBtZXNzYWdlIEVycm9yIG1lc3NhZ2VcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogdGhyb3cgRXRhRXJyKFwidGVtcGxhdGUgbm90IGZvdW5kXCIpXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gRXRhRXJyKG1lc3NhZ2UpIHtcclxuICAgIHZhciBlcnIgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgICBzZXRQcm90b3R5cGVPZihlcnIsIEV0YUVyci5wcm90b3R5cGUpO1xyXG4gICAgcmV0dXJuIGVycjtcclxufVxyXG5FdGFFcnIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUsIHtcclxuICAgIG5hbWU6IHsgdmFsdWU6ICdFdGEgRXJyb3InLCBlbnVtZXJhYmxlOiBmYWxzZSB9XHJcbn0pO1xyXG4vKipcclxuICogVGhyb3dzIGFuIEV0YUVyciB3aXRoIGEgbmljZWx5IGZvcm1hdHRlZCBlcnJvciBhbmQgbWVzc2FnZSBzaG93aW5nIHdoZXJlIGluIHRoZSB0ZW1wbGF0ZSB0aGUgZXJyb3Igb2NjdXJyZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBQYXJzZUVycihtZXNzYWdlLCBzdHIsIGluZHgpIHtcclxuICAgIHZhciB3aGl0ZXNwYWNlID0gc3RyLnNsaWNlKDAsIGluZHgpLnNwbGl0KC9cXG4vKTtcclxuICAgIHZhciBsaW5lTm8gPSB3aGl0ZXNwYWNlLmxlbmd0aDtcclxuICAgIHZhciBjb2xObyA9IHdoaXRlc3BhY2VbbGluZU5vIC0gMV0ubGVuZ3RoICsgMTtcclxuICAgIG1lc3NhZ2UgKz1cclxuICAgICAgICAnIGF0IGxpbmUgJyArXHJcbiAgICAgICAgICAgIGxpbmVObyArXHJcbiAgICAgICAgICAgICcgY29sICcgK1xyXG4gICAgICAgICAgICBjb2xObyArXHJcbiAgICAgICAgICAgICc6XFxuXFxuJyArXHJcbiAgICAgICAgICAgICcgICcgK1xyXG4gICAgICAgICAgICBzdHIuc3BsaXQoL1xcbi8pW2xpbmVObyAtIDFdICtcclxuICAgICAgICAgICAgJ1xcbicgK1xyXG4gICAgICAgICAgICAnICAnICtcclxuICAgICAgICAgICAgQXJyYXkoY29sTm8pLmpvaW4oJyAnKSArXHJcbiAgICAgICAgICAgICdeJztcclxuICAgIHRocm93IEV0YUVycihtZXNzYWdlKTtcclxufVxuXG4vKipcclxuICogQHJldHVybnMgVGhlIGdsb2JhbCBQcm9taXNlIGZ1bmN0aW9uXHJcbiAqL1xyXG52YXIgcHJvbWlzZUltcGwgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5Qcm9taXNlO1xyXG4vKipcclxuICogQHJldHVybnMgQSBuZXcgQXN5bmNGdW5jdGlvbiBjb25zdHVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBc3luY0Z1bmN0aW9uQ29uc3RydWN0b3IoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oJ3JldHVybiAoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvcicpKCk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXRhRXJyKFwiVGhpcyBlbnZpcm9ubWVudCBkb2Vzbid0IHN1cHBvcnQgYXN5bmMvYXdhaXRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogc3RyLnRyaW1MZWZ0IHBvbHlmaWxsXHJcbiAqXHJcbiAqIEBwYXJhbSBzdHIgLSBJbnB1dCBzdHJpbmdcclxuICogQHJldHVybnMgVGhlIHN0cmluZyB3aXRoIGxlZnQgd2hpdGVzcGFjZSByZW1vdmVkXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmltTGVmdChzdHIpIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1leHRyYS1ib29sZWFuLWNhc3RcclxuICAgIGlmICghIVN0cmluZy5wcm90b3R5cGUudHJpbUxlZnQpIHtcclxuICAgICAgICByZXR1cm4gc3RyLnRyaW1MZWZ0KCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrLywgJycpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBzdHIudHJpbVJpZ2h0IHBvbHlmaWxsXHJcbiAqXHJcbiAqIEBwYXJhbSBzdHIgLSBJbnB1dCBzdHJpbmdcclxuICogQHJldHVybnMgVGhlIHN0cmluZyB3aXRoIHJpZ2h0IHdoaXRlc3BhY2UgcmVtb3ZlZFxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gdHJpbVJpZ2h0KHN0cikge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV4dHJhLWJvb2xlYW4tY2FzdFxyXG4gICAgaWYgKCEhU3RyaW5nLnByb3RvdHlwZS50cmltUmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gc3RyLnRyaW1SaWdodCgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXHMrJC8sICcnKTsgLy8gVE9ETzogZG8gd2UgcmVhbGx5IG5lZWQgdG8gcmVwbGFjZSBCT00ncz9cclxuICAgIH1cclxufVxuXG4vLyBUT0RPOiBhbGxvdyAnLScgdG8gdHJpbSB1cCB1bnRpbCBuZXdsaW5lLiBVc2UgW15cXFNcXG5cXHJdIGluc3RlYWQgb2YgXFxzXHJcbi8qIEVORCBUWVBFUyAqL1xyXG5mdW5jdGlvbiBoYXNPd25Qcm9wKG9iaiwgcHJvcCkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xyXG59XHJcbmZ1bmN0aW9uIGNvcHlQcm9wcyh0b09iaiwgZnJvbU9iaikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIGZyb21PYmopIHtcclxuICAgICAgICBpZiAoaGFzT3duUHJvcChmcm9tT2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHRvT2JqW2tleV0gPSBmcm9tT2JqW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvT2JqO1xyXG59XHJcbi8qKlxyXG4gKiBUYWtlcyBhIHN0cmluZyB3aXRoaW4gYSB0ZW1wbGF0ZSBhbmQgdHJpbXMgaXQsIGJhc2VkIG9uIHRoZSBwcmVjZWRpbmcgdGFnJ3Mgd2hpdGVzcGFjZSBjb250cm9sIGFuZCBgY29uZmlnLmF1dG9UcmltYFxyXG4gKi9cclxuZnVuY3Rpb24gdHJpbVdTKHN0ciwgY29uZmlnLCB3c0xlZnQsIHdzUmlnaHQpIHtcclxuICAgIHZhciBsZWZ0VHJpbTtcclxuICAgIHZhciByaWdodFRyaW07XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheShjb25maWcuYXV0b1RyaW0pKSB7XHJcbiAgICAgICAgLy8ga2luZGEgY29uZnVzaW5nXHJcbiAgICAgICAgLy8gYnV0IF99fSB3aWxsIHRyaW0gdGhlIGxlZnQgc2lkZSBvZiB0aGUgZm9sbG93aW5nIHN0cmluZ1xyXG4gICAgICAgIGxlZnRUcmltID0gY29uZmlnLmF1dG9UcmltWzFdO1xyXG4gICAgICAgIHJpZ2h0VHJpbSA9IGNvbmZpZy5hdXRvVHJpbVswXTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGxlZnRUcmltID0gcmlnaHRUcmltID0gY29uZmlnLmF1dG9UcmltO1xyXG4gICAgfVxyXG4gICAgaWYgKHdzTGVmdCB8fCB3c0xlZnQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgbGVmdFRyaW0gPSB3c0xlZnQ7XHJcbiAgICB9XHJcbiAgICBpZiAod3NSaWdodCB8fCB3c1JpZ2h0ID09PSBmYWxzZSkge1xyXG4gICAgICAgIHJpZ2h0VHJpbSA9IHdzUmlnaHQ7XHJcbiAgICB9XHJcbiAgICBpZiAoIXJpZ2h0VHJpbSAmJiAhbGVmdFRyaW0pIHtcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG4gICAgaWYgKGxlZnRUcmltID09PSAnc2x1cnAnICYmIHJpZ2h0VHJpbSA9PT0gJ3NsdXJwJykge1xyXG4gICAgICAgIHJldHVybiBzdHIudHJpbSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGxlZnRUcmltID09PSAnXycgfHwgbGVmdFRyaW0gPT09ICdzbHVycCcpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygndHJpbW1pbmcgbGVmdCcgKyBsZWZ0VHJpbSlcclxuICAgICAgICAvLyBmdWxsIHNsdXJwXHJcbiAgICAgICAgc3RyID0gdHJpbUxlZnQoc3RyKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGxlZnRUcmltID09PSAnLScgfHwgbGVmdFRyaW0gPT09ICdubCcpIHtcclxuICAgICAgICAvLyBubCB0cmltXHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL14oPzpcXHJcXG58XFxufFxccikvLCAnJyk7XHJcbiAgICB9XHJcbiAgICBpZiAocmlnaHRUcmltID09PSAnXycgfHwgcmlnaHRUcmltID09PSAnc2x1cnAnKSB7XHJcbiAgICAgICAgLy8gZnVsbCBzbHVycFxyXG4gICAgICAgIHN0ciA9IHRyaW1SaWdodChzdHIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAocmlnaHRUcmltID09PSAnLScgfHwgcmlnaHRUcmltID09PSAnbmwnKSB7XHJcbiAgICAgICAgLy8gbmwgdHJpbVxyXG4gICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC8oPzpcXHJcXG58XFxufFxccikkLywgJycpOyAvLyBUT0RPOiBtYWtlIHN1cmUgdGhpcyBnZXRzIFxcclxcblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0cjtcclxufVxyXG4vKipcclxuICogQSBtYXAgb2Ygc3BlY2lhbCBIVE1MIGNoYXJhY3RlcnMgdG8gdGhlaXIgWE1MLWVzY2FwZWQgZXF1aXZhbGVudHNcclxuICovXHJcbnZhciBlc2NNYXAgPSB7XHJcbiAgICAnJic6ICcmYW1wOycsXHJcbiAgICAnPCc6ICcmbHQ7JyxcclxuICAgICc+JzogJyZndDsnLFxyXG4gICAgJ1wiJzogJyZxdW90OycsXHJcbiAgICBcIidcIjogJyYjMzk7J1xyXG59O1xyXG5mdW5jdGlvbiByZXBsYWNlQ2hhcihzKSB7XHJcbiAgICByZXR1cm4gZXNjTWFwW3NdO1xyXG59XHJcbi8qKlxyXG4gKiBYTUwtZXNjYXBlcyBhbiBpbnB1dCB2YWx1ZSBhZnRlciBjb252ZXJ0aW5nIGl0IHRvIGEgc3RyaW5nXHJcbiAqXHJcbiAqIEBwYXJhbSBzdHIgLSBJbnB1dCB2YWx1ZSAodXN1YWxseSBhIHN0cmluZylcclxuICogQHJldHVybnMgWE1MLWVzY2FwZWQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBYTUxFc2NhcGUoc3RyKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgIC8vIFRvIGRlYWwgd2l0aCBYU1MuIEJhc2VkIG9uIEVzY2FwZSBpbXBsZW1lbnRhdGlvbnMgb2YgTXVzdGFjaGUuSlMgYW5kIE1hcmtvLCB0aGVuIGN1c3RvbWl6ZWQuXHJcbiAgICB2YXIgbmV3U3RyID0gU3RyaW5nKHN0cik7XHJcbiAgICBpZiAoL1smPD5cIiddLy50ZXN0KG5ld1N0cikpIHtcclxuICAgICAgICByZXR1cm4gbmV3U3RyLnJlcGxhY2UoL1smPD5cIiddL2csIHJlcGxhY2VDaGFyKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBuZXdTdHI7XHJcbiAgICB9XHJcbn1cblxuLyogRU5EIFRZUEVTICovXHJcbnZhciB0ZW1wbGF0ZUxpdFJlZyA9IC9gKD86XFxcXFtcXHNcXFNdfFxcJHsoPzpbXnt9XXx7KD86W157fV18e1tefV0qfSkqfSkqfXwoPyFcXCR7KVteXFxcXGBdKSpgL2c7XHJcbnZhciBzaW5nbGVRdW90ZVJlZyA9IC8nKD86XFxcXFtcXHNcXHdcIidcXFxcYF18W15cXG5cXHInXFxcXF0pKj8nL2c7XHJcbnZhciBkb3VibGVRdW90ZVJlZyA9IC9cIig/OlxcXFxbXFxzXFx3XCInXFxcXGBdfFteXFxuXFxyXCJcXFxcXSkqP1wiL2c7XHJcbi8qKiBFc2NhcGUgc3BlY2lhbCByZWd1bGFyIGV4cHJlc3Npb24gY2hhcmFjdGVycyBpbnNpZGUgYSBzdHJpbmcgKi9cclxuZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cmluZykge1xyXG4gICAgLy8gRnJvbSBNRE5cclxuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qK1xcLT9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTsgLy8gJCYgbWVhbnMgdGhlIHdob2xlIG1hdGNoZWQgc3RyaW5nXHJcbn1cclxuZnVuY3Rpb24gcGFyc2Uoc3RyLCBjb25maWcpIHtcclxuICAgIHZhciBidWZmZXIgPSBbXTtcclxuICAgIHZhciB0cmltTGVmdE9mTmV4dFN0ciA9IGZhbHNlO1xyXG4gICAgdmFyIGxhc3RJbmRleCA9IDA7XHJcbiAgICB2YXIgcGFyc2VPcHRpb25zID0gY29uZmlnLnBhcnNlO1xyXG4gICAgaWYgKGNvbmZpZy5wbHVnaW5zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWcucGx1Z2lucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcGx1Z2luID0gY29uZmlnLnBsdWdpbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChwbHVnaW4ucHJvY2Vzc1RlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSBwbHVnaW4ucHJvY2Vzc1RlbXBsYXRlKHN0ciwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qIEFkZGluZyBmb3IgRUpTIGNvbXBhdGliaWxpdHkgKi9cclxuICAgIGlmIChjb25maWcucm1XaGl0ZXNwYWNlKSB7XHJcbiAgICAgICAgLy8gQ29kZSB0YWtlbiBkaXJlY3RseSBmcm9tIEVKU1xyXG4gICAgICAgIC8vIEhhdmUgdG8gdXNlIHR3byBzZXBhcmF0ZSByZXBsYWNlcyBoZXJlIGFzIGBeYCBhbmQgYCRgIG9wZXJhdG9ycyBkb24ndFxyXG4gICAgICAgIC8vIHdvcmsgd2VsbCB3aXRoIGBcXHJgIGFuZCBlbXB0eSBsaW5lcyBkb24ndCB3b3JrIHdlbGwgd2l0aCB0aGUgYG1gIGZsYWcuXHJcbiAgICAgICAgLy8gRXNzZW50aWFsbHksIHRoaXMgcmVwbGFjZXMgdGhlIHdoaXRlc3BhY2UgYXQgdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9mXHJcbiAgICAgICAgLy8gZWFjaCBsaW5lIGFuZCByZW1vdmVzIG11bHRpcGxlIG5ld2xpbmVzLlxyXG4gICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9bXFxyXFxuXSsvZywgJ1xcbicpLnJlcGxhY2UoL15cXHMrfFxccyskL2dtLCAnJyk7XHJcbiAgICB9XHJcbiAgICAvKiBFbmQgcm1XaGl0ZXNwYWNlIG9wdGlvbiAqL1xyXG4gICAgdGVtcGxhdGVMaXRSZWcubGFzdEluZGV4ID0gMDtcclxuICAgIHNpbmdsZVF1b3RlUmVnLmxhc3RJbmRleCA9IDA7XHJcbiAgICBkb3VibGVRdW90ZVJlZy5sYXN0SW5kZXggPSAwO1xyXG4gICAgZnVuY3Rpb24gcHVzaFN0cmluZyhzdHJuZywgc2hvdWxkVHJpbVJpZ2h0T2ZTdHJpbmcpIHtcclxuICAgICAgICBpZiAoc3RybmcpIHtcclxuICAgICAgICAgICAgLy8gaWYgc3RyaW5nIGlzIHRydXRoeSBpdCBtdXN0IGJlIG9mIHR5cGUgJ3N0cmluZydcclxuICAgICAgICAgICAgc3RybmcgPSB0cmltV1Moc3RybmcsIGNvbmZpZywgdHJpbUxlZnRPZk5leHRTdHIsIC8vIHRoaXMgd2lsbCBvbmx5IGJlIGZhbHNlIG9uIHRoZSBmaXJzdCBzdHIsIHRoZSBuZXh0IG9uZXMgd2lsbCBiZSBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgICAgICAgICBzaG91bGRUcmltUmlnaHRPZlN0cmluZyk7XHJcbiAgICAgICAgICAgIGlmIChzdHJuZykge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVwbGFjZSBcXCB3aXRoIFxcXFwsICcgd2l0aCBcXCdcclxuICAgICAgICAgICAgICAgIC8vIHdlJ3JlIGdvaW5nIHRvIGNvbnZlcnQgYWxsIENSTEYgdG8gTEYgc28gaXQgZG9lc24ndCB0YWtlIG1vcmUgdGhhbiBvbmUgcmVwbGFjZVxyXG4gICAgICAgICAgICAgICAgc3RybmcgPSBzdHJuZy5yZXBsYWNlKC9cXFxcfCcvZywgJ1xcXFwkJicpLnJlcGxhY2UoL1xcclxcbnxcXG58XFxyL2csICdcXFxcbicpO1xyXG4gICAgICAgICAgICAgICAgYnVmZmVyLnB1c2goc3RybmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIHByZWZpeGVzID0gW3BhcnNlT3B0aW9ucy5leGVjLCBwYXJzZU9wdGlvbnMuaW50ZXJwb2xhdGUsIHBhcnNlT3B0aW9ucy5yYXddLnJlZHVjZShmdW5jdGlvbiAoYWNjdW11bGF0b3IsIHByZWZpeCkge1xyXG4gICAgICAgIGlmIChhY2N1bXVsYXRvciAmJiBwcmVmaXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yICsgJ3wnICsgZXNjYXBlUmVnRXhwKHByZWZpeCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByZWZpeCkge1xyXG4gICAgICAgICAgICAvLyBhY2N1bXVsYXRvciBpcyBmYWxzeVxyXG4gICAgICAgICAgICByZXR1cm4gZXNjYXBlUmVnRXhwKHByZWZpeCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBwcmVmaXggYW5kIGFjY3VtdWxhdG9yIGFyZSBib3RoIGZhbHN5XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcclxuICAgICAgICB9XHJcbiAgICB9LCAnJyk7XHJcbiAgICB2YXIgcGFyc2VPcGVuUmVnID0gbmV3IFJlZ0V4cCgnKFteXSo/KScgKyBlc2NhcGVSZWdFeHAoY29uZmlnLnRhZ3NbMF0pICsgJygtfF8pP1xcXFxzKignICsgcHJlZml4ZXMgKyAnKT9cXFxccyonLCAnZycpO1xyXG4gICAgdmFyIHBhcnNlQ2xvc2VSZWcgPSBuZXcgUmVnRXhwKCdcXCd8XCJ8YHxcXFxcL1xcXFwqfChcXFxccyooLXxfKT8nICsgZXNjYXBlUmVnRXhwKGNvbmZpZy50YWdzWzFdKSArICcpJywgJ2cnKTtcclxuICAgIC8vIFRPRE86IGJlbmNobWFyayBoYXZpbmcgdGhlIFxccyogb24gZWl0aGVyIHNpZGUgdnMgdXNpbmcgc3RyLnRyaW0oKVxyXG4gICAgdmFyIG07XHJcbiAgICB3aGlsZSAoKG0gPSBwYXJzZU9wZW5SZWcuZXhlYyhzdHIpKSkge1xyXG4gICAgICAgIGxhc3RJbmRleCA9IG1bMF0ubGVuZ3RoICsgbS5pbmRleDtcclxuICAgICAgICB2YXIgcHJlY2VkaW5nU3RyaW5nID0gbVsxXTtcclxuICAgICAgICB2YXIgd3NMZWZ0ID0gbVsyXTtcclxuICAgICAgICB2YXIgcHJlZml4ID0gbVszXSB8fCAnJzsgLy8gYnkgZGVmYXVsdCBlaXRoZXIgfiwgPSwgb3IgZW1wdHlcclxuICAgICAgICBwdXNoU3RyaW5nKHByZWNlZGluZ1N0cmluZywgd3NMZWZ0KTtcclxuICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IGxhc3RJbmRleDtcclxuICAgICAgICB2YXIgY2xvc2VUYWcgPSB2b2lkIDA7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRPYmogPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSAoKGNsb3NlVGFnID0gcGFyc2VDbG9zZVJlZy5leGVjKHN0cikpKSB7XHJcbiAgICAgICAgICAgIGlmIChjbG9zZVRhZ1sxXSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBzdHIuc2xpY2UobGFzdEluZGV4LCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICBwYXJzZU9wZW5SZWcubGFzdEluZGV4ID0gbGFzdEluZGV4ID0gcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICB0cmltTGVmdE9mTmV4dFN0ciA9IGNsb3NlVGFnWzJdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUeXBlID0gcHJlZml4ID09PSBwYXJzZU9wdGlvbnMuZXhlY1xyXG4gICAgICAgICAgICAgICAgICAgID8gJ2UnXHJcbiAgICAgICAgICAgICAgICAgICAgOiBwcmVmaXggPT09IHBhcnNlT3B0aW9ucy5yYXdcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyAncidcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBwcmVmaXggPT09IHBhcnNlT3B0aW9ucy5pbnRlcnBvbGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnaSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJyc7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50T2JqID0geyB0OiBjdXJyZW50VHlwZSwgdmFsOiBjb250ZW50IH07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFyID0gY2xvc2VUYWdbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJy8qJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21tZW50Q2xvc2VJbmQgPSBzdHIuaW5kZXhPZignKi8nLCBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1lbnRDbG9zZUluZCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIGNvbW1lbnQnLCBzdHIsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSBjb21tZW50Q2xvc2VJbmQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSBcIidcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbmdsZVF1b3RlUmVnLmxhc3RJbmRleCA9IGNsb3NlVGFnLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzaW5nbGVRdW90ZU1hdGNoID0gc2luZ2xlUXVvdGVSZWcuZXhlYyhzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaW5nbGVRdW90ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gc2luZ2xlUXVvdGVSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHN0cmluZycsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoYXIgPT09ICdcIicpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb3VibGVRdW90ZVJlZy5sYXN0SW5kZXggPSBjbG9zZVRhZy5pbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZG91YmxlUXVvdGVNYXRjaCA9IGRvdWJsZVF1b3RlUmVnLmV4ZWMoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG91YmxlUXVvdGVNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IGRvdWJsZVF1b3RlUmVnLmxhc3RJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCBzdHJpbmcnLCBzdHIsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAnYCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUxpdFJlZy5sYXN0SW5kZXggPSBjbG9zZVRhZy5pbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVMaXRNYXRjaCA9IHRlbXBsYXRlTGl0UmVnLmV4ZWMoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVMaXRNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IHRlbXBsYXRlTGl0UmVnLmxhc3RJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCBzdHJpbmcnLCBzdHIsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnJlbnRPYmopIHtcclxuICAgICAgICAgICAgYnVmZmVyLnB1c2goY3VycmVudE9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgdGFnJywgc3RyLCBtLmluZGV4ICsgcHJlY2VkaW5nU3RyaW5nLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHVzaFN0cmluZyhzdHIuc2xpY2UobGFzdEluZGV4LCBzdHIubGVuZ3RoKSwgZmFsc2UpO1xyXG4gICAgaWYgKGNvbmZpZy5wbHVnaW5zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWcucGx1Z2lucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcGx1Z2luID0gY29uZmlnLnBsdWdpbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChwbHVnaW4ucHJvY2Vzc0FTVCkge1xyXG4gICAgICAgICAgICAgICAgYnVmZmVyID0gcGx1Z2luLnByb2Nlc3NBU1QoYnVmZmVyLCBjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJ1ZmZlcjtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIENvbXBpbGVzIGEgdGVtcGxhdGUgc3RyaW5nIHRvIGEgZnVuY3Rpb24gc3RyaW5nLiBNb3N0IG9mdGVuIHVzZXJzIGp1c3QgdXNlIGBjb21waWxlKClgLCB3aGljaCBjYWxscyBgY29tcGlsZVRvU3RyaW5nYCBhbmQgY3JlYXRlcyBhIG5ldyBmdW5jdGlvbiB1c2luZyB0aGUgcmVzdWx0XHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGNvbXBpbGVUb1N0cmluZyhcIkhpIDwlPSBpdC51c2VyICU+XCIsIGV0YS5jb25maWcpXHJcbiAqIC8vIFwidmFyIHRSPScnLGluY2x1ZGU9RS5pbmNsdWRlLmJpbmQoRSksaW5jbHVkZUZpbGU9RS5pbmNsdWRlRmlsZS5iaW5kKEUpO3RSKz0nSGkgJzt0Uis9RS5lKGl0LnVzZXIpO2lmKGNiKXtjYihudWxsLHRSKX0gcmV0dXJuIHRSXCJcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjb21waWxlVG9TdHJpbmcoc3RyLCBjb25maWcpIHtcclxuICAgIHZhciBidWZmZXIgPSBwYXJzZShzdHIsIGNvbmZpZyk7XHJcbiAgICB2YXIgcmVzID0gXCJ2YXIgdFI9JycsX19sLF9fbFBcIiArXHJcbiAgICAgICAgKGNvbmZpZy5pbmNsdWRlID8gJyxpbmNsdWRlPUUuaW5jbHVkZS5iaW5kKEUpJyA6ICcnKSArXHJcbiAgICAgICAgKGNvbmZpZy5pbmNsdWRlRmlsZSA/ICcsaW5jbHVkZUZpbGU9RS5pbmNsdWRlRmlsZS5iaW5kKEUpJyA6ICcnKSArXHJcbiAgICAgICAgJ1xcbmZ1bmN0aW9uIGxheW91dChwLGQpe19fbD1wO19fbFA9ZH1cXG4nICtcclxuICAgICAgICAoY29uZmlnLnVzZVdpdGggPyAnd2l0aCgnICsgY29uZmlnLnZhck5hbWUgKyAnfHx7fSl7JyA6ICcnKSArXHJcbiAgICAgICAgY29tcGlsZVNjb3BlKGJ1ZmZlciwgY29uZmlnKSArXHJcbiAgICAgICAgKGNvbmZpZy5pbmNsdWRlRmlsZVxyXG4gICAgICAgICAgICA/ICdpZihfX2wpdFI9JyArXHJcbiAgICAgICAgICAgICAgICAoY29uZmlnLmFzeW5jID8gJ2F3YWl0ICcgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgKFwiaW5jbHVkZUZpbGUoX19sLE9iamVjdC5hc3NpZ24oXCIgKyBjb25maWcudmFyTmFtZSArIFwiLHtib2R5OnRSfSxfX2xQKSlcXG5cIilcclxuICAgICAgICAgICAgOiBjb25maWcuaW5jbHVkZVxyXG4gICAgICAgICAgICAgICAgPyAnaWYoX19sKXRSPScgK1xyXG4gICAgICAgICAgICAgICAgICAgIChjb25maWcuYXN5bmMgPyAnYXdhaXQgJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAgICAgKFwiaW5jbHVkZShfX2wsT2JqZWN0LmFzc2lnbihcIiArIGNvbmZpZy52YXJOYW1lICsgXCIse2JvZHk6dFJ9LF9fbFApKVxcblwiKVxyXG4gICAgICAgICAgICAgICAgOiAnJykgK1xyXG4gICAgICAgICdpZihjYil7Y2IobnVsbCx0Uil9IHJldHVybiB0UicgK1xyXG4gICAgICAgIChjb25maWcudXNlV2l0aCA/ICd9JyA6ICcnKTtcclxuICAgIGlmIChjb25maWcucGx1Z2lucykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnLnBsdWdpbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBsdWdpbiA9IGNvbmZpZy5wbHVnaW5zW2ldO1xyXG4gICAgICAgICAgICBpZiAocGx1Z2luLnByb2Nlc3NGblN0cmluZykge1xyXG4gICAgICAgICAgICAgICAgcmVzID0gcGx1Z2luLnByb2Nlc3NGblN0cmluZyhyZXMsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qKlxyXG4gKiBMb29wcyB0aHJvdWdoIHRoZSBBU1QgZ2VuZXJhdGVkIGJ5IGBwYXJzZWAgYW5kIHRyYW5zZm9ybSBlYWNoIGl0ZW0gaW50byBKUyBjYWxsc1xyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiAvLyBBU1QgdmVyc2lvbiBvZiAnSGkgPCU9IGl0LnVzZXIgJT4nXHJcbiAqIGxldCB0ZW1wbGF0ZUFTVCA9IFsnSGkgJywgeyB2YWw6ICdpdC51c2VyJywgdDogJ2knIH1dXHJcbiAqIGNvbXBpbGVTY29wZSh0ZW1wbGF0ZUFTVCwgZXRhLmNvbmZpZylcclxuICogLy8gXCJ0Uis9J0hpICc7dFIrPUUuZShpdC51c2VyKTtcIlxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGVTY29wZShidWZmLCBjb25maWcpIHtcclxuICAgIHZhciBpID0gMDtcclxuICAgIHZhciBidWZmTGVuZ3RoID0gYnVmZi5sZW5ndGg7XHJcbiAgICB2YXIgcmV0dXJuU3RyID0gJyc7XHJcbiAgICBmb3IgKGk7IGkgPCBidWZmTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgY3VycmVudEJsb2NrID0gYnVmZltpXTtcclxuICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnRCbG9jayA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdmFyIHN0ciA9IGN1cnJlbnRCbG9jaztcclxuICAgICAgICAgICAgLy8gd2Uga25vdyBzdHJpbmcgZXhpc3RzXHJcbiAgICAgICAgICAgIHJldHVyblN0ciArPSBcInRSKz0nXCIgKyBzdHIgKyBcIidcXG5cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB0eXBlID0gY3VycmVudEJsb2NrLnQ7IC8vIH4sIHMsICEsID8sIHJcclxuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBjdXJyZW50QmxvY2sudmFsIHx8ICcnO1xyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByYXdcclxuICAgICAgICAgICAgICAgIGlmIChjb25maWcuZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9ICdFLmZpbHRlcignICsgY29udGVudCArICcpJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVyblN0ciArPSAndFIrPScgKyBjb250ZW50ICsgJ1xcbic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gJ2knKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbnRlcnBvbGF0ZVxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5maWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJ0UuZmlsdGVyKCcgKyBjb250ZW50ICsgJyknO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5hdXRvRXNjYXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9ICdFLmUoJyArIGNvbnRlbnQgKyAnKSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm5TdHIgKz0gJ3RSKz0nICsgY29udGVudCArICdcXG4nO1xyXG4gICAgICAgICAgICAgICAgLy8gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gJ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBleGVjdXRlXHJcbiAgICAgICAgICAgICAgICByZXR1cm5TdHIgKz0gY29udGVudCArICdcXG4nOyAvLyB5b3UgbmVlZCBhIFxcbiBpbiBjYXNlIHlvdSBoYXZlIDwlIH0gJT5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXR1cm5TdHI7XHJcbn1cblxuLyoqXHJcbiAqIEhhbmRsZXMgc3RvcmFnZSBhbmQgYWNjZXNzaW5nIG9mIHZhbHVlc1xyXG4gKlxyXG4gKiBJbiB0aGlzIGNhc2UsIHdlIHVzZSBpdCB0byBzdG9yZSBjb21waWxlZCB0ZW1wbGF0ZSBmdW5jdGlvbnNcclxuICogSW5kZXhlZCBieSB0aGVpciBgbmFtZWAgb3IgYGZpbGVuYW1lYFxyXG4gKi9cclxudmFyIENhY2hlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENhY2hlcihjYWNoZSkge1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWNoZTtcclxuICAgIH1cclxuICAgIENhY2hlci5wcm90b3R5cGUuZGVmaW5lID0gZnVuY3Rpb24gKGtleSwgdmFsKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZVtrZXldID0gdmFsO1xyXG4gICAgfTtcclxuICAgIENhY2hlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIC8vIHN0cmluZyB8IGFycmF5LlxyXG4gICAgICAgIC8vIFRPRE86IGFsbG93IGFycmF5IG9mIGtleXMgdG8gbG9vayBkb3duXHJcbiAgICAgICAgLy8gVE9ETzogY3JlYXRlIHBsdWdpbiB0byBhbGxvdyByZWZlcmVuY2luZyBoZWxwZXJzLCBmaWx0ZXJzIHdpdGggZG90IG5vdGF0aW9uXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVba2V5XTtcclxuICAgIH07XHJcbiAgICBDYWNoZXIucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy5jYWNoZVtrZXldO1xyXG4gICAgfTtcclxuICAgIENhY2hlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IHt9O1xyXG4gICAgfTtcclxuICAgIENhY2hlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChjYWNoZU9iaikge1xyXG4gICAgICAgIGNvcHlQcm9wcyh0aGlzLmNhY2hlLCBjYWNoZU9iaik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENhY2hlcjtcclxufSgpKTtcblxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBFdGEncyB0ZW1wbGF0ZSBzdG9yYWdlXHJcbiAqXHJcbiAqIFN0b3JlcyBwYXJ0aWFscyBhbmQgY2FjaGVkIHRlbXBsYXRlc1xyXG4gKi9cclxudmFyIHRlbXBsYXRlcyA9IG5ldyBDYWNoZXIoe30pO1xuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIEluY2x1ZGUgYSB0ZW1wbGF0ZSBiYXNlZCBvbiBpdHMgbmFtZSAob3IgZmlsZXBhdGgsIGlmIGl0J3MgYWxyZWFkeSBiZWVuIGNhY2hlZCkuXHJcbiAqXHJcbiAqIENhbGxlZCBsaWtlIGBpbmNsdWRlKHRlbXBsYXRlTmFtZU9yUGF0aCwgZGF0YSlgXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlSGVscGVyKHRlbXBsYXRlTmFtZU9yUGF0aCwgZGF0YSkge1xyXG4gICAgdmFyIHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXMuZ2V0KHRlbXBsYXRlTmFtZU9yUGF0aCk7XHJcbiAgICBpZiAoIXRlbXBsYXRlKSB7XHJcbiAgICAgICAgdGhyb3cgRXRhRXJyKCdDb3VsZCBub3QgZmV0Y2ggdGVtcGxhdGUgXCInICsgdGVtcGxhdGVOYW1lT3JQYXRoICsgJ1wiJyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGVtcGxhdGUoZGF0YSwgdGhpcyk7XHJcbn1cclxuLyoqIEV0YSdzIGJhc2UgKGdsb2JhbCkgY29uZmlndXJhdGlvbiAqL1xyXG52YXIgY29uZmlnID0ge1xyXG4gICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgYXV0b0VzY2FwZTogdHJ1ZSxcclxuICAgIGF1dG9UcmltOiBbZmFsc2UsICdubCddLFxyXG4gICAgY2FjaGU6IGZhbHNlLFxyXG4gICAgZTogWE1MRXNjYXBlLFxyXG4gICAgaW5jbHVkZTogaW5jbHVkZUhlbHBlcixcclxuICAgIHBhcnNlOiB7XHJcbiAgICAgICAgZXhlYzogJycsXHJcbiAgICAgICAgaW50ZXJwb2xhdGU6ICc9JyxcclxuICAgICAgICByYXc6ICd+J1xyXG4gICAgfSxcclxuICAgIHBsdWdpbnM6IFtdLFxyXG4gICAgcm1XaGl0ZXNwYWNlOiBmYWxzZSxcclxuICAgIHRhZ3M6IFsnPCUnLCAnJT4nXSxcclxuICAgIHRlbXBsYXRlczogdGVtcGxhdGVzLFxyXG4gICAgdXNlV2l0aDogZmFsc2UsXHJcbiAgICB2YXJOYW1lOiAnaXQnXHJcbn07XHJcbi8qKlxyXG4gKiBUYWtlcyBvbmUgb3IgdHdvIHBhcnRpYWwgKG5vdCBuZWNlc3NhcmlseSBjb21wbGV0ZSkgY29uZmlndXJhdGlvbiBvYmplY3RzLCBtZXJnZXMgdGhlbSAxIGxheWVyIGRlZXAgaW50byBldGEuY29uZmlnLCBhbmQgcmV0dXJucyB0aGUgcmVzdWx0XHJcbiAqXHJcbiAqIEBwYXJhbSBvdmVycmlkZSBQYXJ0aWFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XHJcbiAqIEBwYXJhbSBiYXNlQ29uZmlnIFBhcnRpYWwgY29uZmlndXJhdGlvbiBvYmplY3QgdG8gbWVyZ2UgYmVmb3JlIGBvdmVycmlkZWBcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogbGV0IGN1c3RvbUNvbmZpZyA9IGdldENvbmZpZyh7dGFnczogWychIycsICcjISddfSlcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRDb25maWcob3ZlcnJpZGUsIGJhc2VDb25maWcpIHtcclxuICAgIC8vIFRPRE86IHJ1biBtb3JlIHRlc3RzIG9uIHRoaXNcclxuICAgIHZhciByZXMgPSB7fTsgLy8gTGlua2VkXHJcbiAgICBjb3B5UHJvcHMocmVzLCBjb25maWcpOyAvLyBDcmVhdGVzIGRlZXAgY2xvbmUgb2YgZXRhLmNvbmZpZywgMSBsYXllciBkZWVwXHJcbiAgICBpZiAoYmFzZUNvbmZpZykge1xyXG4gICAgICAgIGNvcHlQcm9wcyhyZXMsIGJhc2VDb25maWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKG92ZXJyaWRlKSB7XHJcbiAgICAgICAgY29weVByb3BzKHJlcywgb3ZlcnJpZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG4vKiogVXBkYXRlIEV0YSdzIGJhc2UgY29uZmlnICovXHJcbmZ1bmN0aW9uIGNvbmZpZ3VyZShvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gY29weVByb3BzKGNvbmZpZywgb3B0aW9ucyk7XHJcbn1cblxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBUYWtlcyBhIHRlbXBsYXRlIHN0cmluZyBhbmQgcmV0dXJucyBhIHRlbXBsYXRlIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIGNhbGxlZCB3aXRoIChkYXRhLCBjb25maWcsIFtjYl0pXHJcbiAqXHJcbiAqIEBwYXJhbSBzdHIgLSBUaGUgdGVtcGxhdGUgc3RyaW5nXHJcbiAqIEBwYXJhbSBjb25maWcgLSBBIGN1c3RvbSBjb25maWd1cmF0aW9uIG9iamVjdCAob3B0aW9uYWwpXHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGxldCBjb21waWxlZEZuID0gZXRhLmNvbXBpbGUoXCJIaSA8JT0gaXQudXNlciAlPlwiKVxyXG4gKiAvLyBmdW5jdGlvbiBhbm9ueW1vdXMoKVxyXG4gKiBsZXQgY29tcGlsZWRGblN0ciA9IGNvbXBpbGVkRm4udG9TdHJpbmcoKVxyXG4gKiAvLyBcImZ1bmN0aW9uIGFub255bW91cyhpdCxFLGNiXFxuKSB7XFxudmFyIHRSPScnLGluY2x1ZGU9RS5pbmNsdWRlLmJpbmQoRSksaW5jbHVkZUZpbGU9RS5pbmNsdWRlRmlsZS5iaW5kKEUpO3RSKz0nSGkgJzt0Uis9RS5lKGl0LnVzZXIpO2lmKGNiKXtjYihudWxsLHRSKX0gcmV0dXJuIHRSXFxufVwiXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gY29tcGlsZShzdHIsIGNvbmZpZykge1xyXG4gICAgdmFyIG9wdGlvbnMgPSBnZXRDb25maWcoY29uZmlnIHx8IHt9KTtcclxuICAgIC8qIEFTWU5DIEhBTkRMSU5HICovXHJcbiAgICAvLyBUaGUgYmVsb3cgY29kZSBpcyBtb2RpZmllZCBmcm9tIG1kZS9lanMuIEFsbCBjcmVkaXQgc2hvdWxkIGdvIHRvIHRoZW0uXHJcbiAgICB2YXIgY3RvciA9IG9wdGlvbnMuYXN5bmMgPyBnZXRBc3luY0Z1bmN0aW9uQ29uc3RydWN0b3IoKSA6IEZ1bmN0aW9uO1xyXG4gICAgLyogRU5EIEFTWU5DIEhBTkRMSU5HICovXHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBuZXcgY3RvcihvcHRpb25zLnZhck5hbWUsICdFJywgLy8gRXRhQ29uZmlnXHJcbiAgICAgICAgJ2NiJywgLy8gb3B0aW9uYWwgY2FsbGJhY2tcclxuICAgICAgICBjb21waWxlVG9TdHJpbmcoc3RyLCBvcHRpb25zKSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3LWZ1bmNcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoJ0JhZCB0ZW1wbGF0ZSBzeW50YXhcXG5cXG4nICtcclxuICAgICAgICAgICAgICAgIGUubWVzc2FnZSArXHJcbiAgICAgICAgICAgICAgICAnXFxuJyArXHJcbiAgICAgICAgICAgICAgICBBcnJheShlLm1lc3NhZ2UubGVuZ3RoICsgMSkuam9pbignPScpICtcclxuICAgICAgICAgICAgICAgICdcXG4nICtcclxuICAgICAgICAgICAgICAgIGNvbXBpbGVUb1N0cmluZyhzdHIsIG9wdGlvbnMpICtcclxuICAgICAgICAgICAgICAgICdcXG4nIC8vIFRoaXMgd2lsbCBwdXQgYW4gZXh0cmEgbmV3bGluZSBiZWZvcmUgdGhlIGNhbGxzdGFjayBmb3IgZXh0cmEgcmVhZGFiaWxpdHlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbnZhciBfQk9NID0gL15cXHVGRUZGLztcclxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBHZXQgdGhlIHBhdGggdG8gdGhlIGluY2x1ZGVkIGZpbGUgZnJvbSB0aGUgcGFyZW50IGZpbGUgcGF0aCBhbmQgdGhlXHJcbiAqIHNwZWNpZmllZCBwYXRoLlxyXG4gKlxyXG4gKiBJZiBgbmFtZWAgZG9lcyBub3QgaGF2ZSBhbiBleHRlbnNpb24sIGl0IHdpbGwgZGVmYXVsdCB0byBgLmV0YWBcclxuICpcclxuICogQHBhcmFtIG5hbWUgc3BlY2lmaWVkIHBhdGhcclxuICogQHBhcmFtIHBhcmVudGZpbGUgcGFyZW50IGZpbGUgcGF0aFxyXG4gKiBAcGFyYW0gaXNEaXJlY3Rvcnkgd2hldGhlciBwYXJlbnRmaWxlIGlzIGEgZGlyZWN0b3J5XHJcbiAqIEByZXR1cm4gYWJzb2x1dGUgcGF0aCB0byB0ZW1wbGF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0V2hvbGVGaWxlUGF0aChuYW1lLCBwYXJlbnRmaWxlLCBpc0RpcmVjdG9yeSkge1xyXG4gICAgdmFyIGluY2x1ZGVQYXRoID0gcmVzb2x2ZShpc0RpcmVjdG9yeSA/IHBhcmVudGZpbGUgOiBkaXJuYW1lKHBhcmVudGZpbGUpLCAvLyByZXR1cm5zIGRpcmVjdG9yeSB0aGUgcGFyZW50IGZpbGUgaXMgaW5cclxuICAgIG5hbWUgLy8gZmlsZVxyXG4gICAgKSArIChleHRuYW1lKG5hbWUpID8gJycgOiAnLmV0YScpO1xyXG4gICAgcmV0dXJuIGluY2x1ZGVQYXRoO1xyXG59XHJcbi8qKlxyXG4gKiBHZXQgdGhlIGFic29sdXRlIHBhdGggdG8gYW4gaW5jbHVkZWQgdGVtcGxhdGVcclxuICpcclxuICogSWYgdGhpcyBpcyBjYWxsZWQgd2l0aCBhbiBhYnNvbHV0ZSBwYXRoIChmb3IgZXhhbXBsZSwgc3RhcnRpbmcgd2l0aCAnLycgb3IgJ0M6XFwnKVxyXG4gKiB0aGVuIEV0YSB3aWxsIGF0dGVtcHQgdG8gcmVzb2x2ZSB0aGUgYWJzb2x1dGUgcGF0aCB3aXRoaW4gb3B0aW9ucy52aWV3cy4gSWYgaXQgY2Fubm90LFxyXG4gKiBFdGEgd2lsbCBmYWxsYmFjayB0byBvcHRpb25zLnJvb3Qgb3IgJy8nXHJcbiAqXHJcbiAqIElmIHRoaXMgaXMgY2FsbGVkIHdpdGggYSByZWxhdGl2ZSBwYXRoLCBFdGEgd2lsbDpcclxuICogLSBMb29rIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IHRlbXBsYXRlIChpZiB0aGUgY3VycmVudCB0ZW1wbGF0ZSBoYXMgdGhlIGBmaWxlbmFtZWAgcHJvcGVydHkpXHJcbiAqIC0gTG9vayBpbnNpZGUgZWFjaCBkaXJlY3RvcnkgaW4gb3B0aW9ucy52aWV3c1xyXG4gKlxyXG4gKiBOb3RlOiBpZiBFdGEgaXMgdW5hYmxlIHRvIGZpbmQgYSB0ZW1wbGF0ZSB1c2luZyBwYXRoIGFuZCBvcHRpb25zLCBpdCB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aCAgICBzcGVjaWZpZWQgcGF0aFxyXG4gKiBAcGFyYW0gb3B0aW9ucyBjb21waWxhdGlvbiBvcHRpb25zXHJcbiAqIEByZXR1cm4gYWJzb2x1dGUgcGF0aCB0byB0ZW1wbGF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UGF0aChwYXRoLCBvcHRpb25zKSB7XHJcbiAgICB2YXIgaW5jbHVkZVBhdGggPSBmYWxzZTtcclxuICAgIHZhciB2aWV3cyA9IG9wdGlvbnMudmlld3M7XHJcbiAgICB2YXIgc2VhcmNoZWRQYXRocyA9IFtdO1xyXG4gICAgLy8gSWYgdGhlc2UgZm91ciB2YWx1ZXMgYXJlIHRoZSBzYW1lLFxyXG4gICAgLy8gZ2V0UGF0aCgpIHdpbGwgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdCBldmVyeSB0aW1lLlxyXG4gICAgLy8gV2UgY2FuIGNhY2hlIHRoZSByZXN1bHQgdG8gYXZvaWQgZXhwZW5zaXZlXHJcbiAgICAvLyBmaWxlIG9wZXJhdGlvbnMuXHJcbiAgICB2YXIgcGF0aE9wdGlvbnMgPSBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgZmlsZW5hbWU6IG9wdGlvbnMuZmlsZW5hbWUsXHJcbiAgICAgICAgcGF0aDogcGF0aCxcclxuICAgICAgICByb290OiBvcHRpb25zLnJvb3QsXHJcbiAgICAgICAgdmlld3M6IG9wdGlvbnMudmlld3NcclxuICAgIH0pO1xyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUgJiYgb3B0aW9ucy5maWxlcGF0aENhY2hlICYmIG9wdGlvbnMuZmlsZXBhdGhDYWNoZVtwYXRoT3B0aW9uc10pIHtcclxuICAgICAgICAvLyBVc2UgdGhlIGNhY2hlZCBmaWxlcGF0aFxyXG4gICAgICAgIHJldHVybiBvcHRpb25zLmZpbGVwYXRoQ2FjaGVbcGF0aE9wdGlvbnNdO1xyXG4gICAgfVxyXG4gICAgLyoqIEFkZCBhIGZpbGVwYXRoIHRvIHRoZSBsaXN0IG9mIHBhdGhzIHdlJ3ZlIGNoZWNrZWQgZm9yIGEgdGVtcGxhdGUgKi9cclxuICAgIGZ1bmN0aW9uIGFkZFBhdGhUb1NlYXJjaGVkKHBhdGhTZWFyY2hlZCkge1xyXG4gICAgICAgIGlmICghc2VhcmNoZWRQYXRocy5pbmNsdWRlcyhwYXRoU2VhcmNoZWQpKSB7XHJcbiAgICAgICAgICAgIHNlYXJjaGVkUGF0aHMucHVzaChwYXRoU2VhcmNoZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGFrZSBhIGZpbGVwYXRoIChsaWtlICdwYXJ0aWFscy9teXBhcnRpYWwuZXRhJykuIEF0dGVtcHQgdG8gZmluZCB0aGUgdGVtcGxhdGUgZmlsZSBpbnNpZGUgYHZpZXdzYDtcclxuICAgICAqIHJldHVybiB0aGUgcmVzdWx0aW5nIHRlbXBsYXRlIGZpbGUgcGF0aCwgb3IgYGZhbHNlYCB0byBpbmRpY2F0ZSB0aGF0IHRoZSB0ZW1wbGF0ZSB3YXMgbm90IGZvdW5kLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2aWV3cyB0aGUgZmlsZXBhdGggdGhhdCBob2xkcyB0ZW1wbGF0ZXMsIG9yIGFuIGFycmF5IG9mIGZpbGVwYXRocyB0aGF0IGhvbGQgdGVtcGxhdGVzXHJcbiAgICAgKiBAcGFyYW0gcGF0aCB0aGUgcGF0aCB0byB0aGUgdGVtcGxhdGVcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gc2VhcmNoVmlld3Modmlld3MsIHBhdGgpIHtcclxuICAgICAgICB2YXIgZmlsZVBhdGg7XHJcbiAgICAgICAgLy8gSWYgdmlld3MgaXMgYW4gYXJyYXksIHRoZW4gbG9vcCB0aHJvdWdoIGVhY2ggZGlyZWN0b3J5XHJcbiAgICAgICAgLy8gQW5kIGF0dGVtcHQgdG8gZmluZCB0aGUgdGVtcGxhdGVcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2aWV3cykgJiZcclxuICAgICAgICAgICAgdmlld3Muc29tZShmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAgICAgZmlsZVBhdGggPSBnZXRXaG9sZUZpbGVQYXRoKHBhdGgsIHYsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgYWRkUGF0aFRvU2VhcmNoZWQoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4aXN0c1N5bmMoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICB9KSkge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgYWJvdmUgcmV0dXJuZWQgdHJ1ZSwgd2Uga25vdyB0aGF0IHRoZSBmaWxlUGF0aCB3YXMganVzdCBzZXQgdG8gYSBwYXRoXHJcbiAgICAgICAgICAgIC8vIFRoYXQgZXhpc3RzIChBcnJheS5zb21lKCkgcmV0dXJucyBhcyBzb29uIGFzIGl0IGZpbmRzIGEgdmFsaWQgZWxlbWVudClcclxuICAgICAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2Ygdmlld3MgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIC8vIFNlYXJjaCBmb3IgdGhlIGZpbGUgaWYgdmlld3MgaXMgYSBzaW5nbGUgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgIGZpbGVQYXRoID0gZ2V0V2hvbGVGaWxlUGF0aChwYXRoLCB2aWV3cywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGFkZFBhdGhUb1NlYXJjaGVkKGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgaWYgKGV4aXN0c1N5bmMoZmlsZVBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsZVBhdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVW5hYmxlIHRvIGZpbmQgYSBmaWxlXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gUGF0aCBzdGFydHMgd2l0aCAnLycsICdDOlxcJywgZXRjLlxyXG4gICAgdmFyIG1hdGNoID0gL15bQS1aYS16XSs6XFxcXHxeXFwvLy5leGVjKHBhdGgpO1xyXG4gICAgLy8gQWJzb2x1dGUgcGF0aCwgbGlrZSAvcGFydGlhbHMvcGFydGlhbC5ldGFcclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaC5sZW5ndGgpIHtcclxuICAgICAgICAvLyBXZSBoYXZlIHRvIHRyaW0gdGhlIGJlZ2lubmluZyAnLycgb2ZmIHRoZSBwYXRoLCBvciBlbHNlXHJcbiAgICAgICAgLy8gcGF0aC5yZXNvbHZlKGRpciwgcGF0aCkgd2lsbCBhbHdheXMgcmVzb2x2ZSB0byBqdXN0IHBhdGhcclxuICAgICAgICB2YXIgZm9ybWF0dGVkUGF0aCA9IHBhdGgucmVwbGFjZSgvXlxcLyovLCAnJyk7XHJcbiAgICAgICAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHRoZSBwYXRoIHdpdGhpbiBvcHRpb25zLnZpZXdzXHJcbiAgICAgICAgaW5jbHVkZVBhdGggPSBzZWFyY2hWaWV3cyh2aWV3cywgZm9ybWF0dGVkUGF0aCk7XHJcbiAgICAgICAgaWYgKCFpbmNsdWRlUGF0aCkge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGF0IGZhaWxzLCBzZWFyY2hWaWV3cyB3aWxsIHJldHVybiBmYWxzZS4gVHJ5IHRvIGZpbmQgdGhlIHBhdGhcclxuICAgICAgICAgICAgLy8gaW5zaWRlIG9wdGlvbnMucm9vdCAoYnkgZGVmYXVsdCAnLycsIHRoZSBiYXNlIG9mIHRoZSBmaWxlc3lzdGVtKVxyXG4gICAgICAgICAgICB2YXIgcGF0aEZyb21Sb290ID0gZ2V0V2hvbGVGaWxlUGF0aChmb3JtYXR0ZWRQYXRoLCBvcHRpb25zLnJvb3QgfHwgJy8nLCB0cnVlKTtcclxuICAgICAgICAgICAgYWRkUGF0aFRvU2VhcmNoZWQocGF0aEZyb21Sb290KTtcclxuICAgICAgICAgICAgaW5jbHVkZVBhdGggPSBwYXRoRnJvbVJvb3Q7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gUmVsYXRpdmUgcGF0aHNcclxuICAgICAgICAvLyBMb29rIHJlbGF0aXZlIHRvIGEgcGFzc2VkIGZpbGVuYW1lIGZpcnN0XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZmlsZW5hbWUpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGVQYXRoID0gZ2V0V2hvbGVGaWxlUGF0aChwYXRoLCBvcHRpb25zLmZpbGVuYW1lKTtcclxuICAgICAgICAgICAgYWRkUGF0aFRvU2VhcmNoZWQoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGluY2x1ZGVQYXRoID0gZmlsZVBhdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVGhlbiBsb29rIGZvciB0aGUgdGVtcGxhdGUgaW4gb3B0aW9ucy52aWV3c1xyXG4gICAgICAgIGlmICghaW5jbHVkZVBhdGgpIHtcclxuICAgICAgICAgICAgaW5jbHVkZVBhdGggPSBzZWFyY2hWaWV3cyh2aWV3cywgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaW5jbHVkZVBhdGgpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXRhRXJyKCdDb3VsZCBub3QgZmluZCB0aGUgdGVtcGxhdGUgXCInICsgcGF0aCArICdcIi4gUGF0aHMgdHJpZWQ6ICcgKyBzZWFyY2hlZFBhdGhzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBJZiBjYWNoaW5nIGFuZCBmaWxlcGF0aENhY2hlIGFyZSBlbmFibGVkLFxyXG4gICAgLy8gY2FjaGUgdGhlIGlucHV0ICYgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24uXHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLmZpbGVwYXRoQ2FjaGUpIHtcclxuICAgICAgICBvcHRpb25zLmZpbGVwYXRoQ2FjaGVbcGF0aE9wdGlvbnNdID0gaW5jbHVkZVBhdGg7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5jbHVkZVBhdGg7XHJcbn1cclxuLyoqXHJcbiAqIFJlYWRzIGEgZmlsZSBzeW5jaHJvbm91c2x5XHJcbiAqL1xyXG5mdW5jdGlvbiByZWFkRmlsZShmaWxlUGF0aCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gcmVhZEZpbGVTeW5jKGZpbGVQYXRoKS50b1N0cmluZygpLnJlcGxhY2UoX0JPTSwgJycpOyAvLyBUT0RPOiBpcyByZXBsYWNpbmcgQk9NJ3MgbmVjZXNzYXJ5P1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgdGhyb3cgRXRhRXJyKFwiRmFpbGVkIHRvIHJlYWQgdGVtcGxhdGUgYXQgJ1wiICsgZmlsZVBhdGggKyBcIidcIik7XHJcbiAgICB9XHJcbn1cblxuLy8gZXhwcmVzcyBpcyBzZXQgbGlrZTogYXBwLmVuZ2luZSgnaHRtbCcsIHJlcXVpcmUoJ2V0YScpLnJlbmRlckZpbGUpXHJcbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogUmVhZHMgYSB0ZW1wbGF0ZSwgY29tcGlsZXMgaXQgaW50byBhIGZ1bmN0aW9uLCBjYWNoZXMgaXQgaWYgY2FjaGluZyBpc24ndCBkaXNhYmxlZCwgcmV0dXJucyB0aGUgZnVuY3Rpb25cclxuICpcclxuICogQHBhcmFtIGZpbGVQYXRoIEFic29sdXRlIHBhdGggdG8gdGVtcGxhdGUgZmlsZVxyXG4gKiBAcGFyYW0gb3B0aW9ucyBFdGEgY29uZmlndXJhdGlvbiBvdmVycmlkZXNcclxuICogQHBhcmFtIG5vQ2FjaGUgT3B0aW9uYWxseSwgbWFrZSBFdGEgbm90IGNhY2hlIHRoZSB0ZW1wbGF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gbG9hZEZpbGUoZmlsZVBhdGgsIG9wdGlvbnMsIG5vQ2FjaGUpIHtcclxuICAgIHZhciBjb25maWcgPSBnZXRDb25maWcob3B0aW9ucyk7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSByZWFkRmlsZShmaWxlUGF0aCk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBjb21waWxlZFRlbXBsYXRlID0gY29tcGlsZSh0ZW1wbGF0ZSwgY29uZmlnKTtcclxuICAgICAgICBpZiAoIW5vQ2FjaGUpIHtcclxuICAgICAgICAgICAgY29uZmlnLnRlbXBsYXRlcy5kZWZpbmUoY29uZmlnLmZpbGVuYW1lLCBjb21waWxlZFRlbXBsYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvbXBpbGVkVGVtcGxhdGU7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IEV0YUVycignTG9hZGluZyBmaWxlOiAnICsgZmlsZVBhdGggKyAnIGZhaWxlZDpcXG5cXG4nICsgZS5tZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IHRoZSB0ZW1wbGF0ZSBmcm9tIGEgc3RyaW5nIG9yIGEgZmlsZSwgZWl0aGVyIGNvbXBpbGVkIG9uLXRoZS1mbHkgb3JcclxuICogcmVhZCBmcm9tIGNhY2hlIChpZiBlbmFibGVkKSwgYW5kIGNhY2hlIHRoZSB0ZW1wbGF0ZSBpZiBuZWVkZWQuXHJcbiAqXHJcbiAqIElmIGBvcHRpb25zLmNhY2hlYCBpcyB0cnVlLCB0aGlzIGZ1bmN0aW9uIHJlYWRzIHRoZSBmaWxlIGZyb21cclxuICogYG9wdGlvbnMuZmlsZW5hbWVgIHNvIGl0IG11c3QgYmUgc2V0IHByaW9yIHRvIGNhbGxpbmcgdGhpcyBmdW5jdGlvbi5cclxuICpcclxuICogQHBhcmFtIG9wdGlvbnMgICBjb21waWxhdGlvbiBvcHRpb25zXHJcbiAqIEByZXR1cm4gRXRhIHRlbXBsYXRlIGZ1bmN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVDYWNoZShvcHRpb25zKSB7XHJcbiAgICB2YXIgZmlsZW5hbWUgPSBvcHRpb25zLmZpbGVuYW1lO1xyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUpIHtcclxuICAgICAgICB2YXIgZnVuYyA9IG9wdGlvbnMudGVtcGxhdGVzLmdldChmaWxlbmFtZSk7XHJcbiAgICAgICAgaWYgKGZ1bmMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsb2FkRmlsZShmaWxlbmFtZSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgICAvLyBDYWNoaW5nIGlzIGRpc2FibGVkLCBzbyBwYXNzIG5vQ2FjaGUgPSB0cnVlXHJcbiAgICByZXR1cm4gbG9hZEZpbGUoZmlsZW5hbWUsIG9wdGlvbnMsIHRydWUpO1xyXG59XHJcbi8qKlxyXG4gKiBUcnkgY2FsbGluZyBoYW5kbGVDYWNoZSB3aXRoIHRoZSBnaXZlbiBvcHRpb25zIGFuZCBkYXRhIGFuZCBjYWxsIHRoZVxyXG4gKiBjYWxsYmFjayB3aXRoIHRoZSByZXN1bHQuIElmIGFuIGVycm9yIG9jY3VycywgY2FsbCB0aGUgY2FsbGJhY2sgd2l0aFxyXG4gKiB0aGUgZXJyb3IuIFVzZWQgYnkgcmVuZGVyRmlsZSgpLlxyXG4gKlxyXG4gKiBAcGFyYW0gZGF0YSB0ZW1wbGF0ZSBkYXRhXHJcbiAqIEBwYXJhbSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHBhcmFtIGNiIGNhbGxiYWNrXHJcbiAqL1xyXG5mdW5jdGlvbiB0cnlIYW5kbGVDYWNoZShkYXRhLCBvcHRpb25zLCBjYikge1xyXG4gICAgaWYgKGNiKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gTm90ZTogaWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcmVuZGVyaW5nIHRoZSB0ZW1wbGF0ZSxcclxuICAgICAgICAgICAgLy8gSXQgd2lsbCBidWJibGUgdXAgYW5kIGJlIGNhdWdodCBoZXJlXHJcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZUZuID0gaGFuZGxlQ2FjaGUob3B0aW9ucyk7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlRm4oZGF0YSwgb3B0aW9ucywgY2IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjYihlcnIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIE5vIGNhbGxiYWNrLCB0cnkgcmV0dXJuaW5nIGEgcHJvbWlzZVxyXG4gICAgICAgIGlmICh0eXBlb2YgcHJvbWlzZUltcGwgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBwcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZUZuID0gaGFuZGxlQ2FjaGUob3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRlbXBsYXRlRm4oZGF0YSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IEV0YUVycihcIlBsZWFzZSBwcm92aWRlIGEgY2FsbGJhY2sgZnVuY3Rpb24sIHRoaXMgZW52IGRvZXNuJ3Qgc3VwcG9ydCBQcm9taXNlc1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEdldCB0aGUgdGVtcGxhdGUgZnVuY3Rpb24uXHJcbiAqXHJcbiAqIElmIGBvcHRpb25zLmNhY2hlYCBpcyBgdHJ1ZWAsIHRoZW4gdGhlIHRlbXBsYXRlIGlzIGNhY2hlZC5cclxuICpcclxuICogVGhpcyByZXR1cm5zIGEgdGVtcGxhdGUgZnVuY3Rpb24gYW5kIHRoZSBjb25maWcgb2JqZWN0IHdpdGggd2hpY2ggdGhhdCB0ZW1wbGF0ZSBmdW5jdGlvbiBzaG91bGQgYmUgY2FsbGVkLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKlxyXG4gKiBJdCdzIGltcG9ydGFudCB0aGF0IHRoaXMgcmV0dXJucyBhIGNvbmZpZyBvYmplY3Qgd2l0aCBgZmlsZW5hbWVgIHNldC5cclxuICogT3RoZXJ3aXNlLCB0aGUgaW5jbHVkZWQgZmlsZSB3b3VsZCBub3QgYmUgYWJsZSB0byB1c2UgcmVsYXRpdmUgcGF0aHNcclxuICpcclxuICogQHBhcmFtIHBhdGggcGF0aCBmb3IgdGhlIHNwZWNpZmllZCBmaWxlIChpZiByZWxhdGl2ZSwgc3BlY2lmeSBgdmlld3NgIG9uIGBvcHRpb25zYClcclxuICogQHBhcmFtIG9wdGlvbnMgY29tcGlsYXRpb24gb3B0aW9uc1xyXG4gKiBAcmV0dXJuIFtFdGEgdGVtcGxhdGUgZnVuY3Rpb24sIG5ldyBjb25maWcgb2JqZWN0XVxyXG4gKi9cclxuZnVuY3Rpb24gaW5jbHVkZUZpbGUocGF0aCwgb3B0aW9ucykge1xyXG4gICAgLy8gdGhlIGJlbG93IGNyZWF0ZXMgYSBuZXcgb3B0aW9ucyBvYmplY3QsIHVzaW5nIHRoZSBwYXJlbnQgZmlsZXBhdGggb2YgdGhlIG9sZCBvcHRpb25zIG9iamVjdCBhbmQgdGhlIHBhdGhcclxuICAgIHZhciBuZXdGaWxlT3B0aW9ucyA9IGdldENvbmZpZyh7IGZpbGVuYW1lOiBnZXRQYXRoKHBhdGgsIG9wdGlvbnMpIH0sIG9wdGlvbnMpO1xyXG4gICAgLy8gVE9ETzogbWFrZSBzdXJlIHByb3BlcnRpZXMgYXJlIGN1cnJlY3RseSBjb3BpZWQgb3ZlclxyXG4gICAgcmV0dXJuIFtoYW5kbGVDYWNoZShuZXdGaWxlT3B0aW9ucyksIG5ld0ZpbGVPcHRpb25zXTtcclxufVxyXG5mdW5jdGlvbiByZW5kZXJGaWxlKGZpbGVuYW1lLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICAvKlxyXG4gICAgSGVyZSB3ZSBoYXZlIHNvbWUgZnVuY3Rpb24gb3ZlcmxvYWRpbmcuXHJcbiAgICBFc3NlbnRpYWxseSwgdGhlIGZpcnN0IDIgYXJndW1lbnRzIHRvIHJlbmRlckZpbGUgc2hvdWxkIGFsd2F5cyBiZSB0aGUgZmlsZW5hbWUgYW5kIGRhdGFcclxuICAgIEhvd2V2ZXIsIHdpdGggRXhwcmVzcywgY29uZmlndXJhdGlvbiBvcHRpb25zIHdpbGwgYmUgcGFzc2VkIGFsb25nIHdpdGggdGhlIGRhdGEuXHJcbiAgICBUaHVzLCBFeHByZXNzIHdpbGwgY2FsbCByZW5kZXJGaWxlIHdpdGggKGZpbGVuYW1lLCBkYXRhQW5kT3B0aW9ucywgY2IpXHJcbiAgICBBbmQgd2Ugd2FudCB0byBhbHNvIG1ha2UgKGZpbGVuYW1lLCBkYXRhLCBvcHRpb25zLCBjYikgYXZhaWxhYmxlXHJcbiAgICAqL1xyXG4gICAgdmFyIHJlbmRlckNvbmZpZztcclxuICAgIHZhciBjYWxsYmFjaztcclxuICAgIGRhdGEgPSBkYXRhIHx8IHt9OyAvLyBJZiBkYXRhIGlzIHVuZGVmaW5lZCwgd2UgZG9uJ3Qgd2FudCBhY2Nlc3NpbmcgZGF0YS5zZXR0aW5ncyB0byBlcnJvclxyXG4gICAgLy8gRmlyc3QsIGFzc2lnbiBvdXIgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYGNhbGxiYWNrYFxyXG4gICAgLy8gV2UgY2FuIGxlYXZlIGl0IHVuZGVmaW5lZCBpZiBuZWl0aGVyIHBhcmFtZXRlciBpcyBhIGZ1bmN0aW9uO1xyXG4gICAgLy8gQ2FsbGJhY2tzIGFyZSBvcHRpb25hbFxyXG4gICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIC8vIFRoZSA0dGggYXJndW1lbnQgaXMgdGhlIGNhbGxiYWNrXHJcbiAgICAgICAgY2FsbGJhY2sgPSBjYjtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBjb25maWcgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAvLyBUaGUgM3JkIGFyZyBpcyB0aGUgY2FsbGJhY2tcclxuICAgICAgICBjYWxsYmFjayA9IGNvbmZpZztcclxuICAgIH1cclxuICAgIC8vIElmIHRoZXJlIGlzIGEgY29uZmlnIG9iamVjdCBwYXNzZWQgaW4gZXhwbGljaXRseSwgdXNlIGl0XHJcbiAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICByZW5kZXJDb25maWcgPSBnZXRDb25maWcoY29uZmlnIHx8IHt9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIE90aGVyd2lzZSwgZ2V0IHRoZSBjb25maWcgZnJvbSB0aGUgZGF0YSBvYmplY3RcclxuICAgICAgICAvLyBBbmQgdGhlbiBncmFiIHNvbWUgY29uZmlnIG9wdGlvbnMgZnJvbSBkYXRhLnNldHRpbmdzXHJcbiAgICAgICAgLy8gV2hpY2ggaXMgd2hlcmUgRXhwcmVzcyBzb21ldGltZXMgc3RvcmVzIHRoZW1cclxuICAgICAgICByZW5kZXJDb25maWcgPSBnZXRDb25maWcoZGF0YSk7XHJcbiAgICAgICAgaWYgKGRhdGEuc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgLy8gUHVsbCBhIGZldyB0aGluZ3MgZnJvbSBrbm93biBsb2NhdGlvbnNcclxuICAgICAgICAgICAgaWYgKGRhdGEuc2V0dGluZ3Mudmlld3MpIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlckNvbmZpZy52aWV3cyA9IGRhdGEuc2V0dGluZ3Mudmlld3M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRhdGEuc2V0dGluZ3NbJ3ZpZXcgY2FjaGUnXSkge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyQ29uZmlnLmNhY2hlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBVbmRvY3VtZW50ZWQgYWZ0ZXIgRXhwcmVzcyAyLCBidXQgc3RpbGwgdXNhYmxlLCBlc3AuIGZvclxyXG4gICAgICAgICAgICAvLyBpdGVtcyB0aGF0IGFyZSB1bnNhZmUgdG8gYmUgcGFzc2VkIGFsb25nIHdpdGggZGF0YSwgbGlrZSBgcm9vdGBcclxuICAgICAgICAgICAgdmFyIHZpZXdPcHRzID0gZGF0YS5zZXR0aW5nc1sndmlldyBvcHRpb25zJ107XHJcbiAgICAgICAgICAgIGlmICh2aWV3T3B0cykge1xyXG4gICAgICAgICAgICAgICAgY29weVByb3BzKHJlbmRlckNvbmZpZywgdmlld09wdHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gU2V0IHRoZSBmaWxlbmFtZSBvcHRpb24gb24gdGhlIHRlbXBsYXRlXHJcbiAgICAvLyBUaGlzIHdpbGwgZmlyc3QgdHJ5IHRvIHJlc29sdmUgdGhlIGZpbGUgcGF0aCAoc2VlIGdldFBhdGggZm9yIGRldGFpbHMpXHJcbiAgICByZW5kZXJDb25maWcuZmlsZW5hbWUgPSBnZXRQYXRoKGZpbGVuYW1lLCByZW5kZXJDb25maWcpO1xyXG4gICAgcmV0dXJuIHRyeUhhbmRsZUNhY2hlKGRhdGEsIHJlbmRlckNvbmZpZywgY2FsbGJhY2spO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckZpbGVBc3luYyhmaWxlbmFtZSwgZGF0YSwgY29uZmlnLCBjYikge1xyXG4gICAgcmV0dXJuIHJlbmRlckZpbGUoZmlsZW5hbWUsIHR5cGVvZiBjb25maWcgPT09ICdmdW5jdGlvbicgPyBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGF0YSksIHsgYXN5bmM6IHRydWUgfSkgOiBkYXRhLCB0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0JyA/IF9fYXNzaWduKF9fYXNzaWduKHt9LCBjb25maWcpLCB7IGFzeW5jOiB0cnVlIH0pIDogY29uZmlnLCBjYik7XHJcbn1cblxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBDYWxsZWQgd2l0aCBgaW5jbHVkZUZpbGUocGF0aCwgZGF0YSlgXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlRmlsZUhlbHBlcihwYXRoLCBkYXRhKSB7XHJcbiAgICB2YXIgdGVtcGxhdGVBbmRDb25maWcgPSBpbmNsdWRlRmlsZShwYXRoLCB0aGlzKTtcclxuICAgIHJldHVybiB0ZW1wbGF0ZUFuZENvbmZpZ1swXShkYXRhLCB0ZW1wbGF0ZUFuZENvbmZpZ1sxXSk7XHJcbn1cblxuLyogRU5EIFRZUEVTICovXHJcbmZ1bmN0aW9uIGhhbmRsZUNhY2hlJDEodGVtcGxhdGUsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zLmNhY2hlICYmIG9wdGlvbnMubmFtZSAmJiBvcHRpb25zLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKSkge1xyXG4gICAgICAgIHJldHVybiBvcHRpb25zLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKTtcclxuICAgIH1cclxuICAgIHZhciB0ZW1wbGF0ZUZ1bmMgPSB0eXBlb2YgdGVtcGxhdGUgPT09ICdmdW5jdGlvbicgPyB0ZW1wbGF0ZSA6IGNvbXBpbGUodGVtcGxhdGUsIG9wdGlvbnMpO1xyXG4gICAgLy8gTm90ZSB0aGF0IHdlIGRvbid0IGhhdmUgdG8gY2hlY2sgaWYgaXQgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGNhY2hlO1xyXG4gICAgLy8gaXQgd291bGQgaGF2ZSByZXR1cm5lZCBlYXJsaWVyIGlmIGl0IGhhZFxyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUgJiYgb3B0aW9ucy5uYW1lKSB7XHJcbiAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZXMuZGVmaW5lKG9wdGlvbnMubmFtZSwgdGVtcGxhdGVGdW5jKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wbGF0ZUZ1bmM7XHJcbn1cclxuLyoqXHJcbiAqIFJlbmRlciBhIHRlbXBsYXRlXHJcbiAqXHJcbiAqIElmIGB0ZW1wbGF0ZWAgaXMgYSBzdHJpbmcsIEV0YSB3aWxsIGNvbXBpbGUgaXQgdG8gYSBmdW5jdGlvbiBhbmQgdGhlbiBjYWxsIGl0IHdpdGggdGhlIHByb3ZpZGVkIGRhdGEuXHJcbiAqIElmIGB0ZW1wbGF0ZWAgaXMgYSB0ZW1wbGF0ZSBmdW5jdGlvbiwgRXRhIHdpbGwgY2FsbCBpdCB3aXRoIHRoZSBwcm92aWRlZCBkYXRhLlxyXG4gKlxyXG4gKiBJZiBgY29uZmlnLmFzeW5jYCBpcyBgZmFsc2VgLCBFdGEgd2lsbCByZXR1cm4gdGhlIHJlbmRlcmVkIHRlbXBsYXRlLlxyXG4gKlxyXG4gKiBJZiBgY29uZmlnLmFzeW5jYCBpcyBgdHJ1ZWAgYW5kIHRoZXJlJ3MgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgY2FsbCB0aGUgY2FsbGJhY2sgd2l0aCBgKGVyciwgcmVuZGVyZWRUZW1wbGF0ZSlgLlxyXG4gKiBJZiBgY29uZmlnLmFzeW5jYCBpcyBgdHJ1ZWAgYW5kIHRoZXJlJ3Mgbm90IGEgY2FsbGJhY2sgZnVuY3Rpb24sIEV0YSB3aWxsIHJldHVybiBhIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVuZGVyZWQgdGVtcGxhdGUuXHJcbiAqXHJcbiAqIElmIGBjb25maWcuY2FjaGVgIGlzIGB0cnVlYCBhbmQgYGNvbmZpZ2AgaGFzIGEgYG5hbWVgIG9yIGBmaWxlbmFtZWAgcHJvcGVydHksIEV0YSB3aWxsIGNhY2hlIHRoZSB0ZW1wbGF0ZSBvbiB0aGUgZmlyc3QgcmVuZGVyIGFuZCB1c2UgdGhlIGNhY2hlZCB0ZW1wbGF0ZSBmb3IgYWxsIHN1YnNlcXVlbnQgcmVuZGVycy5cclxuICpcclxuICogQHBhcmFtIHRlbXBsYXRlIFRlbXBsYXRlIHN0cmluZyBvciB0ZW1wbGF0ZSBmdW5jdGlvblxyXG4gKiBAcGFyYW0gZGF0YSBEYXRhIHRvIHJlbmRlciB0aGUgdGVtcGxhdGUgd2l0aFxyXG4gKiBAcGFyYW0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZyBvcHRpb25zXHJcbiAqIEBwYXJhbSBjYiBDYWxsYmFjayBmdW5jdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gcmVuZGVyKHRlbXBsYXRlLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGdldENvbmZpZyhjb25maWcgfHwge30pO1xyXG4gICAgaWYgKG9wdGlvbnMuYXN5bmMpIHtcclxuICAgICAgICBpZiAoY2IpIHtcclxuICAgICAgICAgICAgLy8gSWYgdXNlciBwYXNzZXMgY2FsbGJhY2tcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IGlmIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIHJlbmRlcmluZyB0aGUgdGVtcGxhdGUsXHJcbiAgICAgICAgICAgICAgICAvLyBJdCB3aWxsIGJ1YmJsZSB1cCBhbmQgYmUgY2F1Z2h0IGhlcmVcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZUZuID0gaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZUZuKGRhdGEsIG9wdGlvbnMsIGNiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2IoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTm8gY2FsbGJhY2ssIHRyeSByZXR1cm5pbmcgYSBwcm9taXNlXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvbWlzZUltcGwgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcHJvbWlzZUltcGwoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucykoZGF0YSwgb3B0aW9ucykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXRhRXJyKFwiUGxlYXNlIHByb3ZpZGUgYSBjYWxsYmFjayBmdW5jdGlvbiwgdGhpcyBlbnYgZG9lc24ndCBzdXBwb3J0IFByb21pc2VzXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGhhbmRsZUNhY2hlJDEodGVtcGxhdGUsIG9wdGlvbnMpKGRhdGEsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZW5kZXIgYSB0ZW1wbGF0ZSBhc3luY2hyb25vdXNseVxyXG4gKlxyXG4gKiBJZiBgdGVtcGxhdGVgIGlzIGEgc3RyaW5nLCBFdGEgd2lsbCBjb21waWxlIGl0IHRvIGEgZnVuY3Rpb24gYW5kIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIGl0IHdpdGggdGhlIHByb3ZpZGVkIGRhdGEuXHJcbiAqXHJcbiAqIElmIHRoZXJlIGlzIGEgY2FsbGJhY2sgZnVuY3Rpb24sIEV0YSB3aWxsIGNhbGwgaXQgd2l0aCBgKGVyciwgcmVuZGVyZWRUZW1wbGF0ZSlgLlxyXG4gKiBJZiB0aGVyZSBpcyBub3QgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZW5kZXJlZCB0ZW1wbGF0ZVxyXG4gKlxyXG4gKiBAcGFyYW0gdGVtcGxhdGUgVGVtcGxhdGUgc3RyaW5nIG9yIHRlbXBsYXRlIGZ1bmN0aW9uXHJcbiAqIEBwYXJhbSBkYXRhIERhdGEgdG8gcmVuZGVyIHRoZSB0ZW1wbGF0ZSB3aXRoXHJcbiAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlnIG9wdGlvbnNcclxuICogQHBhcmFtIGNiIENhbGxiYWNrIGZ1bmN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJBc3luYyh0ZW1wbGF0ZSwgZGF0YSwgY29uZmlnLCBjYikge1xyXG4gICAgLy8gVXNpbmcgT2JqZWN0LmFzc2lnbiB0byBsb3dlciBidW5kbGUgc2l6ZSwgdXNpbmcgc3ByZWFkIG9wZXJhdG9yIG1ha2VzIGl0IGxhcmdlciBiZWNhdXNlIG9mIHR5cGVzY3JpcHQgaW5qZWN0ZWQgcG9seWZpbGxzXHJcbiAgICByZXR1cm4gcmVuZGVyKHRlbXBsYXRlLCBkYXRhLCBPYmplY3QuYXNzaWduKHt9LCBjb25maWcsIHsgYXN5bmM6IHRydWUgfSksIGNiKTtcclxufVxuXG4vLyBAZGVub2lmeS1pZ25vcmVcclxuY29uZmlnLmluY2x1ZGVGaWxlID0gaW5jbHVkZUZpbGVIZWxwZXI7XHJcbmNvbmZpZy5maWxlcGF0aENhY2hlID0ge307XG5cbmV4cG9ydCB7IHJlbmRlckZpbGUgYXMgX19leHByZXNzLCBjb21waWxlLCBjb21waWxlVG9TdHJpbmcsIGNvbmZpZywgY29uZmlndXJlLCBjb25maWcgYXMgZGVmYXVsdENvbmZpZywgZ2V0Q29uZmlnLCBsb2FkRmlsZSwgcGFyc2UsIHJlbmRlciwgcmVuZGVyQXN5bmMsIHJlbmRlckZpbGUsIHJlbmRlckZpbGVBc3luYywgdGVtcGxhdGVzIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ldGEuZXMuanMubWFwXG4iLCJpbXBvcnQgeyBBcmdTZXQgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IFZBUl9OQU1FOiBzdHJpbmcgPSAnc2snXHJcblxyXG5leHBvcnQgY29uc3QgREVMSU1JVEVSUzogQXJnU2V0ID0ge1xyXG5cdFwiUEFTU19WQUxVRVwiOiBbXCI6XCJdXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBTS19ERVBUSF9MSU1JVCA9IDU7XHJcblxyXG5leHBvcnQgY29uc3QgZW51bSBNb2RlcyB7XHJcblx0Z2VuZXJhbCA9IFwiR0VORVJBTFwiLFxyXG5cdGJsb2NrID0gXCJCTE9DS1wiLFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZW51bSBGbGFncyB7XHJcblx0bm9uZSA9IDAsXHJcblx0dGVtcGxhdGUgPSAxLFxyXG5cdGludGVycCA9IDIsXHJcblx0cmF3ID0gMyxcclxuXHRsaXRlcmFsID0gNCxcclxuXHRldmFsID0gNVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgRUJBUiA9IGBcXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cXG5gIiwiaW1wb3J0IHsgQXBwLCBNYXJrZG93blZpZXcsIG5vcm1hbGl6ZVBhdGgsIFRBYnN0cmFjdEZpbGUsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBFQkFSIH0gZnJvbSBcIi4vdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcIi4vdHlwZXMvdHlwZXNcIjtcclxuXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuXHRpbnRlcmZhY2UgRWxlbWVudCB7XHJcblx0XHRhZGRDbGF6eih0aGlzOiBFbGVtZW50LCBzdHI6IHN0cmluZyB8IHN0cmluZ1tdKTogdm9pZDtcclxuXHRcdGFkZENsYXp6KHRoaXM6IEVsZW1lbnQsIC4uLnN0cjogc3RyaW5nW10pOiB2b2lkO1xyXG5cdH1cclxufVxyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuYWRkQ2xhenogPSBmdW5jdGlvbiAoc3RyOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xyXG5cdGlmIChBcnJheS5pc0FycmF5KHN0cikpIHtcclxuXHRcdHRoaXMuYWRkQ2xhc3MoLi4uc3RyKVxyXG5cdH0gZWxzZSB0aGlzLmFkZENsYXNzKHN0cilcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVBcnJheTxUPihvYmo6IFQgfCBUW10pOiBBcnJheTxUPiB7XHJcblx0cmV0dXJuIEFycmF5LmlzQXJyYXkob2JqKSA/IG9iaiA6IFtvYmpdXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlcyhhcHA6IEFwcCwgZGlyOiBzdHJpbmcpOiBURmlsZVtdIHtcclxuXHRsZXQgZGlyUGF0aCA9IG5vcm1hbGl6ZVBhdGgoZGlyKVxyXG5cdGxldCBmbyA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGlyUGF0aCk7XHJcblxyXG5cdGlmICghZm8gfHwgIShmbyBpbnN0YW5jZW9mIFRGb2xkZXIpKSB0aHJvdyBgU2tyaWJpOiBDb3VsZCBub3QgZmluZCBmb2xkZXIgJyR7ZGlyUGF0aH0nYDtcclxuXHJcblx0bGV0IGZpbGVzOiBURmlsZVtdID0gW107XHJcblx0VmF1bHQucmVjdXJzZUNoaWxkcmVuKGZvLCAoZmkpID0+IHtcclxuXHRcdGlmIChmaSBpbnN0YW5jZW9mIFRGaWxlKSBmaWxlcy5wdXNoKGZpKVxyXG5cdH0pXHJcblxyXG5cdC8vIGNvbnNvbGUubG9nKGZpbGVzKVxyXG5cdHJldHVybiBmaWxlcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrRmlsZUV4dChmaWxlczogVEZpbGVbXSB8IFRGaWxlLCBleHRzOiBzdHJpbmdbXSB8IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGV4dHMgPSB0b0FycmF5KGV4dHMpOyBcclxuXHRyZXR1cm4gdG9BcnJheShmaWxlcykuZXZlcnkoKGYpID0+IHtyZXR1cm4gZXh0cy5jb250YWlucyhmLmV4dGVuc2lvbil9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyRmlsZUV4dChmaWxlczogVEZpbGVbXSB8IFRGaWxlLCBleHRzOiBzdHJpbmdbXSB8IHN0cmluZyk6IFRGaWxlW10ge1xyXG5cdGV4dHMgPSB0b0FycmF5KGV4dHMpXHJcblx0cmV0dXJuIHRvQXJyYXkoZmlsZXMpLmZpbHRlcigoZikgPT4ge2lmIChjaGVja0ZpbGVFeHQoZiwgZXh0cykpIHJldHVybiBmfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQXJyYXkoYXJnczogYW55IHwgYW55W10pOiBhbnlbXSB7XHJcblx0cmV0dXJuIChBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6IFthcmdzXSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSW5Gb2xkZXIoZTogVEFic3RyYWN0RmlsZSwgZGlyOiBzdHJpbmcpIHtcclxuXHRsZXQgYm9vID0gKG5vcm1hbGl6ZVBhdGgoKC8uK1xcLy9nKS5leGVjKGUucGF0aClbMF0pID09IG5vcm1hbGl6ZVBhdGgoZGlyKSlcclxuXHJcblx0cmV0dXJuIGJvb1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRhbnQob2JqOiBhbnkpIHtcclxuXHRyZXR1cm4gISgob2JqID09PSBudWxsICkgfHwgKG9iaiA9PT0gdW5kZWZpbmVkKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJvdW5kVG8oeDogYW55LCB0bz86IG51bWJlcik6IG51bWJlciB7XHJcbiAgcmV0dXJuIHBhcnNlRmxvYXQocGFyc2VGbG9hdCh4KS50b1ByZWNpc2lvbih0byA/PyA0KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFZlcmJvc2l0eSgpIHtcclxuXHQvL0B0cy1pZ25vcmVcclxuXHRyZXR1cm4gd2luZG93LmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJvYnNpZGlhbi1za3JpYmlcIl0/LnNldHRpbmdzLnZlcmJvc2VMb2dnaW5nIHx8IGZhbHNlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdkxvZyguLi5hcmdzOiBhbnlbXSkge1xyXG5cdGlmIChnZXRWZXJib3NpdHkoKSkge1xyXG5cdFx0Y29uc29sZS5sb2coXCJTa3JpYmk6XCIsIC4uLmFyZ3MgKVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZXYXJuKC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0aWYgKGdldFZlcmJvc2l0eSgpKSB7XHJcblx0XHRjb25zb2xlLndhcm4oXCJTa3JpYmk6XCIsIC4uLmFyZ3MpXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZExvZyguLi5hcmdzOiBhbnlbXSkge1xyXG5cdC8vQHRzLWlnbm9yZVxyXG5cdGlmICh3aW5kb3c/LmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJvYnNpZGlhbi1za3JpYmlcIl0/LnNldHRpbmdzPy5kZXZMb2dnaW5nIHx8IGZhbHNlKSB7XHJcblx0XHRjb25zb2xlLmxvZyguLi5hcmdzKVxyXG5cdH1cclxufVxyXG5cclxuLyogVGFrZXMgYW4gYXJyYXkgb2Ygc3RyaW5ncyBhbmQgcmV0dXJucyBhIHJlY29yZCBvZiBrZXkvdmFsdWUgcGFpcnMgZm9yIGVhY2gsIHdoZXJlIHRoZSBrZXkgYW5kIHZhbHVlIGFyZSB0aGUgc2FtZSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9EdXBlUmVjb3JkKGFycjogc3RyaW5nW10pOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcclxuICByZXR1cm4gYXJyLnJlZHVjZSgoYSwgaSkgPT4gKHsuLi5hLCBbaV06IGl9KSwge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPilcclxufVxyXG5cclxuLyoqIFxyXG4gKiBAcGFyYW0gaW5wdXQgQW4gb2JqZWN0IHRvIGNsb25lXHJcbiAqIEBwYXJhbSBrZXlzIFRoZSBrZXlzIG9mIHByb3BlcnRpZXMgdG8gb21pdCBmcm9tIHRoZSBjbG9uZVxyXG4gKiBAcmV0dXJucyBBIGNsb25lIG9mICdpbnB1dCcgd2l0aG91dCB0aGUgb21pdHRlZCBwcm9wZXJ0aWVzICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRob3V0S2V5PFQgZXh0ZW5kcyB7IFtLIGluIGtleW9mIFRdOiBzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2wgfT4oaW5wdXQ6IHtbaW5kZXg6IHN0cmluZ106IGFueX0sIGtleTogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICBjb25zdCBjbG9uZSA9IHsgLi4uaW5wdXQgfTtcclxuICBpZiAoQXJyYXkuaXNBcnJheShrZXkpKSB7XHJcbiAgICAgIChrZXkgYXMgc3RyaW5nW10pLmZvckVhY2goKGspID0+IHtcclxuICAgICAgICAgIGRlbGV0ZSBjbG9uZVtrXVxyXG4gICAgICB9KVxyXG4gIH0gZWxzZSB7IGRlbGV0ZSBjbG9uZVtrZXldIH1cclxuICByZXR1cm4gY2xvbmU7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhc3luY0Z1bmMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvclxyXG5leHBvcnQgY29uc3QgcHJvbWlzZUltcGw6IFByb21pc2VDb25zdHJ1Y3RvciA9IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLlByb21pc2VcclxuZXhwb3J0IGNvbnN0IGdldEFzeW5jQ29uc3RydWN0b3IgPSAoKTogRnVuY3Rpb25Db25zdHJ1Y3RvciA9PiBuZXcgRnVuY3Rpb24oJ3JldHVybiAoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvcicpKClcclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0gQXBwXHJcbiAqIEBwYXJhbSBmbGlwIElmIHRydWUsIHRhcmdldCBpcyBlZGl0b3IgbW9kZS4gT3RoZXJ3aXNlLCB0YXJnZXQgaXMgcHJldmlldyBtb2RlLlxyXG4gKiBAcmV0dXJucyBGaXJzdCBtYXJrZG93biB2aWV3IG9mIHRhcmdldCBtb2RlIHdpdGggc2FtZSBmaWxlIGFzIGFjdGl2ZSB2aWV3LCBvciBhY3RpdmUgdmlldyBpZiBub25lIHdhcyBmb3VuZC4gTnVsbCBpZiBubyBhY3RpdmUgdmlldyBleGlzdHMuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmV2aWV3VmlldyhhcHA6IEFwcCwgZmxpcD86IGJvb2xlYW4pOiBNYXJrZG93blZpZXcgfCBudWxsIHtcclxuXHRsZXQgdDEgPSBmbGlwID8gXCJwcmV2aWV3XCIgOiBcInNvdXJjZVwiXHJcblx0bGV0IHQyID0gZmxpcCA/IFwic291cmNlXCIgOiBcInByZXZpZXdcIlxyXG5cclxuXHR0cnkge1xyXG5cdHZhciB2aWV3ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblx0aWYgKHZpZXcuZ2V0TW9kZSgpID09IHQxKSB7XHJcblx0XHRhcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcIm1hcmtkb3duXCIpLmZvckVhY2goKGxlYWYpID0+IHtcclxuXHRcdFx0aWYgKChsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3KS5nZXRNb2RlKCkgPT0gdDIpIHtcclxuXHRcdFx0XHRsZXQgeiA9IChsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3KS5wcmV2aWV3TW9kZVxyXG5cdFx0XHRcdGlmICh6LmdldEZpbGUoKSA9PSB2aWV3LmZpbGUpIHtcclxuXHRcdFx0XHRcdHZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdH1cclxuXHR9IGNhdGNoIChlKSB7XHJcblxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHZpZXcgfHwgbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGlzRnVuYyA9IChmdW5jOiBhbnkpOiBmdW5jIGlzIEZ1bmN0aW9uID0+IChmdW5jIGluc3RhbmNlb2YgRnVuY3Rpb24pXHJcbmV4cG9ydCBjb25zdCBpc0ZpbGUgPSAoaXRlbTogYW55KTogaXRlbSBpcyBURmlsZSA9PiAoaXRlbSkgaW5zdGFuY2VvZiBURmlsZTsgXHJcblxyXG5mdW5jdGlvbiBpbnZva2VNZXRob2RPZkFuZFJldHVybjxUPihmdW5jOiBrZXlvZiBULCBvYmplY3RzOiBTdHJpbmdkZXg8VD4pIHtcclxuICBsZXQgcmV0czogU3RyaW5nZGV4ID0ge307XHJcbiAgZm9yIChsZXQgbyBvZiBPYmplY3QuZW50cmllcyhvYmplY3RzKSkge1xyXG4gICAgaWYgKChvICE9IG51bGwpICYmIChpc0Z1bmMob1tmdW5jXSkpKSB7XHJcbiAgICAgIHJldHNbb1swXV0gPSAob1sxXVtmdW5jXSBhcyBGdW5jdGlvbikoKVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gcmV0c1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBOb25VbmRlZmluZWQ8QT4gPSBBIGV4dGVuZHMgdW5kZWZpbmVkID8gbmV2ZXIgOiBBO1xyXG5leHBvcnQgdHlwZSBGdW5jdGlvbktleXM8VCBleHRlbmRzIG9iamVjdD4gPSB7XHJcbiAgW0sgaW4ga2V5b2YgVF0tPzogTm9uVW5kZWZpbmVkPFRbS10+IGV4dGVuZHMgRnVuY3Rpb24gPyBLIDogbmV2ZXI7XHJcbn1ba2V5b2YgVF07XHJcblxyXG50eXBlIFBhcmFtZXRlcnNPZjxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueSkgPT4gYW55PiA9IHtcclxuXHRbUCBpbiBrZXlvZiBQYXJhbWV0ZXJzPFQ+XS0/OiBQYXJhbWV0ZXJzPFQ+fVtrZXlvZiBUXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnZva2VNZXRob2RPZjxUPihmdW5jOiBrZXlvZiBULCAuLi5vYmplY3RzOiBUW10pIHtcclxuXHRmb3IgKGxldCBvIG9mIG9iamVjdHMpIHtcclxuICAgIGlmICgobyAhPSBudWxsKSAmJiAoaXNGdW5jKG9bZnVuY10pKSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIChvW2Z1bmNdIGFzIHVua25vd24gYXMgRnVuY3Rpb24pKClcclxuICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYGludm9rZU1ldGhvZE9mOiBjYXVnaHQgZXJyb3IhIFxcbmAsIGBLZXkgY2FsbGVkIGFzIG1ldGhvZDpgLCBmdW5jLCAgYENhbGxlZCBvbjpgLCBvLCBgRXJyb3I6YCwgZXJyKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW52b2tlTWV0aG9kV2l0aDxUIGV4dGVuZHMgb2JqZWN0PihvYmplY3RzOiBUIHwgVFtdLCBrZXk6IEZ1bmN0aW9uS2V5czxUPiwgLi4uYXJnczogLyogUGFyYW1ldGVyc09mPFRba2V5XT4gKi8gYW55W10pOiB2b2lkIHtcclxuXHRmb3IgKGxldCBvIG9mIGVuc3VyZUFycmF5KG9iamVjdHMpKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHQob1trZXldIGFzIHVua25vd24gYXMgRnVuY3Rpb24pKC4uLmFyZ3MpXHJcblx0XHR9IGNhdGNoKGVycikge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oYGludm9rZU1ldGhvZFdpdGg6IGNhdWdodCBlcnJvciEgXFxuIEtleTogJyR7a2V5fScgY2FsbGVkIG9uOmAsIG8sIEVCQVIsIGVycilcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhdmVyYWdlKC4uLm51bWJlcnM6IG51bWJlcltdKSB7XHJcbiAgcmV0dXJuIG51bWJlcnMucmVkdWNlKCh2YWwsIGN1cikgPT4gdmFsK2N1cikvbnVtYmVycy5sZW5ndGhcclxufVxyXG5cclxuLyogR2V0IGxpbmsgdG8gZG9jdW1lbnRhdGlvbiBwYWdlLiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbGlua0RvY3MocGFnZTogc3RyaW5nKSB7XHJcblx0Ly8gcmV0dXJuIGBodHRwczovL2F6dWxhbG9pLm5ldC9vYnNpZGlhbi1za3JpYmkvJHtwYWdlfWBcclxuXHRyZXR1cm4gYGh0dHBzOi8vYXp1bGFsb2kuZ2l0aHViLmlvL29ic2lkaWFuLXNrcmliaS8ke3BhZ2V9YFxyXG59XHJcblxyXG4vKiBQcmVmaXhlcyBzdHJpbmcgd2l0aCBwbHVnaW4gbmFtZS4gTWFrZXMgcmV1c2luZyBjb2RlIGFjcm9zcyBwbHVnaW5zIGVhc2llci4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGtscyhjbHM6IHN0cmluZykge3JldHVybiBgc2tyaWJpLSR7Y2xzfWB9XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzaChzdHI6IHN0cmluZykge1xyXG5cdGxldCBoYXNoID0gNTM4MTtcclxuXHRsZXQgaSA9IHN0ci5sZW5ndGg7XHJcblx0d2hpbGUgKGkpIHtcclxuXHRcdGhhc2ggPSAoaGFzaCAqIDMzKSBeIHN0ci5jaGFyQ29kZUF0KC0taSk7XHJcblx0fVxyXG5cdHJldHVybiBoYXNoID4+PiAwO1xyXG59IiwiaW1wb3J0ICogYXMgRXRhIGZyb20gXCJldGFcIjtcclxuaW1wb3J0IHsgUGFydGlhbENvbmZpZyB9IGZyb20gXCJldGEvZGlzdC90eXBlcy9jb25maWdcIlxyXG5pbXBvcnQgeyBDYWxsYmFja0ZuIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2ZpbGUtaGFuZGxlcnNcIlxyXG5pbXBvcnQgeyBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBzY29wZWRWYXJzIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiXHJcbmltcG9ydCB7IGRMb2csIGdldEFzeW5jQ29uc3RydWN0b3IsIHByb21pc2VJbXBsIH0gZnJvbSBcInNyYy91dGlsXCJcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gXCIuL2V0YVwiXHJcblxyXG4vKiogQWRkcyB0aGUgZW50cmllcyBvZiBzY29wZSB0byBhIGZ1bmN0aW9uIHN0cmluZy4gXHJcbiogQHBhcmFtIGZ1bmN0aW9uU3RyaW5nIEEgc3RyaW5nIGZ1bmN0aW9uIGNvbXBpbGVkIGJ5IEV0YSdzIGNvbXBpbGVUb1N0cmluZygpIFxyXG4qIEBwYXJhbSBrZXlzIEFycmF5IG9mIGtleXMgdGhhdCB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gd2lsbCBleHBlY3QgdG8gYmUgcHJlc2VudCBpbiBpdHMgc2NvcGUgYXJndW1lbnRcclxuKiBAcGFyYW0gYXN5bmMgSWYgdHJ1ZSwgcmV0dXJuZWQgZnVuY3Rpb24gd2lsbCBiZSBhc3luY2hyb25vdXMgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVXaXRoKGZ1bmN0aW9uU3RyaW5nOiBzdHJpbmcsIGtleXM6IHN0cmluZ1tdLCBhc3luYz86IGJvb2xlYW4pOiBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIHtcclxuICB2YXIgYSA9IFwiXCI7IHZhciBiID0gXCJcIjtcclxuICBmb3IgKGxldCBrIG9mIGtleXMpIHtcclxuICAgIGEgKz0gYCR7a30sYFxyXG4gICAgYiArPSBgJyR7a30nLGBcclxuICB9XHJcbiAgbGV0IGZ1bmMgPSBgdmFyIHske2Euc3Vic3RyKDAsIGEubGVuZ3RoLTEpfX0gPSBzY29wZTtcXG5gICsgZnVuY3Rpb25TdHJpbmdcclxuICBsZXQgY29uc3RydWN0b3IgPSAoYXN5bmMpID8gZ2V0QXN5bmNDb25zdHJ1Y3RvcigpIDogRnVuY3Rpb24gXHJcbiAgbGV0IGNvbXBpbGVkID0gbmV3IGNvbnN0cnVjdG9yKCdzY29wZScsIGZ1bmMpXHJcbiAgcmV0dXJuIGNvbXBpbGVkIGFzIFRlbXBsYXRlRnVuY3Rpb25TY29wZWRcclxufVxyXG5cclxuLyogVmVyc2lvbiBvZiBFdGEncyByZW5kZXIgZnVuY3Rpb24sIG1vZGlmaWVkIHRvIGhhbmRsZSBzY29wZWQgdGVtcGxhdGVzICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJFdGEoXHJcbiAgaGFuZGxlcjogRXRhSGFuZGxlcixcclxuICB0ZW1wbGF0ZTogc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCxcclxuICBkYXRhOiBvYmplY3QsXHJcbiAgY29uZmlnPzogUGFydGlhbENvbmZpZyxcclxuICBjYj86IENhbGxiYWNrRm4sXHJcbiAgc2NvcGU/OiBzY29wZWRWYXJzLFxyXG4gIGJpbmRlcj86IGFueVxyXG4gICk6IHN0cmluZyB8IFByb21pc2U8c3RyaW5nPiB8IHZvaWQge1xyXG4gIGNvbnN0IG9wdGlvbnMgPSBFdGEuZ2V0Q29uZmlnKGNvbmZpZyB8fCB7fSlcclxuXHJcbiAgaWYgKG9wdGlvbnMuYXN5bmMpIHtcclxuICAgIC8vIGlmIChjYikge1xyXG4gICAgICAvLyB0cnkgeyBcclxuICAgICAgICAvLyBjb25zdCB0ZW1wbGF0ZUZuID0gaGFuZGxlci5nZXRDYWNoZWQodGVtcGxhdGUsIG9wdGlvbnMsIHNjb3BlLCBiaW5kZXIpXHJcbiAgICAgICAgLy8gdGVtcGxhdGVGbihzY29wZSlcclxuICAgICAgLy8gfSBjYXRjaChlKSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGNiKGUpXHJcbiAgICAgIC8vIH1cclxuICAgIC8vIH0gZWxzZSB7XHJcblxyXG4gICAgICAvLyByZXR1cm4gKGFzeW5jICgpID0+IGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKShzY29wZSkpKClcclxuICAgICAgcmV0dXJuIG5ldyBwcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZTogRnVuY3Rpb24sIHJlamVjdDogRnVuY3Rpb24pIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgcmVzb2x2ZShoYW5kbGVyLmdldENhY2hlZCh0ZW1wbGF0ZSwgb3B0aW9ucywgc2NvcGUsIGJpbmRlcikoc2NvcGUpKVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIHJlamVjdChlKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIC8vIH1cclxuICB9IGVsc2Uge1xyXG4gICAgbGV0IGZ1bmMgPSBoYW5kbGVyLmdldENhY2hlZCh0ZW1wbGF0ZSwgb3B0aW9ucywgc2NvcGUsIGJpbmRlcilcclxuICAgIGRMb2coYFJlbmRlcmluZyBmdW5jdGlvbmAsIGZ1bmMpXHJcbiAgICByZXR1cm4gZnVuYyhzY29wZSlcclxuICB9XHJcbn1cclxuXHJcbi8qIFZlcnNpb24gb2YgRXRhJ3MgYXN5bmMgcmVuZGVyIGZ1bmN0aW9uLCBqdXN0IHNldHMgYXN5bmMgdG8gdHJ1ZSAqL1xyXG4vKiBOb3RlOiBwZXJmIGltcGFjdCBvZiB1c2luZyBhc3luYyB0ZW1wbGF0ZWZ1bmN0aW9ucyBpcyBuZWdsaWdpYmxlICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJFdGFBc3luYyhcclxuICBoYW5kbGVyOiBFdGFIYW5kbGVyLFxyXG4gIHRlbXBsYXRlOiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLFxyXG4gIGRhdGE6IG9iamVjdCxcclxuICBjb25maWc/OiBQYXJ0aWFsQ29uZmlnLFxyXG4gIGNiPzogQ2FsbGJhY2tGbixcclxuICBzY29wZT86IHNjb3BlZFZhcnMsXHJcbiAgYmluZGVyPzogYW55XHJcbiAgKTogc3RyaW5nIHwgUHJvbWlzZTxzdHJpbmc+IHwgdm9pZCB7XHJcbiAgICByZXR1cm4gcmVuZGVyRXRhKGhhbmRsZXIsIHRlbXBsYXRlLCBkYXRhLCBPYmplY3QuYXNzaWduKHt9LCBjb25maWcsIHthc3luYzogdHJ1ZX0pLCBjYiwgc2NvcGUsIGJpbmRlcilcclxufVxyXG5cclxuIiwiaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFN0cmluZ2RleCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgaXNFeHRhbnQgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJCdXMgfSBmcm9tIFwiLi9wcm92aWRlcl9idXNcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVByb3ZpZGVyIHtcclxuICBpZDogc3RyaW5nXHJcbiAgYnVzOiBQcm92aWRlckJ1c1xyXG4gIGZ1bmN0aW9uczogTWFwPHN0cmluZywgYW55PjtcclxuICBjcmVhdGVPYmplY3QoKTogU3RyaW5nZGV4O1xyXG4gIGluaXQoKTogUHJvbWlzZTx2b2lkPjsgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGVkIG9uY2UsIG9uIGJ1cyBsb2FkXHJcbiAgdW5sb2FkKCk6IHZvaWQ7ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGxlZCBvbmNlLCBvbiBidXMgdW5sb2FkXHJcbiAgcmVsb2FkKCk6IFByb21pc2U8YW55PjsgICAgICAgICAgICAgICAgIC8vIE1heSBiZSBjYWxsZWQgbXVsdGlwbGUgdGltZXNcclxuXHJcbiAgc2V0RGlydHkoKTogdm9pZDtcclxuICBwb3N0RGlydHk/KCk6IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQcm92aWRlciBpbXBsZW1lbnRzIElQcm92aWRlciB7XHJcbiAgaWQ6IHN0cmluZ1xyXG4gIGJ1czogUHJvdmlkZXJCdXM7XHJcbiAgZnVuY3Rpb25zOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpXHJcbiAgaW5pdExvYWRlZCA9IGZhbHNlO1xyXG4gIGlzRGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoYnVzOiBQcm92aWRlckJ1cywgaWQ6IHN0cmluZykge1xyXG4gICAgdGhpcy5idXMgPSBidXNcclxuICAgIHRoaXMuaWQgPSBpZFxyXG4gIH1cclxuXHJcbiAgW2luZGV4OiBzdHJpbmddOiBhbnk7XHJcblxyXG4gIGNyZWF0ZU9iamVjdCgpOiBTdHJpbmdkZXgge1xyXG4gICAgcmV0dXJuIHsuLi5PYmplY3QuZnJvbUVudHJpZXModGhpcy5mdW5jdGlvbnMpfVxyXG4gIH1cclxuXHJcbiAgaW5pdCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMuaW5pdExvYWRlZCA9IHRydWVcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCk6IHZvaWQge31cclxuICByZWxvYWQoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGNsZWFuIElmIHRydWUsIHByb3ZpZGVyLmlzRGlydHkgPSBmYWxzZSAqL1xyXG4gIHNldERpcnR5KGRpcnR5PzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5pc0RpcnR5ID0gaXNFeHRhbnQoZGlydHkpID8gZGlydHkgOiB0cnVlXHJcbiAgICB0aGlzLmJ1cy5wcm92aWRlck5vdGlmaWNhdGlvbkRpcnR5KHRoaXMsIHRoaXMuaXNEaXJ0eSlcclxuICB9XHJcblxyXG4gIC8qIE1heSBiZSBjYWxsZWQgd2l0aG91dCBkYXRhLiAqL1xyXG4gIHBvc3REaXJ0eSguLi5hcmdzOiBhbnlbXSk6IHZvaWQge31cclxufVxyXG5cclxuLyoqIFxyXG4gKiBQcmVkaWNhdGVkIHByb3ZpZGVycyBhcmUgcmVzcG9uc2libGUgZm9yIG1vZHVsZXMgdGhhdCByZXF1aXJlIGNlcnRhaW4gY29uZGl0aW9ucyB0byBmdW5jdGlvbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIElQcm92aWRlclByZWRpY2F0ZWQgZXh0ZW5kcyBJUHJvdmlkZXIge1xyXG4gIHByZWRpY2F0ZUNoZWNrKCk6IGJvb2xlYW5cclxuICBwcmVkaWNhdGVFcnJvcigpOiBzdHJpbmdcclxuICBnZXRQcmVkaWNhdGUoKTogUGx1Z2luXHJcbn1cclxuIFxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgUHJvdmlkZXJQcmVkaWNhdGVkIGV4dGVuZHMgUHJvdmlkZXIgaW1wbGVtZW50cyBJUHJvdmlkZXJQcmVkaWNhdGVkIHtcclxuICBwcmVkaWNhdGVQbHVnaW5OYW1lOiBzdHJpbmcgPSAnJ1xyXG4gIFxyXG4gIGdldFByZWRpY2F0ZSgpIHtcclxuICAgIHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucz8uW3RoaXMucHJlZGljYXRlUGx1Z2luTmFtZV0gfHwgbnVsbFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybnMgdHJ1ZSBvbmx5IHdoZW4gdGhlIHByZWRpY2F0ZSBjb25kaXRpb24gaXMgbWV0ICovXHJcbiAgcHJlZGljYXRlQ2hlY2soKSB7XHJcbiAgICByZXR1cm4gdGhpcy5idXMucGx1Z2luLmFwcC5wbHVnaW5zLmVuYWJsZWRQbHVnaW5zLmhhcyh0aGlzLnByZWRpY2F0ZVBsdWdpbk5hbWUpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJucyBBbiBlcnJvciBzdHJpbmcgZGVzY3JpYmluZyB0aGUgdW5tZXQgcHJlZGljYXRlIGNvbmRpdGlvbiAqL1xyXG4gIHByZWRpY2F0ZUVycm9yKCkge1xyXG4gICAgcmV0dXJuIGBJbnRlZ3JhdGlvbiBNb2R1bGUgJyR7dGhpcy5pZH0nIG5vdCBhdmFpbGFibGUsIGNvdWxkIG5vdCBmaW5kIHJlcXVpcmVkIHBsdWdpbjogJyR7dGhpcy5wcmVkaWNhdGVQbHVnaW5OYW1lfSdgXHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgRXZlbnRSZWYsIE1hcmtkb3duUmVuZGVyZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tIFwic3JjL2V0YS9wcm92aWRlcl9hYnNcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcbmltcG9ydCB7IFN0cmluZ2RleCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgdldhcm4gfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlclNLIGV4dGVuZHMgUHJvdmlkZXIge1xyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICBjcmVhdGVPYmplY3QoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZW5kZXI6IGZ1bmN0aW9uKHN0cjogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGUgPSBjcmVhdGVEaXYoe2NsczogXCJza3JpYmktcmVuZGVyLXZpcnR1YWxcIn0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMpXHJcbiAgICAgICAgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihzdHIsIGUsIHRoaXMuY3R4LmZpbGUucGF0aCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIGUuaW5uZXJIVE1MXHJcbiAgICAgIH0sXHJcbiAgICAgIGhhczogZnVuY3Rpb24odjogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuICEoKHRoaXMudj8uW3ZdID09IG51bGwpIHx8ICh0aGlzLnY/Llt2XSA9PSB1bmRlZmluZWQpKVxyXG4gICAgICB9LFxyXG4gICAgICBhYm9ydDogZnVuY3Rpb24oczogc3RyaW5nIHwgU3RyaW5nZGV4KSB7XHJcbiAgICAgICAgbGV0IGFib3J0UGFja2V0ID0gU3RyaW5nLmlzU3RyaW5nKHMpIFxyXG4gICAgICAgID8ge2hhc0RhdGE6IHRydWUsIGZsYWc6ICdhYm9ydCcsIGhvdmVyOiBzfSBcclxuICAgICAgICA6IE9iamVjdC5hc3NpZ24oe2hhc0RhdGE6IHRydWUsIGZsYWc6ICdhYm9ydCd9LCBzKVxyXG4gICAgICAgIHRocm93IGFib3J0UGFja2V0XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldFRlbXBsYXRlU291cmNlOiBmdW5jdGlvbihzOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiBtYWtlSW5pdFByb21pc2UodGhpcy5jaGlsZCwgKCkgPT4ge1xyXG4gICAgICAgICAgbGV0IGhhcyA9IHRoaXMuY3R4LnBsdWdpbi5ldGEubG9hZGVyLnN0eWxlQ2FjaGUuaGFzKHMpXHJcbiAgICAgICAgICBpZiAoIWhhcykge2NvbnNvbGUud2FybihgU2tyaWJpOiBnZXRUZW1wbGF0ZVNvdXJjZSgpXFxuIENvdWxkIG5vdCBmaW5kIHJlcXVlc3RlZCB0ZW1wbGF0ZSAnJHtzfSdcXG5gLCB0aGlzLmNoaWxkLl9jKX1cclxuICAgICAgICAgIGxldCBjID0gdGhpcy5jdHgucGx1Z2luLmV0YS5sb2FkZXIudGVtcGxhdGVDYWNoZS5nZXQocylcclxuICAgICAgICAgIGlmIChoYXMgJiYgIWM/LnNvdXJjZSkge2NvbnNvbGUud2FybihgU2tyaWJpOiBnZXRUZW1wbGF0ZVNvdXJjZSgpXFxuIFRlbXBsYXRlICcke3N9JyBmb3VuZCwgYnV0IGhhcyBubyBjYWNoZWQgc291cmNlXFxuYCwgdGhpcy5jaGlsZC5fYyl9XHJcbiAgICAgICAgICByZXR1cm4gYz8uc291cmNlID8/IG51bGxcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG4gICAgICBnZXRTdHlsZTogZnVuY3Rpb24oczogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICByZXR1cm4gbWFrZUluaXRQcm9taXNlKHRoaXMuY2hpbGQsICgpID0+IHtcclxuICAgICAgICAgIGlmICghdGhpcy5jdHgucGx1Z2luLmV0YS5sb2FkZXIuc3R5bGVDYWNoZS5oYXMocykpIHtjb25zb2xlLndhcm4oYFNrcmliaTogZ2V0U3R5bGUoKVxcbiBDb3VsZCBub3QgZmluZCByZXF1ZXN0ZWQgc3R5bGUgJyR7c30uY3NzJ1xcbmAsIHRoaXMuY2hpbGQuX2MpfVxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuY3R4LnBsdWdpbi5ldGEubG9hZGVyLnN0eWxlQ2FjaGUuZ2V0KHMpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBwYXJhbSBzdHlsZVNuaXAgVGhlIElEIG9mIGEgLmNzcyBmaWxlIHRoYXQgaXMgZXhwZWN0ZWQgdG8gYmUgcHJlc2VudCBpbiB0aGUgc3R5bGUgY2FjaGVcclxuICAgICAgICogQHJldHVybnMgQSBwcm9taXNlIGZvciB0aGUgc2NvcGVkIHN0eWxlIChyZXNvbHZlcyBvbiBwb3N0KSAqL1xyXG4gICAgICBpbmNsdWRlU3R5bGU6IGFzeW5jIGZ1bmN0aW9uKHN0eWxlU25pcDogc3RyaW5nKSB7IC8vVE9ETzogZmFpbHMgb24gaW5pdGxvYWQgZm9yIG5vbi10ZW1wbGF0ZXNcclxuICAgICAgICByZXR1cm4gbWFrZUluaXRQcm9taXNlKHRoaXMuY2hpbGQsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2hpbGQuX2MubGlzdGVuRm9yKFwic3R5bGVcIiwgc3R5bGVTbmlwKVxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGQuYWRkU3R5bGUoYXdhaXQgdGhpcy5nZXRTdHlsZShzdHlsZVNuaXApKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbnR5cGUgZXZlbnRDb25zdHJ1Y3RvciA9IHtvbihpZDogc3RyaW5nLCBjYjogRnVuY3Rpb24pOiBFdmVudFJlZiwgb2ZmcmVmKGV2ZW50OiBFdmVudFJlZik6IGFueX1cclxudHlwZSBldmVudFBvc3Nlc3NvciA9IHtyZWdpc3RlckV2ZW50KGV2ZW50OiBFdmVudFJlZik6IHZvaWR9XHJcblxyXG5mdW5jdGlvbiBtYWtlSW5pdFByb21pc2UoY2hpbGQ6IGV2ZW50UG9zc2Vzc29yLCBjYjogRnVuY3Rpb24pIHtcclxuICBpZiAod2luZG93LmFwcC5wbHVnaW5zLnBsdWdpbnNbJ29ic2lkaWFuLXNrcmliaSddLmluaXRMb2FkZWQpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY2IoKSlcclxuICB9IGVsc2UgcmV0dXJuIG1ha2VFdmVudFByb21pc2UoY2hpbGQsIHdpbmRvdy5hcHAud29ya3NwYWNlLCAnc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnLCBjYilcclxufVxyXG5cclxuZnVuY3Rpb24gbWFrZUV2ZW50UHJvbWlzZShjaGlsZDogZXZlbnRQb3NzZXNzb3IsIGV2ZW50Q29uc3RydWN0b3I6IGV2ZW50Q29uc3RydWN0b3IsIGV2ZW50TmFtZTogc3RyaW5nLCBjYjogRnVuY3Rpb24pIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJtYWtlRXZlbnRQcm9taXNlXCIsIHRoaXMpXHJcbiAgICBsZXQgeCA9IGV2ZW50Q29uc3RydWN0b3Iub24oZXZlbnROYW1lLCAoKSA9PiB7XHJcbiAgICAgIGV2ZW50Q29uc3RydWN0b3Iub2ZmcmVmKHgpXHJcbiAgICAgIHJlc29sdmUoY2IoKSlcclxuICAgIH0pXHJcblxyXG4gICAgY2hpbGQucmVnaXN0ZXJFdmVudCh4KVxyXG4gIH0pXHJcbn0iLCJpbXBvcnQgeyBFdmVudFJlZiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG4vLyBpbXBvcnQgeyBEYXRhdmlld0lubGluZUFwaSB9IGZyb20gXCJvYnNpZGlhbi1kYXRhdmlldy9saWIvYXBpL2lubGluZS1hcGlcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJQcmVkaWNhdGVkIH0gZnJvbSBcInNyYy9ldGEvcHJvdmlkZXJfYWJzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJEYXRhdmlldyBleHRlbmRzIFByb3ZpZGVyUHJlZGljYXRlZCB7XHJcbiAgcHJlZGljYXRlUGx1Z2luTmFtZSA9ICdkYXRhdmlldydcclxuICAvLyBkdnA6IERhdGF2aWV3UGx1Z2luID0gbnVsbFxyXG5cclxuICBldmVudFJlZl9BUElfUkVBRFk6IEV2ZW50UmVmXHJcblxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICAvLyB0aGlzLmR2cCA9IHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3IGFzIERhdGF2aWV3UGx1Z2luIHx8IG51bGxcclxuXHJcbiAgICB0aGlzLmV2ZW50UmVmX0FQSV9SRUFEWSA9IHRoaXMuYnVzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignZGF0YXZpZXc6YXBpLXJlYWR5JywgKGFwaSkgPT4ge3RoaXMuYXBpUmVhZHkoKX0pXHJcblxyXG4gICAgcmV0dXJuIHN1cGVyLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCkge1xyXG4gICAgdGhpcy5idXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9mZnJlZih0aGlzLmV2ZW50UmVmX0FQSV9SRUFEWSlcclxuICB9XHJcblxyXG4gIGNyZWF0ZU9iamVjdCgpIHtcclxuICAgIHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucz8uZGF0YXZpZXc/LmFwaSB8fCBudWxsXHJcbiAgfVxyXG5cclxuICBhcGlSZWFkeSgpIHtcclxuXHJcbiAgfVxyXG5cclxuICAvLyBjcmVhdGVEeW5hbWljKHN0YXRlOiBEeW5hbWljU3RhdGUpIHtcclxuICAgIC8vIGxldCBhcGkgPSBuZXcgRGF0YXZpZXdJbmxpbmVBcGkodGhpcy5kdnAuaW5kZXgsIHN0YXRlLmNoaWxkLCBzdGF0ZS5lbCwgdGhpcy5idXMucGx1Z2luLmFwcCwgdGhpcy5kdnAuc2V0dGluZ3MsIHN0YXRlLmZpbGUucGF0aClcclxuXHJcbiAgICAvLyByZXR1cm4gdGhpcz8uZHZwPy5hcGkgfHwgbnVsbFxyXG4gIC8vIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQcm92aWRlclByZWRpY2F0ZWQgfSBmcm9tIFwiLi4vLi4vcHJvdmlkZXJfYWJzXCI7XHJcbmltcG9ydCB0eXBlIFdlYXRoZXJBUEkgZnJvbSBcIi4uLy4uLy4uLy4uLy4uL29ic2lkaWFuLXdlYXRoZXIvc3JjL2FwaVwiO1xyXG5pbXBvcnQgeyBFdmVudFJlZiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyV2VhdGhlciBleHRlbmRzIFByb3ZpZGVyUHJlZGljYXRlZCB7XHJcbiAgcHJlZGljYXRlUGx1Z2luTmFtZTogc3RyaW5nID0gJ29ic2lkaWFuLXdlYXRoZXInXHJcblxyXG4gIHByaXZhdGUgZXZlbnRSZWZzOiB7XHJcbiAgICByZWFkeTogRXZlbnRSZWYgXHJcbiAgICB1bmxvYWQ6IEV2ZW50UmVmXHJcbiAgICB0aWNrOiBFdmVudFJlZlxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIHRoaXMuZXZlbnRSZWZzID0ge1xyXG4gICAgICByZWFkeTogdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJhei13ZWF0aGVyOmFwaS1yZWFkeVwiLCAoKSA9PiB7fSksXHJcbiAgICAgIHVubG9hZDogdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJhei13ZWF0aGVyOmFwaS11bmxvYWRcIiwgKCkgPT4ge30pLFxyXG4gICAgICB0aWNrOiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXRpY2tcIiwgKCkgPT4ge30pXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5mdW5jdGlvbnMuc2V0KFwiY2hlY2tcIiwgdGhpcy5wcm92aWRlX3ByZWRpY2F0ZSgpKVxyXG4gICAgdGhpcy5mdW5jdGlvbnMuc2V0KFwiY2FjaGVcIiwgdGhpcy5wcm92aWRlX2Rpc3BlbnNlQ2FjaGUoKSlcclxuICAgIHRoaXMuZnVuY3Rpb25zLnNldChcInRpY2tFdmVudFJlZlwiLCB0aGlzLnByb3ZpZGVfdGlja0V2ZW50UmVmKCkpXHJcblxyXG4gICAgcmV0dXJuIHN1cGVyLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCkge1xyXG4gICAgZm9yIChsZXQgciBvZiBPYmplY3QudmFsdWVzKHRoaXMuZXZlbnRSZWZzKSkge1xyXG4gICAgICB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vZmZyZWYocilcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qIFByb3Zpc2lvbnMgKi9cclxuXHJcbiAgcHJvdmlkZV9wcmVkaWNhdGUoKTogRnVuY3Rpb24ge1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgcmV0dXJuICghIXRoaXMud2VhdGhlckFQSSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb3ZpZGVfZGlzcGVuc2VDYWNoZSgpOiBGdW5jdGlvbiB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICBsZXQgcDogYW55ID0gdGhpcy5nZXRQcmVkaWNhdGUoKTtcclxuICAgICAgcmV0dXJuIHA/LkFQST8uZGlzcGVuc2VDYWNoZS5iaW5kKHAuQVBJKSgpXHJcbiAgICB9IFxyXG4gIH1cclxuXHJcbiAgcHJvdmlkZV90aWNrRXZlbnRSZWYoKTogRnVuY3Rpb24ge1xyXG4gICAgcmV0dXJuIChjYjogRnVuY3Rpb24pID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwiYXotd2VhdGhlcjphcGktdGlja1wiLCAoLi4uYTogYW55KSA9PiBjYiguLi5hKSlcclxuICAgIH1cclxuICB9XHJcbn0iLCJpbXBvcnQgeyBGaWxlU3lzdGVtQWRhcHRlciwgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgRmlsZU1pbmRlciwgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBkTG9nLCBmaWx0ZXJGaWxlRXh0LCBnZXRGaWxlcywgaXNFeHRhbnQsIGlzRmlsZSwgaXNJbkZvbGRlciwgdkxvZywgd2l0aG91dEtleSB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gXCIuLi9wcm92aWRlcl9hYnNcIjtcclxuXHJcbi8vIFRPRE86IGFkZCBzeXN0ZW0gdG8gYXV0by1yZWxvYWQgc2tyaWJpcyB3aGVuIG1vZHVsZSBjYWNoZSBjaGFuZ2VzIFxyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJTY3JpcHRsb2FkZXIgZXh0ZW5kcyBQcm92aWRlciBpbXBsZW1lbnRzIEZpbGVNaW5kZXIge1xyXG4gIGxvYWRlZE1vZHVsZXM6IE1hcDxzdHJpbmcsIHtuYW1lPzogc3RyaW5nLCBwcm9wZXJ0aWVzOiBTdHJpbmdkZXh9PiA9IG5ldyBNYXAoKVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5pdExvYWQoKS50aGVuKCgpID0+IHN1cGVyLmluaXQoKSlcclxuICB9XHJcblxyXG4gIGFzeW5jIGluaXRMb2FkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubG9hZEFuZFNldCguLi5nZXRGaWxlcyh0aGlzLmJ1cy5wbHVnaW4uYXBwLCB0aGlzLmJ1cy5wbHVnaW4uc2V0dGluZ3Muc2NyaXB0Rm9sZGVyKSlcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRBbmRTZXQoLi4uZmlsZTogVEZpbGVbXSkge1xyXG4gICAgcmV0dXJuIHRoaXMucmVhZEZpbGVzKC4uLmZpbGUpXHJcbiAgICAudGhlbigocmV0KSA9PiB7Lyp2TG9nKCdMb2FkaW5nIEpTIG1vZHVsZXMuLi4nLCByZXQpOyovIHRoaXMuc3Rhc2hNb2R1bGUocmV0KTsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSk7XHJcbiAgfVxyXG5cclxuICBzdGFzaE1vZHVsZShtb2R1bGVzOiBbc3RyaW5nLCBTdHJpbmdkZXhdW10pIHtcclxuICAgIGRMb2coJ1NjcmlwdGxvYWRlcjogc3Rhc2hNb2R1bGUnLCBtb2R1bGVzKVxyXG5cclxuICAgIG1vZHVsZXMuZm9yRWFjaCgocikgPT4ge1xyXG4gICAgICBpZiAocikge1xyXG4gICAgICAgIHRoaXMubG9hZGVkTW9kdWxlcy5kZWxldGUoclswXSlcclxuICAgICAgICB0aGlzLmxvYWRlZE1vZHVsZXMuc2V0KHJbMF0sIHtcclxuICAgICAgICAgIG5hbWU6IChTdHJpbmcuaXNTdHJpbmcoclsxXT8uX25hbWUgPz8gbnVsbCkgPyByWzFdLl9uYW1lIDogbnVsbCksIFxyXG4gICAgICAgICAgcHJvcGVydGllczogd2l0aG91dEtleShyWzFdLCAnX25hbWUnKVxyXG4gICAgICAgICAgfSAgICAgICAgICBcclxuICAgICAgICApXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBjcmVhdGVPYmplY3QoKTogU3RyaW5nZGV4IHtcclxuICAgIGxldCBleHBvcnRzOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpXHJcbiAgICB0aGlzLmxvYWRlZE1vZHVsZXMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xyXG4gICAgICBsZXQgc2luZ2xlID0gKE9iamVjdC5rZXlzKHZhbHVlLnByb3BlcnRpZXMpLmxlbmd0aCA9PSAxKSBcclxuXHJcbiAgICAgIGV4cG9ydHMuc2V0KCh2YWx1ZS5uYW1lID8/IChzaW5nbGUgPyBPYmplY3Qua2V5cyh2YWx1ZS5wcm9wZXJ0aWVzKVswXSA6IGtleSkpLFxyXG4gICAgICAgIHNpbmdsZSA/IE9iamVjdC52YWx1ZXModmFsdWUucHJvcGVydGllcylbMF0gOiB2YWx1ZS5wcm9wZXJ0aWVzXHJcbiAgICAgIClcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIHsuLi5PYmplY3QuZnJvbUVudHJpZXMoZXhwb3J0cyl9XHJcbiAgfVxyXG5cclxuICBhc3luYyByZWFkRmlsZXMoLi4uZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPFtzdHJpbmcsIFN0cmluZ2RleF1bXT4ge1xyXG4gICAgbGV0IGZpbHRlcmVkID0gZmlsdGVyRmlsZUV4dChmaWxlcywgXCJqc1wiKVxyXG4gICAgY29uc3QgcmVhZHMgPSBmaWx0ZXJlZC5tYXAoYXN5bmMgKGYpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoISh0aGlzLmJ1cy5wbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIgaW5zdGFuY2VvZiBGaWxlU3lzdGVtQWRhcHRlcikpIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xyXG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5idXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmdldEJhc2VQYXRoKCkgKyBcIi9cIiArIGYucGF0aFxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCByZXNQYXRoID0gd2luZG93LnJlcXVpcmUucmVzb2x2ZShwYXRoKVxyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh3aW5kb3cucmVxdWlyZS5jYWNoZSkuY29udGFpbnMocmVzUGF0aCkpIGRlbGV0ZSB3aW5kb3cucmVxdWlyZS5jYWNoZVt3aW5kb3cucmVxdWlyZS5yZXNvbHZlKHJlc1BhdGgpXVxyXG5cclxuICAgICAgICBjb25zdCBtb2QgPSByZXF1aXJlKHBhdGgpXHJcblxyXG4gICAgICAgIHJldHVybiAoaXNFeHRhbnQobW9kKSkgXHJcbiAgICAgICAgICA/IFByb21pc2UucmVzb2x2ZShbZi5iYXNlbmFtZSwgbW9kXSlcclxuICAgICAgICAgIDogUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oZSlcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9ICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocmVhZHMpXHJcbiAgICAudGhlbigoc2V0dGxlZCkgPT4geyByZXR1cm4gc2V0dGxlZFxyXG4gICAgICAuZmlsdGVyKChyKSA9PiB7cmV0dXJuIHIuc3RhdHVzID09IFwiZnVsZmlsbGVkXCJ9KVxyXG4gICAgICAubWFwKCh2KSA9PiB7cmV0dXJuICh2IGFzIFByb21pc2VGdWxmaWxsZWRSZXN1bHQ8W3N0cmluZywgU3RyaW5nZGV4XT4pLnZhbHVlfSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBjbGVhckpTKC4uLml0ZW1zOiBBcnJheTxURmlsZSB8IHN0cmluZz4pOiB2b2lkIHtcclxuICAgIGxldCBuYW1lcyA9IGl0ZW1zLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICBpZiAoaXNGaWxlKGl0ZW0pKSByZXR1cm4gZmlsdGVyRmlsZUV4dChpdGVtLCAnanMnKVswXS5iYXNlbmFtZVxyXG4gICAgICBlbHNlIGlmIChTdHJpbmcuaXNTdHJpbmcoaXRlbSkpIHJldHVybiBpdGVtIFxyXG4gICAgfSlcclxuXHJcbiAgICBmb3IgKGxldCBuYW1lIG9mIG5hbWVzKSB0aGlzLmxvYWRlZE1vZHVsZXMuZGVsZXRlKG5hbWUpXHJcbiAgfVxyXG5cclxuICBhc3luYyByZWxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLmxvYWRlZE1vZHVsZXMuY2xlYXIoKVxyXG4gICAgYXdhaXQgdGhpcy5pbml0TG9hZCgpXHJcbiAgICByZXR1cm4gc3VwZXIucmVsb2FkKClcclxuICB9XHJcblxyXG4gIHBvc3REaXJ0eSgpIHtcclxuICAgIGlmICh0aGlzLmJ1cy5wbHVnaW4uc2V0dGluZ3MuYXV0b1JlbG9hZCkge1xyXG4gICAgICBBcnJheS5mcm9tKHRoaXMuYnVzLnBsdWdpbi5jaGlsZHJlbikuZm9yRWFjaChjaGlsZCA9PiBjaGlsZC5zY3JpcHRzVXBkYXRlZCgpKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyogRmlsZU1pbmRlciBGdW5jdGlvbnMgKi9cclxuXHJcbiAgZ2V0IGRpcmVjdG9yeSgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5idXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlciB9XHJcblxyXG4gIGZpbGVVcGRhdGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIGluIHNjcmlwdCBkaXJlY3RvcnkgbW9kaWZpZWQsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuY2xlYXJKUyhmaWxlKVxyXG4gICAgdGhpcy5sb2FkQW5kU2V0KGZpbGUpXHJcbiAgICAudGhlbigoKSA9PiB7dGhpcy5zZXREaXJ0eSgpfSwgKCkgPT4gdGhpcy5jbGVhckpTKGZpbGUpKVxyXG4gIH1cclxuXHJcbiAgZmlsZURlbGV0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgcmVtb3ZlZCBmcm9tIHNjcmlwdCBkaXJlY3RvcnksIHVubG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmNsZWFySlMoZmlsZSlcclxuICAgIHRoaXMuc2V0RGlydHkoKVxyXG4gIH1cclxuXHJcbiAgZmlsZUFkZGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIGFkZGVkIHRvIHNjcmlwdCBkaXJlY3RvcnksIGxvYWRpbmcuLi5gKVxyXG4gICAgdGhpcy5sb2FkQW5kU2V0KGZpbGUpXHJcbiAgICAudGhlbigoKSA9PiB7dGhpcy5zZXREaXJ0eSgpfSwgKCkgPT4gdGhpcy5jbGVhckpTKGZpbGUpKVxyXG4gIH1cclxuXHJcbiAgZmlsZVJlbmFtZWQoZmlsZTogVEFic3RyYWN0RmlsZSwgb2xkTmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgU2NyaXB0IGZpbGUgJyR7b2xkTmFtZX0nIHJlbmFtZWQgdG8gJyR7ZmlsZS5uYW1lfScsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuY2xlYXJKUyhvbGROYW1lKVxyXG4gICAgdGhpcy5sb2FkQW5kU2V0KGZpbGUpXHJcbiAgICAudGhlbigoKSA9PiB7dGhpcy5zZXREaXJ0eSgpfSwgKCkgPT4ge30pXHJcbiAgfVxyXG5cclxuICBkaXJlY3RvcnlDaGFuZ2VkKCk6IHZvaWQge1xyXG4gICAgdkxvZyhgU2NyaXB0IGRpcmVjdG9yeSBjaGFuZ2VkLCByZWxvYWRpbmcgc2NyaXB0cy4uLmApXHJcbiAgICB0aGlzLnJlbG9hZCgpLnRoZW4oKCkgPT4gdGhpcy5zZXREaXJ0eSgpLCAoZSkgPT4ge2NvbnNvbGUud2FybihlKX0pXHJcbiAgfVxyXG5cclxuICBpc0luRG9tYWluKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBpc0luRm9sZGVyKGZpbGUsIHRoaXMuZGlyZWN0b3J5KVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBcHAsIE1hcmtkb3duUmVuZGVyZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcbmltcG9ydCB7IFZBUl9OQU1FIH0gZnJvbSBcInNyYy90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgeyBEeW5hbWljU3RhdGUsIFN0cmluZ2RleCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgZW5zdXJlQXJyYXksIGlzRnVuYyB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyU0sgfSBmcm9tIFwiLi9wcm92aWRlcnMvYmFzZVwiO1xyXG5pbXBvcnQgeyBQcm92aWRlckRhdGF2aWV3IH0gZnJvbSBcIi4vcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2XCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyV2VhdGhlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9pbnRlZ3JhdGlvbi93ZWF0aGVyXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyU2NyaXB0bG9hZGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL3NjcmlwdGxvYWRlclwiO1xyXG5pbXBvcnQgeyBJUHJvdmlkZXIsIFByb3ZpZGVyLCBQcm92aWRlclByZWRpY2F0ZWQgfSBmcm9tIFwiLi9wcm92aWRlcl9hYnNcIjtcclxuXHJcbmNvbnN0IG9ic2lkaWFuTW9kdWxlID0gcmVxdWlyZShcIm9ic2lkaWFuXCIpO1xyXG5cclxuY29uc3QgTU9EVUxFX05BTUVfSU5URUdSQVRJT05TOiBzdHJpbmcgPSAnaW50JztcclxuXHJcbnR5cGUgUHJvdmlkZXJpc2ggPSBJUHJvdmlkZXJcclxuXHJcbi8qIEhhbmRsZXMgYWxsIHNjcmlwdCBmdW5jdGlvbiBwcm92aWRlcnMgKi9cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyQnVzIHtcclxuXHJcbiAgaGFuZGxlcjogRXRhSGFuZGxlclxyXG4gIHBsdWdpbjogU2tyaWJvc1BsdWdpblxyXG5cclxuICBwcm92aWRlcnM6IE1hcDxzdHJpbmcsIFByb3ZpZGVyPiA9IG5ldyBNYXAoKVxyXG4gIHByb3ZpZGVyc1ByZWRpY2F0ZWQ6IE1hcDxzdHJpbmcsIFByb3ZpZGVyUHJlZGljYXRlZD4gPSBuZXcgTWFwKClcclxuXHJcbiAgLyogSGFzIGEgcmVmZXJlbmNlIHNvIHRoYXQgaXQgY2FuIGJlIG5vdGlmaWVkIGJ5IHVwZGF0ZSBldmVudHMgKi9cclxuICBzY3JpcHRMb2FkZXI6IFByb3ZpZGVyU2NyaXB0bG9hZGVyO1xyXG5cclxuICBza0Jhc2U6IFByb3ZpZGVyU0s7XHJcblxyXG4gIHByaXZhdGUgc2NvcGVTdGF0aWM6IFN0cmluZ2RleCA9IHt9XHJcblxyXG4gIC8vIEluZGljYXRlcyB0aGF0IGEgcHJvdmlkZXIgaGFzIGJlZW4gYWRkZWQgb3IgcmVtb3ZlZCwgYW5kIHRoZSBzdGF0aWMgc2NvcGUgc2hvdWxkIGJlIHJlZ2VuZXJhdGVkLlxyXG4gIGlzU3RhdGljU2NvcGVEaXJ0eTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihoYW5kbGVyOiBFdGFIYW5kbGVyKSB7XHJcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyXHJcbiAgICB0aGlzLnBsdWdpbiA9IGhhbmRsZXIucGx1Z2luXHJcblxyXG4gICAgdGhpcy5zY3JpcHRMb2FkZXIgPSBuZXcgUHJvdmlkZXJTY3JpcHRsb2FkZXIodGhpcywgJ2pzJyk7IC8vIGFzc2lnbmVkIGhlcmUgc28gdGhhdCB3ZSBjYW4gcmVnaXN0ZXIgZmlsZSBldmVudHMgaW4gaGFuZGxlclxyXG4gIH1cclxuXHJcbiAgLyogQ29uc3RydWN0IGFsbCBwcm92aWRlcnMgYnV0IGRvIG5vdCBpbml0aWFsaXplIHRoZW0geWV0LCBzbyB0aGF0IHdlIGNhbiBjb21waWxlIGFuZCBjYWNoZSB0ZW1wbGF0ZXMgQVNBUCAqL1xyXG4gIGFzeW5jIHByZUluaXQoKSB7XHJcbiAgICB0aGlzLmFkZFRvKHRoaXMucHJvdmlkZXJzLCB0aGlzLnNjcmlwdExvYWRlcilcclxuICAgIHRoaXMuYWRkVG8odGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLCBuZXcgUHJvdmlkZXJEYXRhdmlldyh0aGlzLCAnZHYnKSlcclxuICAgIHRoaXMuYWRkVG8odGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLCBuZXcgUHJvdmlkZXJXZWF0aGVyKHRoaXMsICd3ZWF0aGVyJykpXHJcbiAgICB0aGlzLnNrQmFzZSA9IG5ldyBQcm92aWRlclNLKHRoaXMsIFZBUl9OQU1FKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgY29uc3QgaW5pdHMgPSBPYmplY3QudmFsdWVzKHRoaXMuZXhlY09uUHJvdmlkZXJzKCdpbml0JykpXHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGluaXRzKVxyXG4gICAgdGhpcy5jcmVhdGVTdGF0aWNTY29wZSgpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkVG8ocHJvdmlkZXJzOiBNYXA8c3RyaW5nLCBJUHJvdmlkZXI+LCBwcm92aWRlcjogUHJvdmlkZXIpIHtcclxuICAgIHByb3ZpZGVycy5zZXQocHJvdmlkZXIuaWQsIHByb3ZpZGVyKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW50ZWdyYXRpb24gcG9pbnQgZm9yIG90aGVyIHBsdWdpbnMgdG8gYWRkIGEgcHJvdmlkZXIgXHJcbiAgICogQHBhcmFtIHByb3ZpZGVyIFByb3ZpZGVyIGltcGxlbWVudGF0aW9uIHRvIGFkZCAqL1xyXG4gIHB1YmxpYyBhZGRQcm92aWRlciA9IChwcm92aWRlcjogUHJvdmlkZXIpID0+IHtcclxuICAgIHRoaXMucHJvdmlkZXJzLnNldChwcm92aWRlci5pZCwgcHJvdmlkZXIpXHJcbiAgICB0aGlzLmlzU3RhdGljU2NvcGVEaXJ0eSA9IHRydWVcclxuICAgIHRoaXMuaGFuZGxlci5yZWNvbXBpbGVUZW1wbGF0ZXMoKVxyXG4gIH1cclxuICBcclxuICAvKipcclxuICAgKiBJbnRlZ3JhdGlvbiBwb2ludCBmb3Igb3RoZXIgcGx1Z2lucyB0byBhZGQgYSBwcmVkaWNhdGVkIHByb3ZpZGVyXHJcbiAgICogQHBhcmFtIHByb3ZpZGVyIFByb3ZpZGVyUHJlZGljYXRlZCBpbXBsZW1lbnRhdGlvbiB0byBhZGQgKi9cclxuICBhZGRQcm92aWRlclByZWRpY2F0ZWQgPSAocHJvdmlkZXI6IFByb3ZpZGVyUHJlZGljYXRlZCkgPT4ge1xyXG4gICAgdGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLnNldChwcm92aWRlci5pZCwgcHJvdmlkZXIpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmV4ZWNPblByb3ZpZGVycygndW5sb2FkJylcclxuICB9XHJcblxyXG4gIC8qIEludm9rZWQgYnkgcHJvdmlkZXJzIHRvIGluZGljYXRlIHRoZWlyIHByb3Zpc2lvbiBtdXN0IGJlIHJlZ2VuZXJhdGVkICovXHJcbiAgcHJvdmlkZXJOb3RpZmljYXRpb25EaXJ0eShwcm92aWRlcjogUHJvdmlkZXIsIGlzRGlydHk6IGJvb2xlYW4sIC4uLmRhdGE6IGFueVtdKSB7XHJcbiAgICBpZiAoaXNEaXJ0eSkgdGhpcy5yZWZyZXNoUHJvdmlkZXIocHJvdmlkZXIsIC4uLmRhdGEpXHJcbiAgfVxyXG5cclxuICAvKiBSZWdlbmVyYXRlIHRoZSBwcm92aXNpb24gb2YgYSBzaW5nbGUgcHJvdmlkZXIsIGFuZCBwYXNzIGRhdGEgdG8gaXRzIHBvc3QgZnVuY3Rpb24gKi9cclxuICByZWZyZXNoUHJvdmlkZXIocHJvdmlkZXI6IFByb3ZpZGVyLCAuLi5kYXRhOiBhbnlbXSkge1xyXG4gICAgcHJvdmlkZXIuc2V0RGlydHkoZmFsc2UpXHJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMuc2NvcGVTdGF0aWMsIHtbcHJvdmlkZXIuaWRdOiBwcm92aWRlci5jcmVhdGVPYmplY3QoKX0pXHJcbiAgICBwcm92aWRlci5wb3N0RGlydHkoLi4uZGF0YSlcclxuICB9XHJcblxyXG4gIC8qIENsZWFuIGRpcnR5IHByb3ZpZGVycyBieSByZWdlbmVyYXRpbmcgdGhlaXIgcHJvdmlzaW9uICovXHJcbiAgcmVmcmVzaFByb3ZpZGVycyguLi5wcm92aWRlcnM6IFByb3ZpZGVyW10pIHtcclxuICAgIGxldCBwcm94eTogYW55ID0ge307XHJcblxyXG4gICAgZm9yIChsZXQgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7XHJcbiAgICAgIHByb3h5W3Byb3ZpZGVyLmlkXSA9IHByb3ZpZGVyLmNyZWF0ZU9iamVjdCgpXHJcbiAgICAgIHByb3ZpZGVyLnNldERpcnR5KGZhbHNlKVxyXG4gICAgfVxyXG5cclxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5zY29wZVN0YXRpYywgcHJveHkpXHJcblxyXG4gICAgcHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4gcHJvdmlkZXIucG9zdERpcnR5KCkpXHJcbiAgfVxyXG5cclxuICAvKiBSZWxvYWRzIGFsbCBwcm92aWRlcnMgKi9cclxuICBhc3luYyByZWxvYWRQcm92aWRlcnMoKSB7XHJcbiAgICBsZXQgcHJvbXMgPSB0aGlzLmV4ZWNPblByb3ZpZGVycygncmVsb2FkJylcclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGxTZXR0bGVkKE9iamVjdC52YWx1ZXMocHJvbXMpKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFNjb3BlS2V5cygpIHtcclxuICAgIHJldHVybiBbLi4udGhpcy5wcm92aWRlcnMua2V5cygpLCBNT0RVTEVfTkFNRV9JTlRFR1JBVElPTlMsICdtb21lbnQnLCAnb2JzaWRpYW4nXVxyXG4gIH1cclxuXHJcbiAgLyogUmV0cmlldmVzIHByb3ZpZGVycyBvYmplY3QgKi9cclxuICBwdWJsaWMgZ2V0U2NvcGUoY3R4PzogRHluYW1pY1N0YXRlLCByZWZyZXNoPzogYm9vbGVhbikge1xyXG4gICAgbGV0IGRpcnRpZXMgPSBPYmplY3QudmFsdWVzKHRoaXMucHJvdmlkZXJzKS5maWx0ZXIoKHA6IFByb3ZpZGVyKSA9PiB7cmV0dXJuIHAuaXNEaXJ0eX0pXHJcbiAgICBpZiAoZGlydGllcykgdGhpcy5yZWZyZXNoUHJvdmlkZXJzKC4uLmRpcnRpZXMpXHJcblxyXG4gICAgaWYgKHRoaXMuaXNTdGF0aWNTY29wZURpcnR5KSB0aGlzLmNyZWF0ZVN0YXRpY1Njb3BlKClcclxuXHJcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zY29wZVN0YXRpYywge1tNT0RVTEVfTkFNRV9JTlRFR1JBVElPTlNdOiB0aGlzLmNyZWF0ZVByZWRpY2F0ZWRTY29wZShjdHggfHwgbnVsbCl9KVxyXG4gIH1cclxuXHJcbiAgLyogQ3JlYXRlcyBzY29wZSBvYmplY3QuIFNob3VsZCBub3QgYmUgdXNlZCB0byBnZXQgdGhlIHNjb3BlLiAqL1xyXG4gIHByaXZhdGUgY3JlYXRlU3RhdGljU2NvcGUoKSB7XHJcbiAgICBsZXQgc3BhY2VzOiB7W2tleTogc3RyaW5nXTogYW55fSA9IHt9O1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBwIG9mIHRoaXMucHJvdmlkZXJzKSBzcGFjZXNbcFswXV0gPSBwWzFdLmNyZWF0ZU9iamVjdCgpO1xyXG5cclxuICAgIHNwYWNlc1snbW9tZW50J10gPSB3aW5kb3cubW9tZW50XHJcbiAgICBzcGFjZXNbJ29ic2lkaWFuJ10gPSBvYnNpZGlhbk1vZHVsZVxyXG4gICAgXHJcbiAgICB0aGlzLnNjb3BlU3RhdGljID0gc3BhY2VzXHJcbiAgICB0aGlzLmlzU3RhdGljU2NvcGVEaXJ0eSA9IGZhbHNlXHJcbiAgICByZXR1cm4gdGhpcy5zY29wZVN0YXRpY1xyXG4gIH1cclxuXHJcbiAgLyogUHJlZGljYXRlZCBwcm92aWRlcnMgKi9cclxuICBjcmVhdGVQcmVkaWNhdGVkU2NvcGUoY3R4PzogRHluYW1pY1N0YXRlKSB7XHJcbiAgICBsZXQgc3BhY2VzOiB7W2tleTogc3RyaW5nXTogYW55fSA9IHt9O1xyXG4gICBcclxuICAgIGZvciAobGV0IHAgb2YgdGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkKSB7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzcGFjZXMsIHBbMF0sIHsgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlmIChwWzFdLnByZWRpY2F0ZUNoZWNrKCkpIHJldHVybiBwWzFdLmNyZWF0ZU9iamVjdCgpXHJcbiAgICAgICAgICBlbHNlIHRocm93IG5ldyBFcnJvcihwWzFdLnByZWRpY2F0ZUVycm9yKCkpXHJcbiAgICAgICAgfSBcclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHNwYWNlc1xyXG4gIH1cclxuXHJcbiAgLyogR2V0IHRoZSBiYXNlIHByb3ZpZGVyIHNjb3BlICovXHJcbiAgZ2V0U2NvcGVTSygpIHtcclxuICAgIHJldHVybiB0aGlzLnNrQmFzZS5jcmVhdGVPYmplY3QoKVxyXG4gIH1cclxuXHJcbiAgLyogSW52b2tlIGZ1bmN0aW9uIG9uIGFsbCBwcm92aWRlcnMgYW5kIHJldHVybiBhcnJheSBvZiByZXN1bHRzICovXHJcbiAgZXhlY09uUHJvdmlkZXJzKGZ1bmM6IChrZXlvZiBJUHJvdmlkZXIpKTogU3RyaW5nZGV4IHtcclxuICAgIGxldCByZXRzOiBTdHJpbmdkZXggPSB7fTtcclxuXHJcbiAgICBjb25zdCBpbnZva2UgPSAocHJvdmlkZXJzOiBNYXA8c3RyaW5nLCBQcm92aWRlcj4pID0+IHtcclxuICAgICAgZm9yIChsZXQgcCBvZiBwcm92aWRlcnMpIGlmICgocCAhPSBudWxsKSAmJiAoaXNGdW5jKHBbMV1bZnVuY10pKSkge3JldHNbcFswXV0gPSAocFsxXVtmdW5jXSBhcyBGdW5jdGlvbikoKX1cclxuICAgIH1cclxuXHJcbiAgICBpbnZva2UodGhpcy5wcm92aWRlcnMpXHJcbiAgICBpbnZva2UodGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkKVxyXG5cclxuICAgIHJldHVybiByZXRzXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZpZGVyQnVzIHtcclxuICBleGVjT25Qcm92aWRlcnMoZnVuYzogJ3JlbG9hZCcpOiB7W2luZGV4OiBzdHJpbmddOiBQcm9taXNlPHZvaWQ+fVxyXG4gIGV4ZWNPblByb3ZpZGVyKGZ1bmM6ICdpbml0Jyk6IHtbaW5kZXg6IHN0cmluZ106IFByb21pc2U8dm9pZD59XHJcbn1cclxuIiwiLyogVGhpcyBpcyBzbGlnaHRseSBtb2RpZmllZCBmcm9tIEV0YSAqL1xyXG5cclxuZXhwb3J0IGNsYXNzIENhY2hlcjxUPiB7XHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjYWNoZTogUmVjb3JkPHN0cmluZywgVD4pIHt9XHJcbiAgZGVmaW5lKGtleTogc3RyaW5nLCB2YWw6IFQpOiB2b2lkIHt0aGlzLmNhY2hlW2tleV0gPSB2YWx9XHJcbiAgZ2V0KGtleTogc3RyaW5nKTogVCB7cmV0dXJuIHRoaXMuY2FjaGVba2V5XX1cclxuICByZW1vdmUoa2V5OiBzdHJpbmcpOiB2b2lkIHtkZWxldGUgdGhpcy5jYWNoZVtrZXldfVxyXG4gIHJlc2V0KCk6IHZvaWQge3RoaXMuY2FjaGUgPSB7fX1cclxuICBsb2FkKGNhY2hlT2JqOiBSZWNvcmQ8c3RyaW5nLCBUPik6IHZvaWQge2NvcHlQcm9wcyh0aGlzLmNhY2hlLCBjYWNoZU9iail9XHJcbiAgaGFzKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gISgodGhpcy5jYWNoZVtrZXldID09PSBudWxsICkgfHwgKHRoaXMuY2FjaGVba2V5XSA9PT0gdW5kZWZpbmVkKSlcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb3B5UHJvcHM8VD4odG9PYmo6IFQsIGZyb21PYmo6IFQpOiBUIHtcclxuICBmb3IgKGNvbnN0IGtleSBpbiBmcm9tT2JqKSB7XHJcbiAgICBpZiAoaGFzT3duUHJvcCgoZnJvbU9iaiBhcyB1bmtub3duKSBhcyBvYmplY3QsIGtleSkpIHtcclxuICAgICAgdG9PYmpba2V5XSA9IGZyb21PYmpba2V5XVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gdG9PYmpcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc093blByb3Aob2JqOiBvYmplY3QsIHByb3A6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKVxyXG59IiwiaW1wb3J0ICogYXMgRXRhIGZyb20gXCJldGFcIjtcclxuaW1wb3J0IHsgRnJvbnRNYXR0ZXJDYWNoZSwgcGFyc2VZYW1sLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcclxuaW1wb3J0IHsgRUJBUiwgVkFSX05BTUUgfSBmcm9tIFwic3JjL3R5cGVzL2NvbnN0XCI7XHJcbmltcG9ydCB7ICBnZXRGaWxlcywgaXNFeHRhbnQsIGlzRmlsZSwgaXNJbkZvbGRlciwgcm91bmRUbywgdkxvZywgdldhcm4sIHdpdGhvdXRLZXkgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gXCIuL2V0YVwiO1xyXG5pbXBvcnQgeyBDYWNoZXIgfSBmcm9tIFwiLi9jYWNoZXJcIjtcclxuaW1wb3J0IHsgRmlsZU1pbmRlciwgU3RyaW5nZGV4LCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBjb21waWxlV2l0aCB9IGZyb20gXCIuL2NvbXBcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGVtcGxhdGVDYWNoZSB7XHJcbiAgc291cmNlPzogc3RyaW5nLFxyXG4gIGZ1bmN0aW9uOiBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLFxyXG4gIGZyb250bWF0dGVyPzogU3RyaW5nZGV4XHJcbn1cclxuXHJcbi8qIFJlc3BvbnNpYmxlIGZvciB0aGUgY2FjaGluZyBhbmQgbWFuYWdlbWVudCBvZiB0ZW1wbGF0ZXMuICovXHJcbi8vIFRPRE86IGFkZCBzeXN0ZW0gdG8gYXV0by1yZWxvYWQgc2tyaWJpcyB3aGVuIHJlbGV2YW50IHRlbXBsYXRlIGNhY2hlIGNoYW5nZXMgXHJcbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZUxvYWRlciBpbXBsZW1lbnRzIEZpbGVNaW5kZXIge1xyXG4gIHByaXZhdGUgaGFuZGxlcjogRXRhSGFuZGxlclxyXG4gIHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG4gIHRlbXBsYXRlQ2FjaGU6IENhY2hlcjxUZW1wbGF0ZUNhY2hlPiA9IG5ldyBDYWNoZXI8VGVtcGxhdGVDYWNoZT4oe30pXHJcbiAgdGVtcGxhdGVGYWlsdXJlczogTWFwPHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXAoKTtcclxuICBzdHlsZUNhY2hlOiBDYWNoZXI8c3RyaW5nPiA9IG5ldyBDYWNoZXI8c3RyaW5nPih7fSlcclxuXHJcbiAgY29uc3RydWN0b3IoaGFuZGxlcjogRXRhSGFuZGxlcikge1xyXG4gICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlclxyXG4gICAgdGhpcy5wbHVnaW4gPSBoYW5kbGVyLnBsdWdpblxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIGluaXQoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiB0aGlzLmluaXRMb2FkKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmRlZmluZVBhcnRpYWxzKC4uLmdldEZpbGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5kaXJlY3RvcnkpKSBcclxuICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UudHJpZ2dlcignc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICAvKiogXHJcbiAgICogUmVhZHMgcGFzc2VkIGZpbGVzIGFuZCBhdHRlbXB0cyB0byBjYWNoZSB0aGVtLlxyXG4gICAqIEhhbmRsZXMgdGVtcGxhdGVzIGFuZCBzdHlsZXMuIFRlbXBsYXRlcyBhcmUgY29tcGlsZWQgdG8gZnVuY3Rpb25zLiAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGVmaW5lUGFydGlhbHMoLi4uZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG4gICAgdmFyIGZhaWx1cmVDb3VudCA9IDBcclxuICAgIHZhciBzdWNjZXNzQ291bnQgPSAwXHJcblxyXG4gICAgY29uc3Qgc2NvcGVLZXlzID0gdGhpcy5oYW5kbGVyLmJ1cy5nZXRTY29wZUtleXMoKVxyXG5cclxuICAgIGxldCBzdHlsZUZpbGVzOiBURmlsZVtdID0gW11cclxuICAgIGxldCB0ZW1wbGF0ZUZpbGVzOiBURmlsZVtdID0gW10gXHJcbiAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICBzd2l0Y2goZmlsZS5leHRlbnNpb24pIHtcclxuICAgICAgICBjYXNlIFwibWRcIjogdGVtcGxhdGVGaWxlcy5wdXNoKGZpbGUpOyBicmVhaztcclxuICAgICAgICBjYXNlIFwiZXRhXCI6IHRlbXBsYXRlRmlsZXMucHVzaChmaWxlKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImNzc1wiOiBzdHlsZUZpbGVzLnB1c2goZmlsZSk7IGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlYWRUZW1wbGF0ZXMgPSB0ZW1wbGF0ZUZpbGVzLm1hcChhc3luYyBmaWxlID0+IHtcclxuICAgICAgbGV0IHJlYWQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxyXG5cclxuICAgICAgbGV0IGZpbGVGcm9udG1hdHRlciA9IG51bGxcclxuICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09IFwiZXRhXCIpIHtcclxuICAgICAgICBsZXQgZm1TZWFyY2ggPSAoL14tLS1cXG4qKD88ZnJvbnRtYXR0ZXI+Lio/KVxcbiotLS0vcykuZXhlYyhyZWFkKTtcclxuICAgICAgICBpZiAoZm1TZWFyY2guZ3JvdXBzLmZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgeWFtbCA9IHBhcnNlWWFtbChmbVNlYXJjaC5ncm91cHMuZnJvbnRtYXR0ZXIudHJpbSgpKVxyXG4gICAgICAgICAgICBmaWxlRnJvbnRtYXR0ZXIgPSB5YW1sXHJcbiAgICAgICAgICAgIHJlYWQgPSByZWFkLnN1YnN0cihmbVNlYXJjaFswXS5sZW5ndGgpXHJcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHZXYXJuKGBFcnJvciBwYXJzaW5nIGZyb250bWF0dGVyIG9mICR7ZmlsZS5uYW1lfSwgcGxlYXNlIHJlcG9ydC5gLCBFQkFSLCBlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvKiBNYXJrZG93biBmaWxlcyBjYW4gY2hlY2sgZm9yIGNhY2hlZCBmcm9udG1hdHRlciB3aGljaCBpcyBtYXliZSBmYXN0ZXIgKi9cclxuICAgICAgICBmaWxlRnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyXHJcbiAgICAgICAgaWYgKGZpbGVGcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgbGV0IGZtU2VhcmNoID0gKC8oPzxmcm9udG1hdHRlcj5eLS0tLio/KD89XFxuLS0tKVxcbi0tLSkvcykuZXhlYyhyZWFkKTtcclxuICAgICAgICAgIGxldCBmbVRleHQgPSBmbVNlYXJjaD8uZ3JvdXBzPy5mcm9udG1hdHRlciA/PyBudWxsXHJcbiAgICAgICAgICBpZiAoaXNFeHRhbnQoZm1UZXh0KSkgeyByZWFkID0gcmVhZC5zdWJzdHIoZm1UZXh0Lmxlbmd0aCl9ICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCBjb21waWxlZFN0cmluZyA9IEV0YS5jb21waWxlVG9TdHJpbmcocmVhZCwgRXRhLmdldENvbmZpZyh7dmFyTmFtZTogVkFSX05BTUUsIG5hbWU6IGZpbGUuYmFzZW5hbWV9KSlcclxuICAgICAgICB2YXIgY29tcGlsZWQgPSBjb21waWxlV2l0aChjb21waWxlZFN0cmluZywgW1ZBUl9OQU1FLCAnRScsICdjYicsIC4uLnNjb3BlS2V5c10sIChyZWFkLmNvbnRhaW5zKCdhd2FpdCcpKSlcclxuICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlRmFpbHVyZXMuc2V0KGZpbGUuYmFzZW5hbWUsIGVyciB8fCBgVGVtcGxhdGUgZmFpbGVkIHRvIGNvbXBpbGU6IFVua25vd24gRXJyb3JgKVxyXG4gICAgICAgIGNvbnNvbGUud2FybihgU2tyaWJpOiB0ZW1wbGF0ZSAnJHtmaWxlLmJhc2VuYW1lfScgZmFpbGVkIHRvIGNvbXBpbGVgLCBFQkFSLCBlcnIsIEVCQVIsIHJlYWQpXHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlbW92ZShmaWxlLmJhc2VuYW1lKVxyXG4gICAgICAgIGZhaWx1cmVDb3VudCsrXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KClcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICB0aGlzLnRlbXBsYXRlRmFpbHVyZXMuZGVsZXRlKGZpbGUuYmFzZW5hbWUpXHJcbiAgICAgIHRoaXMudGVtcGxhdGVDYWNoZS5kZWZpbmUoZmlsZS5iYXNlbmFtZSwge1xyXG4gICAgICAgICdzb3VyY2UnOiByZWFkLFxyXG4gICAgICAgICdmdW5jdGlvbic6IGNvbXBpbGVkLFxyXG4gICAgICAgICdmcm9udG1hdHRlcic6IGZpbGVGcm9udG1hdHRlciA/IHdpdGhvdXRLZXkoZmlsZUZyb250bWF0dGVyLCAncG9zaXRpb24nKSA6IG51bGxcclxuICAgICAgfSlcclxuICAgICAgc3VjY2Vzc0NvdW50KytcclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCByZWFkU3R5bGVzID0gc3R5bGVGaWxlcy5tYXAoYXN5bmMgZmlsZSA9PiB7XHJcbiAgICAgIGxldCByZWFkID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSlcclxuICAgICAgdGhpcy5zdHlsZUNhY2hlLmRlZmluZShmaWxlLmJhc2VuYW1lLCByZWFkKVxyXG4gICAgfSlcclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocmVhZFRlbXBsYXRlcy5jb25jYXQocmVhZFN0eWxlcykpXHJcblxyXG4gICAgaWYgKCghdGhpcy5wbHVnaW4uaW5pdExvYWRlZCkgJiYgZmlsZXMubGVuZ3RoKSB7XHJcbiAgICAgIGxldCBzdHIgPSBgJHtzdWNjZXNzQ291bnR9IHRlbXBsYXRlJHsoc3VjY2Vzc0NvdW50ID09IDEpID8gJycgOiAncyd9YFxyXG4gICAgICBpZiAoZmFpbHVyZUNvdW50KSBzdHIgKz0gYFxcbiBPZiAke3RlbXBsYXRlRmlsZXMubGVuZ3RofSB0b3RhbCB0ZW1wbGF0ZXMsICR7ZmFpbHVyZUNvdW50fSBmYWlsZWQgdG8gY29tcGlsZS5gXHJcbiAgICAgIGNvbnNvbGUubG9nKGBTa3JpYmk6IExvYWRlZCBgICsgc3RyKVxyXG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdWdpbi5pbml0TG9hZGVkKSB7XHJcbiAgICAgIC8qIE90aGVyIHRoYW4gZHVyaW5nIGluaXQsIGRlZmluZVBhcnRpYWxzIGlzIGNhbGxlZCBvbiBzaW5nbGUgZmlsZXMgYXQgYSB0aW1lLiAgKi9cclxuXHJcbiAgICAgIGlmICh0ZW1wbGF0ZUZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBBcnJheS5mcm9tKHRoaXMucGx1Z2luLmNoaWxkcmVuKS5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgICAgICAgY2hpbGQudGVtcGxhdGVzVXBkYXRlZCh0ZW1wbGF0ZUZpbGVzWzBdLmJhc2VuYW1lKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdkxvZyhgVXBkYXRlZCB0ZW1wbGF0ZSAnJHt0ZW1wbGF0ZUZpbGVzWzBdLmJhc2VuYW1lfScgaW4gJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSwgNCl9bXNgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoc3R5bGVGaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgQXJyYXkuZnJvbSh0aGlzLnBsdWdpbi5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgICAgIGNoaWxkLnN0eWxlc1VwZGF0ZWQoc3R5bGVGaWxlc1swXS5iYXNlbmFtZSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHZMb2coYFVwZGF0ZSBzdHlsZSAnJHtzdHlsZUZpbGVzWzBdLmJhc2VuYW1lfSdgKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICAvKiBEZWxldGVzIGNhY2hlIGVudHJpZXMgYnkgc3RyaW5nIG5hbWUgb3IgZmlsZSBvZiBvcmlnaW4gKi9cclxuICBkZWxldGVQYXJ0aWFsKC4uLml0ZW1zOiBBcnJheTxURmlsZSB8IHN0cmluZz4pOiB2b2lkIHtcclxuICAgIGZvciAobGV0IGl0ZW0gb2YgaXRlbXMpIHtcclxuICAgICAgbGV0IG5hbWUgPSBpc0ZpbGUoaXRlbSkgPyBpdGVtLmJhc2VuYW1lIDogaXRlbVxyXG4gICAgICB0aGlzLnRlbXBsYXRlQ2FjaGUucmVtb3ZlKG5hbWUpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkZWxldGVQYXJ0aWFsQnlOYW1lKC4uLml0ZW1zOiBBcnJheTxzdHJpbmc+KSB7XHJcbiAgICBmb3IgKGxldCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGxldCBzcGxpdCA9ICgvKD88bmFtZT5bXl0rKVxcLig/PGV4dGVuc2lvbj5bXl0rKSQvZykuZXhlYyhpdGVtKVxyXG4gICAgICBpZiAoIShPYmplY3Qua2V5cyhzcGxpdD8uZ3JvdXBzKT8ubGVuZ3RoID8/IDAgPiAwKSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignU2tyaWJpOiBUZW1wbGF0ZUxvYWRlci5kZWxldGVQYXJ0aWFsQnlOYW1lKCkgY291bGQgbm90IHBhcnNlIG5hbWUgXFxuJywgaXRlbSlcclxuICAgICAgICBjb250aW51ZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoc3BsaXQuZ3JvdXBzWydleHRlbnNpb24nXSA9PSBcImNzc1wiKSB7XHJcbiAgICAgICAgdGhpcy5zdHlsZUNhY2hlLnJlbW92ZShzcGxpdC5ncm91cHNbJ25hbWUnXSlcclxuICAgICAgICBBcnJheS5mcm9tKHRoaXMucGx1Z2luLmNoaWxkcmVuKS5mb3JFYWNoKChjaGlsZCkgPT4ge1xyXG4gICAgICAgICAgY2hpbGQuc3R5bGVzVXBkYXRlZChzcGxpdC5ncm91cHNbJ25hbWUnXSlcclxuICAgICAgICB9KVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVDYWNoZS5yZW1vdmUoc3BsaXQuZ3JvdXBzWyduYW1lJ10pXHJcbiAgICAgICAgQXJyYXkuZnJvbSh0aGlzLnBsdWdpbi5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgICAgIGNoaWxkLnRlbXBsYXRlc1VwZGF0ZWQoc3BsaXQuZ3JvdXBzWyduYW1lJ10pXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIHJlbG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMudGVtcGxhdGVDYWNoZS5yZXNldCgpXHJcbiAgICByZXR1cm4gdGhpcy5kZWZpbmVQYXJ0aWFscyguLi5nZXRGaWxlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZGlyZWN0b3J5KSlcclxuICB9XHJcblxyXG4gIC8qIEZpbGVNaW5kZXIgRnVuY3Rpb25zICovXHJcbiAgXHJcbiAgZ2V0IGRpcmVjdG9yeSgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIgfVxyXG5cclxuICBmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBpbiB0ZW1wbGF0ZSBkaXJlY3RvcnkgbW9kaWZpZWQsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuZGVmaW5lUGFydGlhbHMoZmlsZSlcclxuICB9XHJcblxyXG4gIC8vIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUgfCBzdHJpbmcpOiB2b2lkIHsgLy8gbmV2ZXIgYWN0dWFsbHkgY2FsbGVkIGFzIHN0cmluZyBJIGp1c3Qgd3JvdGUgaXQgdG8gaGFuZGxlIGl0IGZvciBzb21lIHJlYXNvblxyXG4gIC8vICAgbGV0IGlzZiA9IGlzRmlsZShmaWxlKVxyXG4gIC8vICAgaWYgKCghaXNmICYmICEoU3RyaW5nLmlzU3RyaW5nKGZpbGUpICYmIHRoaXMudGVtcGxhdGVDYWNoZS5nZXQoZmlsZSkpKSkgcmV0dXJuO1xyXG4gIC8vICAgdkxvZyhgRmlsZSAnJHtpc2YgPyAoZmlsZSBhcyBURmlsZSkubmFtZSA6IGZpbGV9JyByZW1vdmVkIGZyb20gdGVtcGxhdGUgZGlyZWN0b3J5LCB1bmxvYWRpbmcuLi5gKVxyXG4gIC8vICAgdGhpcy5kZWxldGVQYXJ0aWFsKGZpbGUgYXMgKFRGaWxlIHwgc3RyaW5nKSlcclxuICAvLyB9XHJcblxyXG4gIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIHJlbW92ZWQgZnJvbSB0ZW1wbGF0ZSBkaXJlY3RvcnksIHVubG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmRlbGV0ZVBhcnRpYWxCeU5hbWUoZmlsZS5uYW1lKVxyXG4gIH1cclxuXHJcbiAgZmlsZUFkZGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIGFkZGVkIHRvIHRlbXBsYXRlIGRpcmVjdG9yeSwgbG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmRlZmluZVBhcnRpYWxzKGZpbGUpXHJcbiAgfVxyXG5cclxuICBmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBUZW1wbGF0ZSBmaWxlICcke29sZE5hbWV9JyByZW5hbWVkIHRvICcke2ZpbGUubmFtZX0nLCB1cGRhdGluZy4uLmApXHJcblxyXG4gICAgdGhpcy5kZWxldGVQYXJ0aWFsQnlOYW1lKG9sZE5hbWUpXHJcbiAgICB0aGlzLmRlZmluZVBhcnRpYWxzKGZpbGUpXHJcbiAgfVxyXG5cclxuICBkaXJlY3RvcnlDaGFuZ2VkKCk6IHZvaWQge1xyXG4gICAgdkxvZyhgVGVtcGxhdGUgZGlyZWN0b3J5IGNoYW5nZWQsIHJlbG9hZGluZyB0ZW1wbGF0ZXMuLi5gKVxyXG4gICAgdGhpcy5yZWxvYWQoKVxyXG4gIH1cclxuXHJcbiAgaXNJbkRvbWFpbihmaWxlOiBUQWJzdHJhY3RGaWxlKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gaXNJbkZvbGRlcihmaWxlLCB0aGlzLmRpcmVjdG9yeSlcclxuICB9XHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZUZ1bmN0aW9uIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbXBpbGVcIjtcclxuaW1wb3J0IHsgRXRhQ29uZmlnIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbmZpZ1wiO1xyXG5pbXBvcnQgeyBub3JtYWxpemVQYXRoLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBFQkFSLCBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgRmlsZU1pbmRlciwgc2NvcGVkVmFycywgU3RyaW5nZGV4LCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcIi4uL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50IH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuaW1wb3J0IHsgcmVuZGVyRXRhQXN5bmMsIHJlbmRlckV0YSwgY29tcGlsZVdpdGggfSBmcm9tIFwiLi9jb21wXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyQnVzIH0gZnJvbSBcIi4vcHJvdmlkZXJfYnVzXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlTG9hZGVyIH0gZnJvbSBcIi4vdGVtcGxhdGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRXRhSGFuZGxlciB7XHJcbiAgcGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG4gIGJ1czogUHJvdmlkZXJCdXM7XHJcbiAgbG9hZGVyOiBUZW1wbGF0ZUxvYWRlcjtcclxuXHJcbiAgdGVtcGxhdGVzRGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgZ2V0IHRlbXBsYXRlcygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZX1cclxuICBnZXQgZmFpbGVkVGVtcGxhdGVzKCkge3JldHVybiB0aGlzLmxvYWRlci50ZW1wbGF0ZUZhaWx1cmVzfVxyXG4gIC8vIGdldCB0ZW1wbGF0ZUZyb250bWF0dGVycygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVGcm9udG1hdHRlcnN9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmJ1cyA9IG5ldyBQcm92aWRlckJ1cyh0aGlzKVxyXG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgVGVtcGxhdGVMb2FkZXIodGhpcylcclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UubGF5b3V0UmVhZHkpXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB0aGlzLmluaXQuYmluZCh0aGlzKSgpKVxyXG4gICAgZWxzZSB0aGlzLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIHRoaXMuaW5pdExvYWQoKS50aGVuKCgpID0+IHtcclxuICAgICAgdGhpcy5yZWdpc3RlckZpbGVFdmVudHMoKVxyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBTa3JpYmk6IEV0YUhhbmRsZXIgZmFpbGVkIHRvIGluaXRpYWxpemUhYCwgRUJBUiwgZXJyKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyRmlsZUV2ZW50cygpIHtcclxuICAgIC8qIEJlY2F1c2UgdGhlIEZpbGVNaW5kZXIgaW5kZXggZG9lcyBub3QgY2hhbmdlLCB3ZSBkb24ndCBuZWVkIHRoZSBldmVudCByZWZzICovXHJcblxyXG4gICAgY29uc3QgbWluZGVyczogRmlsZU1pbmRlcltdID0gW3RoaXMuYnVzLnNjcmlwdExvYWRlciwgdGhpcy5sb2FkZXJdXHJcbiAgICBmb3IgKGxldCBtaW5kZXIgb2YgbWluZGVycykge1xyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignbW9kaWZ5JywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZVVwZGF0ZWQoZmlsZSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignZGVsZXRlJywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZURlbGV0ZWQoZmlsZSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignY3JlYXRlJywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZUFkZGVkKGZpbGUpXHJcbiAgICAgIH0pKVxyXG5cclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XHJcbiAgICAgICAgICBsZXQgb3VyRGlyID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3JtYWxpemVQYXRoKG1pbmRlci5kaXJlY3RvcnkpKVxyXG4gICAgICAgICAgbGV0IG9sZERpciA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplUGF0aCgoLy4rXFwvL2cpLmV4ZWMob2xkUGF0aClbMF0pKVxyXG4gICAgICAgICAgaWYgKGZpbGUucGFyZW50ID09IG91ckRpcikge1xyXG4gICAgICAgICAgICAvLyBOZXcgbG9jYXRpb24gb2YgZmlsZSBpcyBpbiBvdXIgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnBhcmVudCA9PSBvbGREaXIpIHtcclxuICAgICAgICAgICAgICAvLyBGaWxlIGRpZCBub3QgbW92ZSBidXQgd2FzIHJlbmFtZWRcclxuICAgICAgICAgICAgICBtaW5kZXIuZmlsZVJlbmFtZWQoZmlsZSwgKC8oW2EtekEtWjAtOS1fLl0rXFwuLiopL2cpLmV4ZWMob2xkUGF0aClbMF0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gRmlsZSB3YXMgbW92ZWQgZnJvbSBlbHNld2hlcmUgaW50byB0aGUgdGVtcGxhdGUgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgICAgbWluZGVyLmZpbGVBZGRlZChmaWxlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG9sZERpciA9PSBvdXJEaXIpIHtcclxuICAgICAgICAgICAgLy8gRmlsZSB1c2VkIHRvIGJlIGluIHRlbXBsYXRlcyBkaXJlY3RvcnkgYW5kIGlzIG5vIGxvbmdlclxyXG4gICAgICAgICAgICBtaW5kZXIuZmlsZURlbGV0ZWQoZmlsZSlcclxuICAgICAgICAgIH1cclxuICAgICAgfSkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0TG9hZCgpIHtcclxuICAgIGxldCB7YTogYSwgYjogYn0gPSBhd2FpdCB0aGlzLmJ1cy5wcmVJbml0KCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHJldHVybiB7YTogdGhpcy5idXMuaW5pdCgpLCBiOiB0aGlzLmxvYWRlci5pbml0KCl9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbYSwgYl0pXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmJ1cy51bmxvYWQoKVxyXG4gIH1cclxuXHJcbiAgcmVjb21waWxlVGVtcGxhdGVzKCkge1xyXG4gICAgLy8gSWYgdGhlIGJ1cyBzY29wZSBjaGFuZ2VzLCB0aGUgdGVtcGxhdGVzIG11c3QgYmUgcmVjb21waWxlZC4gXHJcbiAgICAvLyBUaGUgYnVzIHNjb3BlIHNob3VsZCBub3QgY2hhbmdlIHBvc3QtaW5pdCB1bmxlc3MgYW4gZXh0ZXJuYWwgc291cmNlIG1vZGlmaWVzIHRoZSBwcm92aWRlciBsaXN0LlxyXG4gICAgdGhpcy5sb2FkZXIucmVsb2FkKClcclxuICB9XHJcblxyXG4gIGdldFBhcnRpYWwoaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMubG9hZGVyLnRlbXBsYXRlQ2FjaGUuZ2V0KGlkKVxyXG4gIH1cclxuXHJcbiAgaGFzUGFydGlhbChpZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gaXNFeHRhbnQodGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZS5nZXQoaWQpKVxyXG4gIH1cclxuXHJcbiAgZ2V0Q2FjaGVLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudGVtcGxhdGVzLmNhY2hlKVxyXG4gIH1cclxuXHJcbiAgLyoqICAgXHJcbiAgKiBQcmltYXJ5IHNrcmliaSByZW5kZXIgZnVuY3Rpb24uIFJlbmRlcnMgYXN5bmNocm9ub3VzbHkgKFRlbXBsYXRlRnVuY3Rpb24gbWF5IG9yIG1heSBub3QgYmUgYXN5bmMpXHJcbiAgKiBAcGFyYW0gY29udGVudCBTdHJpbmcgb3Igc2NvcGVkIHRlbXBsYXRlIGZ1bmN0aW9uIHRvIHJlbmRlclxyXG4gICogQHBhcmFtIGN0eEluIENvbnRleHQgb2JqZWN0IHRvIGJlIGFkZGVkIHRvIGBza2Agb2JqZWN0XHJcbiAgKiBAcGFyYW0gZmlsZSBGaWxlIGluIHdoaWNoIHRoZSBza3JpYmkgaXMgYmVpbmcgcmVuZGVyZWQgIFxyXG4gICogQHJldHVybnMgW3JlbmRlcmVkIHN0cmluZywgcmV0dXJuZWQgcGFja2V0IChjdXJyZW50bHkgdW51c2VkKV0gKi9cclxuICBhc3luYyByZW5kZXJBc3luYyhjb250ZW50OiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBjdHhJbj86IGFueSwgZmlsZT86IFRGaWxlKTogUHJvbWlzZTxbc3RyaW5nLCBTdHJpbmdkZXhdPiB7XHJcbiAgICAvKiBVc2VkIHRvIHBhc3MgZGF0YSB1cCB0byB0aGUgcmVuZGVyIHByb2Nlc3MgZnJvbSB0aGUgc2tyaWJpIGZ1bmN0aW9uICovXHJcbiAgICBsZXQgcGFja2V0OiBTdHJpbmdkZXggPSB7fTtcclxuICAgIGZ1bmN0aW9uIHVwKCkge1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24oeDogc3RyaW5nLCB5OiBhbnkpIHtcclxuICAgICAgICBwYWNrZXRbeF0gPSB5XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBsZXQgY2ZnID0gRXRhLmdldENvbmZpZyh7dmFyTmFtZTogVkFSX05BTUV9KVxyXG5cclxuICAgIC8qIHRoZSAndGhpcycgb2JqZWN0IG9mIHRoZSBzayBjb250ZXh0Ki9cclxuICAgIGxldCBiaW5kZXIgPSB7fVxyXG5cclxuICAgIC8qIFRoZSAnc2snIG9iamVjdCAqL1xyXG4gICAgbGV0IHNrID0gT2JqZWN0LmFzc2lnbih7fSxcclxuICAgICAgY3R4SW4gfHwge30sIFxyXG4gICAgICB7XHJcbiAgICAgICAgdGhpczogYmluZGVyLCBcclxuICAgICAgICBnZXRFbnY6IGdldEVudiwgXHJcbiAgICAgICAgdXA6IHVwKCksIFxyXG4gICAgICAgIGN0eDoge1xyXG4gICAgICAgICAgZmlsZTogZmlsZSB8fCBudWxsLFxyXG4gICAgICAgICAgcGx1Z2luOiB0aGlzLnBsdWdpbixcclxuICAgICAgICAgIGFwcDogdGhpcy5wbHVnaW4uYXBwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0aGlzLmJ1cy5nZXRTY29wZVNLKClcclxuICAgIClcclxuXHJcbiAgICAvKiBTY29wZSB0byBwYXNzIHRvIHRoZSBmdW5jdGlvbi4gTXVzdCBjb250YWluIGFsbCBrZXlzIHRoYXQgZnVuY3Rpb24gd2FzIGNvbXBpbGVkIHdpdGguICovXHJcbiAgICBsZXQgc2NvcGU6IHNjb3BlZFZhcnMgPSB7XHJcbiAgICAgICdzayc6IHNrLFxyXG4gICAgICAnRSc6IGNmZyxcclxuICAgICAgJ2NiJzogbnVsbCxcclxuICAgICAgLi4udGhpcy5idXMuZ2V0U2NvcGUoKSxcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFbnYoKSB7XHJcbiAgICAgIHJldHVybiBzY29wZVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZW4gPSAoY29udGVudC50b1N0cmluZygpLmNvbnRhaW5zKCdhd2FpdCcpKSAvLyBUaGlzIHdpbGwgY2F0Y2ggc3RyaW5ncyBjb250YWluaW5nIGF3YWl0IGFzIHdlbGwsIG1heWJlIGEgZmxhZyBzaG91bGQgYmUgdXNlZCBpbnN0ZWFkXHJcbiAgICAgID8gcmVuZGVyRXRhQXN5bmModGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuICAgICAgOiByZW5kZXJFdGEodGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuXHJcbiAgICBpZiAocmVuIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICByZXR1cm4gYXdhaXQgcmVuLnRoZW4oKHIpID0+IHtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyLCBwYWNrZXRdKX0sIChyKSA9PiB7cmV0dXJuIFByb21pc2UucmVqZWN0KHIpfSlcclxuICAgIH0gZWxzZSBpZiAoU3RyaW5nLmlzU3RyaW5nKHJlbikpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcmVuIGFzIHN0cmluZywgcGFja2V0XSkgfVxyXG4gICAgZWxzZSByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJFdGFIYW5kbGVyLnJlbmRlckFzeW5jOiBVbmtub3duIEVycm9yXCIpXHJcbiAgfVxyXG5cclxuICAvKiB0aGlzIGlzIHNvbWVob3cgMS4zeCBzbG93ZXIgdGhhbiByZW5kZXJBc3luYyAqL1xyXG4gIGFzeW5jIHJlbmRlckFzeW5jTmFpdmUoY29udGVudDogc3RyaW5nIHwgRnVuY3Rpb24sIGN0eEluPzogYW55LCB2YXJOYW1lPzogYW55KSB7XHJcbiAgICBjb25zb2xlLmxvZygnU2tyaWJvczogcmVuZGVyQXN5bmNOYWl2ZSBpbnZva2VkJywgY29udGVudCwgY3R4SW4pXHJcbiAgICBsZXQgY29udGV4dCA9IE9iamVjdC5hc3NpZ24oe30sIGN0eEluIHx8IHt9KVxyXG4gICAgbGV0IHJlbiA9IEV0YS5yZW5kZXJBc3luYyhjb250ZW50IGFzIChzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uKSwgY29udGV4dCwge3Zhck5hbWU6IHZhck5hbWUgPz8gVkFSX05BTUV9KVxyXG5cclxuICAgIGlmIChyZW4gaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCByZW4udGhlbigocikgPT4ge3JldHVybiBQcm9taXNlLnJlc29sdmUocil9LCAocikgPT4ge3JldHVybiBQcm9taXNlLnJlamVjdChyKX0pXHJcbiAgICB9IGVsc2UgaWYgKFN0cmluZy5pc1N0cmluZyhyZW4pKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUocmVuIGFzIHN0cmluZykgfVxyXG4gICAgZWxzZSByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJVbmtub3duIGVycm9yXCIpXHJcbiAgfVxyXG5cclxuICByZW5kZXIoY29udGVudDogc3RyaW5nLCBjdHhJbj86IGFueSkge1xyXG4gICAgbGV0IGNvbnRleHQgPSBjdHhJbiB8fCB7fTtcclxuXHJcbiAgICBjb250ZW50ID0gRXRhLnJlbmRlcihjb250ZW50LCBjb250ZXh0LCB7IFxyXG4gICAgICB2YXJOYW1lOiBWQVJfTkFNRVxyXG4gICAgfSkgYXMgc3RyaW5nO1xyXG5cclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxuXHJcbiAgLyoqIFRlbXBsYXRlRnVuY3Rpb24gaGFuZGxlciwgd2lsbCByZXR1cm4gY2FjaGVkIG9yIGNvbXBpbGVkIGZ1bmN0aW9uLCBhcHByb3ByaWF0ZWx5IGJvdW5kIGFuZCBzY29wZWRcclxuICAgKiBAcGFyYW0gdGVtcGxhdGUgU3RyaW5nIG9yIHNjb3BlZCB0ZW1wbGF0ZSBmdW5jdGlvblxyXG4gICAqIEBwYXJhbSBvcHRpb25zIEV0YUNvbmZpZyBcclxuICAgKiBAcGFyYW0gc2NvcGUgT2JqZWN0IGNvbnRhaW5pbmcgb2JqZWN0cyB0aGF0IHNob3VsZCBiZSBhdmFpbGFibGUgaW4gdGhlIHJldHVybmVkIGZ1bmN0aW9uJ3Mgc2NvcGUgXHJcbiAgICogQHBhcmFtIGJpbmRlciBPYmplY3QgdG8gd2hpY2ggdGhlIHJldHVybmVkIGZ1bmN0aW9uIHdpbGwgYmUgYm91bmQgKi9cclxuICBnZXRDYWNoZWQodGVtcGxhdGU6IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIG9wdGlvbnM6IEV0YUNvbmZpZywgc2NvcGU/OiBTdHJpbmdkZXgsIGJpbmRlcj86IGFueSk6IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQge1xyXG4gICAgaWYgKG9wdGlvbnMubmFtZSAmJiB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKSkge1xyXG4gICAgICByZXR1cm4gKGJpbmRlcikgPyB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKS5mdW5jdGlvbi5iaW5kKGJpbmRlcikgOiB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKVxyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgdGVtcGxhdGVGdW5jID0gdHlwZW9mIHRlbXBsYXRlID09PSAnZnVuY3Rpb24nID8gdGVtcGxhdGUgOiBjb21waWxlV2l0aChFdGEuY29tcGlsZVRvU3RyaW5nKHRlbXBsYXRlLCBvcHRpb25zKSwgT2JqZWN0LmtleXMoc2NvcGUpLCBvcHRpb25zLmFzeW5jKVxyXG4gIFxyXG4gICAgaWYgKG9wdGlvbnMubmFtZSkgdGhpcy50ZW1wbGF0ZXMuZGVmaW5lKG9wdGlvbnMubmFtZSwge3NvdXJjZTogKFN0cmluZy5pc1N0cmluZyh0ZW1wbGF0ZSkgPyB0ZW1wbGF0ZSA6IG51bGwpLCBmdW5jdGlvbjogdGVtcGxhdGVGdW5jfSk7XHJcbiAgXHJcbiAgICByZXR1cm4gKGJpbmRlcikgPyB0ZW1wbGF0ZUZ1bmMuYmluZChiaW5kZXIpIDogdGVtcGxhdGVGdW5jXHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBTdHJpbmdkZXggfSBmcm9tICdzcmMvdHlwZXMvdHlwZXMnXHJcbmltcG9ydCB7IGlzRXh0YW50LCB2TG9nLCB2V2FybiB9IGZyb20gJ3NyYy91dGlsJ1xyXG5pbXBvcnQgZW4gZnJvbSAnLi9sb2NhbGUvZW4uanNvbidcclxuaW1wb3J0IGVuX2diIGZyb20gJy4vbG9jYWxlL2VuX2diLmpzb24nXHJcblxyXG4vLyBEb3VidCB0aGlzIHdpbGwgYmUgdXNlZCBidXQgSSB3YW50ZWQgdG8gZG8gaXQgYW55d2F5XHJcblxyXG50eXBlIGxvY2FsZSA9IFBhcnRpYWw8dHlwZW9mIGVuPiAmIFN0cmluZ2RleDxzdHJpbmc+XHJcblxyXG50eXBlIGwgPSB7XHJcbiAgJ18nOiAoa2V5OiBrZXlvZiB0eXBlb2YgZW4sIC4uLmFyZ3M6IHN0cmluZ1tdKSA9PiBzdHJpbmdcclxufSAmIHR5cGVvZiBlbiBcclxuLyogTk9URTogdGhpcyBpcyBqdXN0IGNhdXNlIFZTQyBzb21ldGltZXMgcmVmdXNlcyB0byB1cGRhdGUgdGhlIGpzb24gZGVmaW5pdGlvbnMgd2l0aG91dCBoYXZpbmcgdG8gcmVzdGFydCBhbmQgb3BlbiBhbGwgbXkgdGVybWluYWxzIGFnYWluICovXHJcbiYgU3RyaW5nZGV4PHN0cmluZz5cclxuXHJcbmNvbnN0IGxvY2FsZXM6IFN0cmluZ2RleDxsb2NhbGU+ICYge2VuOiBTdHJpbmdkZXg8c3RyaW5nPiAmIHR5cGVvZiBlbn0gPSB7XHJcbiAgZW46IGVuLFxyXG4gICdlbi1nYic6IGVuX2diXHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1ha2UoKTogbCB7XHJcbiAgbGV0IG91dCA9IHtcclxuICAgICdfJzogdFxyXG4gIH1cclxuICBcclxuICBmb3IgKGxldCBrZXkgb2YgT2JqZWN0LmtleXMoZW4pKSB7XHJcbiAgICBpZiAoU3RyaW5nLmlzU3RyaW5nKChlbiBhcyBTdHJpbmdkZXgpW2tleV0pKSB7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvdXQsIGtleSwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4gbG9jYWxlKCk/LltrZXldID8/IChlbiBhcyBsb2NhbGUpW2tleV1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2TG9nKCdMb2NhbGUgZGVmaW5pdGlvbnMgY29uc3RydWN0ZWQnKVxyXG4gIHJldHVybiBvdXQgYXMgbFxyXG59XHJcblxyXG5mdW5jdGlvbiBsb2NhbGUoKTogbG9jYWxlIHtyZXR1cm4gbG9jYWxlcz8uW3dpbmRvdy5tb21lbnQubG9jYWxlKCldfVxyXG5cclxuLyogUHVsbCBsb2NhbGl6ZWQgc3RyaW5ncyBmcm9tIHRoaXMuICovXHJcbmV4cG9ydCBjb25zdCBsOiBsID0gbWFrZSgpXHJcblxyXG4vKipcclxuICogWW91IGNhbiBwdWxsIHN0cmluZ3MgZnJvbSB0aGlzLlxyXG4gKiBQcm86IHNhZmVseSBoYW5kbGVzIHVuZGVmaW5lZCBrZXlzXHJcbiAqIENvbnRyYTogeW91IHdvbid0IGdldCB0aGUgcHJvcGVydHkgZGVmaW5pdGlvbiB0b29sdGlwcyBpbiBWU0MsIHdoaWNoIHdhcyB0aGUgd2hvbGUgcG9pbnQgb2YgdGhpcyBkZXNpZ25cclxuICogQHBhcmFtIGtleSBMYW5nIGZpbGUgc3RyaW5nIGtleSB0byByZXR1cm4gbG9jYWwgdmVyc2lvbiBvZlxyXG4gKiBAcGFyYW0gYXJncyBTdHJpbmdzIHRvIGluc2VydCBpbnRvIGluc2VydGlvbiB0YWdzIChlZyAnJTAnKVxyXG4gKiBAcmV0dXJucyBMb2NhbGl6ZWQgc3RyaW5nICovXHJcbmZ1bmN0aW9uIHQoa2V5OiBrZXlvZiB0eXBlb2YgZW4sIC4uLmFyZ3M6IHN0cmluZ1tdKTogc3RyaW5nIHtcclxuICBpZiAoIWlzRXh0YW50KChlbiBhcyBhbnkpW2tleV0pKSB2V2FybihgQmFiZWwgcmVjZWl2ZWQgdW5kZWZpbmVkIGtleTogJHtrZXl9YCk7XHJcbiAgbGV0IHN0cjogc3RyaW5nID0gbFtrZXldID8/IChlbiBhcyBsb2NhbGUpW2tleV0gPz8gYCQke2tleX1gIFxyXG4gIHJldHVybiBzdHIucmVwbGFjZSgoLyUoXFxkKykvZyksICh0LCBuKSA9PiAodm9pZCAwICE9PSBhcmdzW25dID8gYXJnc1tuXSA6IHQpKVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IHsgbCB9IGZyb20gXCJzcmMvbGFuZy9iYWJlbFwiO1xyXG5pbXBvcnQgeyBrbHMgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuXHJcbmludGVyZmFjZSBjb25maXJtYXRpb25Nb2RhbFZhbHVlcyB7XHJcbiAgdGl0bGU6IHN0cmluZ1xyXG4gIGxhYmVsUG9zOiBzdHJpbmdcclxuICBsYWJlbE5lZzogc3RyaW5nXHJcbiAgZGVzYz86IHN0cmluZ1xyXG4gIGNsYXNzPzogc3RyaW5nXHJcbiAgZWxlbWVudHM/OiBFbGVtZW50W11cclxufSBcclxuXHJcbmV4cG9ydCBjbGFzcyBjb25maXJtYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcmVqZWN0OiAocmVhc29uPzogYW55KSA9PiB2b2lkO1xyXG5cclxuICBwcml2YXRlIGZpZWxkczogY29uZmlybWF0aW9uTW9kYWxWYWx1ZXMgPSB7XHJcbiAgICB0aXRsZTogbFtcIm1vZGFsLmNvbmZpcm0udGl0bGVcIl0sXHJcbiAgICBsYWJlbFBvczogbFtcIm1vZGFsLmNvbmZpcm0uY29uZmlybVwiXSxcclxuICAgIGxhYmVsTmVnOiBsW1wibW9kYWwuY29uZmlybS5jYW5jZWxcIl0sXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmllbGRzSW4/OiBQYXJ0aWFsPGNvbmZpcm1hdGlvbk1vZGFsVmFsdWVzPikge1xyXG4gICAgc3VwZXIoYXBwKVxyXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpZWxkcywgZmllbGRzSW4gfHwge30pXHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKXtcclxuICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KHRoaXMuZmllbGRzLnRpdGxlKVxyXG4gICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGF6eihrbHMoJ2NvbmZpcm1hdGlvbi1tb2RhbCcpLCB0aGlzLmZpZWxkcy5jbGFzcylcclxuICAgIGlmICh0aGlzLmZpZWxkcy5kZXNjKSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2Nsczoga2xzKCdjb25maXJtYXRpb24tbW9kYWwtZGVzY3JpcHRpb24nKSwgdGV4dDogdGhpcy5maWVsZHMuZGVzY30pXHJcbiAgICB0aGlzLmNvbnRlbnRFbC5hcHBlbmQoLi4udGhpcy5maWVsZHMuZWxlbWVudHMpXHJcblxyXG4gICAgbGV0IGMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2Nsczoga2xzKCdjb25maXJtLW1vZGFsLWJ1dHRvbnMnKX0pXHJcbiAgICBjLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHt0ZXh0OiB0aGlzLmZpZWxkcy5sYWJlbFBvcywgY2xzOiBrbHMoJ21vZGFsLWJ1dHRvbi1jb25maXJtJyl9LCAoYikgPT4geyAgXHJcbiAgICAgIGIub25DbGlja0V2ZW50KCgpID0+IHtcclxuICAgICAgICB0aGlzLnJlc29sdmUoXCJ0cnVlXCIpXHJcbiAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgIH0pIFxyXG4gICAgfSlcclxuXHJcbiAgICBjLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHt0ZXh0OiB0aGlzLmZpZWxkcy5sYWJlbE5lZywgY2xzOiBrbHMoJ21vZGFsLWJ1dHRvbi1jYW5jZWwnKX0sIChiKSA9PiB7IFxyXG4gICAgICBiLm9uQ2xpY2tFdmVudCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlKFwiZmFsc2VcIilcclxuICAgICAgICB0aGlzLmNsb3NlKCkgXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgb3BlbkFuZEdldFZhbHVlKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XHJcbiAgICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VFeHRlcm5hbExpbmsobGlua0luOiBIVE1MQW5jaG9yRWxlbWVudCB8IHN0cmluZyk6IEhUTUxBbmNob3JFbGVtZW50IHtcclxuXHRjb25zdCBsaW5rID0gU3RyaW5nLmlzU3RyaW5nKGxpbmtJbikgPyBjcmVhdGVFbCgnYScsIHthdHRyOiB7aHJlZjogbGlua0lufX0pIDogbGlua0luXHJcblxyXG4gIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpID0+IHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICBsZXQgcCA9IG5ldyBjb25maXJtYXRpb25Nb2RhbCh3aW5kb3cuYXBwLCB7XHJcbiAgICAgIHRpdGxlOiBsW1wibW9kYWwuZXh0ZXJuYWwudGl0bGVcIl0sXHJcbiAgICAgIGRlc2M6IGxbXCJtb2RhbC5leHRlcm5hbC5kZXNjXCJdLFxyXG4gICAgICBsYWJlbFBvczogbFtcIm1vZGFsLmV4dGVybmFsLmxhYmVsXCJdLFxyXG4gICAgICBlbGVtZW50czogW2NyZWF0ZURpdih7Y2xzOiBrbHMoJ2NvbmZpcm1hdGlvbi1tb2RhbC1saW5rJyksIHRleHQ6IGxpbmsuZ2V0QXR0cignaHJlZicpfSldXHJcbiAgICB9KTtcclxuXHJcbiAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQsIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZCkgPT4gcC5vcGVuQW5kR2V0VmFsdWUocmVzb2x2ZSwgcmVqZWN0KSlcclxuICAgIC50aGVuKHJlcyA9PiAge1xyXG4gICAgICBpZiAocmVzID09PSBcInRydWVcIikge1xyXG4gICAgICAgIHdpbmRvdy5vcGVuKGxpbmsuZ2V0QXR0cignaHJlZicpKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcblxyXG5cdHJldHVybiBsaW5rXHJcbn0iLCJpbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiLCBBcHAsIFNldHRpbmcsIFRleHRBcmVhQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIGRlYm91bmNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGwgfSBmcm9tIFwiLi9sYW5nL2JhYmVsXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCIuL21haW5cIjtcclxuaW1wb3J0IHsgbWFrZUV4dGVybmFsTGluayB9IGZyb20gXCIuL21vZGFsL2NvbmZpcm1hdGlvbk1vZGFsXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCBpc0Z1bmMsIGxpbmtEb2NzIH0gZnJvbSBcIi4vdXRpbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNrcmlib3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBTa3JpYm9zUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRsZXQge2NvbnRhaW5lckVsfSA9IHRoaXM7XHJcbiBcclxuXHRcdGNvbnRhaW5lckVsLmFkZENsYXNzKFwic2tyaWJpLXNldHRpbmdzXCIpO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiBsW1wic2V0dGluZy50aXRsZVwiXX0pO1xyXG5cdFx0XHJcbiAgICBsZXQgZGVzYyA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7Y2xzOiAnc2tyaWJpLW1vZGFsLWRlc2MnLCBhdHRyOiB7c3R5bGU6IFwibWFyZ2luLWJvdHRvbTogMWVtO1wifX0pXHJcbiAgICBtYWtlRXh0ZXJuYWxMaW5rKGRlc2MuY3JlYXRlRWwoJ2EnLCB7dGV4dDogbFsnZG9jdW1lbnRhdGlvbiddLCBhdHRyOiB7J2hyZWYnOiBsaW5rRG9jcygnc2V0dGluZ3MnKX19KSlcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUobFtcInNldHRpbmcudGVtcGxhdGVEaXJlY3RvcnkubmFtZVwiXSlcclxuXHRcdFx0LnNldERlc2MobFtcInNldHRpbmcudGVtcGxhdGVEaXJlY3RvcnkuZGVzY1wiXSlcclxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0OiBUZXh0QXJlYUNvbXBvbmVudCkgPT4ge3RleHRcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pOyB0ZXh0LmlucHV0RWwuY29scyA9IDMwOyByZXR1cm4gdGV4dH0pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShsW1wic2V0dGluZy5zY3JpcHREaXJlY3RvcnkubmFtZVwiXSlcclxuXHRcdFx0LnNldERlc2MobFtcInNldHRpbmcuc2NyaXB0RGlyZWN0b3J5LmRlc2NcIl0pXHJcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dDogVGV4dEFyZWFDb21wb25lbnQpID0+IHt0ZXh0XHJcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlcilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnNhdmVTZXR0aW5nKCdzY3JpcHRGb2xkZXInLCB2YWx1ZSwgKCkgPT4gdGhpcy5wbHVnaW4uZXRhLmJ1cy5zY3JpcHRMb2FkZXIuZGlyZWN0b3J5Q2hhbmdlZCgpKVxyXG5cdFx0XHRcdH0pOyB0ZXh0LmlucHV0RWwuY29scyA9IDMwOyByZXR1cm4gdGV4dH0pO1xyXG5cclxuXHRcdHRoaXMubWFrZVRvZ2dsZShjb250YWluZXJFbCwgXCJhdXRvUmVsb2FkXCIsIGxbXCJzZXR0aW5nLmF1dG9SZWxvYWQubmFtZVwiXSwgbFtcInNldHRpbmcuYXV0b1JlbG9hZC5kZXNjXCJdKVxyXG5cdFx0dGhpcy5tYWtlVG9nZ2xlKGNvbnRhaW5lckVsLCBcImVycm9yTG9nZ2luZ1wiLCBsW1wic2V0dGluZy5lcnJvckxvZy5uYW1lXCJdLCBsW1wic2V0dGluZy5lcnJvckxvZy5kZXNjXCJdKVxyXG5cdFx0dGhpcy5tYWtlVG9nZ2xlKGNvbnRhaW5lckVsLCBcInZlcmJvc2VMb2dnaW5nXCIsIGxbXCJzZXR0aW5nLnZlcmJvc2UubmFtZVwiXSwgbFtcInNldHRpbmcudmVyYm9zZS5kZXNjXCJdKVxyXG5cdFx0dGhpcy5tYWtlVG9nZ2xlKGNvbnRhaW5lckVsLCBcInRlbXBsYXRlU3VnZ2VzdFwiLCBsW1wic2V0dGluZy50ZW1wbGF0ZVN1Z2dlc3QubmFtZVwiXSwgbFtcInNldHRpbmcudGVtcGxhdGVTdWdnZXN0LmRlc2NcIl0pXHJcblx0XHRcclxuXHRcdC8vIHRoaXMubWFrZVRvZ2dsZShjb250YWluZXJFbCwgXCJzaGFkb3dNb2RlXCIsIFwiU2hhZG93IE1vZGVcIiwgXCJFbWJlZCBza3JpYmlzIGluIGEgc2hhZG93IHJvb3RcIiwgKCkgPT4gaW52b2tlTWV0aG9kT2Y8U2tyaWJpQ2hpbGQ+KFwicmVyZW5kZXJcIiwgLi4udGhpcy5wbHVnaW4uY2hpbGRyZW4pKSAvLyBoaWRkZW4gZm9yIG5vdyAodGhpcyBraWxscyB0aGUgc2tyaWJpY2hpbGQpXHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG1ha2VUb2dnbGUoZWw6IEhUTUxFbGVtZW50LCBzZXR0aW5nOiBrZXlvZiBTa3JpYm9zU2V0dGluZ3MsIG5hbWU6IHN0cmluZywgZGVzYzogc3RyaW5nLCBjYj86ICh2YWx1ZTogYW55KSA9PiB2b2lkKSB7XHJcblx0XHRyZXR1cm4gbmV3IFNldHRpbmcoZWwpXHJcblx0XHQuc2V0TmFtZShuYW1lKVxyXG5cdFx0LnNldERlc2MoZGVzYylcclxuXHRcdC5hZGRUb2dnbGUoKHRvZ2dsZTogVG9nZ2xlQ29tcG9uZW50KSA9PiB7IHRvZ2dsZVxyXG5cdFx0XHQuc2V0VmFsdWUoISF0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nXSlcclxuXHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmddID0gdmFsdWU7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0aWYgKGNiKSBjYih2YWx1ZSk7XHJcblx0XHRcdH0pXHJcblx0XHR9KVxyXG5cdH1cclxuXHJcblx0c2F2ZVNldHRpbmcgPSBkZWJvdW5jZShhc3luYyAoc2V0dGluZzogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiwgY2I/OiBGdW5jdGlvbiwgLi4uYXJnczogYW55W10pID0+IHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKFwic2F2aW5nOiBcIiArIHNldHRpbmcgKyBcIiA9IFwiICsgdmFsdWUpXHJcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nXSA9IHZhbHVlO1xyXG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCkudGhlbigoKSA9PiB7aWYgKGlzRXh0YW50KGNiKSAmJiBpc0Z1bmMoY2IpKSBjYiguLi5hcmdzIHx8IG51bGwpfSlcclxuXHR9LCAyMDAwLCB0cnVlKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrcmlib3NTZXR0aW5ncyB7XHJcblx0W2tleTogc3RyaW5nXSA6IGJvb2xlYW4gfCBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bWJlcjtcclxuXHJcblx0dGVtcGxhdGVGb2xkZXI6IHN0cmluZztcclxuXHRzY3JpcHRGb2xkZXI6IHN0cmluZztcclxuXHR2ZXJib3NlTG9nZ2luZzogYm9vbGVhbjtcclxuXHRkZXZMb2dnaW5nOiBib29sZWFuO1xyXG5cdGVycm9yTG9nZ2luZzogYm9vbGVhbjtcclxuXHRhdXRvUmVsb2FkOiBib29sZWFuO1xyXG5cdHRlbXBsYXRlU3VnZ2VzdDogYm9vbGVhbjtcclxuXHJcblx0LyogdW5saXN0ZWQgKi9cclxuXHRyZWZsZWN0U3R5bGVUYWdUZXh0OiBib29sZWFuO1xyXG5cdHNoYWRvd01vZGU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBTa3JpYm9zU2V0dGluZ3MgPSB7XHJcblx0dGVtcGxhdGVGb2xkZXI6IFwiXCIsXHJcblx0c2NyaXB0Rm9sZGVyOiBcIlwiLFxyXG5cdHZlcmJvc2VMb2dnaW5nOiBmYWxzZSxcclxuXHRkZXZMb2dnaW5nOiBmYWxzZSxcclxuXHRlcnJvckxvZ2dpbmc6IGZhbHNlLFxyXG5cdGF1dG9SZWxvYWQ6IHRydWUsXHJcblx0dGVtcGxhdGVTdWdnZXN0OiB0cnVlLFxyXG5cdFxyXG5cdHJlZmxlY3RTdHlsZVRhZ1RleHQ6IHRydWUsXHJcblx0c2hhZG93TW9kZTogZmFsc2UsXHJcbn0iLCIvKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdFxyXG4gKiB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZlxyXG4gKiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUXHJcbiAqIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZVxyXG4gKiBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlclxyXG4gKiB0aGUgTGljZW5zZS5cclxuICovXHJcblxyXG4vKiBcclxuICogTW9kaWZpZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vc2FtdGhvci9zY29wZWQgKHBvbHlmaWxsIGZvciBkZXByZWNhdGVkIEhUTUwgZmVhdHVyZSBzY29wZWQgc3R5bGVzKVxyXG4gKi9cclxuXHJcbi8qKiBQcmVmaXhlcyBhbGwgQ1NTIHNlbGVjdG9ycyBpbiBhIHNlbGVjdG9yIHRleHQgc3RyaW5nIHdpdGggcHJlZml4IHByZWZpeCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcHJlZml4U2VsZWN0b3JzKHNlbGVjdG9yVGV4dDogc3RyaW5nLCBwcmVmaXg6IHN0cmluZykge1xyXG5cdGNvbnN0IGZvdW5kID0gW107XHJcblxyXG5cdHdoaWxlIChzZWxlY3RvclRleHQpIHtcclxuXHRcdGNvbnN0IGNvbnN1bWVkID0gY29uc3VtZVNlbGVjdG9yKHNlbGVjdG9yVGV4dCwgcHJlZml4KTtcclxuXHRcdGlmIChjb25zdW1lZCA9PT0gbnVsbCkge1xyXG5cdFx0XHRyZXR1cm4gJzpub3QoKiknO1xyXG5cdFx0fVxyXG5cdFx0Zm91bmQucHVzaChjb25zdW1lZC5zZWxlY3Rvcik7XHJcblx0XHRzZWxlY3RvclRleHQgPSBjb25zdW1lZC5yZXN0O1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGZvdW5kLmpvaW4oJywgJyk7XHJcbn1cclxuXHJcbi8vIFRoaXMgbW9uc3Ryb3NpdHkgbWF0Y2hlcyBhbnkgdmFsaWQgYFtmb289XCJiYXJcIl1gIGJsb2NrLCB3aXRoIGVpdGhlciBxdW90ZSBzdHlsZS4gUGFyZW50aGVzaXNcclxuLy8gaGF2ZSBubyBzcGVjaWFsIG1lYW5pbmcgd2l0aGluIGFuIGF0dHJpYnV0ZSBzZWxlY3RvciwgYW5kIHRoZSBjb21wbGV4IHJlZ2V4cCBiZWxvdyBtb3N0bHlcclxuLy8gZXhpc3RzIHRvIGFsbG93IFxcXCIgb3IgXFwnIGluIHN0cmluZyBwYXJ0cyAoZS5nLiBgW2Zvbz1cImJcXFwiYXJcIl1gKS5cclxuY29uc3QgYXR0clJlID0gL15cXFsuKj8oPzooW1wiJ10pKD86LnxcXFxcXFwxKSpcXDEuKikqXFxdLztcclxuY29uc3Qgd2Fsa1NlbGVjdG9yUmUgPSAvKFsoWyxdfDpzY29wZVxcYikvOyAgLy8gXCJpbnRlcmVzdGluZ1wiIHNldHVwc1xyXG5jb25zdCBzY29wZVJlID0gL146c2NvcGVcXGIvO1xyXG5cclxuLyoqXHJcbiAqIENvbnN1bWVzIGEgc2luZ2xlIHNlbGVjdG9yIGZyb20gY2FuZGlkYXRlIHNlbGVjdG9yIHRleHQsIHdoaWNoIG1heSBjb250YWluIG1hbnkuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb25zdW1lU2VsZWN0b3IocmF3OiBzdHJpbmcsIHByZWZpeDogc3RyaW5nKToge3NlbGVjdG9yOiBzdHJpbmcsIHJlc3Q6IHN0cmluZ30gfCBudWxsICB7XHJcbiAgICBsZXQgaSA9IHJhdy5zZWFyY2god2Fsa1NlbGVjdG9yUmUpO1xyXG4gICAgaWYgKGkgPT09IC0xKSB7XHJcbiAgICAgIHJldHVybiB7IHNlbGVjdG9yOiBgJHtwcmVmaXh9ICR7cmF3fWAsIHJlc3Q6ICcnfVxyXG4gICAgfSBlbHNlIGlmIChyYXdbaV0gPT09ICcsJykge1xyXG4gICAgICByZXR1cm4geyBzZWxlY3RvcjogYCR7cHJlZml4fSAke3Jhdy5zdWJzdHIoMCwgaSl9YCwgcmVzdDogcmF3LnN1YnN0cihpICsgMSkgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBsZWZ0bW9zdCA9IHRydWU7ICAgLy8gd2hldGhlciB3ZSdyZSBwYXN0IGEgZGVzY2VuZGFudCBvciBzaW1pbGFyIHNlbGVjdG9yXHJcbiAgICBsZXQgc2NvcGUgPSBmYWxzZTsgICAgIC8vIHdoZXRoZXIgOnNjb3BlIGhhcyBiZWVuIGZvdW5kICsgcmVwbGFjZWRcclxuICAgIGkgPSByYXcuc2VhcmNoKC9cXFMvKTsgIC8vIHBsYWNlIGkgYWZ0ZXIgaW5pdGlhbCB3aGl0ZXNwYWNlIG9ubHlcclxuXHJcbiAgICBsZXQgZGVwdGggPSAwO1xyXG5cdFx0XHJcbiAgXHRvdXRlcjpcclxuICAgIGZvciAoOyBpIDwgcmF3Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgIGNvbnN0IGNoYXIgPSByYXdbaV07XHJcbiAgICAgIHN3aXRjaCAoY2hhcikge1xyXG4gICAgICAgIGNhc2UgJ1snOlxyXG4gICAgICAgICAgY29uc3QgbWF0Y2ggPSBhdHRyUmUuZXhlYyhyYXcuc3Vic3RyKGkpKTtcclxuICAgICAgICAgIGkgKz0gKG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMSkgLSAxOyAgLy8gd2UgYWRkIDEgZXZlcnkgbG9vcFxyXG4gICAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICAgIGNhc2UgJygnOlxyXG4gICAgICAgICAgKytkZXB0aDtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICBjYXNlICc6JzpcclxuICAgICAgICAgIGlmICghbGVmdG1vc3QpIHtcclxuICAgICAgICAgICAgY29udGludWU7ICAvLyBkb2Vzbid0IG1hdHRlciBpZiA6c2NvcGUgaXMgaGVyZSwgaXQnbGwgYWx3YXlzIGJlIGlnbm9yZWRcclxuICAgICAgICAgIH0gZWxzZSBpZiAoIXNjb3BlUmUudGVzdChyYXcuc3Vic3RyKGkpKSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTsgIC8vIG5vdCAnOnNjb3BlJywgaWdub3JlXHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGRlcHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIFJlcGxhY2UgJzpzY29wZScgd2l0aCBvdXIgcHJlZml4LiBUaGlzIGNhbiBoYXBwZW4gbWFueSB0aW1lczsgJzpzY29wZTpzY29wZScgaXMgdmFsaWQuXHJcbiAgICAgICAgICAvLyBJdCB3aWxsIG5ldmVyIGFwcGx5IHRvIGEgZGVzY2VuZGFudCBzZWxlY3RvciAoZS5nLiwgXCIuZm9vIDpzY29wZVwiKSBhcyB0aGlzIGlzIGlnbm9yZWRcclxuICAgICAgICAgIC8vIGJ5IGJyb3dzZXJzIGFueXdheSAoaW52YWxpZCkuXHJcbiAgICAgICAgICByYXcgPSByYXcuc3Vic3RyaW5nKDAsIGkpICsgcHJlZml4ICsgcmF3LnN1YnN0cihpICsgNik7XHJcbiAgICAgICAgICBpICs9IHByZWZpeC5sZW5ndGg7XHJcbiAgICAgICAgICBzY29wZSA9IHRydWU7XHJcbiAgICAgICAgICAtLWk7ICAvLyB3ZSdkIHNraXAgb3ZlciBuZXh0IGNoYXJhY3RlciBvdGhlcndpc2VcclxuICAgICAgICAgIGNvbnRpbnVlOyAgLy8gcnVuIGxvb3AgYWdhaW5cclxuXHJcbiAgICAgIGNhc2UgJyknOlxyXG4gICAgICAgIGlmIChkZXB0aCkgey0tZGVwdGh9XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVwdGgpIHsgY29udGludWUgfVxyXG5cclxuICAgIHN3aXRjaCAoY2hhcikge1xyXG4gICAgICBjYXNlICcsJzpcclxuICAgICAgICBicmVhayBvdXRlcjtcclxuXHJcbiAgICAgIGNhc2UgJyAnOlxyXG4gICAgICBjYXNlICc+JzpcclxuICAgICAgY2FzZSAnfic6XHJcbiAgICAgIGNhc2UgJysnOlxyXG4gICAgICAgIGlmICghbGVmdG1vc3QpIHtjb250aW51ZX1cclxuICAgICAgICBsZWZ0bW9zdCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2VsZWN0b3IgPSAoc2NvcGUgPyAnJyA6IGAke3ByZWZpeH0gYCkgKyByYXcuc3Vic3RyKDAsIGkpO1xyXG4gIHJldHVybiB7c2VsZWN0b3IsIHJlc3Q6IHJhdy5zdWJzdHIoaSArIDEpfTtcclxufSIsImltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IEVCQVIgfSBmcm9tIFwic3JjL3R5cGVzL2NvbnN0XCJcclxuaW1wb3J0IHsgaGFzaCB9IGZyb20gXCJzcmMvdXRpbFwiXHJcbmltcG9ydCB0eXBlIHsgU2tyaWJpQ2hpbGQgfSBmcm9tIFwiLi4vY2hpbGRcIlxyXG5pbXBvcnQgeyBwcmVmaXhTZWxlY3RvcnMgfSBmcm9tIFwiLi9wb2x5ZmlsbFwiXHJcblxyXG4vKiBTVFlMRSBGVU5DVElPTlMgKi9cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdHJpcFN0eWxlRnJvbVN0cmluZyhzdHI6IHN0cmluZyk6IFtzdHJpbmcsIEhUTUxTdHlsZUVsZW1lbnQgfCBudWxsXSB7XHJcblx0bGV0IHggPSBjcmVhdGVEaXYoKVxyXG5cdHguaW5uZXJIVE1MID0gc3RyXHJcblx0Ly8gY29uc29sZS5sb2coJ3ByZXN0cmlwJywgeClcclxuXHRsZXQgc3R5bGUgPSB4LnF1ZXJ5U2VsZWN0b3IoJ3N0eWxlJylcclxuXHRpZiAoc3R5bGUpIHgucmVtb3ZlQ2hpbGQoc3R5bGUpXHJcblxyXG5cdHJldHVybiBbeC5pbm5lckhUTUwsIHN0eWxlID8/IG51bGxdXHJcbn1cclxuXHJcbi8qIHMgbXVzdCBiZSBhdHRhY2hlZCB0byBkb2N1bWVudCBvciBzLnNoZWV0IHdpbGwgYmUgbnVsbCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVTdHlsZShjaGlsZDogU2tyaWJpQ2hpbGQsIGVsOiBIVE1MRWxlbWVudCwgczogSFRNTFN0eWxlRWxlbWVudCk6IEhUTUxTdHlsZUVsZW1lbnQge1xyXG5cdGNoaWxkLmhhc2ggPSBjaGlsZC5oYXNoID8/IGhhc2goY2hpbGQuc291cmNlKVxyXG5cdGNoaWxkLmNvbnRhaW5lckVsLnNldEF0dHIoJ3NrLWhhc2gnLCBjaGlsZC5oYXNoKVxyXG5cdGlmICghcy5zaGVldCkge1xyXG5cdFx0Y29uc29sZS53YXJuKFwiU2tyaWJpOiBDb3VsZCBub3Qgc2NvcGUgc3R5bGUgYmVjYXVzZSBpdCB3YXMgbm90IGF0dGFjaGVkIHRvIHRoZSBkb2N1bWVudCFcIiwgRUJBUiwgXCJTdHlsZTogXCIsIHMsIEVCQVIsIFwiSW4gZWxlbWVudDogXCIsIGVsLCBFQkFSLCBcIk9mIGNoaWxkOlwiLCBjaGlsZCk7IFxyXG5cdFx0cmV0dXJuXHJcblx0fVxyXG5cdGNvbnN0IGwgPSBzLnNoZWV0LmNzc1J1bGVzLmxlbmd0aFxyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgbDsgKytpKSB7XHJcblx0XHRjb25zdCBydWxlID0gcy5zaGVldC5jc3NSdWxlc1tpXVxyXG5cclxuXHRcdGlmICghKHJ1bGUgaW5zdGFuY2VvZiBDU1NJbXBvcnRSdWxlKSkge1xyXG5cdFx0XHRzY29wZVJ1bGUocnVsZSwgWydzay1oYXNoJywgY2hpbGQuaGFzaF0pXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiBDaGFuZ2luZyB0aGUgcnVsZSBwcm9wZXJ0aWVzIGRvZXNuJ3QgY2hhbmdlIHRoZSB0ZXh0IG9mIHRoZSBzdHlsZSBlbGVtZW50LCBzbyB3ZSBkbyBpdCBtYW51YWxseSBzbyBtYWtlIHRoZSByZXNvbHZlZCBiZWhhdmlvciB2aXNpYmxlIGZvciB1c2VycyBpbiBlbGVtZW50IHBhbmVsICovXHJcblx0aWYgKCh3aW5kb3cuYXBwLnBsdWdpbnMucGx1Z2luc1snb2JzaWRpYW4tc2tyaWJpJ10gYXMgU2tyaWJvc1BsdWdpbikuc2V0dGluZ3MucmVmbGVjdFN0eWxlVGFnVGV4dCkge1xyXG5cdFx0bGV0IHJ1bGVzID0gW11cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcy5zaGVldC5jc3NSdWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRydWxlcy5wdXNoKHMuc2hlZXQuY3NzUnVsZXMuaXRlbShpKSlcclxuXHRcdH1cclxuXHRcdGxldCBzdHIgPSBydWxlcy5yZWR1Y2U8c3RyaW5nPigoYTogc3RyaW5nLCBiOiBDU1NSdWxlKSA9PiB7cmV0dXJuIGEgKyBgJHtiLmNzc1RleHR9YCArICdcXG4nfSwgXCJcIilcclxuXHRcdHMudGV4dENvbnRlbnQgPSBzdHJcclxuXHR9XHJcblxyXG5cdHJldHVybiBzXHJcbn1cclxuXHJcbi8qKiBNdXRhdGVzIGEgQ1NTUnVsZSdzIHNlbGVjdG9ycyB0byBzZWxlY3QgZWxlbWVudHMgd2l0aCBhdHRyaWJ1dGUgJ3NrLWhhc2gnIGVxdWFsIHRvIGhhc2ggXHJcbi8qIEBwYXJhbSBydWxlIENTU1J1bGUgdG8gc2NvcGUgXHJcbi8qIEBwYXJhbSBoYXNoIFthdHRyS2V5LCBhdHRyVmFsXSB0byB0YXJnZXQgKi9cclxuZnVuY3Rpb24gc2NvcGVSdWxlKHJ1bGU6IENTU1J1bGUsIHRhcmdldDogW3N0cmluZywgbnVtYmVyXSk6IHZvaWQge1xyXG5cdGlmICghKHJ1bGUgaW5zdGFuY2VvZiBDU1NTdHlsZVJ1bGUpKSByZXR1cm47IC8vIG1lZGlhIGFuZCBpbXBvcnQgcnVsZXMgaWdub3JlZFxyXG5cclxuXHRsZXQgYiA9IHByZWZpeFNlbGVjdG9ycyhydWxlLnNlbGVjdG9yVGV4dCwgYFske3RhcmdldFswXX09JyR7dGFyZ2V0WzFdfSddYClcclxuXHRydWxlLnNlbGVjdG9yVGV4dCA9IGJcclxufSIsImltcG9ydCB7IEV2ZW50UmVmLCBNYXJrZG93blJlbmRlckNoaWxkIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXggfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGRMb2csIHZMb2cgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgc2NvcGVTdHlsZSB9IGZyb20gXCIuL3N0eWxlL3N0eWxlXCI7XHJcblxyXG5pbnRlcmZhY2UgU2tDaGlsZCB7XHJcblx0c2NyaXB0c1VwZGF0ZWQ6ICgpID0+IGFueVxyXG59XHJcblxyXG50eXBlIHNrQ2hpbGRTdGF0ZSA9IFwicHJlXCIgfCBcInBvc3RcIiB8IFwiZXJyb3JcIlxyXG5cclxuZXhwb3J0IGNsYXNzIFNrcmliaUNoaWxkIGV4dGVuZHMgTWFya2Rvd25SZW5kZXJDaGlsZCBpbXBsZW1lbnRzIFNrQ2hpbGQge1xyXG5cdHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG5cdHBhY2tldDogU3RyaW5nZGV4XHJcblx0cHJpdmF0ZSBpbnRlcnZhbHM6IG51bWJlcltdID0gW107XHJcblx0cHJpdmF0ZSBjYk9uVW5sb2FkOiBbRnVuY3Rpb24sIGFueV1bXSA9IFtdXHJcblx0cHJpdmF0ZSBjYk9uUG9zdDogW0Z1bmN0aW9uLCBhbnldW10gPSBbXVxyXG5cclxuXHRpc1Bvc3Q6IGJvb2xlYW4gPSBmYWxzZSAvLyBUcnVlIHdoZW4gY29udGFpbmVyIGhhcyBhdHRhY2hlZCB0byBkb2N1bWVudCBcclxuXHRzdGF0ZTogc2tDaGlsZFN0YXRlID0gXCJwcmVcIlxyXG5cclxuXHR0ZW1wbGF0ZUtleT86IHN0cmluZyAvLyBUaGUgc291cmNlIHRlbXBsYXRlXHJcblx0c291cmNlOiBzdHJpbmcgLy8gVGhlIHVuY29tcGlsZWQgc291cmNlIHN0cmluZyBvZiB0aGUgc2tyaWJpIGludm9jYXRpb25cclxuXHRoYXNoOiBudW1iZXIgLy8gQXNzaWduZWQgd2hlbiBuZWVkZWRcclxuXHRzb3VyY2VzOiB7dGVtcGxhdGVzOiBzdHJpbmdbXSwgc3R5bGVzOiBzdHJpbmdbXX0gPSB7XHJcblx0XHR0ZW1wbGF0ZXM6IFtdLFxyXG5cdFx0c3R5bGVzOiBbXVxyXG5cdH1cclxuXHJcblx0Y29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luLCBlbDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdHN1cGVyKGVsKVxyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHR9XHJcblxyXG4gIHB1YmxpYyBwcm92aWRlQ29udGV4dCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGVsOiB0aGlzLmNvbnRhaW5lckVsLFxyXG4gICAgICByZWdpc3RlckludGVydmFsOiB0aGlzLnNrUmVnaXN0ZXJJbnRlcnZhbC5iaW5kKHRoaXMpLFxyXG4gICAgICByZWdpc3RlclVubG9hZDogdGhpcy5za1JlZ2lzdGVyVW5sb2FkLmJpbmQodGhpcyksXHJcbiAgICAgIHJlZ2lzdGVyRXZlbnQ6IHRoaXMuc2tSZWdpc3RlckV2ZW50LmJpbmQodGhpcyksXHJcblx0XHRcdHJlZ2lzdGVyUG9zdDogdGhpcy5za1JlZ2lzdGVyUG9zdC5iaW5kKHRoaXMpLFxyXG5cdFx0XHRhZGRTdHlsZTogdGhpcy5za0FkZFN0eWxlLmJpbmQodGhpcyksXHJcbiAgICAgIHJlbG9hZDogdGhpcy5yZXJlbmRlciwgLy8gQm91bmQgb24gYXNzaWdubWVudFxyXG4gICAgICBfYzogdGhpc1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblx0cHVibGljIHNjcmlwdHNVcGRhdGVkKCkge1xyXG5cdFx0dGhpcy5yZXJlbmRlcigpXHJcblx0fVxyXG5cclxuXHRwdWJsaWMgdGVtcGxhdGVzVXBkYXRlZChpZDogc3RyaW5nLCBuZXdJZD86IHN0cmluZykge1x0XHJcblx0XHRpZiAoKHRoaXM/LnRlbXBsYXRlS2V5ID09IGlkKSB8fCB0aGlzLnNvdXJjZXMudGVtcGxhdGVzLmNvbnRhaW5zKGlkKSkge1xyXG5cdFx0XHRkTG9nKFwiQ2hpbGQgcmVjZWl2ZWQgdGVtcGxhdGUgdXBkYXRlIG5vdGlmaWNhdGlvbiB0aGF0IG1hdGNoZWQgb25lIG9mIGl0cyBzb3VyY2VzXCIsIGlkLCB0aGlzKVxyXG5cdFx0XHR0aGlzLnJlcmVuZGVyKChpZCA9PSB0aGlzPy50ZW1wbGF0ZUtleSkgPyBpZCA6IG51bGwpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3R5bGVzVXBkYXRlZChpZDogc3RyaW5nKSB7XHJcblx0XHRpZiAoKHRoaXMuc291cmNlcy5zdHlsZXMpLmNvbnRhaW5zKGlkKSkge1xyXG5cdFx0XHRkTG9nKFwiQ2hpbGQgcmVjZWl2ZWQgc3R5bGUgdXBkYXRlIG5vdGlmaWNhdGlvbiB0aGF0IG1hdGNoZWQgb25lIG9mIGl0cyBzb3VyY2VzXCIsIGlkLCB0aGlzKVxyXG5cdFx0XHR0aGlzLnJlcmVuZGVyKClcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGxpc3RlbkZvcih0eXBlOiBcInN0eWxlXCIgfCBcInRlbXBsYXRlXCIsIGlkOiBzdHJpbmcpIHtcclxuXHRcdGxldCBsID0gKHR5cGUgPT0gXCJzdHlsZVwiID8gdGhpcy5zb3VyY2VzLnN0eWxlcyA6IHR5cGUgPT0gXCJ0ZW1wbGF0ZVwiID8gdGhpcy5zb3VyY2VzLnRlbXBsYXRlcyA6IG51bGwpXHJcblx0XHRpZiAobCkgbC5wdXNoKGlkKSBcclxuXHR9XHJcblxyXG5cdHNldFBhY2tldChwYWNrZXQ6IFN0cmluZ2RleCkge1xyXG5cdFx0aWYgKHRoaXMucGFja2V0ID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5wYWNrZXQgPSBwYWNrZXQ7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRvbmxvYWQoKSB7fVxyXG5cclxuXHQvKiBOT1QgY2FsbGVkIGJ5IGNoaWxkLnVubG9hZCgpIChleGNlcHQgc29tZXRpbWVzIGl0IGlzKSAqL1xyXG5cdG9udW5sb2FkKCkge1xyXG5cdFx0ZExvZyhcInNrcmVlYiB1bmxvYWRcIiwgdGhpcy5jb250YWluZXJFbCk7XHJcblx0XHR0aGlzLmNsZWFyKClcclxuXHR9XHJcblxyXG5cdC8qIENhbGxlZCBieSByZXJlbmRlci4gKi9cclxuXHRjbGVhcigpIHtcclxuXHRcdHZMb2coXCJjbGVhclwiLCB0aGlzLmNvbnRhaW5lckVsKVxyXG5cdFx0Zm9yIChsZXQgaSBvZiB0aGlzLmludGVydmFscykgd2luZG93LmNsZWFySW50ZXJ2YWwoaSk7IC8vIHRoZXJlIG1pZ2h0IGJlIGNhc2VzIHdoZXJlIHRoaXMgZG9lc24ndCBnZXQgY2FsbGVkIHByb3Blcmx5ICg/KVxyXG5cdFx0Zm9yIChsZXQgY2Igb2YgdGhpcy5jYk9uVW5sb2FkKSBjYlswXShjYlsxXSk7XHJcblxyXG5cdFx0Ly8gdGhpcy5jb250YWluZXJFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuY29udGFpbmVyRWwpXHJcblx0XHR0aGlzLnBsdWdpbi5jaGlsZHJlbi5yZW1vdmUodGhpcylcclxuXHR9XHJcblxyXG5cdC8qIENhbGxlZCBhZnRlciByZW5kZXIgZnVsZmlsbG1lbnQgKi9cclxuXHRvblBvc3QoKSB7XHJcblx0XHR0aGlzLmlzUG9zdCA9IHRydWVcclxuXHRcdHRoaXMuc3RhdGUgPSBcInBvc3RcIlxyXG5cdFx0Zm9yIChsZXQgY2Igb2YgdGhpcy5jYk9uUG9zdCkgY2JbMF0oY2JbMV0pO1xyXG5cdH1cclxuXHJcbiAgLyotLSBQcm92aWRlciBGdW5jdGlvbnMgLS0qL1xyXG5cclxuXHQvLyBBc3luY2hyb25vdXNseSBhZGRzIGEgc2NvcGVkIHN0eWxlIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lciwgZnJvbSBzdHJpbmcgc3RyXHJcblx0Ly8gV2lsbCBub3QgcmVzb2x2ZSB1bnRpbCBwb3N0ICh3aGVuIGVsZW1lbnQgaXMgYXR0YWNoZWQgdG8gZG9jdW1lbnQsIHdoaWNoIGlzIHJlcXVpcmVkIGZvciBzY29wZVN0eWxlKCkpXHJcblx0Ly8gUmV0dXJucyByZWZlcmVuY2UgdG8gdGhlIGNyZWF0ZWQgZWxlbWVudFxyXG5cdC8vIFRPRE86IGlmIGFib3J0ZWQgYmVmb3JlIHBvc3QsIHdpbGwgcHJvbWlzZSBwZXJzaXN0IGluIG1lbW9yeT9cclxuXHRza0FkZFN0eWxlKHN0cjogc3RyaW5nKTogUHJvbWlzZTxIVE1MU3R5bGVFbGVtZW50PiB7XHJcblx0XHRsZXQgcyA9IGNyZWF0ZUVsKCdzdHlsZScpXHJcblx0XHRzLmlubmVySFRNTCA9IHN0clxyXG5cdFx0dGhpcy5jb250YWluZXJFbC5wcmVwZW5kKHMpXHJcblxyXG5cdFx0bGV0IHAgPSAoKSA9PiB7XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdFx0dGhpcy5za1JlZ2lzdGVyUG9zdCgoKSA9PiB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHNjb3BlU3R5bGUodGhpcywgdGhpcy5jb250YWluZXJFbCwgcykpfSlcclxuXHRcdFx0fSlcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcCgpIGFzIFByb21pc2U8SFRNTFN0eWxlRWxlbWVudD5cclxuXHR9XHJcblxyXG5cdHNrUmVnaXN0ZXJJbnRlcnZhbChjYjogRnVuY3Rpb24sIHRpbWU6IG51bWJlciwgLi4uYXJnczogYW55W10pIHtcclxuXHRcdC8vQHRzLWlnbm9yZVxyXG5cdFx0bGV0IHggPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKC4uLmE6IGFueSkgPT4geyBpZiAodGhpcy5fbG9hZGVkID09IGZhbHNlKSB7d2luZG93LmNsZWFySW50ZXJ2YWwoeCl9XHJcblx0XHRcdGNiKC4uLmEpfSwgdGltZSAqIDEwMDAsIC4uLmFyZ3MpXHJcblx0XHR0aGlzLmludGVydmFscy5wdXNoKHgpXHJcblx0XHRyZXR1cm4geDtcclxuXHR9XHJcblxyXG4gIHNrUmVnaXN0ZXJFdmVudChldmVudDogRXZlbnRSZWYpIHtcclxuICAgIGRMb2coJ1NrQ2hpbGQgcmVnaXN0ZXJlZCBldmVudDonLCBldmVudClcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChldmVudClcclxuICB9XHJcblxyXG5cdHNrUmVnaXN0ZXJVbmxvYWQoY2I6IEZ1bmN0aW9uLCAuLi5hcmdzOiBhbnlbXSkge1xyXG5cdFx0dGhpcy5jYk9uVW5sb2FkLnB1c2goWyguLi54OiBhbnkpID0+IGNiKC4uLngpLCBhcmdzXSlcclxuXHR9XHJcblxyXG5cdHNrUmVnaXN0ZXJQb3N0KGNiOiBGdW5jdGlvbiwgLi4uYXJnczogYW55W10pIHtcclxuXHRcdGlmICghdGhpcy5pc1Bvc3QpIHtcclxuXHRcdFx0dGhpcy5jYk9uUG9zdC5wdXNoKFsoLi4ueDogYW55KSA9PiBjYiguLi54KSwgYXJnc10pXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQoKC4uLng6IGFueSkgPT4gY2IoLi4ueCkpKGFyZ3MpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuICAvLyBBc3NpZ25lZCBpbiByZW5kZXJTa3JpYmkoKVxyXG4gIHJlcmVuZGVyKC4uLmFyZ3M6IGFueVtdKSB7fVxyXG59IiwiaW1wb3J0IHsgRnV6enlTdWdnZXN0TW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU3VnZ2VzdGlvbk1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XHJcbiAgcHJpdmF0ZSByZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZDtcclxuXHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFNrcmlib3NQbHVnaW4pIHtcclxuICAgIHN1cGVyKHBsdWdpbi5hcHApXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uZXRhLmdldENhY2hlS2V5cygpXHJcbiAgfVxyXG5cclxuICBnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge3JldHVybiBpdGVtfVxyXG5cclxuICBvbkNob29zZUl0ZW0oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLnJlc29sdmUoaXRlbSlcclxuICB9XHJcblxyXG4gIGFzeW5jIG9wZW5BbmRHZXRWYWx1ZShyZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCwgcmVqZWN0OiAoKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlXHJcbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdFxyXG4gICAgdGhpcy5vcGVuKClcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBFdGFDb25maWcgfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29uZmlnXCI7XHJcbmltcG9ydCB7IENhbGxiYWNrRm4gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvZmlsZS1oYW5kbGVyc1wiO1xyXG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gXCJzcmMvcmVuZGVyL2NoaWxkXCI7XHJcbmltcG9ydCB7IE1vZGVzLCBGbGFncyB9IGZyb20gXCIuL2NvbnN0XCI7XHJcblxyXG5leHBvcnQgdHlwZSBTa3JpYmlSZXN1bHQgPSBTa3JpYmlSZXN1bHRSZW5kZXJlZCB8IFNrcmliaVJlc3VsdFF1ZXVlZCB8IHZvaWRcclxuZXhwb3J0IHR5cGUgU2tyaWJpUmVzdWx0UmVuZGVyZWQgPSBbUHJvbWlzZTxIVE1MRGl2RWxlbWVudD4sIFNrcmliaUNoaWxkXVxyXG5leHBvcnQgdHlwZSBTa3JpYmlSZXN1bHRRdWV1ZWQgPSB7bXNnOiBzdHJpbmcsIHFpOiBudW1iZXJ9XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrQ29udGV4dCB7XHJcblx0dGltZTogbnVtYmVyLCAvLyBUaW1lIG9mIGluaXRpYWwgcmVuZGVyIHByb21pc2UgZGlzcGF0Y2hcclxuXHRmbGFnOiBudW1iZXIsXHJcblx0ZGVwdGg6IG51bWJlciwgXHJcblx0c291cmNlOiBzdHJpbmcsIC8vIE9yaWdpbmFsIHRleHQgY29udGVudFxyXG5cdGN0eD86IGFueVx0Ly8gU3RvcmVzIHBhc3NlZCB0ZW1wbGF0ZSB2YWx1ZXMsIG51bGwgb24gbm9uLXRlbXBsYXRlc1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFByb2Nlc3Nvck1vZGUge1xyXG5cdHNyY1R5cGU6IE1vZGVzXHJcblx0ZmxhZz86IEZsYWdzXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGVtcGxhdGUge1xyXG5cdGZpbGU6IFRGaWxlXHJcbn1cclxuXHJcbmV4cG9ydCBkZWNsYXJlIHR5cGUgU3RyaW5nZGV4PFQgPSBhbnk+ID0ge1tpbmRleDogc3RyaW5nXTogVH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXJnU2V0IHtbaW5kZXg6IHN0cmluZ106IHN0cmluZyB8IHN0cmluZ1tdfTtcclxuXHJcbmV4cG9ydCBlbnVtIHByb21wdFR5cGVzIHtcclxuICBzdHJpbmcgPSBcInN0cmluZ1wiXHJcbn1cclxuXHJcbi8qIEFuIG9iamVjdCBjcmVhdGVkIGZyb20gdGVtcGxhdGUgbWV0YWRhdGEsIHVzZWQgYnkgaW5zZXJ0aW9uTW9kYWwuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgZmllbGRQcm9tcHQge1xyXG5cdFtpbmRleDogc3RyaW5nXTogYW55XHJcblx0aWQ6IHN0cmluZ1xyXG5cdHR5cGU6IHByb21wdFR5cGVzXHJcblx0bmFtZTogc3RyaW5nXHJcblx0cGxhY2Vob2xkZXI6IHN0cmluZ1xyXG5cdGRlZmF1bHQ6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHNjb3BlZFZhcnMgZXh0ZW5kcyBTdHJpbmdkZXgge1xyXG4gIHNrOiBvYmplY3QsIFxyXG4gIEU6IEV0YUNvbmZpZywgXHJcbiAgY2I/OiBDYWxsYmFja0ZuLCBcclxuICBzY29wZT86IFN0cmluZ2RleFxyXG59XHJcblxyXG5leHBvcnQgZGVjbGFyZSB0eXBlIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgPSAoc2NvcGU6IHNjb3BlZFZhcnMpID0+IFByb21pc2U8c3RyaW5nPjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRHluYW1pY1N0YXRlIHtcclxuICBlbDogSFRNTEVsZW1lbnQsXHJcbiAgZmlsZTogVEZpbGUsXHJcbiAgY2hpbGQ6IFNrcmliaUNoaWxkXHJcbn1cclxuXHJcbi8qIEZvciBvYmplY3RzIHRoYXQgbXVzdCByZWFjdCB0byBmaWxlIGNoYW5nZSBldmVudHMgKi9cclxuZXhwb3J0IGludGVyZmFjZSBGaWxlTWluZGVyIHtcclxuXHRmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkXHJcblx0ZmlsZUFkZGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkXHJcblx0ZmlsZURlbGV0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWRcclxuXHRmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZFxyXG5cdGRpcmVjdG9yeUNoYW5nZWQoKTogdm9pZFxyXG5cdGlzSW5Eb21haW4oZmlsZTogVEFic3RyYWN0RmlsZSk6IGJvb2xlYW5cclxuXHRkaXJlY3Rvcnk6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBxdWV1ZWRUZW1wbGF0ZSA9IHtcclxuXHRmdW5jdGlvbjogKGVsOiBIVE1MRWxlbWVudCwgdGltZTogbnVtYmVyKSA9PiBQcm9taXNlPFNrcmliaVJlc3VsdD4sXHJcblx0ZWxlbWVudDogSFRNTEVsZW1lbnRcclxufSIsImltcG9ydCB7IEFic3RyYWN0VGV4dENvbXBvbmVudCwgRWRpdG9yLCBFZGl0b3JSYW5nZU9yQ2FyZXQsS2V5bWFwRXZlbnRIYW5kbGVyLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBsIH0gZnJvbSBcInNyYy9sYW5nL2JhYmVsXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGZpZWxkUHJvbXB0LCBwcm9tcHRUeXBlcyB9IGZyb20gXCIuLi90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBpc0V4dGFudCwgdG9EdXBlUmVjb3JkIH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBJbnNlcnRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHBsdWdpbjogU2tyaWJvc1BsdWdpbjtcclxuICBwcml2YXRlIGVkaXRvcjogRWRpdG9yO1xyXG4gIHByaXZhdGUga2V5cHJlc3NSZWY6IEtleW1hcEV2ZW50SGFuZGxlcjtcclxuXHJcbiAgY3VycmVudElEOiBzdHJpbmc7XHJcbiAgdGV4dElucHV0OiBBYnN0cmFjdFRleHRDb21wb25lbnQ8YW55PlxyXG5cclxuICB2YWxGaWVsZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFNrcmlib3NQbHVnaW4sIGVkaXRvcjogRWRpdG9yLCBpZDogc3RyaW5nKSB7XHJcbiAgICBzdXBlcihwbHVnaW4uYXBwKVxyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmVkaXRvciA9IGVkaXRvcjtcclxuXHJcbiAgICB0aGlzLmN1cnJlbnRJRCA9IGlkLnRvU3RyaW5nKClcclxuXHJcbiAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwic2tyaWJpLWluc2VydGlvbi1tb2RhbFwiKVxyXG4gICAgdGhpcy50aXRsZUVsLnNldFRleHQobFtcIm1vZGFsLmluc2VydC50aXRsZVwiXSlcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIHRoaXMuY3JlYXRlKClcclxuICB9XHJcblxyXG4gIGNyZWF0ZSgpIHtcclxuICAgIGxldCBzID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBzLmFkZERyb3Bkb3duKChkcm9wKSA9PiB7IGRyb3BcclxuICAgICAgLmFkZE9wdGlvbnModG9EdXBlUmVjb3JkKHRoaXMucGx1Z2luLmV0YS5nZXRDYWNoZUtleXMoKSkpXHJcbiAgICAgIC5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRJRClcclxuICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SUQgPSB2XHJcbiAgICAgICAgbGV0IGYgPSB0aGlzLmdlbmVyYXRlRmllbGRzKGZpZWxkc0RpdiwgdGhpcy5jdXJyZW50SUQpO1xyXG4gICAgICAgICgoZi5sZW5ndGggPiAwKSA/IGZbMF0gOiB0aGlzLnRleHRJbnB1dCkuaW5wdXRFbC5mb2N1cygpO1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgZmllbGRzRGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLW1vZGFsLWZpZWxkc1wifSlcclxuXHJcbiAgICBsZXQgdCA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgdC5hZGRUZXh0KCh0ZSkgPT4ge3RoaXMudGV4dElucHV0ID0gdGU7IHJldHVybiB0ZTt9KVxyXG4gICAgdC5zZXROYW1lKGxbXCJtb2RhbC5pbnNlcnQuYXBwZW5kXCJdKVxyXG4gICAgdC5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJza3JpYmktbW9kYWwtZmllbGQtYXBwZW5kXCIpXHJcblxyXG4gICAgbGV0IGYgPSB0aGlzLmdlbmVyYXRlRmllbGRzKGZpZWxkc0RpdiwgdGhpcy5jdXJyZW50SUQpO1xyXG4gICAgKChmLmxlbmd0aCA+IDApID8gZlswXSA6IHRoaXMudGV4dElucHV0KS5pbnB1dEVsLmZvY3VzKCk7XHJcblxyXG4gICAgbGV0IGNvbmZpcm0gPSBuZXcgU2V0dGluZyh0aGlzLmNvbnRlbnRFbClcclxuICAgIGxldCBjYiA9IGNvbmZpcm0uYWRkQnV0dG9uKChidXR0b24pID0+IGJ1dHRvblxyXG4gICAgICAuc2V0QnV0dG9uVGV4dChsW1wibW9kYWwuaW5zZXJ0Lmluc2VydFwiXSlcclxuICAgICAgLm9uQ2xpY2soKCkgPT4gdGhpcy5kb0luc2VydCgpKSlcclxuXHJcbiAgICB0aGlzLmtleXByZXNzUmVmID0gdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCB0aGlzLmRvSW5zZXJ0LmJpbmQodGhpcykpXHJcbiAgfVxyXG5cclxuICBvbkNsb3NlKCkge1xyXG4gICAgdGhpcy5zY29wZS51bnJlZ2lzdGVyKHRoaXMua2V5cHJlc3NSZWYpXHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUZpZWxkcyhlbDogSFRNTEVsZW1lbnQsIGlkOiBzdHJpbmcpIHtcclxuICAgIGVsLmVtcHR5KCk7XHJcblxyXG4gICAgdmFyIGFycjogQWJzdHJhY3RUZXh0Q29tcG9uZW50PGFueT5bXSA9IFtdO1xyXG5cclxuICAgIGlmICh0aGlzLnBsdWdpbi5ldGEudGVtcGxhdGVzLmdldChpZCk/LmZyb250bWF0dGVyKSB7XHJcbiAgICAgIGxldCBmbSA9IHRoaXMucGx1Z2luLmV0YS50ZW1wbGF0ZXMuZ2V0KGlkKS5mcm9udG1hdHRlclxyXG4gICAgICBsZXQgcHYgPSBbXVxyXG4gICAgICBmb3IgKGxldCB2IG9mIE9iamVjdC5rZXlzKGZtKSkge1xyXG4gICAgICAgIGlmICh2LmNoYXJBdCgwKT09XCJfXCIpIHtcclxuICAgICAgICAgIGxldCB2biA9IHYuc3Vic3RyaW5nKDEpXHJcbiAgICAgICAgICBsZXQgZm1hID0gdGhpcy5wYXJzZVByb21wdFZhbCh2biwgZm1bdl0pXHJcblxyXG4gICAgICAgICAgbGV0IHMgPSBuZXcgU2V0dGluZyhlbClcclxuICAgICAgICAgIHMuc2V0dGluZ0VsLmFkZENsYXNzKFwic2tyaWJpLW1vZGFsLXRlbXBsYXRlLWZpZWxkXCIpXHJcbiAgICAgICAgICBpZiAoZm1hLnR5cGUgPT0gcHJvbXB0VHlwZXMuc3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGFyci5wdXNoKHRoaXMuY3JlYXRlVGV4dEZpZWxkKHMsIGZtYSkpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzLnNldE5hbWUoZm1hLm5hbWUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFycjtcclxuICB9XHJcblxyXG4gIGNyZWF0ZVRleHRGaWVsZChzZXQ6IFNldHRpbmcsIGZtYTogZmllbGRQcm9tcHQpIHtcclxuICAgIGxldCB0O1xyXG4gICAgc2V0LmFkZFRleHQoKHRleHQpID0+IHsgXHJcbiAgICAgIHRleHRcclxuICAgICAgLnNldFZhbHVlKGZtYS5kZWZhdWx0KVxyXG4gICAgICAuc2V0UGxhY2Vob2xkZXIoZm1hLnBsYWNlaG9sZGVyKVxyXG4gICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgdGhpcy52YWxGaWVsZHNbZm1hLmlkXSA9IHZhbHVlXHJcbiAgICAgIH0pXHJcbiAgICAgIHRleHQuaW5wdXRFbC5hZGRDbGFzcyhcInNrcmliaS10ZXh0LWlucHV0XCIpXHJcbiAgICAgIHQgPSB0ZXh0XHJcbiAgICB9KVxyXG5cclxuICAgIGlmIChmbWEuZGVmYXVsdC5sZW5ndGggPiAwKSB0aGlzLnZhbEZpZWxkc1tmbWEuaWRdID0gZm1hLmRlZmF1bHRcclxuXHJcbiAgICByZXR1cm4gdFxyXG4gIH1cclxuXHJcbiAgcGFyc2VQcm9tcHRWYWwoazogYW55LCB2YWw6IGFueSk6IGZpZWxkUHJvbXB0IHtcclxuICAgIGxldCB2OiBmaWVsZFByb21wdCA9IHtcclxuICAgICAgaWQ6IGssXHJcbiAgICAgIHR5cGU6IHByb21wdFR5cGVzLnN0cmluZyxcclxuICAgICAgbmFtZTogaXNFeHRhbnQodmFsPy5uYW1lKSA/IHZhbC5uYW1lIDogayxcclxuICAgICAgcGxhY2Vob2xkZXI6IGlzRXh0YW50KHZhbD8ucGxhY2Vob2xkZXIpID8gdmFsLnBsYWNlaG9sZGVyIDogXCJcIixcclxuICAgICAgZGVmYXVsdDogaXNFeHRhbnQodmFsPy5kZWZhdWx0KSA/IHZhbC5kZWZhdWx0IDogaXNFeHRhbnQodmFsPy5kZWYpID8gdmFsLmRlZiA6IFwiXCIsXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZcclxuICB9XHJcblxyXG4gIGRvSW5zZXJ0KCkge1xyXG4gICAgbGV0IGlkID0gdGhpcy5jdXJyZW50SURcclxuXHJcbiAgICBsZXQgb3NlbCA9IHRoaXMuZWRpdG9yLmxpc3RTZWxlY3Rpb25zKClcclxuICAgIFxyXG4gICAgbGV0IHRvSW5zZXJ0ID0gYFxcYHs6JHtpZH1gXHJcblxyXG4gICAgZm9yIChsZXQgZSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnZhbEZpZWxkcykpIHtcclxuICAgICAgdG9JbnNlcnQgKz0gYCB8ICR7ZVswXX06ICR7ZVsxXX1gXHJcbiAgICB9XHJcblxyXG4gICAgdG9JbnNlcnQgKz0gKHRoaXM/LnRleHRJbnB1dC5nZXRWYWx1ZSgpLmxlbmd0aCA+IDApID8gXCIgfCBcIiArIHRoaXMudGV4dElucHV0LmdldFZhbHVlKCkgOiBcIlwiXHJcbiAgICB0b0luc2VydCArPSBgfVxcYGBcclxuXHJcbiAgICB0aGlzLmVkaXRvci5nZXREb2MoKS5yZXBsYWNlU2VsZWN0aW9uKHRvSW5zZXJ0KVxyXG5cclxuICAgIGxldCBuc2VsOiBFZGl0b3JSYW5nZU9yQ2FyZXRbXSA9IFtdIFxyXG4gICAgZm9yIChsZXQgcCBvZiBvc2VsKSB7bnNlbC5wdXNoKHtmcm9tOiB7bGluZTogcC5hbmNob3IubGluZSwgY2g6IHAuYW5jaG9yLmNoICsgKHRvSW5zZXJ0Lmxlbmd0aCl9fSl9XHJcbiAgICB0aGlzLmVkaXRvci50cmFuc2FjdGlvbih7c2VsZWN0aW9uczogbnNlbH0pXHJcblxyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBYnN0cmFjdFRleHRDb21wb25lbnQsIEtleW1hcEV2ZW50SGFuZGxlciwgTWFya2Rvd25TZWN0aW9uSW5mb3JtYXRpb24sIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGwgfSBmcm9tIFwic3JjL2xhbmcvYmFiZWxcIjtcclxuaW1wb3J0IHsgU2tyaWJpQ2hpbGQgfSBmcm9tIFwic3JjL3JlbmRlci9jaGlsZFwiO1xyXG5pbXBvcnQgeyBNb2RlcyB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgYXZlcmFnZSwgIGludm9rZU1ldGhvZE9mLCAgbGlua0RvY3MsIHJvdW5kVG8sIHZMb2cgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5pbXBvcnQgeyBtYWtlRXh0ZXJuYWxMaW5rIH0gZnJvbSBcIi4vY29uZmlybWF0aW9uTW9kYWxcIjtcclxuXHJcbmNvbnN0IG1heGltdW1JdGVyYXRpb25zID0gMTAwMDBcclxuXHJcbmV4cG9ydCBjbGFzcyBUZXN0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW47XHJcbiAgcHJpdmF0ZSBrZXlwcmVzc1JlZjogS2V5bWFwRXZlbnRIYW5kbGVyO1xyXG5cclxuICB0ZXh0RmllbGRUb0V2YWw6IEFic3RyYWN0VGV4dENvbXBvbmVudDxhbnk+XHJcbiAgaXRlcmF0aW9uczogbnVtYmVyID0gMTA7XHJcbiAgbXVsdGlCbG9jazogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICByZXN1bHRzRmllbGQ6IEhUTUxFbGVtZW50XHJcblxyXG4gIHZhbEZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XHJcblxyXG4gIHRleHRJbjogc3RyaW5nXHJcbiAgYXV0b2ZpbGw6IHtcclxuICAgIHR5cGU6IHN0cmluZ1xyXG4gICAgdmFsdWU6IHN0cmluZ1xyXG4gIH0gPSBudWxsXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbiwgYXV0b2ZpbGw/OiB7dHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nfSkge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcClcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgdGhpcy5hdXRvZmlsbCA9IGF1dG9maWxsXHJcbiAgICBcclxuICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJza3JpYmktdGVzdC1tb2RhbFwiKVxyXG4gICAgdGhpcy50aXRsZUVsLnNldFRleHQobFsnbW9kYWwucGVyZi50aXRsZSddKVxyXG5cclxuICAgIGxldCBkZXNjID0gY3JlYXRlRGl2KHtjbHM6ICdza3JpYmktbW9kYWwtZGVzYyd9KVxyXG4gICAgbWFrZUV4dGVybmFsTGluayhkZXNjLmNyZWF0ZUVsKCdhJywge3RleHQ6IGxbJ2RvY3VtZW50YXRpb24nXSwgYXR0cjogeydocmVmJzogbGlua0RvY3MoJ2NvbW1hbmRzL3BlcmZvcm1hbmNlJyl9fSkpXHJcblxyXG4gICAgZGVzYy5pbnNlcnRBZnRlcih0aGlzLnRpdGxlRWwpXHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKSB7XHJcbiAgICB0aGlzLmNyZWF0ZSgpXHJcbiAgfVxyXG5cclxuICBjcmVhdGUoKSB7XHJcbiAgICBsZXQgZmllbGRUZXh0VG9FdmFsID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBmaWVsZFRleHRUb0V2YWwuYWRkVGV4dEFyZWEoKHRleHQpID0+IHt0aGlzLnRleHRGaWVsZFRvRXZhbCA9IHRleHQ7IHJldHVybiB0ZXh0fSlcclxuICAgIGZpZWxkVGV4dFRvRXZhbC5zZXROYW1lKGxbXCJtb2RhbC5wZXJmLnRleHRUb0V2YWx1YXRlLm5hbWVcIl0pXHJcbiAgICBmaWVsZFRleHRUb0V2YWwuc2V0RGVzYyhsW1wibW9kYWwucGVyZi50ZXh0VG9FdmFsdWF0ZS5kZXNjXCJdKVxyXG4gICAgdGhpcy50ZXh0RmllbGRUb0V2YWwuc2V0UGxhY2Vob2xkZXIobFtcIm1vZGFsLnBlcmYudGV4dFRvRXZhbHVhdGUucGxhY2Vob2xkZXJcIl0pXHJcbiAgICBpZiAodGhpcy5hdXRvZmlsbCkge1xyXG4gICAgICBmaWVsZFRleHRUb0V2YWwuaW5mb0VsLmFwcGVuZChjcmVhdGVEaXYoe3RleHQ6IGBBdXRvZmlsbGVkIGZyb20gJHt0aGlzLmF1dG9maWxsLnR5cGV9YCwgY2xzOiAnc2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uIHNrcmliaS1hdXRvZmlsbC1ub3RpZmljYXRpb24nfSkpXHJcbiAgICAgIHRoaXMudGV4dEZpZWxkVG9FdmFsLnNldFZhbHVlKHRoaXMuYXV0b2ZpbGwudmFsdWUpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZpZWxkSXRlcmF0aW9ucyA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgbGV0IGl0ZXJzOiBIVE1MSW5wdXRFbGVtZW50ID0gZmllbGRJdGVyYXRpb25zLmNvbnRyb2xFbC5jcmVhdGVFbCgnaW5wdXQnLCB7YXR0cjoge3R5cGU6ICdudW1iZXInfX0pXHJcbiAgICBpdGVycy5kZWZhdWx0VmFsdWUgPSB0aGlzLml0ZXJhdGlvbnMudG9TdHJpbmcoKVxyXG4gICAgaXRlcnMub25jaGFuZ2UgPSAoZXYpID0+IHt0aGlzLml0ZXJhdGlvbnMgPSBpdGVycy52YWx1ZUFzTnVtYmVyfVxyXG4gICAgZmllbGRJdGVyYXRpb25zLnNldE5hbWUobFtcIm1vZGFsLnBlcmYuZXZhbEl0ZXJhdGlvbnMubmFtZVwiXSlcclxuICAgIGZpZWxkSXRlcmF0aW9ucy5zZXREZXNjKGxbXCJtb2RhbC5wZXJmLnRleHRUb0V2YWx1YXRlLmRlc2NcIl0pXHJcblxyXG4gICAgbGV0IGJsb2NrU2V0dGluZyA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgYmxvY2tTZXR0aW5nLmFkZFRvZ2dsZSgodG9nKSA9PiB7XHJcbiAgICAgIHRvZy5zZXRWYWx1ZSh0aGlzLm11bHRpQmxvY2spXHJcbiAgICAgIHRvZy5vbkNoYW5nZSgodikgPT4gdGhpcy5tdWx0aUJsb2NrID0gdilcclxuICAgICAgcmV0dXJuIHRvZ1xyXG4gICAgfSlcclxuICAgIGJsb2NrU2V0dGluZy5zZXROYW1lKGxbXCJtb2RhbC5wZXJmLmV2YWxCbG9ja3NcIl0pXHJcblxyXG4gICAgbGV0IGNvbmZpcm0gPSBuZXcgU2V0dGluZyh0aGlzLmNvbnRlbnRFbCkuc2V0Q2xhc3MoJ3NrcmliaS1idXR0b24tZXZhbCcpXHJcbiAgICBjb25maXJtLmFkZEJ1dHRvbigoYnV0dG9uKSA9PiBidXR0b25cclxuICAgICAgLnNldEJ1dHRvblRleHQobFtcIm1vZGFsLnBlcmYuZXZhbHVhdGVcIl0pXHJcbiAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuZG9FdmFsKCkpKVxyXG4gICAgdGhpcy5rZXlwcmVzc1JlZiA9IHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgdGhpcy5kb0V2YWwuYmluZCh0aGlzKSlcclxuXHJcbiAgICB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnaHInKVxyXG5cclxuICAgIHRoaXMucmVzdWx0c0ZpZWxkID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLXRlc3QtcmVzdWx0cy1maWVsZFwifSlcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICB0aGlzLnNjb3BlLnVucmVnaXN0ZXIodGhpcy5rZXlwcmVzc1JlZilcclxuICB9XHJcblxyXG4gIGFzeW5jIGRvRXZhbCgpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uaW5pdExvYWRlZCkge1xyXG4gICAgICB0aGlzLnJlc3VsdHNGaWVsZC5zZXRUZXh0KFwiVGVtcGxhdGUgY2FjaGUgbm90IHJlYWR5IVwiKVxyXG4gICAgICByZXR1cm47IFxyXG4gICAgfVxyXG5cclxuICAgIGxldCBjb250YWluZXIgPSBjcmVhdGVEaXYoKVxyXG4gICAgbGV0IGVsID0gY3JlYXRlRGl2KClcclxuXHJcbiAgICBsZXQgYmxvY2tzVG9Qcm9jZXNzOiBIVE1MRWxlbWVudFtdID0gW11cclxuICAgIGxldCB0b0l0ZXIgPSBNYXRoLm1pbih0aGlzLml0ZXJhdGlvbnMsIG1heGltdW1JdGVyYXRpb25zKVxyXG4gICAgaWYgKHRoaXMubXVsdGlCbG9jaykge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvSXRlcjsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGQgPSBjcmVhdGVEaXYoKVxyXG4gICAgICAgIGQuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogdGhpcy50ZXh0RmllbGRUb0V2YWwuZ2V0VmFsdWUoKX0pXHJcbiAgICAgICAgYmxvY2tzVG9Qcm9jZXNzLnB1c2goZClcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IHNpbmdsZURpdiA9IGNyZWF0ZURpdigpXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9JdGVyOyBpKyspIHtcclxuICAgICAgICBzaW5nbGVEaXYuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogdGhpcy50ZXh0RmllbGRUb0V2YWwuZ2V0VmFsdWUoKX0pXHJcbiAgICAgIH1cclxuICAgICAgYmxvY2tzVG9Qcm9jZXNzLnB1c2goc2luZ2xlRGl2KVxyXG4gICAgfVxyXG5cclxuICAgIGxldCB0aW1lU3RhcnQgPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcclxuXHJcbiAgICBjb25zdCBwcm9tczogUHJvbWlzZTxbW10sIG51bWJlciwgbnVtYmVyXT5bXSA9IGJsb2Nrc1RvUHJvY2Vzcy5tYXAoYXN5bmMgKGRpdikgPT4ge1xyXG4gICAgICBsZXQgcHJvbWlzZVN0YXJ0VGltZSA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG5cclxuICAgICAgbGV0IHByb21pc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9jZXNzb3IucHJvY2Vzc0VudHJ5KHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgZGl2LCB7XHJcbiAgICAgICAgcmVtYWluaW5nTmVzdExldmVsOiA0LFxyXG4gICAgICAgIGRvY0lkOiAnNTU1NTU1NTUnLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBudWxsLFxyXG4gICAgICAgIHNvdXJjZVBhdGg6IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpPy5wYXRoIHx8IFwiXCIsXHJcbiAgICAgICAgYWRkQ2hpbGQ6IChjaGlsZDogYW55KSA9PiB7fSxcclxuICAgICAgICBnZXRTZWN0aW9uSW5mbzogKCkgPT4ge3JldHVybiBudWxsIGFzIE1hcmtkb3duU2VjdGlvbkluZm9ybWF0aW9ufSxcclxuICAgICAgICBjb250YWluZXJFbDogY29udGFpbmVyLFxyXG4gICAgICAgIGVsOiBlbFxyXG4gICAgICB9LCA0LCBmYWxzZSwgbnVsbCkuY2F0Y2goKCkgPT4ge30pXHJcblxyXG4gICAgICByZXR1cm4gW3Byb21pc2UsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSwgcHJvbWlzZVN0YXJ0VGltZV0gYXMgYW55XHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucmVzdWx0c0ZpZWxkLnNldFRleHQobFtcIm1vZGFsLnBlcmYuZXZhbHVhdGluZ1wiXSlcclxuXHJcbiAgICBsZXQgc2V0dGxlZFZhbHVlcyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChwcm9tcylcclxuXHJcbiAgICBcclxuICAgIHZMb2coYFBlcmZvcm1hbmNlIHRlc3Qgc2V0dGxlZCBpbjogJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS10aW1lU3RhcnQsIDMpfW1zYClcclxuXHJcbiAgICBsZXQgZnVsbGZpbGxlZDogW2FueVtdLCBudW1iZXIsIG51bWJlcl1bXSA9IHNldHRsZWRWYWx1ZXMubWFwKCh2KSA9PiB7aWYgKHYuc3RhdHVzID09ICdmdWxmaWxsZWQnKSByZXR1cm4gdi52YWx1ZX0pXHJcbiAgICBsZXQgdGltZXMgPSBmdWxsZmlsbGVkLm1hcCgocmVzdWx0KSA9PiAocmVzdWx0WzFdIGFzIG51bWJlciAtIChyZXN1bHRbMl0gYXMgbnVtYmVyKSkpXHJcbiAgICBsZXQgYXZnID0gYXZlcmFnZSguLi50aW1lcylcclxuICAgIFxyXG4gICAgbGV0IHA6IGFueVtdID0gW11cclxuICAgIGZ1bGxmaWxsZWQubWFwKHJlcyA9PiByZXNbMF0ubWFwKChhKSA9PiBwLnB1c2goYSkpKVxyXG4gICAgbGV0IGNoaWxkcmVuID0gKGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChwKSkubWFwKChyZXopID0+IHtpZiAocmV6LnN0YXR1cyA9PSBcImZ1bGZpbGxlZFwiKSByZXR1cm4gcmV6LnZhbHVlWzFdfSlcclxuICAgIFxyXG4gICAgdGhpcy5yZXN1bHRzRmllbGQuc2V0VGV4dChgJHtsW1wibW9kYWwucGVyZi5yZXN1bHRzXCJdfSAoJHtjaGlsZHJlbi5sZW5ndGh9IGNoaWxkcmVuIGluICR7IGwuXygodGltZXMubGVuZ3RoID4gMSA/IFwibW9kYWwucGVyZi5yZXN1bHRzQmxvY2tDb3VudC5wbHVyYWxcIiA6IFwibW9kYWwucGVyZi5yZXN1bHRzQmxvY2tDb3VudC5zaW5nbGVcIiksIHRpbWVzLmxlbmd0aC50b1N0cmluZygpKX0pOiAke3JvdW5kVG8oYXZnLCAzKX1tc2ApXHJcbiAgXHJcbiAgICAvLyBpbnZva2VNZXRob2RPZjxTa3JpYmlDaGlsZD4oXCJjbGVhclwiLCAuLi5jaGlsZHJlbikgLy8gVW5sb2FkIGRvZXNuJ3Qgc2VlbSB0byBiZSBpbnZva2VkIGNvbnNpc3RlbnRseSBzbyBsZXQncyBqdXN0IG1ha2Ugc3VyZSBldmVyeXRoaW5nIGlzIGNsZWFyZWRcclxuICAgIEFycmF5LmZyb20oY2hpbGRyZW4pLmZvckVhY2goKGNoaWxkOiBTa3JpYmlDaGlsZCkgPT4gY2hpbGQuY2xlYXIoKSlcclxuICAgIGJsb2Nrc1RvUHJvY2Vzcy5tYXAoYmxvY2sgPT4gYmxvY2sucmVtb3ZlKCkpIC8vIENoaWxkcmVuIGFyZSBlYXNpZXIgdG8gY29sbGVjdCB3aGVuIHRoZXkgbGFjayBzaGVsdGVyXHJcbiAgICBjb250YWluZXIucmVtb3ZlKCk7IGVsLnJlbW92ZSgpOyAvLyBPbmUgZGF5LCB0aGUgbGFzdCBwZXJzb24gd2hvIHJlbWVtYmVycyB5b3Ugd2lsbCBkaWUsIGFuZCB5b3Ugd2lsbCBiZSBmb3Jnb3R0ZW4gZm9yZXZlclxyXG4gIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGludGVyZmFjZSBSZWdlbnREYXRhIHtcclxuXHRbaW5kZXg6IHN0cmluZ106IGFueSxcclxuXHRjbGFzcz86IHN0cmluZyxcclxuXHRsYWJlbD86IHN0cmluZyxcclxuXHRjbGVhcj86IGJvb2xlYW4sXHJcblx0aG92ZXI/OiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJFcnJvcihlbDogSFRNTEVsZW1lbnQsIGU6IFJlZ2VudERhdGEpIHtcclxuXHRpZiAoZT8uZmxhZyAmJiBlLmZsYWcgPT0gXCJhYm9ydFwiKSB7XHJcblx0XHRyZXR1cm4gcmVuZGVyUmVnZW50KGVsLCBPYmplY3QuYXNzaWduKHt9LCB7XHJcblx0XHRcdGNsYXNzOiAnYWJvcnQnLFxyXG5cdFx0XHRsYWJlbDogJ3NrJyxcclxuXHRcdFx0aG92ZXI6ICdSZW5kZXIgQWJvcnRlZCdcclxuXHRcdH0sIGUpKVxyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gcmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdlcnJvcicsIGxhYmVsOiAnc2snLCBob3ZlcjogZT8ubXNnIHx8IFwiVW5rbm93biBFcnJvclwiLCBjbGVhcjogdHJ1ZX0pXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyV2FpdChlbDogSFRNTEVsZW1lbnQpIHtcclxuXHRjb25zdCBwcmUgPSBjcmVhdGVFbChcImNvZGVcIiwge2NsczogXCJza3JpYmktcmVnZW50IHdhaXRcIiwgdGV4dDogXCJza1wifSlcclxuXHRlbC5yZXBsYWNlV2l0aChwcmUpXHJcblx0cmV0dXJuIHByZVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyU3RhdGUoZWw6IEhUTUxFbGVtZW50LCBkYXRhSW46IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwic3RhdGVcIixcclxuXHRcdGxhYmVsOiBcInNrXCIsXHJcblx0XHRjbGVhcjogZmFsc2UsXHJcblx0XHRob3ZlcjogXCJcIlxyXG5cdH0sIGRhdGFJbiB8fCB7fSlcclxuXHJcblx0ZWwuY2xhc3NOYW1lID0gYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWBcclxuXHRlbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVnZW50KGRhdGFJbj86IFJlZ2VudERhdGEpOiBbSFRNTEVsZW1lbnQsIFJlZ2VudERhdGFdIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwiZ2VuZXJpY1wiLFxyXG5cdFx0bGFiZWw6IFwic2tcIixcclxuXHRcdGNsZWFyOiBmYWxzZSxcclxuXHRcdGhvdmVyOiBcIlwiXHJcblx0fSwgZGF0YUluIHx8IHt9KVxyXG5cclxuXHRjb25zdCBwcmUgPSBjcmVhdGVFbChcImNvZGVcIiwge2NsczogYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWAsIHRleHQ6IGRhdGEubGFiZWx9KVxyXG5cdHByZS5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG5cclxuXHRyZXR1cm4gW3ByZSwgZGF0YV1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclJlZ2VudChlbDogSFRNTEVsZW1lbnQsIGRhdGFJbj86IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgW3ByZSwgZGF0YV0gPSBjcmVhdGVSZWdlbnQoZGF0YUluKVxyXG5cdGlmIChkYXRhLmNsZWFyKSBlbC5jbGFzc05hbWUgPSBcIlwiO1xyXG5cdGVsLnJlcGxhY2VXaXRoKHByZSlcclxuXHJcblx0cmV0dXJuIHByZVxyXG59IiwiaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgbm9ybWFsaXplUGF0aCwgcGFyc2VGcm9udE1hdHRlclN0cmluZ0FycmF5LCBNYXJrZG93blJlbmRlcmVyLCBzZXRJY29uLCBNYXJrZG93blByZXZpZXdWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgY3JlYXRlUmVnZW50IH0gZnJvbSBcIi4vcmVnZW50XCJcclxuaW1wb3J0IHsgZExvZywgaXNFeHRhbnQgfSBmcm9tIFwiLi4vdXRpbFwiXHJcblxyXG5jb25zdCBleHRJbWcgPSBbXCJibXBcIiwgXCJwbmdcIiwgXCJqcGdcIiwgXCJqcGVnXCIsIFwiZ2lmXCIsIFwic3ZnXCJdXHJcbmNvbnN0IGV4dEF1ZCA9IFtcIm1wM1wiLCBcIndhdlwiLCBcIm00YVwiLCBcIjNncFwiLCBcImZsYWNcIiwgXCJvZ2dcIiwgXCJvZ2FcIl1cclxuY29uc3QgZXh0VmlkID0gW1wibXA0XCIsIFwid2VibVwiLCBcIm9ndlwiXVxyXG5jb25zdCBleHRUeHQgPSBbXCJtZFwiXVxyXG5jb25zdCBleHRQZGYgPSBbXCJwZGZcIl1cclxuXHJcbi8qIFJlcGFpcnMgbWVkaWEgZW1iZWRzIHRoYXQgaGF2ZSBiZWVuIHJlbmRlcmVkIHRvIG1hcmtkb3duICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbWJlZE1lZGlhIChcclxuICBlbDogSFRNTEVsZW1lbnQsIFxyXG4gIHNyY1BhdGg6IHN0cmluZyxcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW4sXHJcbiAgZGVwdGg/OiBudW1iZXIsXHJcbiAgc2VsZj86IGJvb2xlYW5cclxuKSB7XHJcbiAgZExvZyhcImVtYmVkIHNlbGY6XCIsIHNlbGYpXHJcbiAgZExvZyhcImVtYmVkOlwiLCBlbClcclxuICB2YXIgcHJvbXM6IFByb21pc2U8dm9pZD5bXSA9IFtdXHJcblxyXG4gIGNvbnN0IGNhdGNoZXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwic3Bhbi5pbnRlcm5hbC1lbWJlZFwiKSBcclxuXHJcbiAgbGV0IGVsRGVwdGggPSBlbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKTtcclxuICBsZXQgZCA9IChpc0V4dGFudChlbERlcHRoKSA/IHBhcnNlSW50KGVsRGVwdGgpIDogaXNFeHRhbnQoZGVwdGgpID8gZGVwdGggOiAwKVxyXG5cclxuICBkTG9nKFwiZW1iZWRkZXIgZGVwdGg6XCIsIGQpXHJcblxyXG5cclxuICBmb3IgKGxldCBmaXNoIG9mIEFycmF5LmZyb20oY2F0Y2hlcykpIHtcclxuICAgIGlmIChmaXNoLmhhc0NsYXNzKFwiaXMtbG9hZGVkXCIpKSBjb250aW51ZTtcclxuXHJcbiAgICBsZXQgc3JjID0gbm9ybWFsaXplUGF0aChmaXNoLmdldEF0dHJpYnV0ZShcInNyY1wiKSlcclxuXHJcbiAgICBsZXQgZGVzdCA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChzcmMsIHNyY1BhdGgpXHJcbiAgICBcclxuICAgIGlmIChkZXN0KSB7XHJcbiAgICAgIGxldCBwYXRoID0gcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChkZXN0LnBhdGgpXHJcblxyXG4gICAgICBsZXQgZXh0ID0gZGVzdC5leHRlbnNpb247XHJcblxyXG4gICAgICBpZiAoZXh0SW1nLmNvbnRhaW5zKGV4dCkpIHsvLyBFbWJlZCBJbWFnZVxyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJpbWFnZS1lbWJlZFwiKTtcclxuICAgICAgICBcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiaW1nXCIpO1xyXG4gICAgICAgIG5lbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgcGF0aClcclxuICAgICAgICBcclxuICAgICAgfSBlbHNlIGlmIChleHRBdWQuY29udGFpbnMoZXh0KSkgeyAvLyBFbWJlZCBBdWRpb1xyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJtZWRpYS1lbWJlZFwiKTtcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiYXVkaW9cIiwge1wiYXR0clwiOiB7XCJjb250cm9sc1wiIDogdHJ1ZX19KTtcclxuICAgICAgICBuZWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFZpZC5jb250YWlucyhleHQpKSB7IC8vIEVtYmVkIFZpZGVvXHJcbiAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuXHJcbiAgICAgICAgbGV0IHZpZGl2ID0gZmlzaC5jcmVhdGVFbChcInZpZGVvXCIsIHtcImF0dHJcIiA6IHtcImNvbnRyb2xzXCIgOiB0cnVlfX0pXHJcbiAgICAgICAgdmlkaXYuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFR4dC5jb250YWlucyhleHQpKSB7IFxyXG4gICAgICAgIC8qIEVtYmVkIFRyYW5zY2x1c2lvbiAqL1xyXG5cclxuICAgICAgICBjb25zdCBjcmVhdGVFbWJlZFByb21pc2U6ICgpPT5Qcm9taXNlPHZvaWQ+ID0gKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRMb2coXCJuZXcgZW1iZWQgcHJvbVwiKVxyXG5cclxuICAgICAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuICBcclxuICAgICAgICAgICAgICBsZXQgY2FjaGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZGVzdC5wYXRoKVxyXG4gICAgICAgICAgICAgIGxldCByZWFkID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGRlc3QpXHJcbiAgICAgICAgICAgICAgbGV0IGNsYXNzZXMgPSBwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkoY2FjaGU/LmZyb250bWF0dGVyLCBcImNzc2NsYXNzXCIpXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgZGl2ID0gZmlzaC5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZFwifSlcclxuICAgICAgICAgICAgICBsZXQgZGl2dGl0bGUgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtdGl0bGVcIiwgdGV4dDogZGVzdC5iYXNlbmFtZX0pXHJcbiAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtY29udGVudFwifSlcclxuICAgICAgICAgICAgICBsZXQgbGluayA9IGRpdi5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZC1saW5rXCJ9KVxyXG4gICAgICAgICAgICAgIHNldEljb24obGluaywgXCJsaW5rXCIpXHJcbiAgICAgICAgICAgICAgbGluay5vbkNsaWNrRXZlbnQoKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChzcmMsIHNyY1BhdGgpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgcHYgPSBjb250ZW50LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctdmlld1wifSk7IHB2LmFkZENsYXp6KGNsYXNzZXMpO1xyXG4gICAgICAgICAgICAgIGxldCBwcyA9IHB2LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctc2l6ZXIgbWFya2Rvd24tcHJldmlldy1zZWN0aW9uXCJ9KVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgbGV0IG1raCA9IGNyZWF0ZURpdih7YXR0cjoge1wiZGVwdGhcIjogZGVwdGgudG9TdHJpbmcoKX19KVxyXG4gICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24ocmVhZCwgbWtoLCBzcmNQYXRoLCBudWxsKVxyXG4gICAgICAgICAgICAgIGNvbnN0IG1rZTogQ2hpbGROb2RlW10gPSAoQXJyYXkuZnJvbShta2g/LmNoaWxkTm9kZXMgfHwgW10pLm1hcCgobikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKG4uY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7IGxldCBkID0gY3JlYXRlRGl2KCk7IGQuYXBwZW5kKG4uY2xvbmVOb2RlKHRydWUpKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyBsZXQgZCA9IGNyZWF0ZURpdigpOyBkLmFwcGVuZChuKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuXHJcbiAgICAgICAgICAgICAgcHMuYXBwZW5kKC4uLm1rZSk7IC8vcHMuc2V0QXR0cmlidXRlKFwiZGVwdGhcIiwgZC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVtYmVkTWVkaWEocHMsIHNyY1BhdGgsIHBsdWdpbiwgZC0xLCB0cnVlKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkIDw9IDApICB7XHJcbiAgICAgICAgICBsZXQgW2xdID0gY3JlYXRlUmVnZW50KHtjbGFzczogXCJkZXB0aC1saW1pdFwiLCBob3ZlcjogXCJJdCBnb2VzIG9uIGZvcmV2ZXIuLi5cIn0pXHJcbiAgICAgICAgICBmaXNoLnJlcGxhY2VXaXRoKGwpXHJcblxyXG4gICAgICAgICAgZExvZyhcImVtYmVkZGVyIGhpdCBsaW1pdFwiKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm9tcy5wdXNoKGNyZWF0ZUVtYmVkUHJvbWlzZSgpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChwcm9tcykudGhlbih2YWx1ZXMgPT4ge1xyXG4gICAgZExvZyhcImVtYmVkZGVyIGRvbmVcIiwgcHJvbXMpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb21zLmxlbmd0aClcclxuICB9KVxyXG59IiwiaW1wb3J0IHsgaXNFeHRhbnQgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuXHJcbi8qIENoZWNrIGlmIGNvZGUgYmxvY2sgaXMgdGhhdCBnb29kIGdvb2QgYW5kIGlmIHNvIHdoYXQgdHlwZSBvZiBnb29kIGdvb2QgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXBhcnNlU2tyaWJpKGVsOiBIVE1MRWxlbWVudCwgc3RyPzogc3RyaW5nLCBmbGc/OiBhbnkpIHtcclxuXHRsZXQgdGV4dCA9IGlzRXh0YW50KHN0cikgPyBzdHIgOiBlbC50ZXh0Q29udGVudFxyXG5cdGlmICh0ZXh0Lmxlbmd0aCA8IDMpIHJldHVybjtcclxuXHJcblx0bGV0IGUgPSB0ZXh0LnN1YnN0cih0ZXh0Lmxlbmd0aC0yKVxyXG5cdGxldCBzID0gdGV4dC5zdWJzdHIoMCwgMilcclxuXHRcclxuXHRpZiAocy5zdGFydHNXaXRoKFwie1wiKSAmJiBlLmVuZHNXaXRoKFwifVwiKSkge1xyXG5cdFx0bGV0IGYgPSBzWzFdO1xyXG5cdFx0bGV0IGZsYWcgPSAoZiA9PSBcIjpcIikgPyAxIDogKGYgPT0gXCI9XCIpID8gMiA6IChmID09IFwiflwiKSA/IDMgOiAoZiA9PSBcIntcIikgPyA0IDogKGYgPT0gXCIuXCIpID8gNSA6IC0xO1xyXG5cdFx0aWYgKChmbGFnID4gMCkgJiYgKGZsYWcgIT0gNCB8fCAoZSA9PSBcIn19XCIpKSkge1xyXG5cdFx0XHRyZXR1cm4ge2ZsYWc6IGZsYWcsIHRleHQ6IHRleHQuc3Vic3RyaW5nKDIsIHRleHQubGVuZ3RoIC0gKGZsYWcgPT0gNCA/IDIgOiAxICkpfVxyXG5cdFx0fSBlbHNlIHJldHVyblxyXG5cdH0gZWxzZSByZXR1cm5cclxufVxyXG5cclxuLyogUGFyc2UgdmFyaWFibGVzIGluIHRlbXBsYXRlIGludm9jYXRpb25zICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVNrcmliaShzcmM6IHN0cmluZyk6IFByb21pc2U8e1xyXG5cdGlkOiBzdHJpbmcsXHJcblx0YXJnczogYW55XHJcbn0+IHtcclxuXHRsZXQgc2EgPSBzcmMuc3BsaXQoLyg/PCFbXFxcXF0pXFx8LylcclxuXHRsZXQgaWQgPSBzYS5zcGxpY2UoMCwgMSlbMF0udHJpbSgpXHJcblxyXG5cdGxldCBhcmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XHJcblx0Zm9yIChsZXQgc2VnIG9mIHNhKSB7XHJcblx0XHRsZXQgc2kgPSBzZWcuaW5kZXhPZihcIjpcIilcclxuXHRcdGlmIChzaSA9PSAtMSkgY29udGludWU7XHJcblx0XHRhcmdzW3NlZy5zbGljZSgwLCBzaSkudHJpbSgpXSA9IHNlZy5zbGljZShzaSsxKS50cmltKCk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge2lkOiBpZCwgYXJnczoge3Y6IGFyZ3N9fTtcclxufSIsImltcG9ydCB7IE1hcmtkb3duUG9zdFByb2Nlc3NvciwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgTWFya2Rvd25SZW5kZXJlciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcInNyYy9ldGEvZXRhXCI7XHJcbmltcG9ydCB7IGwgfSBmcm9tIFwic3JjL2xhbmcvYmFiZWxcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcbmltcG9ydCB7IE1vZGVzLCBGbGFncywgRUJBUiB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IHsgUHJvY2Vzc29yTW9kZSwgcXVldWVkVGVtcGxhdGUsIFNrQ29udGV4dCwgU2tyaWJpUmVzdWx0LCBTdHJpbmdkZXgsIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCBkTG9nLCB2TG9nLCByb3VuZFRvIH0gZnJvbSBcInNyYy91dGlsXCI7XHJcbmltcG9ydCB7IFNrcmliaUNoaWxkIH0gZnJvbSBcIi4vY2hpbGRcIjtcclxuaW1wb3J0IHsgZW1iZWRNZWRpYSB9IGZyb20gXCIuL2VtYmVkXCI7XHJcbmltcG9ydCB7IHBhcnNlU2tyaWJpLCBwcmVwYXJzZVNrcmliaSB9IGZyb20gXCIuL3BhcnNlXCI7XHJcbmltcG9ydCB7IHJlbmRlclJlZ2VudCwgcmVuZGVyRXJyb3IsIHJlbmRlclN0YXRlIH0gZnJvbSBcIi4vcmVnZW50XCI7XHJcbmltcG9ydCB7IHNjb3BlU3R5bGUsIHN0cmlwU3R5bGVGcm9tU3RyaW5nIH0gZnJvbSBcIi4vc3R5bGUvc3R5bGVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNrcmliaVByb2Nlc3NvciB7XHJcbiAgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcbiAgZXRhOiBFdGFIYW5kbGVyXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICAgIHRoaXMuZXRhID0gcGx1Z2luLmV0YVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgb3VyIG1hcmtkb3duIHByb2Nlc3NvcnMuICovXHJcbiAgcmVnaXN0ZXJQcm9jZXNzb3JzKCkge1xyXG4gICAgY29uc3QgcHJvY2Vzc0NvZGVTcGFuOiBNYXJrZG93blBvc3RQcm9jZXNzb3IgPSBhc3luYyhlbCwgY3R4KSA9PiB7dGhpcy5wcm9jZXNzRW50cnkoe3NyY1R5cGU6IE1vZGVzLmdlbmVyYWx9LCBlbCwgY3R4KX1cclxuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiBwcm9jZXNzQ29kZVNwYW4oZWwsIGN0eCkpXHJcblxyXG4gICAgY29uc3QgcHJvY2Vzc0NvZGVCbG9jayA9IGFzeW5jIChtb2RlOiBQcm9jZXNzb3JNb2RlLCBzdHI6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50LCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpID0+IHsgdGhpcy5wcm9jZXNzRW50cnkobW9kZSwgZWwsIGN0eCwgbnVsbCwgbnVsbCwgc3RyLnRyaW1FbmQoKSkgfVxyXG4gICAgKFtbXCJub3JtYWxcIiwgXCJcIiwgRmxhZ3Mubm9uZV0sIFtcInJhd1wiLCBcIi1yYXdcIiwgRmxhZ3MucmF3XSwgW1wibGl0ZXJhbFwiLCBcIi1saXRcIiwgRmxhZ3MubGl0ZXJhbF0sIFtcImludGVycG9sYXRlXCIsIFwiLWludFwiLCBGbGFncy5pbnRlcnBdLCBbXCJldmFsdWF0ZVwiLCBcIi1ldmFsXCIsIEZsYWdzLmV2YWxdXSlcclxuXHRcdC5mb3JFYWNoKCh2KSA9PiB7XHJcblx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoYHNrcmliaSR7dlsxXX1gLCBwcm9jZXNzQ29kZUJsb2NrLmJpbmQodGhpcywge3NyY1R5cGU6IE1vZGVzLmJsb2NrLCBmbGFnOiB2WzJdfSkpXHJcblx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoYHNrJHt2WzFdfWAsIHByb2Nlc3NDb2RlQmxvY2suYmluZCh0aGlzLCB7c3JjVHlwZTogTW9kZXMuYmxvY2ssIGZsYWc6IHZbMl19KSlcclxuXHRcdH0pXHJcbiAgfVxyXG5cclxuICAvKiogRW50cnkgdG8gdGhlIFNrcmliaSBwcm9jZXNzIGNoYWluLiBDYWxsZWQ6XHJcbiAgICogLSBCeSBNYXJrZG93blZpZXcgb24gZWFjaCBibG9jayBvZiBhIG1hcmtkb3duIHByZXZpZXdcclxuICAgKiAtIEJ5IE1hcmtkb3duVmlldyBvbiBjb2RlIGJsb2NrcyBvZiBvdXIgcmVnaXN0ZXIgbGFuZ3VhZ2UgdHlwZXNcclxuICAgKiAtIEJ5IHJlbmRlclNrcmliaSB0byByZWN1cnNlIG5lc3RlZCBza3JpYmlzICovXHJcbiAgYXN5bmMgcHJvY2Vzc0VudHJ5IChcclxuXHRcdG1vZGU6IFByb2Nlc3Nvck1vZGUsIC8vIDA6IGNvZGVzcGFuOyAxOiBjb2RlYmxvY2s7XHJcblx0XHRkb2M6IEhUTUxFbGVtZW50LFxyXG5cdFx0Y3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LFxyXG5cdFx0ZGVwdGg/OiBudW1iZXIsXHJcblx0XHRzZWxmPzogYm9vbGVhbixcclxuXHRcdHNyY0luPzogc3RyaW5nXHJcblx0KTogUHJvbWlzZTxQcm9taXNlPFNrcmliaVJlc3VsdD5bXSB8IG51bGw+IHtcclxuXHRcdGxldCBuZXN0RXh0YW50ID0gaXNFeHRhbnQoY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdGxldCBuZXN0TGV2ZWwgPSBuZXN0RXh0YW50ID8gY3R4LnJlbWFpbmluZ05lc3RMZXZlbCA6IG51bGw7XHJcblx0XHQvKiBuZXN0RXh0YW50IG1lYW5zIHRoYXQgd2UgYXJlIGluc2lkZSBvZiBhIG5hdHVyYWwgdHJhbnNjbHVzaW9uICovXHJcblxyXG5cdFx0c2VsZiA9IGlzRXh0YW50KHNlbGYpXHJcblx0XHRkZXB0aCA9IHNlbGYgPyBkZXB0aCA6IG51bGxcclxuXHRcdC8qIHNlbGYgbWVhbnMgdGhhdCB3ZSBoYXZlIGJlZW4gY2FsbGVkIGJ5IHJlbmRlclNrcmliaSwgdG8gbG9vayBmb3IgY29kZWJsb2NrcyAqL1xyXG5cclxuXHRcdGxldCBlbEhhc0RlcHRoID0gaXNFeHRhbnQoZG9jLmdldEF0dHJpYnV0ZShcImRlcHRoXCIpKVxyXG5cdFx0bGV0IGVsRWxIYXNEZXB0aCA9IGlzRXh0YW50KGN0eC5lbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSlcclxuXHRcdGxldCBlbERlcHRoID0gZWxIYXNEZXB0aCA/IHBhcnNlSW50KGRvYy5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSkgOiBlbEVsSGFzRGVwdGggPyBwYXJzZUludChjdHguZWwuZ2V0QXR0cmlidXRlKFwiZGVwdGhcIikpIDogbnVsbDtcclxuXHRcdC8qIFVzZWQgZm9yIHBhc3NpbmcgZGVwdGggdG8gdmlydHVhbCBlbGVtZW50cyAod2UgbWF5IGJlIGluIG9uZSBldmVuIGFzIHdlIHNwZWFrLi4uKSovXHJcblxyXG5cdFx0LyogZGV0ZXJtaW5lIG91ciBkZXB0aCBjb25kaXRpb24gdHlwZSAqL1xyXG5cdFx0bGV0IGQgPSBzZWxmID8gZGVwdGggOiAoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpID8gZWxEZXB0aCA6IG5lc3RFeHRhbnQgPyBuZXN0TGV2ZWwgOiAwXHJcblxyXG5cdFx0aWYgKCFuZXN0RXh0YW50ICYmICEoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpKSBkTG9nKFwicHJvY2Vzc29yIHNlZXMgbm8gZGVwdGhcIilcclxuXHJcblx0XHRpZiAoZWxIYXNEZXB0aCkgeyBcclxuXHRcdFx0ZExvZyhcImVsRGVwdGhcIiwgZWxEZXB0aCwgXCJkb2NcIiwgZG9jLCBcImVsXCIsIGN0eC5lbCwgXCJjb25FbFwiLCBjdHguY29udGFpbmVyRWwpIFxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZExvZyhcInByb2Nlc3NvcjogXCIsIFwiZG9jXCIsIGRvYywgXCJlbFwiLCBjdHguZWwsIFwiY29uRWxcIiwgY3R4LmNvbnRhaW5lckVsLCBcIm5lc3RcIiwgY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0LyogRGlzcGF0Y2ggcmVuZGVyIHByb21pc2VzICovXHJcblx0XHR2YXIgcHJvbXM6IFByb21pc2U8U2tyaWJpUmVzdWx0PltdID0gW11cclxuXHRcdHZhciB0ZW1wcyA9IDA7XHJcblx0XHRjb25zdCBlbENvZGVzID0gKG1vZGUuc3JjVHlwZSA9PSBNb2Rlcy5ibG9jaykgPyBbZG9jXSA6IGRvYy5xdWVyeVNlbGVjdG9yQWxsKFwiY29kZVwiKVxyXG5cdFx0aWYgKCEoZCA8PSAwKSkge1xyXG5cdFx0XHRsZXQgdG0gPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdGNvbnN0IGVsUHJvbXMgPSBBcnJheS5mcm9tKGVsQ29kZXMpLm1hcChhc3luYyAoZWwpID0+IHtcclxuXHRcdFx0XHRsZXQgdCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKTtcclxuXHRcdFx0XHRkTG9nKFwic3RhcnQ6XCIsIHQpXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bGV0IHNyYyA9IChpc0V4dGFudChtb2RlLmZsYWcpICYmIG1vZGUuZmxhZyAhPSBGbGFncy5ub25lKSA/XHJcblx0XHRcdFx0XHR7dGV4dDogc3JjSW4gfHwgZG9jLnRleHRDb250ZW50LCBmbGFnOiBtb2RlLmZsYWd9IDogYXdhaXQgcHJlcGFyc2VTa3JpYmkoZWwpO1xyXG5cclxuXHRcdFx0XHRsZXQgb3JpZ2luYWxUZXh0ID0gKG1vZGUuc3JjVHlwZSA9PSBNb2Rlcy5ibG9jaykgPyBzcmNJbiA6IGVsLnRleHRDb250ZW50XHJcblxyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRpZiAoc3JjICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0bGV0IHNrQ3R4OiBTa0NvbnRleHQgPSB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBkZXB0aDogZCwgZmxhZzogc3JjLmZsYWcsIHNvdXJjZTogb3JpZ2luYWxUZXh0fVxyXG5cdFx0XHRcdFx0XHRsZXQgbmVsID0gcmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdzay1sb2FkaW5nJywgaG92ZXI6IGxbJ3JlZ2VudC5sb2FkaW5nLmhvdmVyJ119KVxyXG5cdFx0XHRcdFx0XHRpZiAoc3JjLmZsYWcgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdHByb21zLnB1c2godGhpcy5hd2FpdFRlbXBsYXRlc0xvYWRlZCh7ZWw6IG5lbCwgc3JjOiBzcmMudGV4dCwgbWRDdHg6IGN0eCwgc2tDdHg6IHNrQ3R4fSlcclxuXHRcdFx0XHRcdFx0XHQuY2F0Y2goZSA9PiB7Y29uc29sZS53YXJuKGBTa3JpYmk6IERpc3BhdGNoIEVycm9yZWQgKFRlbXBsYXRlKWAsIEVCQVIsIGUpfSkpO1xyXG5cdFx0XHRcdFx0XHRcdHRlbXBzKys7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cHJvbXMucHVzaCh0aGlzLnByb2Nlc3NTa3JpYmkobmVsLCBzcmMudGV4dCwgY3R4LCBza0N0eClcclxuXHRcdFx0XHRcdFx0XHQuY2F0Y2goZSA9PiB7Y29uc29sZS53YXJuKGBTa3JpYmk6IERpc3BhdGNoIEVycm9yZWRgLCBFQkFSLCBlKX0pKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdH0gY2F0Y2goZSkge1xyXG5cdFx0XHRcdFx0aWYgKCFlLmZsYWdzLm5vUmVuZGVyKSB7XHJcblx0XHRcdFx0XHRcdHJlbmRlckVycm9yKGVsLCBlKVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcblx0XHRcdH0pXHJcblx0XHRcclxuXHRcdFx0Ly9UT0RPOiBSZXdyaXRlIHRoZSBsb2dnaW5nIGxvZ2ljIGZvciB0aGUgbmV3IHRlbXBsYXRlIHF1ZXVlXHJcblxyXG5cdFx0XHRhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoZWxQcm9tcylcclxuXHRcdFx0aWYgKHByb21zLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhkb2MsIHByb21zKTsgXHJcblx0XHRcdFx0Ly8gUHJvbWlzZS5hbGxTZXR0bGVkKHByb21zKS50aGVuKCgpID0+IGNvbnNvbGUubG9nKHByb21zKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHByb21zXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvKiBEZXB0aCB0b28gaGlnaCEgKi9cclxuXHJcblx0XHRcdGVsQ29kZXMuZm9yRWFjaChhc3luYyAoZWwpID0+IHtcclxuXHRcdFx0XHRwcmVwYXJzZVNrcmliaShlbCkudGhlbihhc3luYyAoc3JjKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoc3JjICE9IG51bGwpIHJlbmRlclN0YXRlKGVsLCB7aG92ZXI6IGxbJ3JlZ2VudC5zdGFzaXMuaG92ZXInXSwgY2xhc3M6ICdzdGFzaXMnfSlcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9KVxyXG5cdFx0XHRkTG9nKFwicHJvY2Vzc29yIGhpdCBsaW1pdFwiKTsgXHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpOyAvLyBQb3N0cHJvY2Vzc29yIGNhbGxzIGFyZSBub3QgY2F1Z2h0IHNvIHdlIGNhbid0IHJlamVjdCBuZWF0bHkuXHJcblx0XHR9XHJcblx0fVxyXG5cclxuICBwcml2YXRlIHF1ZXVlZFRlbXBsYXRlczogQXJyYXk8cXVldWVkVGVtcGxhdGU+ID0gW11cclxuXHJcbiAgLyoqIFF1ZXVlcyB0ZW1wbGF0ZXMgdG8gcHJvY2VzcyBvbiBpbml0aWFsIHRlbXBsYXRlIGxvYWQgY29tcGxldGlvbiwgb3IgcHJvY2Vzc2VzIHRoZW0gaW1tZWRpYXRlbHkgaWYgcmVhZHkuICovXHJcblx0YXN5bmMgYXdhaXRUZW1wbGF0ZXNMb2FkZWQoYXJnczoge2VsOiBIVE1MRWxlbWVudCwgc3JjOiBhbnksIG1kQ3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBza0N0eDogU2tDb250ZXh0fSk6IFByb21pc2U8U2tyaWJpUmVzdWx0PiB7XHJcblx0XHRsZXQgZWwgPSByZW5kZXJSZWdlbnQoYXJncy5lbCwge2NsYXNzOiAnd2FpdCcsIGxhYmVsOiAnc2snLCBob3ZlcjogJ0F3YWl0aW5nIFRlbXBsYXRlIENhY2hlJywgY2xlYXI6IHRydWV9KVxyXG5cclxuXHRcdHJldHVybiAodGhpcy5wbHVnaW4uaW5pdExvYWRlZCkgXHJcblx0XHRcdD8gYXdhaXQgdGhpcy5wcm9jZXNzU2tyaWJpVGVtcGxhdGUoZWwsIGFyZ3Muc3JjLCBhcmdzLm1kQ3R4LCBhcmdzLnNrQ3R4KVxyXG5cdFx0XHQ6IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHRcdFx0XHRcdGxldCBhY3RpdmF0ZSA9IChlbGU6IEhUTUxFbGVtZW50LCB0aW1lOiBudW1iZXIpID0+IHsgcmVzb2x2ZShcclxuXHRcdFx0XHRcdFx0dGhpcy5wcm9jZXNzU2tyaWJpVGVtcGxhdGUoZWxlLCBhcmdzLnNyYywgYXJncy5tZEN0eCwgT2JqZWN0LmFzc2lnbihhcmdzLnNrQ3R4LCB7dGltZTogdGltZX0pKVxyXG5cdFx0XHRcdFx0KX1cclxuXHRcdFx0XHRcdHRoaXMucXVldWVkVGVtcGxhdGVzLnB1c2goe2Z1bmN0aW9uOiBhY3RpdmF0ZSBhcyBhbnksIGVsZW1lbnQ6IGVsfSlcclxuXHRcdFx0XHR9KVxyXG5cdH1cclxuXHJcbiAgLyoqIENhbGxlZCBvbiB0ZW1wbGF0ZSBpbml0IGxvYWQgY29tcGxldGUuIEZpcmVzIG9mZiBhbGwgb2YgdGhlIHF1ZXVlZCB0ZW1wbGF0ZXMuICovXHJcbiAgdGVtcGxhdGVzUmVhZHkoKSB7XHJcbiAgICBsZXQgcHJvbXMgPSB0aGlzLnF1ZXVlZFRlbXBsYXRlcy5tYXAoKHF1ZXVlZCkgPT4ge1xyXG5cdFx0XHRsZXQgZWwgPSByZW5kZXJSZWdlbnQocXVldWVkLmVsZW1lbnQsIHtjbGFzczogJ3NrLWxvYWRpbmcnLCBob3ZlcjogbFsncmVnZW50LmxvYWRpbmcuaG92ZXInXX0pXHJcblx0XHRcdHJldHVybiBxdWV1ZWQuZnVuY3Rpb24oZWwsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSlcclxuXHRcdH0pXHJcbiAgICBQcm9taXNlLmFsbFNldHRsZWQocHJvbXMpLnRoZW4oKCkgPT4ge3RoaXMucXVldWVkVGVtcGxhdGVzID0gW119KVxyXG4gIH1cclxuXHJcblx0LyoqIFBhcnNlIHZhcmlhYmxlcyBhbmQgcHJlcCB0aGUgdGVtcGxhdGUgKi9cclxuXHRhc3luYyBwcm9jZXNzU2tyaWJpVGVtcGxhdGUoXHJcblx0XHRlbDogSFRNTEVsZW1lbnQsIFxyXG5cdFx0c3JjOiBzdHJpbmcsIFxyXG5cdFx0bWRDdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIFxyXG5cdFx0c2tDdHg6IFNrQ29udGV4dFxyXG5cdCk6IFByb21pc2U8U2tyaWJpUmVzdWx0PiB7XHJcblx0XHRsZXQgcGFyc2VkOiB7aWQ6IHN0cmluZywgYXJnczogYW55fSA9IG51bGw7XHJcblx0XHR0cnkgeyBwYXJzZWQgPSBhd2FpdCBwYXJzZVNrcmliaShzcmMpIH1cclxuXHRcdGNhdGNoIChlKSB7IHJlbmRlckVycm9yKGVsLCBlKTsgcmV0dXJuIFByb21pc2UucmVqZWN0KCdQYXJzaW5nIEVycm9yJykgfVxyXG5cclxuXHRcdC8qIEFib3J0IGlmIGJlaW5nIHJlbmRlcmVkIGluIGl0cyBvd24gZGVmaW5pdGlvbiAqL1xyXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KFwiXCIsIG1kQ3R4LnNvdXJjZVBhdGgpLmJhc2VuYW1lID09IHBhcnNlZC5pZCkge1xyXG5cdFx0XHRyZW5kZXJSZWdlbnQoZWwsIHtjbGFzczogJ3NlbGYnLCBob3ZlcjogbFsncmVnZW50LnN0YXNpcy5ob3ZlciddfSk7IHJldHVybiBQcm9taXNlLnJlamVjdCgnV2l0aGluIFNlbGYgRGVmaW5pdGlvbicpOyB9XHJcblxyXG5cdFx0bGV0IHRlbXBsYXRlID0gdGhpcy5ldGEuZ2V0UGFydGlhbChwYXJzZWQuaWQpPy5mdW5jdGlvblxyXG5cdFx0aWYgKCFpc0V4dGFudCh0ZW1wbGF0ZSkpIHtcclxuXHRcdFx0aWYgKHRoaXMuZXRhLmZhaWxlZFRlbXBsYXRlcy5oYXMocGFyc2VkLmlkKSkge2VsID0gYXdhaXQgcmVuZGVyRXJyb3IoZWwsIHttc2c6IGBUZW1wbGF0ZSAke3BhcnNlZC5pZH0gZXhpc3RzIGJ1dCBmYWlsZWQgdG8gY29tcGlsZSwgd2l0aCBlcnJvcjpgICsgRUJBUiArIHRoaXMuZXRhLmZhaWxlZFRlbXBsYXRlcy5nZXQocGFyc2VkLmlkKX0pIH1cclxuXHRcdFx0ZWxzZSB7ZWwgPSBhd2FpdCByZW5kZXJFcnJvcihlbCwge21zZzogYFNrcmliaUVycm9yOiBDYW5ub3QgcmVhZCB1bmRlZmluZWQgdGVtcGxhdGUgJyR7cGFyc2VkLmlkfScgKG5vIHN1Y2ggdGVtcGxhdGUgZXhpc3RzKWB9KX1cclxuXHRcdFx0LyogV2UgaW50ZW50aW9uYWxseSBhdHRlbXB0IHRvIHJlbmRlciB0aGUgdGVtcGxhdGUgZXZlbiB0aG91Z2ggd2Uga25vdyBpdCBkb2Vzbid0IGV4aXN0LFxyXG5cdFx0XHRiZWNhdXNlIGl0IHdpbGwgYmUgY2F1Z2h0IGFuZCBjb252ZXJ0ZWQgaW50byBhIGdob3N0IGxpc3RlbmVyLiAqL1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnJlbmRlclNrcmliaShlbCwgdGVtcGxhdGUsIHBhcnNlZC5pZCwgbWRDdHgsIE9iamVjdC5hc3NpZ24oe30sIHNrQ3R4LCB7Y3R4OiBwYXJzZWQuYXJnc30pKTtcclxuXHR9XHJcblxyXG4gIC8qKiBXcmFwIG5vbi10ZW1wbGF0ZSBza3JpYmlzIGluIHRhZ3MgYXMgZGV0ZXJtaW5lZCBieSB0aGVpciB0eXBlIGZsYWcgKi9cclxuXHRhc3luYyBwcm9jZXNzU2tyaWJpKFxyXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcclxuXHRcdHNyYzogc3RyaW5nLCBcclxuXHRcdG1kQ3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBcclxuXHRcdHNrQ3R4OiBTa0NvbnRleHRcclxuXHQpOiBQcm9taXNlPFNrcmliaVJlc3VsdD4ge1xyXG5cdFx0Y29uc3QgcHJlcCA9IGZ1bmN0aW9uIChzdHI6IHN0cmluZywgZmxhZzogbnVtYmVyKSB7XHJcblx0XHRcdHN3aXRjaCAoZmxhZykgeyBcclxuXHRcdFx0XHRjYXNlIDI6IHJldHVybiBgPCU9JHtzcmN9JT5gOyBcclxuXHRcdFx0XHRjYXNlIDM6IHJldHVybiBgPCV+JHtzcmN9JT5gOyBcclxuXHRcdFx0XHRjYXNlIDQ6IHJldHVybiBzdHI7XHJcblx0XHRcdFx0Y2FzZSA1OiByZXR1cm4gYDwlJHtzcmN9JT5gO1xyXG5cdFx0XHR9IFxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnJlbmRlclNrcmliaShlbCwgcHJlcChzcmMsIHNrQ3R4LmZsYWcpLCBcImxpdGVyYWxcIiwgbWRDdHgsIHNrQ3R4KVxyXG5cdH1cclxuXHJcbiAgLyoqIE1haW4gc2tyaWJpIHJlbmRlcmluZyBmdW5jdGlvbiAqL1xyXG5cdGFzeW5jIHJlbmRlclNrcmliaShcclxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXHJcblx0XHRjb246IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIFxyXG5cdFx0aWQ6IHN0cmluZywgXHJcblx0XHRtZEN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgXHJcblx0XHRza0N0eDogU2tDb250ZXh0XHJcblx0KTogUHJvbWlzZTxTa3JpYmlSZXN1bHQ+IHtcclxuXHRcdGxldCBoYW5kbGVkID0gZmFsc2VcclxuXHRcdGxldCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoXCJcIiwgbWRDdHguc291cmNlUGF0aClcclxuXHJcblx0XHRsZXQgbmV3RWxlbWVudCA9IGNyZWF0ZURpdih7Y2xzOiBcInNrcmliaS1yZW5kZXItdmlydHVhbFwifSk7XHJcblx0XHRsZXQgY2hpbGQgPSBuZXcgU2tyaWJpQ2hpbGQodGhpcy5wbHVnaW4sIG5ld0VsZW1lbnQpXHJcblx0XHRPYmplY3QuYXNzaWduKGNoaWxkLCB7XHJcblx0XHRcdC8qIFdlIGFzc2lnbiByZXJlbmRlciBoZXJlIGZvciB0aGUgY2xvc3VyZSAqL1xyXG5cdFx0XHRyZXJlbmRlcjogKCh0ZW1wbGF0ZVRvUmV0cmlldmU/OiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRsZXQgbnNrQ3R4ID0gT2JqZWN0LmFzc2lnbih7fSwgc2tDdHgsIHt0aW1lOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCl9KVxyXG5cdFx0XHRcdGlmIChza0N0eC5mbGFnID09IDEgJiYgaXNFeHRhbnQodGVtcGxhdGVUb1JldHJpZXZlKSkge1xyXG5cdFx0XHRcdFx0bGV0IHRlbXBsYXRlID0gdGhpcy5ldGEuZ2V0UGFydGlhbCh0ZW1wbGF0ZVRvUmV0cmlldmUpPy5mdW5jdGlvblxyXG5cdFx0XHRcdFx0Y2hpbGQudW5sb2FkKCk7XHJcblx0XHRcdFx0XHR0aGlzLnJlbmRlclNrcmliaShuZXdFbGVtZW50LCB0ZW1wbGF0ZSwgdGVtcGxhdGVUb1JldHJpZXZlLCBtZEN0eCwgbnNrQ3R4KVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRjaGlsZC51bmxvYWQoKTsgXHJcblx0XHRcdFx0XHR0aGlzLnJlbmRlclNrcmliaShuZXdFbGVtZW50LCBjb24sIGlkLCBtZEN0eCwgbnNrQ3R4KVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSkuYmluZCh0aGlzKSxcclxuXHRcdFx0dGVtcGxhdGVLZXk6IChza0N0eC5mbGFnID09IDEpID8gaWQgOiBudWxsLFxyXG5cdFx0XHRzb3VyY2U6IHNrQ3R4LnNvdXJjZVxyXG5cdFx0fSkgXHJcblx0XHRcdFxyXG5cdFx0bGV0IGN0eCA9IE9iamVjdC5hc3NpZ24oe30sIHNrQ3R4Py5jdHggfHwge30sIHtjaGlsZDogY2hpbGQucHJvdmlkZUNvbnRleHQoKX0pXHJcblxyXG5cdFx0bGV0IFtyZW5kZXJlZCwgcGFja2V0XTogW3N0cmluZywgU3RyaW5nZGV4XSA9IGF3YWl0IHRoaXMuZXRhLnJlbmRlckFzeW5jKGNvbiwgY3R4LCBmaWxlKVxyXG5cdFx0LmNhdGNoKChlcnIpID0+IHsgLyogSWYgdGhlIHRlbXBsYXRlIGZ1bmN0aW9uIHRocm93cyBhbiBlcnJvciwgaXQgc2hvdWxkIGJ1YmJsZSB1cCB0byBoZXJlLiAqL1xyXG5cclxuXHRcdFx0LyogSWYgYSB0ZW1wbGF0ZSBza3JpYmkncyB0ZW1wbGF0ZSBkb2VzIG5vdCBleGlzdCAoaW50ZW50aW9uYWxseSBub3QgY2F1Z2h0IHVudGlsIHRoaXMgcG9pbnQpICovXHJcblx0XHRcdGlmIChjb24gPT09IHVuZGVmaW5lZCAmJiAhdGhpcy5ldGEuaGFzUGFydGlhbChpZCkpIHtcclxuXHRcdFx0XHRjb24gPSBza0N0eC5zb3VyY2VcclxuXHRcdFx0XHRlcnIgPSBgU2tyaWJpRXJyb3I6IENhbm5vdCByZWFkIHVuZGVmaW5lZCB0ZW1wbGF0ZSAnJHtpZH0nXFxuYFxyXG5cdFx0XHRcdGxldCBpbmZvID0gbWRDdHguZ2V0U2VjdGlvbkluZm8obWRDdHguZWwpXHJcblx0XHRcdFx0aWYgKGluZm8pIGVyciArPSBgICAgYXQgKE1hcmtkb3duU2VjdGlvbkluZm8pIGxpbmVTdGFydDogJHtpbmZvLmxpbmVTdGFydH0sIGxpbmVFbmQ6ICR7aW5mby5saW5lRW5kfSAoemVyby1pbmRleGVkKWBcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVycm9yTG9nZ2luZykge2NvbnNvbGUud2FybihgU2tyaWJpIHJlbmRlciB0aHJldyBlcnJvciEgRGlzcGxheWluZyBjb250ZW50IGFuZCBlcnJvci4uLmAsIEVCQVIsIGNvbiwgRUJBUiwgZXJyKX1cclxuXHRcdFx0cmVuZGVyRXJyb3IoZWwsIChlcnI/Lmhhc0RhdGEpID8gZXJyIDoge21zZzogZXJyPy5tc2cgfHwgZXJyIHx8IFwiUmVuZGVyIEVycm9yXCJ9KS50aGVuKGVyckVsID0+IHtcclxuXHRcdFx0XHQvKiBBbHRlciB0aGUgY2hpbGQgc28gdGhhdCBpdCBtYXkgeWV0IGxpdmUgKGFuZCBsaXN0ZW4gZm9yIHNvdXJjZSB1cGRhdGVzKSAqL1xyXG5cdFx0XHRcdE9iamVjdC5hc3NpZ24oY2hpbGQsIHtcclxuXHRcdFx0XHRcdGNvbnRhaW5lckVsOiBlcnJFbCxcclxuXHRcdFx0XHRcdHN0YXRlOiBcImVycm9yXCIsXHJcblx0XHRcdFx0XHRyZXJlbmRlcjogKCh0ZW1wbGF0ZVRvUmV0cmlldmU/OiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0bGV0IG5za0N0eCA9IE9iamVjdC5hc3NpZ24oe30sIHNrQ3R4LCB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpfSlcclxuXHRcdFx0XHRcdFx0aWYgKHNrQ3R4LmZsYWcgPT0gMSAmJiBpc0V4dGFudCh0ZW1wbGF0ZVRvUmV0cmlldmUpKSB7XHJcblx0XHRcdFx0XHRcdFx0bGV0IHRlbXBsYXRlID0gdGhpcy5ldGEuZ2V0UGFydGlhbCh0ZW1wbGF0ZVRvUmV0cmlldmUpLmZ1bmN0aW9uXHJcblx0XHRcdFx0XHRcdFx0Y2hpbGQudW5sb2FkKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5yZW5kZXJTa3JpYmkoZXJyRWwsIHRlbXBsYXRlLCB0ZW1wbGF0ZVRvUmV0cmlldmUsIG1kQ3R4LCBuc2tDdHgpXHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Y2hpbGQudW5sb2FkKCk7IFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMucmVuZGVyU2tyaWJpKGVyckVsLCBjb24sIGlkLCBtZEN0eCwgbnNrQ3R4KVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KS5iaW5kKHRoaXMpLFxyXG5cdFx0XHRcdH0pIFxyXG5cdFx0XHRcdG1kQ3R4LmFkZENoaWxkKGNoaWxkKVxyXG5cdFx0XHRcdHRoaXMucGx1Z2luLmNoaWxkcmVuLnB1c2goY2hpbGQpXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHRoYW5kbGVkID0gdHJ1ZTtcclxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShbbnVsbCwgbnVsbF0pXHJcblx0XHR9KVxyXG5cdFx0XHJcblx0XHQvKiBSRU5ERVJJTkcgKi9cclxuXHRcdGRMb2coXCJyZW5kZXJTa3JpYmk6XCIsIGVsLCBtZEN0eCwgc2tDdHgsIGlkKVxyXG5cdFx0aWYgKGlzRXh0YW50KHJlbmRlcmVkKSkge1xyXG5cdFx0XHRsZXQgZCA9IGlzRXh0YW50KG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCkgPyBtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwgOiAoc2tDdHguZGVwdGgpXHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRsZXQgc3R5bGUgPSBzdHJpcFN0eWxlRnJvbVN0cmluZyhyZW5kZXJlZCkgLy8gcmVuZGVyTWFya2Rvd24gaWdub3JlcyBzdHlsZSBub2RlcyBzbyB3ZSdsbCBqdXN0IHlvaW5rIGVtIFxyXG5cdFx0XHRpZiAoc3R5bGVbMV0pIHtyZW5kZXJlZCA9IHN0eWxlWzBdfVxyXG5cclxuXHRcdFx0bGV0IHJlbmRlciA9IChwYWNrZXQ/Llsnbm9NYXJrZG93biddIFxyXG5cdFx0XHRcdD8gdGhpcy5zaW1wbGVSZW5kZXIocmVuZGVyZWQsIG5ld0VsZW1lbnQpIFxyXG5cdFx0XHRcdDogTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihyZW5kZXJlZCwgbmV3RWxlbWVudCwgbWRDdHguc291cmNlUGF0aCwgbnVsbCkpXHJcblx0XHRcdC50aGVuKCgpID0+IHtcclxuXHRcdFx0XHQvKiB0aGlzIGJpdCBkaXNhYmxlZCBiZWNhdXNlIGl0IGtpbGxzIG90aGVyIHNrcmliaXMgcmVuZGVyaW5nIGluIHRoZSBzYW1lIGJsb2NrICovXHJcblx0XHRcdFx0Ly8gaWYgKGVsPy5wYXJlbnRFbGVtZW50Py5ub2RlTmFtZSA9PSBcIlBcIikgeyAvLyB0cnVlIHdoZW4gKG1vZGUgPT0gTW9kZS5ibG9jaylcclxuXHRcdFx0XHRcdC8vIGVsLnBhcmVudEVsZW1lbnQucmVwbGFjZVdpdGgoZWwpIC8vIHN0cmlwIHRoZSBzdXBlcmZsdW91cyBQIGVsZW1lbnRcclxuXHRcdFx0XHQvLyB9XHJcblx0XHRcdFx0bmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJza3JpYmlcIiwgKHNrQ3R4LmZsYWcgPT0gMSkgPyAndGVtcGxhdGUnIDogaWQpXHJcblx0XHRcdFx0aWYgKHNrQ3R4LmZsYWcgPT0gMSkge25ld0VsZW1lbnQuc2V0QXR0cmlidXRlKFwic2tyaWJpLXRlbXBsYXRlXCIsIGlkKX1cclxuXHRcdFx0XHRuZXdFbGVtZW50LnJlbW92ZUNsYXNzKFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCIpXHJcblx0XHRcdFx0aWYgKCFuZXdFbGVtZW50LmdldEF0dHIoXCJjbGFzc1wiKSkge25ld0VsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiY2xhc3NcIil9XHJcblxyXG5cdFx0XHRcdGxldCBzaGFkZTtcclxuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hhZG93TW9kZSkge1xyXG5cdFx0XHRcdFx0LyogaXQgc2VlbXMgdGhhdCBub24tY29kZWJsb2NrIHNrcmliaXMgZG8gbm90IHN1cnZpdmUgdGhpcyBwcm9jZXNzICovXHJcblx0XHRcdFx0XHRsZXQgbmVsID0gY3JlYXRlRGl2KClcclxuXHRcdFx0XHRcdGVsPy5wYXJlbnRFbGVtZW50LnByZXBlbmQobmVsKVxyXG5cdFx0XHRcdFx0bmVsLnNldEF0dHIoJ3NrcmliaS1ob3N0JywgJycpXHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhlbCkgXHJcblx0XHRcdFx0XHRzaGFkZSA9IG5lbC5hdHRhY2hTaGFkb3coe21vZGU6ICdvcGVuJ30pXHJcblx0XHRcdFx0XHRzaGFkZS5hcHBlbmQobmV3RWxlbWVudClcclxuXHRcdFx0XHRcdGVsLnJlbW92ZSgpXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGVsLnJlcGxhY2VXaXRoKG5ld0VsZW1lbnQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0ZExvZyhcImZpbmlzaDogXCIsIHNrQ3R4LnRpbWUsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSk7XHJcblxyXG5cdFx0XHRcdGlmIChzdHlsZVsxXSkge1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNoYWRvd01vZGUpIHtcclxuXHRcdFx0XHRcdFx0KHNoYWRlIGFzIFNoYWRvd1Jvb3QpLmFwcGVuZChzdHlsZVsxXSlcclxuXHRcdFx0XHRcdFx0Ly8gbmV3RWxlbWVudC5wcmVwZW5kKHN0eWxlWzFdKVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0bmV3RWxlbWVudC5wcmVwZW5kKHN0eWxlWzFdKTsgXHJcblx0XHRcdFx0XHRcdHNjb3BlU3R5bGUoY2hpbGQsIG5ld0VsZW1lbnQsIHN0eWxlWzFdKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChza0N0eC5mbGFnID09IDEpIHtcclxuXHRcdFx0XHRcdHZMb2coYFJlbmRlcmVkIHRlbXBsYXRlIFwiJHtpZH1cIiAoJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS1za0N0eC50aW1lLCA0KX0gbXMpYCwgbmV3RWxlbWVudClcclxuXHRcdFx0XHR9IGVsc2UgdkxvZyhgUmVuZGVyZWQgbGl0ZXJhbCAoZjogJHtza0N0eC5mbGFnfSkgKCR7cm91bmRUbyh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktc2tDdHgudGltZSwgNCl9IG1zKWAsIG5ld0VsZW1lbnQpXHJcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXdFbGVtZW50KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRjaGlsZC5zZXRQYWNrZXQocGFja2V0KVxyXG5cdFx0XHRtZEN0eC5hZGRDaGlsZChjaGlsZClcclxuXHRcdFx0dGhpcy5wbHVnaW4uY2hpbGRyZW4ucHVzaChjaGlsZClcclxuXHRcdFx0XHJcblx0XHRcdHJlbmRlci50aGVuKChlKTogUHJvbWlzZTxhbnk+ID0+IHtcclxuXHRcdFx0XHRjaGlsZC5vblBvc3QoKVxyXG5cclxuXHRcdFx0XHQvLyBUT0RPOiBvbmx5IHJlc3RyaWN0IGRlcHRoIGZvciB0cmFuc2NsdXNpb25zXHJcblx0XHRcdFx0aWYgKGlzRXh0YW50KG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCkgJiYgKG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCA+IDApIHx8ICFpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZW1iZWRNZWRpYShlLCBtZEN0eC5zb3VyY2VQYXRoLCB0aGlzLnBsdWdpbiwgc2tDdHguZGVwdGgpIFxyXG5cdFx0XHRcdH0gZWxzZSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuXHRcdFx0fSlcclxuXHRcdFx0LnRoZW4oKHgpID0+IHtcclxuXHRcdFx0XHRkTG9nKFwicmVuZGVyZXIgZmluYWw6IFwiLCBkKVxyXG5cdFx0XHRcdHRoaXMucHJvY2Vzc0VudHJ5KHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgbmV3RWxlbWVudCwgbWRDdHgsIHNrQ3R4LmRlcHRoLTEsIHRydWUpIC8qIFJlY3Vyc2UgdGhlIHByb2Nlc3NvciB0byBwYXJzZSBza3JlZWJsaW5ncyAqL1xyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0cmV0dXJuIFtyZW5kZXIsIGNoaWxkXTtcclxuXHRcdH0gZWxzZSBpZiAoIWhhbmRsZWQpIHtcclxuXHRcdFx0Y2hpbGQuY2xlYXIoKTtcclxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KFwiVW5rbm93biBSZW5kZXIgRXJyb3JcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiBFbmQgb2YgcHJvY2Vzc29yIGNoYWluICovXHJcblxyXG5cdGFzeW5jIHNpbXBsZVJlbmRlcihjb250ZW50OiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xyXG5cdFx0ZWwuaW5uZXJIVE1MID0gY29udGVudFxyXG5cdFx0Y29uc29sZS5sb2coZWwpXHJcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuXHR9XHJcbn0iLCJpbXBvcnQgeyBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBFZGl0b3JTdWdnZXN0LCBFZGl0b3JTdWdnZXN0Q29udGV4dCwgRWRpdG9yU3VnZ2VzdFRyaWdnZXJJbmZvLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50IH0gZnJvbSBcIi4vdXRpbFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVtcGxhdGVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxzdHJpbmc+IHtcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luKSB7XHJcbiAgICBzdXBlcihwbHVnaW4uYXBwKVxyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICB9XHJcbiAgb25UcmlnZ2VyKGN1cnNvcjogRWRpdG9yUG9zaXRpb24sIGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVTdWdnZXN0KSB7XHJcbiAgICAgIGxldCBzb0ZhciA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKS5zdWJzdHIoMCwgY3Vyc29yLmNoKVxyXG4gICAgICBsZXQgbWF0Y2ggPSAoL14uKmB7OihbXn1dKikkL2dzKS5leGVjKHNvRmFyKVxyXG4gICAgICAvLyBjb25zb2xlLmxvZyhtYXRjaClcclxuICAgICAgaWYgKG1hdGNoPy5bMF0pIHtcclxuICAgICAgICBsZXQgbSA9IG1hdGNoWzFdLm1hdGNoKC9cXHwoW15cXHxdKikkLylcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIm1cIiwgbSlcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgZW5kOiBjdXJzb3IsXHJcbiAgICAgICAgICBzdGFydDoge1xyXG4gICAgICAgICAgICBjaDogaXNFeHRhbnQobT8uWzFdKSA/IChjdXJzb3IuY2ggLSBtWzFdLmxlbmd0aCkgOiAobWF0Y2hbMF0ubGVuZ3RoIC0gKG1hdGNoWzFdPy5sZW5ndGggPz8gMCkpLCAvL21hdGNoWzFdLm1hdGNoKC9bXlxcfF0qJC8pLCAvLyxcclxuICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBxdWVyeTogbWF0Y2g/LlsxXSA/PyBcIlwiXHJcbiAgICAgICAgfVxyXG4gICAgICB9IFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBzdHJpbmdbXSB8IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGxldCBoYXMgPSBjb250ZXh0LnF1ZXJ5Lm1hdGNoKC9eKC4qKVxcfChbXlxcOl0qJCkvcylcclxuICAgIC8vIGNvbnNvbGUubG9nKGhhcylcclxuICAgIGlmIChoYXMpIHtcclxuICAgICAgbGV0IGluZCA9IGNvbnRleHQucXVlcnkuaW5kZXhPZihcInxcIilcclxuICAgICAgbGV0IGtleSA9IGNvbnRleHQucXVlcnkuc3Vic3RyKDAsIGluZCkudHJpbSgpXHJcbiAgICAgIGxldCB0cCA9IHRoaXMucGx1Z2luLmV0YS50ZW1wbGF0ZXMuZ2V0KGtleSlcclxuICAgICAgaWYgKHRwPy5mcm9udG1hdHRlcikge1xyXG4gICAgICAgIGxldCBwayA9IGhhcz8uWzJdPy50cmltKClcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhwaylcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModHAuZnJvbnRtYXR0ZXIpXHJcbiAgICAgICAgLmZpbHRlcihrID0+IChrLnN1YnN0cigxKS5zdGFydHNXaXRoKGhhcz8uWzJdPy50cmltU3RhcnQoKSkgJiYgIShrLnN1YnN0cmluZygxKS50cmltKCkgPT0gaGFzPy5bMl0udHJpbSgpKSkpXHJcbiAgICAgICAgLm1hcCgodikgPT4gdi5zdWJzdHIoMSkpXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBrZXlzID0gdGhpcy5wbHVnaW4uZXRhLmdldENhY2hlS2V5cygpXHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdxdWVyeTonLCBjb250ZXh0Py5xdWVyeSlcclxuICAgICAgbGV0IHJldCA9IGNvbnRleHQ/LnF1ZXJ5ID8ga2V5cy5maWx0ZXIoa2V5ID0+IChrZXkuc3RhcnRzV2l0aChjb250ZXh0LnF1ZXJ5KSAmJiAhKGtleSA9PSBjb250ZXh0LnF1ZXJ5KSkpIDoga2V5c1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhyZXQpXHJcbiAgICAgIHJldHVybiByZXRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBlbC5hZGRDbGFzcyhcInNrcmliaS1zdWdnZXN0aW9uXCIpXHJcbiAgICBlbC5jcmVhdGVTcGFuKHt0ZXh0OiB2YWx1ZX0pXHJcbiAgICAvLyBjb25zb2xlLmxvZyhlbC5jbG9uZU5vZGUodHJ1ZSkpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhlbC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xvbmVOb2RlKHRydWUpKVxyXG4gIH1cclxuXHJcbiAgc2VsZWN0U3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5jb250ZXh0KSB7XHJcblxyXG4gICAgICAvLyBsZXQgY29uTGVuZ3RoID0gdGhpcy5jb250ZXh0LmVuZC5jaCAtIHRoaXMuY29udGV4dC5zdGFydC5jaFxyXG4gICAgICAvLyBsZXQgcHJlTGVuZ3RoID0gY29uTGVuZ3RoIC0gKHRoaXMuY29udGV4dC5xdWVyeS5sZW5ndGggKyAzKVxyXG4gICAgICBsZXQgbGluZSA9IHRoaXMuY29udGV4dC5lZGl0b3IuZ2V0TGluZSh0aGlzLmNvbnRleHQuc3RhcnQubGluZSlcclxuICAgICAgbGV0IGJhciA9IGxpbmUubWF0Y2goL14uKihcXGBcXHtcXDooW15cXHxdKlxcfCkqKS9zKVxyXG4gICAgICBcclxuICAgICAgLy8gY29uc29sZS5sb2coJ2JhclxcbicsIGJhcilcclxuICAgICAgLy8gY29uc29sZS5sb2coJ3F1ZXJ5XFxuJywgdGhpcy5jb250ZXh0LnF1ZXJ5KVxyXG4gICAgICAvLyBjb25zb2xlLmxvZygncHJlXFxuJywgbGluZS5zdWJzdHIocHJlTGVuZ3RoLCBwcmVMZW5ndGggKyBiYXI/LlswXS5sZW5ndGgpKVxyXG4gICAgICAvLyBjb25zb2xlLmxvZygnbGluZVxcbicsIGxpbmUpXHJcbiAgICAgIGxldCBjaCA9ICgoYmFyICYmIGJhcj8uWzBdKSA/IGJhclswXS5sZW5ndGggOiBudWxsKSA/PyB0aGlzLmNvbnRleHQuc3RhcnQuY2hcclxuICAgICAgLy8gY29uc29sZS5sb2cobGluZS5jaGFyQXQoY2gtMSkpXHJcbiAgICAgIHRoaXMuY29udGV4dC5lZGl0b3IucmVwbGFjZVJhbmdlKCgobGluZS5jaGFyQXQoY2gtMSkgPT0gXCI6XCIpID8gXCJcIiA6IFwiIFwiKSArIHZhbHVlLCB7XHJcbiAgICAgICAgbGluZTogdGhpcy5jb250ZXh0LnN0YXJ0LmxpbmUsXHJcbiAgICAgICAgY2g6IGNoXHJcbiAgICAgIH0sIHRoaXMuY29udGV4dC5lbmQpXHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEV0YUhhbmRsZXIgfSBmcm9tICcuL2V0YS9ldGEnO1xyXG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBTa3JpYm9zU2V0dGluZ3MsIFNrcmlib3NTZXR0aW5nVGFiIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IFNrcmliaUNoaWxkIH0gZnJvbSAnLi9yZW5kZXIvY2hpbGQnO1xyXG5pbXBvcnQgeyBTdWdnZXN0aW9uTW9kYWwgfSBmcm9tICcuL21vZGFsL3N1Z2dlc3Rpb25Nb2RhbCc7XHJcbmltcG9ydCB7IEluc2VydGlvbk1vZGFsIH0gZnJvbSAnLi9tb2RhbC9pbnNlcnRpb25Nb2RhbCc7XHJcbmltcG9ydCB7IFRlc3RNb2RhbCB9IGZyb20gJy4vbW9kYWwvdGVzdE1vZGFsJztcclxuaW1wb3J0IHsgbCB9IGZyb20gJy4vbGFuZy9iYWJlbCc7XHJcbmltcG9ydCBTa3JpYmlQcm9jZXNzb3IgZnJvbSAnLi9yZW5kZXIvcHJvY2Vzc29yJztcclxuaW1wb3J0IFRlbXBsYXRlU3VnZ2VzdCBmcm9tICcuL3N1Z2dlc3QnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2tyaWJvc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblx0c2V0dGluZ3M6IFNrcmlib3NTZXR0aW5ncztcclxuXHRldGE6IEV0YUhhbmRsZXI7XHJcblx0cHJvY2Vzc29yOiBTa3JpYmlQcm9jZXNzb3JcclxuXHRzdWdnZXN0OiBUZW1wbGF0ZVN1Z2dlc3RcclxuXHJcblx0dmFyTmFtZTogc3RyaW5nID0gXCJza1wiO1xyXG5cdGluaXRMb2FkZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0bCA9IGxcclxuXHJcblx0Y2hpbGRyZW46IFNrcmliaUNoaWxkW10gPSBbXVxyXG5cdGNoaWxkUHJvdG86IGFueSA9IFNrcmliaUNoaWxkIC8vIGZvciBkZXYgbWVtb3J5IHF1ZXJ5aW5nIFxyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRjb25zb2xlLmxvZygnU2tyaWJpOiBMb2FkaW5nLi4uJyk7XHJcblxyXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2tyaWJvc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLmV0YSA9IG5ldyBFdGFIYW5kbGVyKHRoaXMpXHJcblx0XHR0aGlzLnByb2Nlc3NvciA9IG5ldyBTa3JpYmlQcm9jZXNzb3IodGhpcylcclxuXHJcblx0XHR0aGlzLnByb2Nlc3Nvci5yZWdpc3RlclByb2Nlc3NvcnMoKVxyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuaW5pdExvYWRlZCA9IHRydWVcclxuXHRcdFx0dGhpcy5wcm9jZXNzb3IudGVtcGxhdGVzUmVhZHkoKVxyXG5cdFx0fSkpXHJcblxyXG5cdFx0dGhpcy5kZWZpbmVDb21tYW5kcygpXHJcblx0XHR0aGlzLnJlZ2lzdGVyRXh0ZW5zaW9ucyhbJ2V0YSddLCAnbWFya2Rvd24nKVxyXG5cdFx0dGhpcy5zdWdnZXN0ID0gbmV3IFRlbXBsYXRlU3VnZ2VzdCh0aGlzKVxyXG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QodGhpcy5zdWdnZXN0KVxyXG5cdFx0Ly8gcmVnaXN0ZXJNaXJyb3IodGhpcyk7XHJcblxyXG5cdFx0LyogUmVyZW5kZXIgcHJldmlldyB2aWV3cyAqL1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIikuZm9yRWFjaCgobGVhZikgPT4ge1xyXG5cdFx0XHRcdGlmICgobGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykuY3VycmVudE1vZGUudHlwZSA9PSBcInByZXZpZXdcIikge1xyXG5cdFx0XHRcdFx0KGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLnByZXZpZXdNb2RlLnJlcmVuZGVyKHRydWUpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0fSlcclxuXHR9XHJcblxyXG5cdC8qKiBSZWdpc3RlciBvdXIgY29tbWFuZHMuICovXHJcblx0ZGVmaW5lQ29tbWFuZHMoKSB7XHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe2lkOiBcImluc2VydC1za3JpYmlcIiwgbmFtZTogbFsnY29tbWFuZC5pbnNlcnQnXSwgXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yLCB2aWV3KSA9PiB7XHJcblx0XHRcdFx0aWYgKCF0aGlzLmluaXRMb2FkZWQpIHJldHVybjtcclxuXHRcdFx0XHRsZXQgeCA9IG5ldyBTdWdnZXN0aW9uTW9kYWwodGhpcyk7XHJcblx0XHRcdFx0bmV3IFByb21pc2UoKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpID0+IHgub3BlbkFuZEdldFZhbHVlKHJlc29sdmUsIHJlamVjdCkpXHJcblx0XHRcdFx0LnRoZW4ocmVzdWx0ID0+IHtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmV0YS5oYXNQYXJ0aWFsKHJlc3VsdCkpIHtcclxuXHRcdFx0XHRcdFx0bGV0IGkgPSBuZXcgSW5zZXJ0aW9uTW9kYWwodGhpcywgZWRpdG9yLCByZXN1bHQpXHJcblx0XHRcdFx0XHRcdGkub3BlbigpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sIChyKSA9PiB7fSk7XHJcblx0XHRcdH19KVxyXG5cclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7aWQ6IFwicmVsb2FkLXNjcmlwdHNcIiwgbmFtZTogbFsnY29tbWFuZC5yZWxvYWRTY3JpcHRzJ10sIGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdHRoaXMuZXRhLmJ1cy5zY3JpcHRMb2FkZXIucmVsb2FkKCkudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIlNrcmliaTogUmVsb2FkZWQgU2NyaXB0c1wiKSk7XHJcblx0XHR9fSlcclxuXHRcdFxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJyZWxvYWQtc2tyaWJpc1wiLCBuYW1lOiBcIlJlbG9hZCBTa3JpYmlzXCIsIGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikuZm9yRWFjaChjaGlsZCA9PiBjaGlsZC5yZXJlbmRlcihjaGlsZD8udGVtcGxhdGVLZXkpKVxyXG5cdFx0fX0pXHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJ0ZXN0LXBlcmZvcm1hbmNlXCIsIG5hbWU6IGxbJ2NvbW1hbmQucGVyZlRlc3QnXSwgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0bGV0IHNlbCA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcj8uZ2V0U2VsZWN0aW9uKClcclxuXHRcdFx0bGV0IGNsaXAgPSBhd2FpdCB3aW5kb3cubmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpO1xyXG5cdFx0XHRsZXQgZmlsbCA9IChzZWwgfHwgY2xpcCkgPyB7XHJcblx0XHRcdFx0dHlwZTogbFtzZWwgPyAnbW9kYWwucGVyZi5hdXRvZmlsbC5zZWxlY3Rpb24nIDogJ21vZGFsLnBlcmYuYXV0b2ZpbGwuY2xpcGJvYXJkJ10sXHJcblx0XHRcdFx0dmFsdWU6IHNlbCA/IHNlbCA6IGNsaXBcclxuXHRcdFx0fSA6IG51bGxcclxuXHRcdFx0XHJcblx0XHRcdG5ldyBUZXN0TW9kYWwodGhpcywgZmlsbCkub3BlbigpXHJcblx0XHR9fSlcclxuXHR9XHJcblx0XHJcblx0b251bmxvYWQoKSB7XHJcblx0XHR0aGlzLmV0YS51bmxvYWQoKVxyXG5cdFx0Y29uc29sZS5sb2coJ1NrcmliaTogVW5sb2FkaW5nLi4uJywgdGhpcy5jaGlsZHJlbik7ICBcclxuXHRcdEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuXHRcdFx0bGV0IHByZSA9IGNyZWF0ZUVsKCdjb2RlJywge3RleHQ6IGNoaWxkLnNvdXJjZX0pXHJcblx0XHRcdGNoaWxkLmNvbnRhaW5lckVsLnJlcGxhY2VXaXRoKHByZSlcclxuXHRcdFx0Y2hpbGQudW5sb2FkKClcclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG59Il0sIm5hbWVzIjpbInByb21pc2VJbXBsIiwiaGFzT3duUHJvcCIsImNvcHlQcm9wcyIsIkNhY2hlciIsInJlc29sdmUiLCJkaXJuYW1lIiwiZXh0bmFtZSIsImV4aXN0c1N5bmMiLCJyZWFkRmlsZVN5bmMiLCJub3JtYWxpemVQYXRoIiwiVEZvbGRlciIsIlZhdWx0IiwiVEZpbGUiLCJFdGEuZ2V0Q29uZmlnIiwiTWFya2Rvd25SZW5kZXJlciIsIkZpbGVTeXN0ZW1BZGFwdGVyIiwicGFyc2VZYW1sIiwiRXRhLmNvbXBpbGVUb1N0cmluZyIsIkV0YS5yZW5kZXJBc3luYyIsIkV0YS5yZW5kZXIiLCJNb2RhbCIsIlBsdWdpblNldHRpbmdUYWIiLCJkZWJvdW5jZSIsIlNldHRpbmciLCJNYXJrZG93blJlbmRlckNoaWxkIiwiRnV6enlTdWdnZXN0TW9kYWwiLCJwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkiLCJzZXRJY29uIiwiRWRpdG9yU3VnZ2VzdCIsIlBsdWdpbiIsIk1hcmtkb3duVmlldyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdURBO0FBQ08sU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQzdELElBQUksU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxLQUFLLFlBQVksQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0FBQ2hILElBQUksT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQy9ELFFBQVEsU0FBUyxTQUFTLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtBQUNuRyxRQUFRLFNBQVMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtBQUN0RyxRQUFRLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsRUFBRTtBQUN0SCxRQUFRLElBQUksQ0FBQyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxVQUFVLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUM5RSxLQUFLLENBQUMsQ0FBQztBQUNQOztBQ2hEQSxTQUFT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
