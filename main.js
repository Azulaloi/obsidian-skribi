/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');
var fs = require('fs');
var path = require('path');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function setPrototypeOf(obj, proto) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    if (Object.setPrototypeOf) {
        Object.setPrototypeOf(obj, proto);
    }
    else {
        obj.__proto__ = proto;
    }
}
// This is pretty much the only way to get nice, extended Errors
// without using ES6
/**
 * This returns a new Error with a custom prototype. Note that it's _not_ a constructor
 *
 * @param message Error message
 *
 * **Example**
 *
 * ```js
 * throw EtaErr("template not found")
 * ```
 */
function EtaErr(message) {
    var err = new Error(message);
    setPrototypeOf(err, EtaErr.prototype);
    return err;
}
EtaErr.prototype = Object.create(Error.prototype, {
    name: { value: 'Eta Error', enumerable: false }
});
/**
 * Throws an EtaErr with a nicely formatted error and message showing where in the template the error occurred.
 */
function ParseErr(message, str, indx) {
    var whitespace = str.slice(0, indx).split(/\n/);
    var lineNo = whitespace.length;
    var colNo = whitespace[lineNo - 1].length + 1;
    message +=
        ' at line ' +
            lineNo +
            ' col ' +
            colNo +
            ':\n\n' +
            '  ' +
            str.split(/\n/)[lineNo - 1] +
            '\n' +
            '  ' +
            Array(colNo).join(' ') +
            '^';
    throw EtaErr(message);
}

/**
 * @returns The global Promise function
 */
var promiseImpl$1 = new Function('return this')().Promise;
/**
 * @returns A new AsyncFunction constuctor
 */
function getAsyncFunctionConstructor() {
    try {
        return new Function('return (async function(){}).constructor')();
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr("This environment doesn't support async/await");
        }
        else {
            throw e;
        }
    }
}
/**
 * str.trimLeft polyfill
 *
 * @param str - Input string
 * @returns The string with left whitespace removed
 *
 */
function trimLeft(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimLeft) {
        return str.trimLeft();
    }
    else {
        return str.replace(/^\s+/, '');
    }
}
/**
 * str.trimRight polyfill
 *
 * @param str - Input string
 * @returns The string with right whitespace removed
 *
 */
function trimRight(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimRight) {
        return str.trimRight();
    }
    else {
        return str.replace(/\s+$/, ''); // TODO: do we really need to replace BOM's?
    }
}

// TODO: allow '-' to trim up until newline. Use [^\S\n\r] instead of \s
/* END TYPES */
function hasOwnProp$1(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}
function copyProps$1(toObj, fromObj) {
    for (var key in fromObj) {
        if (hasOwnProp$1(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
/**
 * Takes a string within a template and trims it, based on the preceding tag's whitespace control and `config.autoTrim`
 */
function trimWS(str, config, wsLeft, wsRight) {
    var leftTrim;
    var rightTrim;
    if (Array.isArray(config.autoTrim)) {
        // kinda confusing
        // but _}} will trim the left side of the following string
        leftTrim = config.autoTrim[1];
        rightTrim = config.autoTrim[0];
    }
    else {
        leftTrim = rightTrim = config.autoTrim;
    }
    if (wsLeft || wsLeft === false) {
        leftTrim = wsLeft;
    }
    if (wsRight || wsRight === false) {
        rightTrim = wsRight;
    }
    if (!rightTrim && !leftTrim) {
        return str;
    }
    if (leftTrim === 'slurp' && rightTrim === 'slurp') {
        return str.trim();
    }
    if (leftTrim === '_' || leftTrim === 'slurp') {
        // console.log('trimming left' + leftTrim)
        // full slurp
        str = trimLeft(str);
    }
    else if (leftTrim === '-' || leftTrim === 'nl') {
        // nl trim
        str = str.replace(/^(?:\r\n|\n|\r)/, '');
    }
    if (rightTrim === '_' || rightTrim === 'slurp') {
        // full slurp
        str = trimRight(str);
    }
    else if (rightTrim === '-' || rightTrim === 'nl') {
        // nl trim
        str = str.replace(/(?:\r\n|\n|\r)$/, ''); // TODO: make sure this gets \r\n
    }
    return str;
}
/**
 * A map of special HTML characters to their XML-escaped equivalents
 */
var escMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
};
function replaceChar(s) {
    return escMap[s];
}
/**
 * XML-escapes an input value after converting it to a string
 *
 * @param str - Input value (usually a string)
 * @returns XML-escaped string
 */
function XMLEscape(str) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    // To deal with XSS. Based on Escape implementations of Mustache.JS and Marko, then customized.
    var newStr = String(str);
    if (/[&<>"']/.test(newStr)) {
        return newStr.replace(/[&<>"']/g, replaceChar);
    }
    else {
        return newStr;
    }
}

/* END TYPES */
var templateLitReg = /`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g;
var singleQuoteReg = /'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g;
var doubleQuoteReg = /"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;
/** Escape special regular expression characters inside a string */
function escapeRegExp(string) {
    // From MDN
    return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
}
function parse(str, config) {
    var buffer = [];
    var trimLeftOfNextStr = false;
    var lastIndex = 0;
    var parseOptions = config.parse;
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processTemplate) {
                str = plugin.processTemplate(str, config);
            }
        }
    }
    /* Adding for EJS compatibility */
    if (config.rmWhitespace) {
        // Code taken directly from EJS
        // Have to use two separate replaces here as `^` and `$` operators don't
        // work well with `\r` and empty lines don't work well with the `m` flag.
        // Essentially, this replaces the whitespace at the beginning and end of
        // each line and removes multiple newlines.
        str = str.replace(/[\r\n]+/g, '\n').replace(/^\s+|\s+$/gm, '');
    }
    /* End rmWhitespace option */
    templateLitReg.lastIndex = 0;
    singleQuoteReg.lastIndex = 0;
    doubleQuoteReg.lastIndex = 0;
    function pushString(strng, shouldTrimRightOfString) {
        if (strng) {
            // if string is truthy it must be of type 'string'
            strng = trimWS(strng, config, trimLeftOfNextStr, // this will only be false on the first str, the next ones will be null or undefined
            shouldTrimRightOfString);
            if (strng) {
                // replace \ with \\, ' with \'
                // we're going to convert all CRLF to LF so it doesn't take more than one replace
                strng = strng.replace(/\\|'/g, '\\$&').replace(/\r\n|\n|\r/g, '\\n');
                buffer.push(strng);
            }
        }
    }
    var prefixes = [parseOptions.exec, parseOptions.interpolate, parseOptions.raw].reduce(function (accumulator, prefix) {
        if (accumulator && prefix) {
            return accumulator + '|' + escapeRegExp(prefix);
        }
        else if (prefix) {
            // accumulator is falsy
            return escapeRegExp(prefix);
        }
        else {
            // prefix and accumulator are both falsy
            return accumulator;
        }
    }, '');
    var parseOpenReg = new RegExp('([^]*?)' + escapeRegExp(config.tags[0]) + '(-|_)?\\s*(' + prefixes + ')?\\s*', 'g');
    var parseCloseReg = new RegExp('\'|"|`|\\/\\*|(\\s*(-|_)?' + escapeRegExp(config.tags[1]) + ')', 'g');
    // TODO: benchmark having the \s* on either side vs using str.trim()
    var m;
    while ((m = parseOpenReg.exec(str))) {
        lastIndex = m[0].length + m.index;
        var precedingString = m[1];
        var wsLeft = m[2];
        var prefix = m[3] || ''; // by default either ~, =, or empty
        pushString(precedingString, wsLeft);
        parseCloseReg.lastIndex = lastIndex;
        var closeTag = void 0;
        var currentObj = false;
        while ((closeTag = parseCloseReg.exec(str))) {
            if (closeTag[1]) {
                var content = str.slice(lastIndex, closeTag.index);
                parseOpenReg.lastIndex = lastIndex = parseCloseReg.lastIndex;
                trimLeftOfNextStr = closeTag[2];
                var currentType = prefix === parseOptions.exec
                    ? 'e'
                    : prefix === parseOptions.raw
                        ? 'r'
                        : prefix === parseOptions.interpolate
                            ? 'i'
                            : '';
                currentObj = { t: currentType, val: content };
                break;
            }
            else {
                var char = closeTag[0];
                if (char === '/*') {
                    var commentCloseInd = str.indexOf('*/', parseCloseReg.lastIndex);
                    if (commentCloseInd === -1) {
                        ParseErr('unclosed comment', str, closeTag.index);
                    }
                    parseCloseReg.lastIndex = commentCloseInd;
                }
                else if (char === "'") {
                    singleQuoteReg.lastIndex = closeTag.index;
                    var singleQuoteMatch = singleQuoteReg.exec(str);
                    if (singleQuoteMatch) {
                        parseCloseReg.lastIndex = singleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '"') {
                    doubleQuoteReg.lastIndex = closeTag.index;
                    var doubleQuoteMatch = doubleQuoteReg.exec(str);
                    if (doubleQuoteMatch) {
                        parseCloseReg.lastIndex = doubleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '`') {
                    templateLitReg.lastIndex = closeTag.index;
                    var templateLitMatch = templateLitReg.exec(str);
                    if (templateLitMatch) {
                        parseCloseReg.lastIndex = templateLitReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
            }
        }
        if (currentObj) {
            buffer.push(currentObj);
        }
        else {
            ParseErr('unclosed tag', str, m.index + precedingString.length);
        }
    }
    pushString(str.slice(lastIndex, str.length), false);
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processAST) {
                buffer = plugin.processAST(buffer, config);
            }
        }
    }
    return buffer;
}

/* END TYPES */
/**
 * Compiles a template string to a function string. Most often users just use `compile()`, which calls `compileToString` and creates a new function using the result
 *
 * **Example**
 *
 * ```js
 * compileToString("Hi <%= it.user %>", eta.config)
 * // "var tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR"
 * ```
 */
function compileToString(str, config) {
    var buffer = parse(str, config);
    var res = "var tR='',__l,__lP" +
        (config.include ? ',include=E.include.bind(E)' : '') +
        (config.includeFile ? ',includeFile=E.includeFile.bind(E)' : '') +
        '\nfunction layout(p,d){__l=p;__lP=d}\n' +
        (config.useWith ? 'with(' + config.varName + '||{}){' : '') +
        compileScope(buffer, config) +
        (config.includeFile
            ? 'if(__l)tR=' +
                (config.async ? 'await ' : '') +
                ("includeFile(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
            : config.include
                ? 'if(__l)tR=' +
                    (config.async ? 'await ' : '') +
                    ("include(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
                : '') +
        'if(cb){cb(null,tR)} return tR' +
        (config.useWith ? '}' : '');
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processFnString) {
                res = plugin.processFnString(res, config);
            }
        }
    }
    return res;
}
/**
 * Loops through the AST generated by `parse` and transform each item into JS calls
 *
 * **Example**
 *
 * ```js
 * // AST version of 'Hi <%= it.user %>'
 * let templateAST = ['Hi ', { val: 'it.user', t: 'i' }]
 * compileScope(templateAST, eta.config)
 * // "tR+='Hi ';tR+=E.e(it.user);"
 * ```
 */
function compileScope(buff, config) {
    var i = 0;
    var buffLength = buff.length;
    var returnStr = '';
    for (i; i < buffLength; i++) {
        var currentBlock = buff[i];
        if (typeof currentBlock === 'string') {
            var str = currentBlock;
            // we know string exists
            returnStr += "tR+='" + str + "'\n";
        }
        else {
            var type = currentBlock.t; // ~, s, !, ?, r
            var content = currentBlock.val || '';
            if (type === 'r') {
                // raw
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
            }
            else if (type === 'i') {
                // interpolate
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                if (config.autoEscape) {
                    content = 'E.e(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
                // reference
            }
            else if (type === 'e') {
                // execute
                returnStr += content + '\n'; // you need a \n in case you have <% } %>
            }
        }
    }
    return returnStr;
}

/**
 * Handles storage and accessing of values
 *
 * In this case, we use it to store compiled template functions
 * Indexed by their `name` or `filename`
 */
var Cacher$1 = /** @class */ (function () {
    function Cacher(cache) {
        this.cache = cache;
    }
    Cacher.prototype.define = function (key, val) {
        this.cache[key] = val;
    };
    Cacher.prototype.get = function (key) {
        // string | array.
        // TODO: allow array of keys to look down
        // TODO: create plugin to allow referencing helpers, filters with dot notation
        return this.cache[key];
    };
    Cacher.prototype.remove = function (key) {
        delete this.cache[key];
    };
    Cacher.prototype.reset = function () {
        this.cache = {};
    };
    Cacher.prototype.load = function (cacheObj) {
        copyProps$1(this.cache, cacheObj);
    };
    return Cacher;
}());

/* END TYPES */
/**
 * Eta's template storage
 *
 * Stores partials and cached templates
 */
var templates = new Cacher$1({});

/* END TYPES */
/**
 * Include a template based on its name (or filepath, if it's already been cached).
 *
 * Called like `include(templateNameOrPath, data)`
 */
function includeHelper(templateNameOrPath, data) {
    var template = this.templates.get(templateNameOrPath);
    if (!template) {
        throw EtaErr('Could not fetch template "' + templateNameOrPath + '"');
    }
    return template(data, this);
}
/** Eta's base (global) configuration */
var config = {
    async: false,
    autoEscape: true,
    autoTrim: [false, 'nl'],
    cache: false,
    e: XMLEscape,
    include: includeHelper,
    parse: {
        exec: '',
        interpolate: '=',
        raw: '~'
    },
    plugins: [],
    rmWhitespace: false,
    tags: ['<%', '%>'],
    templates: templates,
    useWith: false,
    varName: 'it'
};
/**
 * Takes one or two partial (not necessarily complete) configuration objects, merges them 1 layer deep into eta.config, and returns the result
 *
 * @param override Partial configuration object
 * @param baseConfig Partial configuration object to merge before `override`
 *
 * **Example**
 *
 * ```js
 * let customConfig = getConfig({tags: ['!#', '#!']})
 * ```
 */
function getConfig(override, baseConfig) {
    // TODO: run more tests on this
    var res = {}; // Linked
    copyProps$1(res, config); // Creates deep clone of eta.config, 1 layer deep
    if (baseConfig) {
        copyProps$1(res, baseConfig);
    }
    if (override) {
        copyProps$1(res, override);
    }
    return res;
}

/* END TYPES */
/**
 * Takes a template string and returns a template function that can be called with (data, config, [cb])
 *
 * @param str - The template string
 * @param config - A custom configuration object (optional)
 *
 * **Example**
 *
 * ```js
 * let compiledFn = eta.compile("Hi <%= it.user %>")
 * // function anonymous()
 * let compiledFnStr = compiledFn.toString()
 * // "function anonymous(it,E,cb\n) {\nvar tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR\n}"
 * ```
 */
function compile(str, config) {
    var options = getConfig(config || {});
    /* ASYNC HANDLING */
    // The below code is modified from mde/ejs. All credit should go to them.
    var ctor = options.async ? getAsyncFunctionConstructor() : Function;
    /* END ASYNC HANDLING */
    try {
        return new ctor(options.varName, 'E', // EtaConfig
        'cb', // optional callback
        compileToString(str, options)); // eslint-disable-line no-new-func
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr('Bad template syntax\n\n' +
                e.message +
                '\n' +
                Array(e.message.length + 1).join('=') +
                '\n' +
                compileToString(str, options) +
                '\n' // This will put an extra newline before the callstack for extra readability
            );
        }
        else {
            throw e;
        }
    }
}

var _BOM = /^\uFEFF/;
/* END TYPES */
/**
 * Get the path to the included file from the parent file path and the
 * specified path.
 *
 * If `name` does not have an extension, it will default to `.eta`
 *
 * @param name specified path
 * @param parentfile parent file path
 * @param isDirectory whether parentfile is a directory
 * @return absolute path to template
 */
function getWholeFilePath(name, parentfile, isDirectory) {
    var includePath = path.resolve(isDirectory ? parentfile : path.dirname(parentfile), // returns directory the parent file is in
    name // file
    ) + (path.extname(name) ? '' : '.eta');
    return includePath;
}
/**
 * Get the absolute path to an included template
 *
 * If this is called with an absolute path (for example, starting with '/' or 'C:\')
 * then Eta will attempt to resolve the absolute path within options.views. If it cannot,
 * Eta will fallback to options.root or '/'
 *
 * If this is called with a relative path, Eta will:
 * - Look relative to the current template (if the current template has the `filename` property)
 * - Look inside each directory in options.views
 *
 * Note: if Eta is unable to find a template using path and options, it will throw an error.
 *
 * @param path    specified path
 * @param options compilation options
 * @return absolute path to template
 */
function getPath(path, options) {
    var includePath = false;
    var views = options.views;
    var searchedPaths = [];
    // If these four values are the same,
    // getPath() will return the same result every time.
    // We can cache the result to avoid expensive
    // file operations.
    var pathOptions = JSON.stringify({
        filename: options.filename,
        path: path,
        root: options.root,
        views: options.views
    });
    if (options.cache && options.filepathCache && options.filepathCache[pathOptions]) {
        // Use the cached filepath
        return options.filepathCache[pathOptions];
    }
    /** Add a filepath to the list of paths we've checked for a template */
    function addPathToSearched(pathSearched) {
        if (!searchedPaths.includes(pathSearched)) {
            searchedPaths.push(pathSearched);
        }
    }
    /**
     * Take a filepath (like 'partials/mypartial.eta'). Attempt to find the template file inside `views`;
     * return the resulting template file path, or `false` to indicate that the template was not found.
     *
     * @param views the filepath that holds templates, or an array of filepaths that hold templates
     * @param path the path to the template
     */
    function searchViews(views, path) {
        var filePath;
        // If views is an array, then loop through each directory
        // And attempt to find the template
        if (Array.isArray(views) &&
            views.some(function (v) {
                filePath = getWholeFilePath(path, v, true);
                addPathToSearched(filePath);
                return fs.existsSync(filePath);
            })) {
            // If the above returned true, we know that the filePath was just set to a path
            // That exists (Array.some() returns as soon as it finds a valid element)
            return filePath;
        }
        else if (typeof views === 'string') {
            // Search for the file if views is a single directory
            filePath = getWholeFilePath(path, views, true);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                return filePath;
            }
        }
        // Unable to find a file
        return false;
    }
    // Path starts with '/', 'C:\', etc.
    var match = /^[A-Za-z]+:\\|^\//.exec(path);
    // Absolute path, like /partials/partial.eta
    if (match && match.length) {
        // We have to trim the beginning '/' off the path, or else
        // path.resolve(dir, path) will always resolve to just path
        var formattedPath = path.replace(/^\/*/, '');
        // First, try to resolve the path within options.views
        includePath = searchViews(views, formattedPath);
        if (!includePath) {
            // If that fails, searchViews will return false. Try to find the path
            // inside options.root (by default '/', the base of the filesystem)
            var pathFromRoot = getWholeFilePath(formattedPath, options.root || '/', true);
            addPathToSearched(pathFromRoot);
            includePath = pathFromRoot;
        }
    }
    else {
        // Relative paths
        // Look relative to a passed filename first
        if (options.filename) {
            var filePath = getWholeFilePath(path, options.filename);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                includePath = filePath;
            }
        }
        // Then look for the template in options.views
        if (!includePath) {
            includePath = searchViews(views, path);
        }
        if (!includePath) {
            throw EtaErr('Could not find the template "' + path + '". Paths tried: ' + searchedPaths);
        }
    }
    // If caching and filepathCache are enabled,
    // cache the input & output of this function.
    if (options.cache && options.filepathCache) {
        options.filepathCache[pathOptions] = includePath;
    }
    return includePath;
}
/**
 * Reads a file synchronously
 */
function readFile(filePath) {
    try {
        return fs.readFileSync(filePath).toString().replace(_BOM, ''); // TODO: is replacing BOM's necessary?
    }
    catch (_a) {
        throw EtaErr("Failed to read template at '" + filePath + "'");
    }
}

// express is set like: app.engine('html', require('eta').renderFile)
/* END TYPES */
/**
 * Reads a template, compiles it into a function, caches it if caching isn't disabled, returns the function
 *
 * @param filePath Absolute path to template file
 * @param options Eta configuration overrides
 * @param noCache Optionally, make Eta not cache the template
 */
function loadFile(filePath, options, noCache) {
    var config = getConfig(options);
    var template = readFile(filePath);
    try {
        var compiledTemplate = compile(template, config);
        if (!noCache) {
            config.templates.define(config.filename, compiledTemplate);
        }
        return compiledTemplate;
    }
    catch (e) {
        throw EtaErr('Loading file: ' + filePath + ' failed:\n\n' + e.message);
    }
}
/**
 * Get the template from a string or a file, either compiled on-the-fly or
 * read from cache (if enabled), and cache the template if needed.
 *
 * If `options.cache` is true, this function reads the file from
 * `options.filename` so it must be set prior to calling this function.
 *
 * @param options   compilation options
 * @return Eta template function
 */
function handleCache(options) {
    var filename = options.filename;
    if (options.cache) {
        var func = options.templates.get(filename);
        if (func) {
            return func;
        }
        return loadFile(filename, options);
    }
    // Caching is disabled, so pass noCache = true
    return loadFile(filename, options, true);
}
/**
 * Get the template function.
 *
 * If `options.cache` is `true`, then the template is cached.
 *
 * This returns a template function and the config object with which that template function should be called.
 *
 * @remarks
 *
 * It's important that this returns a config object with `filename` set.
 * Otherwise, the included file would not be able to use relative paths
 *
 * @param path path for the specified file (if relative, specify `views` on `options`)
 * @param options compilation options
 * @return [Eta template function, new config object]
 */
function includeFile(path, options) {
    // the below creates a new options object, using the parent filepath of the old options object and the path
    var newFileOptions = getConfig({ filename: getPath(path, options) }, options);
    // TODO: make sure properties are currectly copied over
    return [handleCache(newFileOptions), newFileOptions];
}

/* END TYPES */
/**
 * Called with `includeFile(path, data)`
 */
function includeFileHelper(path, data) {
    var templateAndConfig = includeFile(path, this);
    return templateAndConfig[0](data, templateAndConfig[1]);
}

/* END TYPES */
function handleCache$1(template, options) {
    if (options.cache && options.name && options.templates.get(options.name)) {
        return options.templates.get(options.name);
    }
    var templateFunc = typeof template === 'function' ? template : compile(template, options);
    // Note that we don't have to check if it already exists in the cache;
    // it would have returned earlier if it had
    if (options.cache && options.name) {
        options.templates.define(options.name, templateFunc);
    }
    return templateFunc;
}
/**
 * Render a template
 *
 * If `template` is a string, Eta will compile it to a function and then call it with the provided data.
 * If `template` is a template function, Eta will call it with the provided data.
 *
 * If `config.async` is `false`, Eta will return the rendered template.
 *
 * If `config.async` is `true` and there's a callback function, Eta will call the callback with `(err, renderedTemplate)`.
 * If `config.async` is `true` and there's not a callback function, Eta will return a Promise that resolves to the rendered template.
 *
 * If `config.cache` is `true` and `config` has a `name` or `filename` property, Eta will cache the template on the first render and use the cached template for all subsequent renders.
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function render(template, data, config, cb) {
    var options = getConfig(config || {});
    if (options.async) {
        if (cb) {
            // If user passes callback
            try {
                // Note: if there is an error while rendering the template,
                // It will bubble up and be caught here
                var templateFn = handleCache$1(template, options);
                templateFn(data, options, cb);
            }
            catch (err) {
                return cb(err);
            }
        }
        else {
            // No callback, try returning a promise
            if (typeof promiseImpl$1 === 'function') {
                return new promiseImpl$1(function (resolve, reject) {
                    try {
                        resolve(handleCache$1(template, options)(data, options));
                    }
                    catch (err) {
                        reject(err);
                    }
                });
            }
            else {
                throw EtaErr("Please provide a callback function, this env doesn't support Promises");
            }
        }
    }
    else {
        return handleCache$1(template, options)(data, options);
    }
}
/**
 * Render a template asynchronously
 *
 * If `template` is a string, Eta will compile it to a function and call it with the provided data.
 * If `template` is a function, Eta will call it with the provided data.
 *
 * If there is a callback function, Eta will call it with `(err, renderedTemplate)`.
 * If there is not a callback function, Eta will return a Promise that resolves to the rendered template
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function renderAsync(template, data, config, cb) {
    // Using Object.assign to lower bundle size, using spread operator makes it larger because of typescript injected polyfills
    return render(template, data, Object.assign({}, config, { async: true }), cb);
}

// @denoify-ignore
config.includeFile = includeFileHelper;
config.filepathCache = {};

const VAR_NAME = 'sk';
const EBAR = `\n---------------------------\n`;

Element.prototype.addClazz = function (str) {
    if (Array.isArray(str)) {
        this.addClass(...str);
    }
    else
        this.addClass(str);
};
function getFiles(app, dir) {
    let dirPath = obsidian.normalizePath(dir);
    let fo = app.vault.getAbstractFileByPath(dirPath);
    if (!fo || !(fo instanceof obsidian.TFolder))
        throw `Skribi: Could not find folder '${dirPath}'`;
    let files = [];
    obsidian.Vault.recurseChildren(fo, (fi) => {
        if (fi instanceof obsidian.TFile)
            files.push(fi);
    });
    // console.log(files)
    return files;
}
function checkFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).every((f) => { return exts.contains(f.extension); });
}
function filterFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).filter((f) => { if (checkFileExt(f, exts))
        return f; });
}
function toArray(args) {
    return (Array.isArray(args) ? args : [args]);
}
function isInFolder(e, dir) {
    let boo = (obsidian.normalizePath((/.+\//g).exec(e.path)[0]) == obsidian.normalizePath(dir));
    return boo;
}
function isExtant(obj) {
    return !((obj === null) || (obj === undefined));
}
function roundTo(x, to) {
    return parseFloat(parseFloat(x).toPrecision(to !== null && to !== void 0 ? to : 4));
}
function getVerbosity() {
    var _a;
    //@ts-ignore
    return ((_a = window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings.verboseLogging) || false;
}
function vLog(...args) {
    if (getVerbosity()) {
        console.log("Skribi:", ...args);
    }
}
function vWarn(...args) {
    if (getVerbosity()) {
        console.warn("Skribi:", ...args);
    }
}
function dLog(...args) {
    var _a, _b;
    //@ts-ignore
    if (((_b = (_a = window === null || window === void 0 ? void 0 : window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.devLogging) || false) {
        console.log(...args);
    }
}
/* Takes an array of strings and returns a record of key/value pairs for each, where the key and value are the same */
function toDupeRecord(arr) {
    return arr.reduce((a, i) => (Object.assign(Object.assign({}, a), { [i]: i })), {});
}
/**
 * @param input An object to clone
 * @param keys The keys of properties to omit from the clone
 * @returns A clone of 'input' without the omitted properties */
function withoutKey(input, key) {
    const clone = Object.assign({}, input);
    if (Array.isArray(key)) {
        key.forEach((k) => {
            delete clone[k];
        });
    }
    else {
        delete clone[key];
    }
    return clone;
}
Object.getPrototypeOf(function () {
    return __awaiter(this, void 0, void 0, function* () { });
}).constructor;
const promiseImpl = new Function('return this')().Promise;
const getAsyncConstructor = () => new Function('return (async function(){}).constructor')();
const isFunc = (func) => (func instanceof Function);
const isFile = (item) => (item) instanceof obsidian.TFile;
function average(...numbers) {
    return numbers.reduce((val, cur) => val + cur) / numbers.length;
}
/* Get link to documentation page. */
function linkDocs(page) {
    // return `https://azulaloi.net/obsidian-skribi/${page}`
    return `https://azulaloi.github.io/obsidian-skribi/${page}`;
}
/* Prefixes string with plugin name. Makes reusing code across plugins easier. */
function kls(cls) { return `skribi-${cls}`; }
function hash(str) {
    let hash = 5381;
    let i = str.length;
    while (i) {
        hash = (hash * 33) ^ str.charCodeAt(--i);
    }
    return hash >>> 0;
}

/** Adds the entries of scope to a function string.
* @param functionString A string function compiled by Eta's compileToString()
* @param keys Array of keys that the returned function will expect to be present in its scope argument
* @param async If true, returned function will be asynchronous */
function compileWith(functionString, keys, async) {
    var a = "";
    for (let k of keys) {
        a += `${k},`;
    }
    let func = `var {${a.substr(0, a.length - 1)}} = scope;\n` + functionString;
    let constructor = (async) ? getAsyncConstructor() : Function;
    let compiled = new constructor('scope', func);
    return compiled;
}
/* Version of Eta's render function, modified to handle scoped templates */
function renderEta(handler, template, data, config, cb, scope, binder) {
    const options = getConfig(config || {});
    if (options.async) {
        // if (cb) {
        // try { 
        // const templateFn = handler.getCached(template, options, scope, binder)
        // templateFn(scope)
        // } catch(e) {
        // return cb(e)
        // }
        // } else {
        // return (async () => handler.getCached(template, options, scope, binder)(scope))()
        return new promiseImpl(function (resolve, reject) {
            try {
                resolve(handler.getCached(template, options, scope, binder)(scope));
            }
            catch (e) {
                reject(e);
            }
        });
        // }
    }
    else {
        let func = handler.getCached(template, options, scope, binder);
        dLog(`Rendering function`, func);
        return func(scope);
    }
}
/* Version of Eta's async render function, just sets async to true */
/* Note: perf impact of using async templatefunctions is negligible */
function renderEtaAsync(handler, template, data, config, cb, scope, binder) {
    return renderEta(handler, template, data, Object.assign({}, config, { async: true }), cb, scope, binder);
}

class Provider {
    constructor(bus, id) {
        this.functions = new Map();
        this.initLoaded = false;
        this.isDirty = false;
        this.bus = bus;
        this.id = id;
    }
    createObject() {
        return Object.assign({}, Object.fromEntries(this.functions));
    }
    init() {
        this.initLoaded = true;
        return Promise.resolve();
    }
    unload() { }
    reload() {
        return Promise.resolve();
    }
    /**
     * @param clean If true, provider.isDirty = false */
    setDirty(dirty) {
        this.isDirty = isExtant(dirty) ? dirty : true;
        this.bus.providerNotificationDirty(this, this.isDirty);
    }
    /* May be called without data. */
    postDirty(...args) { }
}
class ProviderPredicated extends Provider {
    constructor() {
        super(...arguments);
        this.predicatePluginName = '';
    }
    getPredicate() {
        var _a;
        return ((_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a[this.predicatePluginName]) || null;
    }
    /**
     * @returns true only when the predicate condition is met */
    predicateCheck() {
        return this.bus.plugin.app.plugins.enabledPlugins.has(this.predicatePluginName);
    }
    /**
     * @returns An error string describing the unmet predicate condition */
    predicateError() {
        return `Integration Module '${this.id}' not available, could not find required plugin: '${this.predicatePluginName}'`;
    }
}

class ProviderSK extends Provider {
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return _super.init.call(this);
        });
    }
    createObject() {
        return {
            render: function (str) {
                let e = createDiv({ cls: "skribi-render-virtual" });
                console.log(this);
                obsidian.MarkdownRenderer.renderMarkdown(str, e, this.ctx.file.path, null);
                return e.innerHTML;
            },
            has: function (v) {
                var _a, _b;
                return !((((_a = this.v) === null || _a === void 0 ? void 0 : _a[v]) == null) || (((_b = this.v) === null || _b === void 0 ? void 0 : _b[v]) == undefined));
            },
            abort: function (s) {
                let abortPacket = String.isString(s)
                    ? { hasData: true, flag: 'abort', hover: s }
                    : Object.assign({ hasData: true, flag: 'abort' }, s);
                throw abortPacket;
            },
            getTemplateSource: function (s) {
                let plugin = this.ctx.plugin;
                return plugin.initLoaded
                    ? plugin.eta.loader.templateSource.get(s)
                    : (() => {
                        return new Promise((resolve, reject) => {
                            let x = plugin.app.workspace.on('skribi:template-init-complete', () => {
                                plugin.app.workspace.offref(x);
                                resolve(plugin.eta.loader.templateSource.get(s));
                            });
                            this.registerEvent(x);
                        });
                    })();
            },
            getStyle: function (s) {
                let plugin = this.ctx.plugin;
                console.log(this);
                return plugin.initLoaded
                    ? Promise.resolve(plugin.eta.loader.styleCache.get(s))
                    : (() => {
                        return new Promise((resolve, reject) => {
                            let x = plugin.app.workspace.on('skribi:template-init-complete', () => {
                                plugin.app.workspace.offref(x);
                                resolve(plugin.eta.loader.styleCache.get(s));
                            });
                            this.registerEvent(x);
                        });
                    })();
            },
            includeStyle: function (s) {
                return __awaiter(this, void 0, void 0, function* () {
                    if (this.ctx.plugin.eta.loader.styleCache.has(s)) {
                        this.child._c.listenFor("style", s);
                        return this.child.addStyle(yield this.getStyle(s));
                    }
                });
            }
        };
    }
}

class ProviderDataview extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'dataview';
        // createDynamic(state: DynamicState) {
        // let api = new DataviewInlineApi(this.dvp.index, state.child, state.el, this.bus.plugin.app, this.dvp.settings, state.file.path)
        // return this?.dvp?.api || null
        // }
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            // this.dvp = this.bus.plugin.app.plugins.plugins.dataview as DataviewPlugin || null
            this.eventRef_API_READY = this.bus.plugin.app.metadataCache.on('dataview:api-ready', (api) => { this.apiReady(); });
            return _super.init.call(this);
        });
    }
    unload() {
        this.bus.plugin.app.metadataCache.offref(this.eventRef_API_READY);
    }
    createObject() {
        var _a, _b;
        return ((_b = (_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a.dataview) === null || _b === void 0 ? void 0 : _b.api) || null;
    }
    apiReady() {
    }
}

class ProviderWeather extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'obsidian-weather';
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.eventRefs = {
                ready: this.bus.plugin.app.workspace.on("az-weather:api-ready", () => { }),
                unload: this.bus.plugin.app.workspace.on("az-weather:api-unload", () => { }),
                tick: this.bus.plugin.app.workspace.on("az-weather:api-tick", () => { })
            };
            this.functions.set("check", this.provide_predicate());
            this.functions.set("cache", this.provide_dispenseCache());
            this.functions.set("tickEventRef", this.provide_tickEventRef());
            return _super.init.call(this);
        });
    }
    unload() {
        for (let r of Object.values(this.eventRefs)) {
            this.bus.plugin.app.workspace.offref(r);
        }
    }
    /* Provisions */
    provide_predicate() {
        return () => {
            return (!!this.weatherAPI);
        };
    }
    provide_dispenseCache() {
        return () => {
            var _a;
            let p = this.getPredicate();
            return (_a = p === null || p === void 0 ? void 0 : p.API) === null || _a === void 0 ? void 0 : _a.dispenseCache.bind(p.API)();
        };
    }
    provide_tickEventRef() {
        return (cb) => {
            return this.bus.plugin.app.workspace.on("az-weather:api-tick", (...a) => cb(...a));
        };
    }
}

// TODO: add system to auto-reload skribis when module cache changes 
class ProviderScriptloader extends Provider {
    constructor() {
        super(...arguments);
        this.loadedModules = new Map();
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad().then(() => _super.init.call(this));
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.loadAndSet(...getFiles(this.bus.plugin.app, this.bus.plugin.settings.scriptFolder));
        });
    }
    loadAndSet(...file) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.readFiles(...file)
                .then((ret) => { /*vLog('Loading JS modules...', ret);*/ this.stashModule(ret); return Promise.resolve(); });
        });
    }
    stashModule(modules) {
        dLog('Scriptloader: stashModule', modules);
        modules.forEach((r) => {
            var _a, _b;
            if (r) {
                this.loadedModules.delete(r[0]);
                this.loadedModules.set(r[0], {
                    name: (String.isString((_b = (_a = r[1]) === null || _a === void 0 ? void 0 : _a._name) !== null && _b !== void 0 ? _b : null) ? r[1]._name : null),
                    properties: withoutKey(r[1], '_name')
                });
            }
        });
    }
    createObject() {
        let exports = new Map();
        this.loadedModules.forEach((value, key) => {
            var _a;
            let single = (Object.keys(value.properties).length == 1);
            exports.set(((_a = value.name) !== null && _a !== void 0 ? _a : (single ? Object.keys(value.properties)[0] : key)), single ? Object.values(value.properties)[0] : value.properties);
        });
        return Object.assign({}, Object.fromEntries(exports));
    }
    readFiles(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            let filtered = filterFileExt(files, "js");
            const reads = filtered.map((f) => __awaiter(this, void 0, void 0, function* () {
                try {
                    if (!(this.bus.plugin.app.vault.adapter instanceof obsidian.FileSystemAdapter))
                        return Promise.reject();
                    let path = this.bus.plugin.app.vault.adapter.getBasePath() + "/" + f.path;
                    let resPath = window.require.resolve(path);
                    if (Object.keys(window.require.cache).contains(resPath))
                        delete window.require.cache[window.require.resolve(resPath)];
                    const mod = require(path);
                    return (isExtant(mod))
                        ? Promise.resolve([f.basename, mod])
                        : Promise.reject();
                }
                catch (e) {
                    console.warn(e);
                    return Promise.reject();
                }
            }));
            return yield Promise.allSettled(reads)
                .then((settled) => {
                return settled
                    .filter((r) => { return r.status == "fulfilled"; })
                    .map((v) => { return v.value; });
            });
        });
    }
    clearJS(...items) {
        let names = items.map((item) => {
            if (isFile(item))
                return filterFileExt(item, 'js')[0].basename;
            else if (String.isString(item))
                return item;
        });
        for (let name of names)
            this.loadedModules.delete(name);
    }
    reload() {
        const _super = Object.create(null, {
            reload: { get: () => super.reload }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.loadedModules.clear();
            yield this.initLoad();
            return _super.reload.call(this);
        });
    }
    postDirty() {
        if (this.bus.plugin.settings.autoReload) {
            Array.from(this.bus.plugin.children).forEach(child => child.scriptsUpdated());
        }
    }
    /* FileMinder Functions */
    get directory() { return this.bus.plugin.settings.scriptFolder; }
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in script directory modified, updating...`);
        this.clearJS(file);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from script directory, unloading...`);
        this.clearJS(file);
        this.setDirty();
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to script directory, loading...`);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Script file '${oldName}' renamed to '${file.name}', updating...`);
        this.clearJS(oldName);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => { });
    }
    directoryChanged() {
        vLog(`Script directory changed, reloading scripts...`);
        this.reload().then(() => this.setDirty(), (e) => { console.warn(e); });
    }
    isInDomain(file) {
        return isInFolder(file, this.directory);
    }
}

const obsidianModule = require("obsidian");
const MODULE_NAME_INTEGRATIONS = 'int';
/* Handles all script function providers */
class ProviderBus {
    constructor(handler) {
        this.providers = new Map();
        this.providersPredicated = new Map();
        this.scopeStatic = {};
        // Indicates that a provider has been added or removed, and the static scope should be regenerated.
        this.isStaticScopeDirty = false;
        /**
         * Integration point for other plugins to add a provider
         * @param provider Provider implementation to add */
        this.addProvider = (provider) => {
            this.providers.set(provider.id, provider);
            this.isStaticScopeDirty = true;
            this.handler.recompileTemplates();
        };
        /**
         * Integration point for other plugins to add a predicated provider
         * @param provider ProviderPredicated implementation to add */
        this.addProviderPredicated = (provider) => {
            this.providersPredicated.set(provider.id, provider);
        };
        this.handler = handler;
        this.plugin = handler.plugin;
        this.scriptLoader = new ProviderScriptloader(this, 'js'); // assigned here so that we can register file events in handler
    }
    /* Construct all providers but do not initialize them yet, so that we can compile and cache templates ASAP */
    preInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addTo(this.providers, this.scriptLoader);
            this.addTo(this.providersPredicated, new ProviderDataview(this, 'dv'));
            this.addTo(this.providersPredicated, new ProviderWeather(this, 'weather'));
            this.skBase = new ProviderSK(this, VAR_NAME);
            return Promise.resolve();
        });
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            const inits = Object.values(this.execOnProviders('init'));
            yield Promise.allSettled(inits);
            this.createStaticScope();
            return Promise.resolve();
        });
    }
    addTo(providers, provider) {
        providers.set(provider.id, provider);
    }
    unload() {
        this.execOnProviders('unload');
    }
    /* Invoked by providers to indicate their provision must be regenerated */
    providerNotificationDirty(provider, isDirty, ...data) {
        if (isDirty)
            this.refreshProvider(provider, ...data);
    }
    /* Regenerate the provision of a single provider, and pass data to its post function */
    refreshProvider(provider, ...data) {
        provider.setDirty(false);
        Object.assign(this.scopeStatic, { [provider.id]: provider.createObject() });
        provider.postDirty(...data);
    }
    /* Clean dirty providers by regenerating their provision */
    refreshProviders(...providers) {
        let proxy = {};
        for (let provider of providers) {
            proxy[provider.id] = provider.createObject();
            provider.setDirty(false);
        }
        Object.assign(this.scopeStatic, proxy);
        providers.forEach(provider => provider.postDirty());
    }
    /* Reloads all providers */
    reloadProviders() {
        return __awaiter(this, void 0, void 0, function* () {
            let proms = this.execOnProviders('reload');
            return Promise.allSettled(Object.values(proms));
        });
    }
    getScopeKeys() {
        return [...this.providers.keys(), MODULE_NAME_INTEGRATIONS, 'moment', 'obsidian'];
    }
    /* Retrieves providers object */
    getScope(ctx, refresh) {
        let dirties = Object.values(this.providers).filter((p) => { return p.isDirty; });
        if (dirties)
            this.refreshProviders(...dirties);
        if (this.isStaticScopeDirty)
            this.createStaticScope();
        return Object.assign({}, this.scopeStatic, { [MODULE_NAME_INTEGRATIONS]: this.createPredicatedScope(ctx || null) });
    }
    /* Creates scope object. Should not be used to get the scope. */
    createStaticScope() {
        let spaces = {};
        for (let p of this.providers)
            spaces[p[0]] = p[1].createObject();
        spaces['moment'] = window.moment;
        spaces['obsidian'] = obsidianModule;
        this.scopeStatic = spaces;
        this.isStaticScopeDirty = false;
        return this.scopeStatic;
    }
    /* Predicated providers */
    createPredicatedScope(ctx) {
        let spaces = {};
        for (let p of this.providersPredicated) {
            Object.defineProperty(spaces, p[0], { get: function () {
                    if (p[1].predicateCheck())
                        return p[1].createObject();
                    else
                        throw new Error(p[1].predicateError());
                }
            });
        }
        return spaces;
    }
    /* Get the base provider scope */
    getScopeSK() {
        return this.skBase.createObject();
    }
    /* Invoke function on all providers and return array of results */
    execOnProviders(func) {
        let rets = {};
        const invoke = (providers) => {
            for (let p of providers)
                if ((p != null) && (isFunc(p[1][func]))) {
                    rets[p[0]] = p[1][func]();
                }
        };
        invoke(this.providers);
        invoke(this.providersPredicated);
        return rets;
    }
}

/* This is slightly modified from Eta */
class Cacher {
    constructor(cache) {
        this.cache = cache;
    }
    define(key, val) { this.cache[key] = val; }
    get(key) { return this.cache[key]; }
    remove(key) { delete this.cache[key]; }
    reset() { this.cache = {}; }
    load(cacheObj) { copyProps(this.cache, cacheObj); }
    has(key) {
        return !((this.cache[key] === null) || (this.cache[key] === undefined));
    }
}
function copyProps(toObj, fromObj) {
    for (const key in fromObj) {
        if (hasOwnProp(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
function hasOwnProp(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* Responsible for the caching and management of templates. */
// TODO: add system to auto-reload skribis when relevant template cache changes 
class TemplateLoader {
    constructor(handler) {
        this.templateCache = new Cacher({});
        this.templateFailures = new Map();
        this.templateFrontmatters = new Map();
        this.templateSource = new Cacher({});
        this.styleCache = new Cacher({});
        this.handler = handler;
        this.plugin = handler.plugin;
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad();
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.definePartials(...getFiles(this.plugin.app, this.directory));
            this.plugin.app.workspace.trigger('skribi:template-init-complete');
            return Promise.resolve();
        });
    }
    /**
     * Reads passed files and attempts to cache them.
     * Handles templates and styles. Templates are compiled to functions. */
    definePartials(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            const startTime = window.performance.now();
            var failureCount = 0;
            var successCount = 0;
            const scopeKeys = this.handler.bus.getScopeKeys();
            let styleFiles = [];
            let templateFiles = [];
            files.forEach(file => {
                switch (file.extension) {
                    case "md":
                        templateFiles.push(file);
                        break;
                    case "eta":
                        templateFiles.push(file);
                        break;
                    case "css":
                        styleFiles.push(file);
                        break;
                }
            });
            const readTemplates = templateFiles.map((file) => __awaiter(this, void 0, void 0, function* () {
                var _a, _b, _c;
                let read = yield this.plugin.app.vault.cachedRead(file);
                let fileFrontmatter = null;
                if (file.extension == "eta") {
                    let fmSearch = (/^---\n*(?<frontmatter>.*?)\n*---/s).exec(read);
                    if (fmSearch.groups.frontmatter) {
                        try {
                            let yaml = obsidian.parseYaml(fmSearch.groups.frontmatter.trim());
                            fileFrontmatter = yaml;
                            read = read.substr(fmSearch[0].length);
                        }
                        catch (e) {
                            vWarn(`Error parsing frontmatter of ${file.name}, please report.`, EBAR, e);
                        }
                    }
                }
                else {
                    /* Markdown files can check for cached frontmatter which is maybe faster */
                    fileFrontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) === null || _a === void 0 ? void 0 : _a.frontmatter;
                    if (fileFrontmatter) {
                        let fmSearch = (/(?<frontmatter>^---.*?(?=\n---)\n---)/s).exec(read);
                        let fmText = (_c = (_b = fmSearch === null || fmSearch === void 0 ? void 0 : fmSearch.groups) === null || _b === void 0 ? void 0 : _b.frontmatter) !== null && _c !== void 0 ? _c : null;
                        if (isExtant(fmText)) {
                            read = read.substr(fmText.length);
                        }
                    }
                }
                try {
                    let compiledString = compileToString(read, getConfig({ varName: VAR_NAME, name: file.basename }));
                    var compiled = compileWith(compiledString, [VAR_NAME, 'E', 'cb', ...scopeKeys], (read.contains('await')));
                }
                catch (err) {
                    this.templateFailures.set(file.basename, err || `Template failed to compile: Unknown Error`);
                    console.warn(`Skribi: template '${file.basename}' failed to compile`, EBAR, err, EBAR, read);
                    this.templateCache.remove(file.basename);
                    this.templateFrontmatters.delete(file.basename);
                    failureCount++;
                    return Promise.reject();
                }
                this.templateFailures.delete(file.basename);
                this.templateCache.define(file.basename, compiled);
                this.templateSource.define(file.basename, read);
                if (fileFrontmatter)
                    this.templateFrontmatters.set(file.basename, withoutKey(fileFrontmatter, 'position'));
                successCount++;
                return Promise.resolve();
            }));
            const readStyles = styleFiles.map((file) => __awaiter(this, void 0, void 0, function* () {
                let read = yield this.plugin.app.vault.cachedRead(file);
                this.styleCache.define(file.basename, read);
            }));
            yield Promise.allSettled(readTemplates.concat(readStyles));
            if ((!this.plugin.initLoaded) && files.length) {
                let str = `${successCount} template${(successCount == 1) ? '' : 's'}`;
                if (failureCount)
                    str += `\n Of ${templateFiles.length} total templates, ${failureCount} failed to compile.`;
                console.log(`Skribi: Loaded ` + str);
            }
            else if (this.plugin.initLoaded) {
                /* Other than during init, definePartials is called on single files at a time.  */
                if (templateFiles.length > 0) {
                    Array.from(this.plugin.children).forEach((child) => {
                        child.templatesUpdated(templateFiles[0].basename);
                    });
                    vLog(`Updated template '${templateFiles[0].basename}' in ${roundTo(window.performance.now() - startTime, 4)}ms`);
                }
                if (styleFiles.length > 0) {
                    Array.from(this.plugin.children).forEach((child) => {
                        child.stylesUpdated(styleFiles[0].basename);
                    });
                    vLog(`Update style '${styleFiles[0].basename}'`);
                }
            }
            return Promise.resolve();
        });
    }
    /* Deletes cache entries by string name or file of origin */
    deletePartial(...items) {
        for (let item of items) {
            let name = isFile(item) ? item.basename : item;
            this.templateCache.remove(name);
        }
    }
    deletePartialByName(...items) {
        var _a, _b;
        for (let item of items) {
            let split = (/(?<name>[^]+)\.(?<extension>[^]+)$/g).exec(item);
            if (!((_b = (_a = Object.keys(split === null || split === void 0 ? void 0 : split.groups)) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0 > 0)) {
                console.warn('Skribi: TemplateLoader.deletePartialByName() could not parse name \n', item);
                continue;
            }
            ((split.groups['extension'] == "css") ? this.styleCache : this.templateCache)
                .remove(split.groups['name']);
        }
    }
    reload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.templateCache.reset();
            return this.definePartials(...getFiles(this.plugin.app, this.directory));
        });
    }
    /* FileMinder Functions */
    get directory() { return this.plugin.settings.templateFolder; }
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in template directory modified, updating...`);
        this.definePartials(file);
    }
    // fileDeleted(file: TAbstractFile | string): void { // never actually called as string I just wrote it to handle it for some reason
    //   let isf = isFile(file)
    //   if ((!isf && !(String.isString(file) && this.templateCache.get(file)))) return;
    //   vLog(`File '${isf ? (file as TFile).name : file}' removed from template directory, unloading...`)
    //   this.deletePartial(file as (TFile | string))
    // }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from template directory, unloading...`);
        this.deletePartialByName(file.name);
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to template directory, loading...`);
        this.definePartials(file);
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Template file '${oldName}' renamed to '${file.name}', updating...`);
        this.deletePartialByName(oldName);
        this.definePartials(file);
    }
    directoryChanged() {
        vLog(`Template directory changed, reloading templates...`);
        this.reload();
    }
    isInDomain(file) {
        return isInFolder(file, this.directory);
    }
}

class EtaHandler {
    constructor(plugin) {
        this.templatesDirty = false;
        this.plugin = plugin;
        this.bus = new ProviderBus(this);
        this.loader = new TemplateLoader(this);
        if (!this.plugin.app.workspace.layoutReady)
            this.plugin.app.workspace.onLayoutReady(() => this.init.bind(this)());
        else
            this.init();
    }
    get templates() { return this.loader.templateCache; }
    get failedTemplates() { return this.loader.templateFailures; }
    get templateFrontmatters() { return this.loader.templateFrontmatters; }
    init() {
        this.initLoad().then(() => {
            this.registerFileEvents();
        }).catch((err) => {
            console.error(`Skribi: EtaHandler failed to initialize!`, EBAR, err);
        });
    }
    registerFileEvents() {
        /* Because the FileMinder index does not change, we don't need the event refs */
        const minders = [this.bus.scriptLoader, this.loader];
        for (let minder of minders) {
            this.plugin.registerEvent(this.plugin.app.vault.on('modify', file => {
                if (minder.isInDomain(file))
                    minder.fileUpdated(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('delete', file => {
                if (minder.isInDomain(file))
                    minder.fileDeleted(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('create', file => {
                if (minder.isInDomain(file))
                    minder.fileAdded(file);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('rename', (file, oldPath) => {
                let ourDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath(minder.directory));
                let oldDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath((/.+\//g).exec(oldPath)[0]));
                if (file.parent == ourDir) {
                    // New location of file is in our directory
                    if (file.parent == oldDir) {
                        // File did not move but was renamed
                        minder.fileRenamed(file, (/([a-zA-Z0-9-_.]+\..*)/g).exec(oldPath)[0]);
                    }
                    else {
                        // File was moved from elsewhere into the template directory
                        minder.fileAdded(file);
                    }
                }
                else if (oldDir == ourDir) {
                    // File used to be in templates directory and is no longer
                    minder.fileDeleted(file);
                }
            }));
        }
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            let { a: a, b: b } = yield this.bus.preInit().then(() => {
                return { a: this.bus.init(), b: this.loader.init() };
            });
            return Promise.all([a, b]);
        });
    }
    unload() {
        this.bus.unload();
    }
    recompileTemplates() {
        // If the bus scope changes, the templates must be recompiled. 
        // The bus scope should not change post-init unless an external source modifies the provider list.
        this.loader.reload();
    }
    getPartial(id) {
        return this.loader.templateCache.get(id);
    }
    hasPartial(id) {
        return isExtant(this.loader.templateCache.get(id));
    }
    getCacheKeys() {
        //@ts-ignore
        return Object.keys(this.templates.cache);
    }
    /**
    * Primary skribi render function. Renders asynchronously (TemplateFunction may or may not be async)
    * @param content String or scoped template function to render
    * @param ctxIn Context object to be added to `sk` object
    * @param file File in which the skribi is being rendered
    * @returns [rendered string, returned packet (currently unused)] */
    renderAsync(content, ctxIn, file) {
        return __awaiter(this, void 0, void 0, function* () {
            /* Used to pass data up to the render process from the skribi function */
            let packet = {};
            function up() {
                return function (x, y) {
                    packet[x] = y;
                };
            }
            let cfg = getConfig({ varName: VAR_NAME });
            /* the 'this' object of the sk context*/
            let binder = {};
            /* The 'sk' object */
            let sk = Object.assign({}, ctxIn || {}, {
                this: binder,
                getEnv: getEnv,
                up: up(),
                ctx: {
                    file: file || null,
                    plugin: this.plugin,
                    app: this.plugin.app
                }
            }, this.bus.getScopeSK());
            /* Scope to pass to the function. Must contain all keys that function was compiled with. */
            let scope = Object.assign({ 'sk': sk, 'E': cfg, 'cb': null }, this.bus.getScope());
            function getEnv() {
                return scope;
            }
            let ren = (content.toString().contains('await')) // This will catch strings containing await as well, maybe a flag should be used instead
                ? renderEtaAsync(this, content, {}, cfg, null, scope, binder)
                : renderEta(this, content, {}, cfg, null, scope, binder);
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve([r, packet]); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve([ren, packet]);
            }
            else
                return Promise.reject("EtaHandler.renderAsync: Unknown Error");
        });
    }
    /* this is somehow 1.3x slower than renderAsync */
    renderAsyncNaive(content, ctxIn, varName) {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribos: renderAsyncNaive invoked', content, ctxIn);
            let context = Object.assign({}, ctxIn || {});
            let ren = renderAsync(content, context, { varName: varName !== null && varName !== void 0 ? varName : VAR_NAME });
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve(r); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve(ren);
            }
            else
                return Promise.reject("Unknown error");
        });
    }
    render(content, ctxIn) {
        let context = ctxIn || {};
        content = render(content, context, {
            varName: VAR_NAME
        });
        return content;
    }
    /** TemplateFunction handler, will return cached or compiled function, appropriately bound and scoped
     * @param template String or scoped template function
     * @param options EtaConfig
     * @param scope Object containing objects that should be available in the returned function's scope
     * @param binder Object to which the returned function will be bound */
    getCached(template, options, scope, binder) {
        if (options.name && this.templates.get(options.name)) {
            return (binder) ? this.templates.get(options.name).bind(binder) : this.templates.get(options.name);
        }
        const templateFunc = typeof template === 'function' ? template : compileWith(compileToString(template, options), Object.keys(scope), options.async);
        if (options.name)
            this.templates.define(options.name, templateFunc);
        return (binder) ? templateFunc.bind(binder) : templateFunc;
    }
}

var test$1 = "test";
var documentation = "Documentation";
var en = {
	test: test$1,
	documentation: documentation,
	"command.insert": "Insert Skribi",
	"command.reloadScripts": "Reload Scripts",
	"command.perfTest": "Test Performance",
	"regent.loading.hover": "Evaluating...",
	"regent.stasis.hover": "Recursion limit reached!",
	"regent.self.hover": "Self Render Prohibited",
	"setting.title": "Skribi Settings",
	"setting.templateDirectory.name": "Template Directory",
	"setting.templateDirectory.desc": "Skribi will look for templates in this folder.",
	"setting.scriptDirectory.name": "Skript Directory",
	"setting.scriptDirectory.desc": "Skribi will look for JS files in this folder.",
	"setting.errorLog.name": "Error Logging",
	"setting.errorLog.desc": "Enable to dump any errored renders to the console. If false, will still add the error as tooltip on the errored element. \n Will spam your console if typing into a skribi with a preview window open.",
	"setting.verbose.name": "Verbose Logging",
	"setting.verbose.desc": "Enable to get more detailed logs in the console.",
	"setting.autoReload.name": "Auto Reload",
	"setting.autoReload.desc": "Enable to automatically reload rendered skribis when scripts or relevant templates are updated.",
	"modal.insert.title": "Insert Skribi Template",
	"modal.insert.append": "Append",
	"modal.insert.insert": "Insert",
	"modal.confirm.title": "Please Confirm",
	"modal.confirm.confirm": "Confirm",
	"modal.confirm.cancel": "Cancel",
	"modal.external.title": "Open External Link?",
	"modal.external.desc": "Will open the following address with default program:",
	"modal.external.label": "Open Link",
	"modal.perf.title": "Skribi Performance Test",
	"modal.perf.textToEvaluate.name": "Text To Evaluate",
	"modal.perf.textToEvaluate.desc": "Text is evaluated as the contents of a code span.",
	"modal.perf.textToEvaluate.placeholder": "{~ console.log('Hello World'); }",
	"modal.perf.evalIterations.name": "Evaluation Iterations",
	"modal.perf.evalIterations.desc": "How many times should the text be evaluated?",
	"modal.perf.evalBlocks": "Eval As Individual Blocks?",
	"modal.perf.evaluate": "Evaluate",
	"modal.perf.evaluating": "Evaluating...",
	"modal.perf.results": "Average fulfillment time",
	"modal.perf.resultsBlockCount.single": "%0 block",
	"modal.perf.resultsBlockCount.plural": "%0 blocks",
	"modal.perf.autofill.selection": "Selection",
	"modal.perf.autofill.clipboard": "Clipboard"
};

var test = "test but in a british accent";
var en_gb = {
	test: test
};

const locales = {
    en: en,
    'en-gb': en_gb
};
function make() {
    let out = {
        '_': t
    };
    for (let key of Object.keys(en)) {
        if (String.isString(en[key])) {
            Object.defineProperty(out, key, {
                get: function () {
                    var _a, _b;
                    return (_b = (_a = locale()) === null || _a === void 0 ? void 0 : _a[key]) !== null && _b !== void 0 ? _b : en[key];
                }
            });
        }
    }
    vLog('Locale definitions constructed');
    return out;
}
function locale() { return locales === null || locales === void 0 ? void 0 : locales[window.moment.locale()]; }
/* Pull localized strings from this. */
const l = make();
/**
 * You can pull strings from this.
 * Pro: safely handles undefined keys
 * Contra: you won't get the property definition tooltips in VSC, which was the whole point of this design
 * @param key Lang file string key to return local version of
 * @param args Strings to insert into insertion tags (eg '%0')
 * @returns Localized string */
function t(key, ...args) {
    var _a, _b;
    if (!isExtant(en[key]))
        vWarn(`Babel received undefined key: ${key}`);
    let str = (_b = (_a = l[key]) !== null && _a !== void 0 ? _a : en[key]) !== null && _b !== void 0 ? _b : `$${key}`;
    return str.replace((/%(\d+)/g), (t, n) => (void 0 !== args[n] ? args[n] : t));
}

class confirmationModal extends obsidian.Modal {
    constructor(app, fieldsIn) {
        super(app);
        this.fields = {
            title: l["modal.confirm.title"],
            labelPos: l["modal.confirm.confirm"],
            labelNeg: l["modal.confirm.cancel"],
        };
        Object.assign(this.fields, fieldsIn || {});
    }
    onOpen() {
        this.titleEl.setText(this.fields.title);
        this.containerEl.addClazz(kls('confirmation-modal'), this.fields.class);
        if (this.fields.desc)
            this.contentEl.createDiv({ cls: kls('confirmation-modal-description'), text: this.fields.desc });
        this.contentEl.append(...this.fields.elements);
        let c = this.contentEl.createDiv({ cls: kls('confirm-modal-buttons') });
        c.createEl("button", { text: this.fields.labelPos, cls: kls('modal-button-confirm') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("true");
                this.close();
            });
        });
        c.createEl("button", { text: this.fields.labelNeg, cls: kls('modal-button-cancel') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("false");
                this.close();
            });
        });
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}
function makeExternalLink(linkIn) {
    const link = String.isString(linkIn) ? createEl('a', { attr: { href: linkIn } }) : linkIn;
    link.addEventListener('click', (ev) => {
        ev.preventDefault();
        let p = new confirmationModal(window.app, {
            title: l["modal.external.title"],
            desc: l["modal.external.desc"],
            labelPos: l["modal.external.label"],
            elements: [createDiv({ cls: kls('confirmation-modal-link'), text: link.getAttr('href') })]
        });
        new Promise((resolve, reject) => p.openAndGetValue(resolve, reject))
            .then(res => {
            if (res === "true") {
                window.open(link.getAttr('href'));
            }
        });
    });
    return link;
}

class SkribosSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.saveSetting = obsidian.debounce((setting, value, cb, ...args) => __awaiter(this, void 0, void 0, function* () {
            // console.log("saving: " + setting + " = " + value)
            this.plugin.settings[setting] = value;
            this.plugin.saveSettings().then(() => { if (isExtant(cb) && isFunc(cb))
                cb(...args || null); });
        }), 2000, true);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.addClass("skribi-settings");
        containerEl.empty();
        containerEl.createEl('h2', { text: l["setting.title"] });
        let desc = containerEl.createDiv({ cls: 'skribi-modal-desc', attr: { style: "margin-bottom: 1em;" } });
        makeExternalLink(desc.createEl('a', { text: l['documentation'], attr: { 'href': linkDocs('settings') } }));
        new obsidian.Setting(containerEl)
            .setName(l["setting.templateDirectory.name"])
            .setDesc(l["setting.templateDirectory.desc"])
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.templateFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.templateFolder = value;
                yield this.plugin.saveSettings();
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName(l["setting.scriptDirectory.name"])
            .setDesc(l["setting.scriptDirectory.desc"])
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.scriptFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.saveSetting('scriptFolder', value, () => this.plugin.eta.bus.scriptLoader.directoryChanged());
            }));
            text.inputEl.cols = 30;
            return text;
        });
        this.makeToggle(containerEl, "autoReload", l["setting.autoReload.name"], l["setting.autoReload.desc"]);
        this.makeToggle(containerEl, "errorLogging", l["setting.errorLog.name"], l["setting.errorLog.desc"]);
        this.makeToggle(containerEl, "verboseLogging", l["setting.verbose.name"], l["setting.verbose.desc"]);
        // this.makeToggle(containerEl, "shadowMode", "Shadow Mode", "Embed skribis in a shadow root", () => invokeMethodOf<SkribiChild>("rerender", ...this.plugin.children)) // hidden for now (this kills the skribichild)
    }
    makeToggle(el, setting, name, desc, cb) {
        return new obsidian.Setting(el)
            .setName(name)
            .setDesc(desc)
            .addToggle((toggle) => {
            toggle
                .setValue(!!this.plugin.settings[setting])
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings[setting] = value;
                yield this.plugin.saveSettings();
                if (cb)
                    cb(value);
            }));
        });
    }
}
const DEFAULT_SETTINGS = {
    templateFolder: "",
    scriptFolder: "",
    verboseLogging: false,
    devLogging: false,
    errorLogging: false,
    autoReload: true,
    reflectStyleTagText: true,
    shadowMode: false,
};

function renderError(el, e) {
    return __awaiter(this, void 0, void 0, function* () {
        if ((e === null || e === void 0 ? void 0 : e.flag) && e.flag == "abort") {
            return renderRegent(el, Object.assign({}, {
                class: 'abort',
                label: 'sk',
                hover: 'Render Aborted'
            }, e));
        }
        else {
            return renderRegent(el, { class: 'error', label: 'sk', hover: (e === null || e === void 0 ? void 0 : e.msg) || "Unknown Error", clear: true });
        }
    });
}
function renderState(el, dataIn) {
    return __awaiter(this, void 0, void 0, function* () {
        let data = Object.assign({
            class: "state",
            label: "sk",
            clear: false,
            hover: ""
        }, dataIn || {});
        el.className = `skribi-regent ${data.class}`;
        el.setAttribute("title", data.hover);
    });
}
function createRegent(dataIn) {
    let data = Object.assign({
        class: "generic",
        label: "sk",
        clear: false,
        hover: ""
    }, dataIn || {});
    const pre = createEl("code", { cls: `skribi-regent ${data.class}`, text: data.label });
    pre.setAttribute("title", data.hover);
    return [pre, data];
}
function renderRegent(el, dataIn) {
    let [pre, data] = createRegent(dataIn);
    if (data.clear)
        el.className = "";
    el.replaceWith(pre);
    return pre;
}

const extImg = ["bmp", "png", "jpg", "jpeg", "gif", "svg"];
const extAud = ["mp3", "wav", "m4a", "3gp", "flac", "ogg", "oga"];
const extVid = ["mp4", "webm", "ogv"];
const extTxt = ["md"];
/* Repairs media embeds that have been rendered to markdown */
function embedMedia(el, srcPath, plugin, depth, self) {
    return __awaiter(this, void 0, void 0, function* () {
        dLog("embed self:", self);
        dLog("embed:", el);
        var proms = [];
        const catches = el.querySelectorAll("span.internal-embed");
        let elDepth = el.getAttribute("depth");
        let d = (isExtant(elDepth) ? parseInt(elDepth) : isExtant(depth) ? depth : 0);
        dLog("embedder depth:", d);
        for (let fish of Array.from(catches)) {
            if (fish.hasClass("is-loaded"))
                continue;
            let src = obsidian.normalizePath(fish.getAttribute("src"));
            let dest = plugin.app.metadataCache.getFirstLinkpathDest(src, srcPath);
            if (dest) {
                let path = plugin.app.vault.adapter.getResourcePath(dest.path);
                let ext = dest.extension;
                if (extImg.contains(ext)) { // Embed Image
                    fish.addClass("image-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("img");
                    nel.setAttribute("src", path);
                }
                else if (extAud.contains(ext)) { // Embed Audio
                    fish.addClass("media-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("audio", { "attr": { "controls": true } });
                    nel.setAttribute("src", path);
                }
                else if (extVid.contains(ext)) { // Embed Video
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let vidiv = fish.createEl("video", { "attr": { "controls": true } });
                    vidiv.setAttribute("src", path);
                }
                else if (extTxt.contains(ext)) {
                    /* Embed Transclusion */
                    const createEmbedPromise = () => {
                        return new Promise(() => __awaiter(this, void 0, void 0, function* () {
                            dLog("new embed prom");
                            fish.childNodes.forEach((n) => { fish.removeChild(n); });
                            let cache = plugin.app.metadataCache.getCache(dest.path);
                            let read = yield plugin.app.vault.cachedRead(dest);
                            let classes = obsidian.parseFrontMatterStringArray(cache === null || cache === void 0 ? void 0 : cache.frontmatter, "cssclass");
                            let div = fish.createDiv({ cls: "markdown-embed" });
                            div.createDiv({ cls: "markdown-embed-title", text: dest.basename });
                            let content = div.createDiv({ cls: "markdown-embed-content" });
                            let link = div.createDiv({ cls: "markdown-embed-link" });
                            obsidian.setIcon(link, "link");
                            link.onClickEvent((e) => {
                                e.preventDefault();
                                plugin.app.workspace.openLinkText(src, srcPath);
                            });
                            let pv = content.createDiv({ cls: "markdown-preview-view" });
                            pv.addClazz(classes);
                            let ps = pv.createDiv({ cls: "markdown-preview-sizer markdown-preview-section" });
                            let mkh = createDiv({ attr: { "depth": depth.toString() } });
                            yield obsidian.MarkdownRenderer.renderMarkdown(read, mkh, srcPath, null);
                            const mke = (Array.from((mkh === null || mkh === void 0 ? void 0 : mkh.childNodes) || []).map((n) => {
                                // if (n.childNodes.length > 0) { let d = createDiv(); d.append(n.cloneNode(true)); return d;} else return n;}));
                                if (n.childNodes.length > 0) {
                                    let d = createDiv();
                                    d.append(n);
                                    return d;
                                }
                                else
                                    return n;
                            }));
                            ps.append(...mke); //ps.setAttribute("depth", d.toString())
                            return embedMedia(ps, srcPath, plugin, d - 1, true);
                        }));
                    };
                    if (d <= 0) {
                        let [l] = createRegent({ class: "depth-limit", hover: "It goes on forever..." });
                        fish.replaceWith(l);
                        dLog("embedder hit limit");
                    }
                    else {
                        proms.push(createEmbedPromise());
                    }
                }
            }
        }
        return Promise.allSettled(proms).then(values => {
            dLog("embedder done", proms);
            return Promise.resolve(proms.length);
        });
    });
}

/* Check if code block is that good good and if so what type of good good */
function preparseSkribi(el, str, flg) {
    return __awaiter(this, void 0, void 0, function* () {
        let text = isExtant(str) ? str : el.textContent;
        if (text.length < 3)
            return;
        let e = text.substr(text.length - 2);
        let s = text.substr(0, 2);
        if (s.startsWith("{") && e.endsWith("}")) {
            let f = s[1];
            let flag = (f == ":") ? 1 : (f == "=") ? 2 : (f == "~") ? 3 : (f == "{") ? 4 : (f == ".") ? 5 : -1;
            if ((flag > 0) && (flag != 4 || (e == "}}"))) {
                return { flag: flag, text: text.substring(2, text.length - (flag == 4 ? 2 : 1)) };
            }
            else
                return;
        }
        else
            return;
    });
}
/* Parse variables in template invocations */
function parseSkribi(src) {
    return __awaiter(this, void 0, void 0, function* () {
        let sa = src.split(/(?<![\\])\|/);
        let id = sa.splice(0, 1)[0].trim();
        let args = {};
        for (let seg of sa) {
            let si = seg.indexOf(":");
            if (si == -1)
                continue;
            args[seg.slice(0, si).trim()] = seg.slice(si + 1).trim();
        }
        return { id: id, args: { v: args } };
    });
}

/*
 * Copyright 2017 Google Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
/*
 * Modified from https://github.com/samthor/scoped (polyfill for deprecated HTML feature scoped styles)
 */
/** Prefixes all CSS selectors in a selector text string with prefix prefix */
function prefixSelectors(selectorText, prefix) {
    const found = [];
    while (selectorText) {
        const consumed = consumeSelector(selectorText, prefix);
        if (consumed === null) {
            return ':not(*)';
        }
        found.push(consumed.selector);
        selectorText = consumed.rest;
    }
    return found.join(', ');
}
// This monstrosity matches any valid `[foo="bar"]` block, with either quote style. Parenthesis
// have no special meaning within an attribute selector, and the complex regexp below mostly
// exists to allow \" or \' in string parts (e.g. `[foo="b\"ar"]`).
const attrRe = /^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/;
const walkSelectorRe = /([([,]|:scope\b)/; // "interesting" setups
const scopeRe = /^:scope\b/;
/**
 * Consumes a single selector from candidate selector text, which may contain many. */
function consumeSelector(raw, prefix) {
    let i = raw.search(walkSelectorRe);
    if (i === -1) {
        return { selector: `${prefix} ${raw}`, rest: '' };
    }
    else if (raw[i] === ',') {
        return { selector: `${prefix} ${raw.substr(0, i)}`, rest: raw.substr(i + 1) };
    }
    let leftmost = true; // whether we're past a descendant or similar selector
    let scope = false; // whether :scope has been found + replaced
    i = raw.search(/\S/); // place i after initial whitespace only
    let depth = 0;
    outer: for (; i < raw.length; ++i) {
        const char = raw[i];
        switch (char) {
            case '[':
                const match = attrRe.exec(raw.substr(i));
                i += (match ? match[0].length : 1) - 1; // we add 1 every loop
                continue;
            case '(':
                ++depth;
                continue;
            case ':':
                if (!leftmost) {
                    continue; // doesn't matter if :scope is here, it'll always be ignored
                }
                else if (!scopeRe.test(raw.substr(i))) {
                    continue; // not ':scope', ignore
                }
                else if (depth) {
                    return null;
                }
                // Replace ':scope' with our prefix. This can happen many times; ':scope:scope' is valid.
                // It will never apply to a descendant selector (e.g., ".foo :scope") as this is ignored
                // by browsers anyway (invalid).
                raw = raw.substring(0, i) + prefix + raw.substr(i + 6);
                i += prefix.length;
                scope = true;
                --i; // we'd skip over next character otherwise
                continue; // run loop again
            case ')':
                if (depth) {
                    --depth;
                }
                continue;
        }
        if (depth) {
            continue;
        }
        switch (char) {
            case ',':
                break outer;
            case ' ':
            case '>':
            case '~':
            case '+':
                if (!leftmost) {
                    continue;
                }
                leftmost = false;
        }
    }
    const selector = (scope ? '' : `${prefix} `) + raw.substr(0, i);
    return { selector, rest: raw.substr(i + 1) };
}

class SkribiProcessor {
    constructor(plugin) {
        this.queuedTemplates = []; // TODO: maybe construct promises to resolve on event so the promise chain isn't broken?
        this.plugin = plugin;
        this.eta = plugin.eta;
    }
    /**
     * Register our markdown processors. */
    registerProcessors() {
        const processCodeSpan = (el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processEntry({ srcType: "GENERAL" /* general */ }, el, ctx); });
        this.plugin.registerMarkdownPostProcessor((el, ctx) => processCodeSpan(el, ctx));
        const processCodeBlock = (mode, str, el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processEntry(mode, el, ctx, null, null, str.trimEnd()); });
        ([["normal", "", 0 /* none */], ["raw", "-raw", 3 /* raw */], ["literal", "-lit", 4 /* literal */], ["interpolate", "-int", 2 /* interp */], ["evaluate", "-eval", 5 /* eval */]])
            .forEach((v) => {
            this.plugin.registerMarkdownCodeBlockProcessor(`skribi${v[1]}`, processCodeBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
            this.plugin.registerMarkdownCodeBlockProcessor(`sk${v[1]}`, processCodeBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
        });
    }
    /** Entry to the Skribi process chain. Called:
     * - By MarkdownView on each block of a markdown preview
     * - By MarkdownView on code blocks of our register language types
     * - By renderSkribi to recurse nested skribis */
    processEntry(mode, // 0: codespan; 1: codeblock;
    doc, ctx, depth, self, srcIn) {
        return __awaiter(this, void 0, void 0, function* () {
            let nestExtant = isExtant(ctx.remainingNestLevel);
            let nestLevel = nestExtant ? ctx.remainingNestLevel : null;
            /* nestExtant means that we are inside of a natural transclusion */
            self = isExtant(self);
            depth = self ? depth : null;
            /* self means that we have been called by renderSkribi, to look for codeblocks */
            let elHasDepth = isExtant(doc.getAttribute("depth"));
            let elElHasDepth = isExtant(ctx.el.getAttribute("depth"));
            let elDepth = elHasDepth ? parseInt(doc.getAttribute("depth")) : elElHasDepth ? parseInt(ctx.el.getAttribute("depth")) : null;
            /* Used for passing depth to virtual elements (we may be in one even as we speak...)*/
            /* determine our depth condition type */
            let d = self ? depth : (elHasDepth || elElHasDepth) ? elDepth : nestExtant ? nestLevel : 0;
            if (!nestExtant && !(elHasDepth || elElHasDepth))
                dLog("processor sees no depth");
            if (elHasDepth) {
                dLog("elDepth", elDepth, "doc", doc, "el", ctx.el, "conEl", ctx.containerEl);
            }
            else {
                dLog("processor: ", "doc", doc, "el", ctx.el, "conEl", ctx.containerEl, "nest", ctx.remainingNestLevel);
            }
            /* Dispatch render promises */
            var proms = [];
            var temps = 0;
            const elCodes = (mode.srcType == "BLOCK" /* block */) ? [doc] : doc.querySelectorAll("code");
            if (!(d <= 0)) {
                let tm = window.performance.now();
                const elProms = Array.from(elCodes).map((el) => __awaiter(this, void 0, void 0, function* () {
                    let t = window.performance.now();
                    dLog("start:", t);
                    let src = (isExtant(mode.flag) && mode.flag != 0 /* none */) ?
                        { text: srcIn || doc.textContent, flag: mode.flag } : yield preparseSkribi(el);
                    let originalText = (mode.srcType == "BLOCK" /* block */) ? srcIn : el.textContent;
                    try {
                        if (src != null) {
                            let skCtx = { time: window.performance.now(), depth: d, flag: src.flag, source: originalText };
                            let nel = renderRegent(el, { class: 'sk-loading', hover: l['regent.loading.hover'] });
                            if (src.flag == 1) {
                                proms.push(this.awaitTemplatesLoaded({ el: nel, src: src.text, mdCtx: ctx, skCtx: skCtx }));
                                temps++;
                            }
                            else {
                                proms.push(this.processSkribi(nel, src.text, ctx, skCtx));
                            }
                        }
                    }
                    catch (e) {
                        if (!e.flags.noRender) {
                            renderError(el, e);
                        }
                    }
                    return Promise.resolve();
                }));
                if ( /*!self && */!doc.hasClass("skribi-render-virtual")) {
                    let aps = Promise.all(elProms);
                    aps.then(() => {
                        Promise.allSettled(proms).then(() => {
                            if (proms.length > 0) {
                                if (this.plugin.initLoaded) {
                                    vLog(`Processed ${proms.length} skribis (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                                else {
                                    let str = "";
                                    if (temps > 0) {
                                        if (proms.length - temps > 0) {
                                            str = `Processed ${proms.length - temps} and queued ${temps} skribis`;
                                        }
                                        else
                                            str = `Queued ${temps} skribis`;
                                    }
                                    else
                                        str = `Processed ${proms.length - temps} skribis`;
                                    vLog(str + ` (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                            }
                        });
                    });
                }
                yield Promise.allSettled(elProms);
                return proms;
            }
            else {
                /* Depth too high! */
                elCodes.forEach((el) => __awaiter(this, void 0, void 0, function* () {
                    preparseSkribi(el).then((src) => __awaiter(this, void 0, void 0, function* () {
                        if (src != null)
                            renderState(el, { hover: l['regent.stasis.hover'], class: 'stasis' });
                    }));
                }));
                dLog("processor hit limit");
                return Promise.resolve(null); // Postprocessor calls are not caught so we can't reject neatly
            }
        });
    }
    /* Ensures that the initial template load is complete before continuing to render. */
    awaitTemplatesLoaded(args) {
        return __awaiter(this, void 0, void 0, function* () {
            let el = renderRegent(args.el, { class: 'wait', label: 'sk', hover: 'Awaiting Template Cache', clear: true });
            if (!this.plugin.initLoaded) {
                dLog("not yet loaded");
                let func = () => __awaiter(this, void 0, void 0, function* () { return yield this.processSkribiTemplate(el, args.src, args.mdCtx, Object.assign(args.skCtx, { time: window.performance.now() })); });
                let q = this.queuedTemplates.push(func);
                return Promise.resolve({ msg: "Queued", qi: q });
            }
            else
                return yield this.processSkribiTemplate(el, args.src, args.mdCtx, args.skCtx);
        });
    }
    /* Called by template load event. */
    templatesReady() {
        let proms = this.queuedTemplates.map((func) => func());
        Promise.allSettled(proms).then(() => { this.queuedTemplates = []; });
    }
    processSkribiTemplate(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let parsed = null;
            try {
                parsed = yield parseSkribi(src);
            }
            catch (e) {
                renderError(el, e);
                return Promise.reject('Parsing Error');
            }
            // Abort if being rendered in its own definition
            if (this.plugin.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath).basename == parsed.id) {
                renderRegent(el, { class: 'self', hover: l['regent.stasis.hover'] });
                return Promise.reject('Within Self Definition');
            }
            let template = this.eta.getPartial(parsed.id);
            if (!isExtant(template)) {
                if (this.eta.failedTemplates.has(parsed.id)) {
                    renderError(el, { msg: `Template ${parsed.id} failed to compile, error: \n` + this.eta.failedTemplates.get(parsed.id) });
                }
                else {
                    renderError(el, { msg: `No such template "${parsed.id}"` });
                }
                return Promise.reject('Missing Template Definition');
            }
            return this.renderSkribi(el, template, parsed.id, mdCtx, Object.assign({}, skCtx, { ctx: parsed.args }));
        });
    }
    /** Wrap non-template skribis in tags as determined by their type flag */
    processSkribi(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            const prep = function (str, flag) {
                switch (flag) {
                    case 2: return `<%=${src}%>`;
                    case 3: return `<%~${src}%>`;
                    case 4: return str;
                    case 5: return `<%${src}%>`;
                }
            };
            return this.renderSkribi(el, prep(src, skCtx.flag), "literal", mdCtx, skCtx);
        });
    }
    /** Main skribi rendering function */
    renderSkribi(el, con, id, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let file = this.plugin.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath);
            let newElement = createDiv({ cls: "skribi-render-virtual" });
            let child = new SkribiChild(this.plugin, newElement);
            Object.assign(child, {
                rerender: ((templateToRetrieve) => {
                    let nskCtx = Object.assign({}, skCtx, { time: window.performance.now() });
                    if (skCtx.flag == 1 && isExtant(templateToRetrieve)) {
                        let template = this.eta.getPartial(templateToRetrieve);
                        child.unload();
                        this.renderSkribi(newElement, template, templateToRetrieve, mdCtx, nskCtx);
                    }
                    else {
                        child.unload();
                        this.renderSkribi(newElement, con, id, mdCtx, nskCtx);
                    }
                }).bind(this),
                templateKey: (skCtx.flag == 1) ? id : null,
                source: skCtx.source
            });
            let ctx = Object.assign({}, (skCtx === null || skCtx === void 0 ? void 0 : skCtx.ctx) || {}, { child: child.provideContext() });
            let [rendered, packet] = yield this.eta.renderAsync(con, ctx, file)
                .catch((err) => {
                /* If the template function throws an error, it should bubble up to here. */
                if (this.plugin.settings.errorLogging)
                    console.warn(`Skribi render threw error! Displaying content and error...`, EBAR, con, EBAR, err);
                renderError(el, (err === null || err === void 0 ? void 0 : err.hasData) ? err : { msg: (err === null || err === void 0 ? void 0 : err.msg) || err || "Render Error" }).then(errEl => {
                    /* Alter the child so that it may yet live (and listen for source updates) */
                    Object.assign(child, {
                        containerEl: errEl,
                        state: "error",
                        rerender: ((templateToRetrieve) => {
                            let nskCtx = Object.assign({}, skCtx, { time: window.performance.now() });
                            if (skCtx.flag == 1 && isExtant(templateToRetrieve)) {
                                let template = this.eta.getPartial(templateToRetrieve);
                                child.unload();
                                this.renderSkribi(errEl, template, templateToRetrieve, mdCtx, nskCtx);
                            }
                            else {
                                child.unload();
                                this.renderSkribi(errEl, con, id, mdCtx, nskCtx);
                            }
                        }).bind(this),
                    });
                    mdCtx.addChild(child);
                    this.plugin.children.push(child);
                });
                return Promise.resolve([null, null]);
            });
            dLog("renderSkribi:", el, mdCtx, skCtx, id);
            if (isExtant(rendered)) {
                let d = isExtant(mdCtx.remainingNestLevel) ? mdCtx.remainingNestLevel : (skCtx.depth);
                let style = stripStyleFromString(rendered); // renderMarkdown ignores style nodes so we'll just yoink em 
                if (style[1]) {
                    rendered = style[0];
                }
                let render = ((packet === null || packet === void 0 ? void 0 : packet['noMarkdown'])
                    ? this.simpleRender(rendered, newElement)
                    : obsidian.MarkdownRenderer.renderMarkdown(rendered, newElement, mdCtx.sourcePath, null))
                    .then(() => {
                    var _a;
                    if (((_a = el === null || el === void 0 ? void 0 : el.parentElement) === null || _a === void 0 ? void 0 : _a.nodeName) == "P") { // true when (mode == Mode.block)
                        el.parentElement.replaceWith(el); // strip the superfluous P element
                    }
                    newElement.setAttribute("skribi", (skCtx.flag == 1) ? 'template' : id);
                    if (skCtx.flag == 1) {
                        newElement.setAttribute("skribi-template", id);
                    }
                    newElement.removeClass("skribi-render-virtual");
                    if (!newElement.getAttr("class")) {
                        newElement.removeAttribute("class");
                    }
                    let shade;
                    if (this.plugin.settings.shadowMode) {
                        /* it seems that non-codeblock skribis do not survive this process */
                        let nel = createDiv();
                        el === null || el === void 0 ? void 0 : el.parentElement.prepend(nel);
                        nel.setAttr('skribi-host', '');
                        console.log(el);
                        shade = nel.attachShadow({ mode: 'open' });
                        shade.append(newElement);
                        el.remove();
                    }
                    else {
                        el.replaceWith(newElement);
                    }
                    dLog("finish: ", skCtx.time, window.performance.now());
                    if (style[1]) {
                        if (this.plugin.settings.shadowMode) {
                            shade.append(style[1]);
                            // newElement.prepend(style[1])
                        }
                        else {
                            newElement.prepend(style[1]);
                            scopeStyle(child, newElement, style[1]);
                        }
                    }
                    if (skCtx.flag == 1) {
                        vLog(`Rendered template "${id}" (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, newElement);
                    }
                    else
                        vLog(`Rendered literal (f: ${skCtx.flag}) (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, newElement);
                    return Promise.resolve(newElement);
                });
                child.setPacket(packet);
                mdCtx.addChild(child);
                this.plugin.children.push(child);
                render.then((e) => {
                    child.onPost();
                    // TODO: only restrict depth for transclusions
                    if (isExtant(mdCtx.remainingNestLevel) && (mdCtx.remainingNestLevel > 0) || !isExtant(mdCtx.remainingNestLevel)) {
                        return embedMedia(e, mdCtx.sourcePath, this.plugin, skCtx.depth);
                    }
                    else
                        return Promise.resolve();
                })
                    .then((x) => {
                    dLog("renderer final: ", d);
                    this.processEntry({ srcType: "GENERAL" /* general */ }, newElement, mdCtx, skCtx.depth - 1, true); /* Recurse the processor to parse skreeblings */
                });
                return [render, child];
            }
            else {
                child.clear();
                return Promise.reject("Render Error");
            }
        });
    }
    /* End of processor chain */
    simpleRender(content, el) {
        return __awaiter(this, void 0, void 0, function* () {
            el.innerHTML = content;
            console.log(el);
            return Promise.resolve();
        });
    }
}
/* STYLE FUNCTIONS */
function stripStyleFromString(str) {
    let x = createDiv();
    x.innerHTML = str;
    // console.log('prestrip', x)
    let style = x.querySelector('style');
    if (style)
        x.removeChild(style);
    return [x.innerHTML, style !== null && style !== void 0 ? style : null];
}
/* s must be attached to document or s.sheet will be null */
function scopeStyle(child, el, s) {
    var _a;
    child.hash = (_a = child.hash) !== null && _a !== void 0 ? _a : hash(child.source);
    child.containerEl.setAttr('sk-hash', child.hash);
    if (!s.sheet) {
        console.warn("Could not scope style because it was not attached to the document!\n", el, s);
        return;
    }
    const l = s.sheet.cssRules.length;
    for (let i = 0; i < l; ++i) {
        const rule = s.sheet.cssRules[i];
        if (!(rule instanceof CSSImportRule)) {
            scopeRule(rule, ['sk-hash', child.hash]);
        }
    }
    /* Changing the rule properties doesn't change the text of the style element, so we do it manually so make the resolved behavior visible for users in element panel */
    if (window.app.plugins.plugins['obsidian-skribi'].settings.reflectStyleTagText) {
        let rules = [];
        for (let i = 0; i < s.sheet.cssRules.length; i++) {
            rules.push(s.sheet.cssRules.item(i));
        }
        let str = rules.reduce((a, b) => { return a + `${b.cssText}` + '\n'; }, "");
        s.textContent = str;
    }
    return s;
}
/** Mutates a CSSRule's selectors to select elements with attribute 'sk-hash' equal to hash
/* @param rule CSSRule to scope
/* @param hash [attrKey, attrVal] to target */
function scopeRule(rule, target) {
    if (!(rule instanceof CSSStyleRule))
        return; // media and import rules ignored
    let b = prefixSelectors(rule.selectorText, `[${target[0]}='${target[1]}']`);
    rule.selectorText = b;
}

class SkribiChild extends obsidian.MarkdownRenderChild {
    constructor(plugin, el) {
        super(el);
        this.intervals = [];
        this.cbOnUnload = [];
        this.cbOnPost = [];
        this.isPost = false; // True when container has attached to document 
        this.state = "pre";
        this.sources = {
            templates: [],
            styles: []
        };
        this.plugin = plugin;
    }
    provideContext() {
        return {
            el: this.containerEl,
            registerInterval: this.skRegisterInterval.bind(this),
            registerUnload: this.skRegisterUnload.bind(this),
            registerEvent: this.skRegisterEvent.bind(this),
            registerPost: this.skRegisterPost.bind(this),
            addStyle: this.skAddStyle.bind(this),
            reload: this.rerender,
            _c: this
        };
    }
    scriptsUpdated() {
        this.rerender();
    }
    templatesUpdated(id, newId) {
        if (((this === null || this === void 0 ? void 0 : this.templateKey) == id) || this.sources.templates.contains(id)) {
            dLog("Child received template update notification that matched one of its sources", id, this);
            this.rerender((id == (this === null || this === void 0 ? void 0 : this.templateKey)) ? id : null);
        }
    }
    stylesUpdated(id) {
        if ((this.sources.styles).contains(id)) {
            dLog("Child received style update notification that matched one of its sources", id, this);
            this.rerender();
        }
    }
    listenFor(type, id) {
        let l = (type == "style" ? this.sources.styles : type == "template" ? this.sources.templates : null);
        if (l)
            l.push(id);
    }
    setPacket(packet) {
        if (this.packet == null) {
            this.packet = packet;
        }
    }
    onload() { }
    /* NOT called by child.unload() (except sometimes it is) */
    onunload() {
        dLog("skreeb unload", this.containerEl);
        this.clear();
    }
    /* Called by rerender. */
    clear() {
        vLog("clear", this.containerEl);
        for (let i of this.intervals)
            window.clearInterval(i); // there might be cases where this doesn't get called properly (?)
        for (let cb of this.cbOnUnload)
            cb[0](cb[1]);
        // this.containerEl.parentNode.removeChild(this.containerEl)
        this.plugin.children.remove(this);
    }
    /* Called after render fulfillment */
    onPost() {
        this.isPost = true;
        this.state = "post";
        for (let cb of this.cbOnPost)
            cb[0](cb[1]);
    }
    /*-- Provider Functions --*/
    // Asynchronously adds a scoped style element to the container, from string str
    // Will not resolve until post (when element is attached to document, which is required for scopeStyle())
    // Returns reference to the created element
    // TODO: if aborted before post, will promise persist in memory?
    skAddStyle(str) {
        let s = createEl('style');
        s.innerHTML = str;
        this.containerEl.prepend(s);
        let p = () => {
            return new Promise((resolve, reject) => {
                this.skRegisterPost(() => {
                    resolve(scopeStyle(this, this.containerEl, s));
                });
            });
        };
        return p();
    }
    skRegisterInterval(cb, time, ...args) {
        //@ts-ignore
        let x = window.setInterval((...a) => {
            if (this._loaded == false) {
                window.clearInterval(x);
            }
            cb(...a);
        }, time * 1000, ...args);
        this.intervals.push(x);
        return x;
    }
    skRegisterEvent(event) {
        dLog('SkChild registered event:', event);
        this.registerEvent(event);
    }
    skRegisterUnload(cb, ...args) {
        this.cbOnUnload.push([(...x) => cb(...x), args]);
    }
    skRegisterPost(cb, ...args) {
        if (!this.isPost) {
            this.cbOnPost.push([(...x) => cb(...x), args]);
        }
        else {
            ((...x) => cb(...x))(args);
        }
    }
    // Assigned in renderSkribi()
    rerender(...args) { }
}

class SuggestionModal extends obsidian.FuzzySuggestModal {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
    }
    getItems() {
        return this.plugin.eta.getCacheKeys();
    }
    getItemText(item) { return item; }
    onChooseItem(item, evt) {
        this.resolve(item);
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}

var promptTypes;
(function (promptTypes) {
    promptTypes["string"] = "string";
})(promptTypes || (promptTypes = {}));

class InsertionModal extends obsidian.Modal {
    constructor(plugin, editor, id) {
        super(plugin.app);
        this.valFields = {};
        this.plugin = plugin;
        this.editor = editor;
        this.currentID = id.toString();
        this.containerEl.addClass("skribi-insertion-modal");
        this.titleEl.setText(l["modal.insert.title"]);
    }
    onOpen() {
        this.create();
    }
    create() {
        let s = new obsidian.Setting(this.contentEl);
        s.addDropdown((drop) => {
            drop
                .addOptions(toDupeRecord(this.plugin.eta.getCacheKeys()))
                .setValue(this.currentID)
                .onChange((v) => {
                this.currentID = v;
                let f = this.generateFields(fieldsDiv, this.currentID);
                ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
            });
        });
        let fieldsDiv = this.contentEl.createDiv({ cls: "skribi-modal-fields" });
        let t = new obsidian.Setting(this.contentEl);
        t.addText((te) => { this.textInput = te; return te; });
        t.setName(l["modal.insert.append"]);
        t.settingEl.addClass("skribi-modal-field-append");
        let f = this.generateFields(fieldsDiv, this.currentID);
        ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
        let confirm = new obsidian.Setting(this.contentEl);
        confirm.addButton((button) => button
            .setButtonText(l["modal.insert.insert"])
            .onClick(() => this.doInsert()));
        this.keypressRef = this.scope.register([], "Enter", this.doInsert.bind(this));
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    generateFields(el, id) {
        el.empty();
        var arr = [];
        if (this.plugin.eta.templateFrontmatters.has(id)) {
            let fm = this.plugin.eta.templateFrontmatters.get(id);
            for (let v of Object.keys(fm)) {
                if (v.charAt(0) == "_") {
                    let vn = v.substring(1);
                    let fma = this.parsePromptVal(vn, fm[v]);
                    let s = new obsidian.Setting(el);
                    s.settingEl.addClass("skribi-modal-template-field");
                    if (fma.type == promptTypes.string) {
                        arr.push(this.createTextField(s, fma));
                    }
                    s.setName(fma.name);
                }
            }
        }
        return arr;
    }
    createTextField(set, fma) {
        let t;
        set.addText((text) => {
            text
                .setValue(fma.default)
                .setPlaceholder(fma.placeholder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.valFields[fma.id] = value;
            }));
            text.inputEl.addClass("skribi-text-input");
            t = text;
        });
        if (fma.default.length > 0)
            this.valFields[fma.id] = fma.default;
        return t;
    }
    parsePromptVal(k, val) {
        let v = {
            id: k,
            type: promptTypes.string,
            name: isExtant(val === null || val === void 0 ? void 0 : val.name) ? val.name : k,
            placeholder: isExtant(val === null || val === void 0 ? void 0 : val.placeholder) ? val.placeholder : "",
            default: isExtant(val === null || val === void 0 ? void 0 : val.default) ? val.default : isExtant(val === null || val === void 0 ? void 0 : val.def) ? val.def : "",
        };
        return v;
    }
    doInsert() {
        let id = this.currentID;
        let osel = this.editor.listSelections();
        let toInsert = `\`{:${id}`;
        for (let e of Object.entries(this.valFields)) {
            toInsert += ` | ${e[0]}: ${e[1]}`;
        }
        toInsert += ((this === null || this === void 0 ? void 0 : this.textInput.getValue().length) > 0) ? " | " + this.textInput.getValue() : "";
        toInsert += `}\``;
        this.editor.getDoc().replaceSelection(toInsert);
        let nsel = [];
        for (let p of osel) {
            nsel.push({ from: { line: p.anchor.line, ch: p.anchor.ch + (toInsert.length) } });
        }
        this.editor.transaction({ selections: nsel });
        this.close();
    }
}

const maximumIterations = 10000;
class TestModal extends obsidian.Modal {
    constructor(plugin, autofill) {
        super(plugin.app);
        this.iterations = 10;
        this.multiBlock = false;
        this.valFields = {};
        this.autofill = null;
        this.plugin = plugin;
        this.autofill = autofill;
        this.containerEl.addClass("skribi-test-modal");
        this.titleEl.setText(l['modal.perf.title']);
        let desc = createDiv({ cls: 'skribi-modal-desc' });
        makeExternalLink(desc.createEl('a', { text: l['documentation'], attr: { 'href': linkDocs('commands/performance') } }));
        desc.insertAfter(this.titleEl);
    }
    onOpen() {
        this.create();
    }
    create() {
        let fieldTextToEval = new obsidian.Setting(this.contentEl);
        fieldTextToEval.addTextArea((text) => { this.textFieldToEval = text; return text; });
        fieldTextToEval.setName(l["modal.perf.textToEvaluate.name"]);
        fieldTextToEval.setDesc(l["modal.perf.textToEvaluate.desc"]);
        this.textFieldToEval.setPlaceholder(l["modal.perf.textToEvaluate.placeholder"]);
        if (this.autofill) {
            fieldTextToEval.infoEl.append(createDiv({ text: `Autofilled from ${this.autofill.type}`, cls: 'setting-item-description skribi-autofill-notification' }));
            this.textFieldToEval.setValue(this.autofill.value);
        }
        let fieldIterations = new obsidian.Setting(this.contentEl);
        let iters = fieldIterations.controlEl.createEl('input', { attr: { type: 'number' } });
        iters.defaultValue = this.iterations.toString();
        iters.onchange = (ev) => { this.iterations = iters.valueAsNumber; };
        fieldIterations.setName(l["modal.perf.evalIterations.name"]);
        fieldIterations.setDesc(l["modal.perf.textToEvaluate.desc"]);
        let blockSetting = new obsidian.Setting(this.contentEl);
        blockSetting.addToggle((tog) => {
            tog.setValue(this.multiBlock);
            tog.onChange((v) => this.multiBlock = v);
            return tog;
        });
        blockSetting.setName(l["modal.perf.evalBlocks"]);
        let confirm = new obsidian.Setting(this.contentEl).setClass('skribi-button-eval');
        confirm.addButton((button) => button
            .setButtonText(l["modal.perf.evaluate"])
            .onClick(() => this.doEval()));
        this.keypressRef = this.scope.register([], "Enter", this.doEval.bind(this));
        this.contentEl.createEl('hr');
        this.resultsField = this.contentEl.createDiv({ cls: "skribi-test-results-field" });
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    doEval() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.plugin.initLoaded) {
                this.resultsField.setText("Template cache not ready!");
                return;
            }
            let container = createDiv();
            let el = createDiv();
            let blocksToProcess = [];
            let toIter = Math.min(this.iterations, maximumIterations);
            if (this.multiBlock) {
                for (let i = 0; i < toIter; i++) {
                    let d = createDiv();
                    d.createEl('code', { text: this.textFieldToEval.getValue() });
                    blocksToProcess.push(d);
                }
            }
            else {
                let singleDiv = createDiv();
                for (let i = 0; i < toIter; i++) {
                    singleDiv.createEl('code', { text: this.textFieldToEval.getValue() });
                }
                blocksToProcess.push(singleDiv);
            }
            let timeStart = window.performance.now();
            const proms = blocksToProcess.map((div) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                let promiseStartTime = window.performance.now();
                let promise = yield this.plugin.processor.processEntry({ srcType: "GENERAL" /* general */ }, div, {
                    remainingNestLevel: 4,
                    docId: '55555555',
                    frontmatter: null,
                    sourcePath: ((_a = this.plugin.app.workspace.getActiveFile()) === null || _a === void 0 ? void 0 : _a.path) || "",
                    addChild: (child) => { },
                    getSectionInfo: () => { return null; },
                    containerEl: container,
                    el: el
                }, 4, false, null).catch(() => { });
                return [promise, window.performance.now(), promiseStartTime];
            }));
            this.resultsField.setText(l["modal.perf.evaluating"]);
            let settledValues = yield Promise.allSettled(proms);
            vLog(`Performance test settled in: ${roundTo(window.performance.now() - timeStart, 3)}ms`);
            let fullfilled = settledValues.map((v) => { if (v.status == 'fulfilled')
                return v.value; });
            let times = fullfilled.map((result) => (result[1] - result[2]));
            let avg = average(...times);
            let p = [];
            fullfilled.map(res => res[0].map((a) => p.push(a)));
            let children = (yield Promise.allSettled(p)).map((rez) => { if (rez.status == "fulfilled")
                return rez.value[1]; });
            this.resultsField.setText(`${l["modal.perf.results"]} (${children.length} children in ${l._((times.length > 1 ? "modal.perf.resultsBlockCount.plural" : "modal.perf.resultsBlockCount.single"), times.length.toString())}): ${roundTo(avg, 3)}ms`);
            // invokeMethodOf<SkribiChild>("clear", ...children) // Unload doesn't seem to be invoked consistently so let's just make sure everything is cleared
            Array.from(children).forEach((child) => child.clear());
            blocksToProcess.map(block => block.remove()); // Children are easier to collect when they lack shelter
            container.remove();
            el.remove(); // One day, the last person who remembers you will die, and you will be forgotten forever
        });
    }
}

class SkribosPlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        this.varName = "sk";
        this.initLoaded = false;
        this.l = l;
        this.children = [];
        this.childProto = SkribiChild; // for dev memory querying 
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribi: Loading...');
            yield this.loadSettings();
            this.addSettingTab(new SkribosSettingTab(this.app, this));
            this.eta = new EtaHandler(this);
            this.processor = new SkribiProcessor(this);
            this.processor.registerProcessors();
            this.registerEvent(this.app.workspace.on('skribi:template-init-complete', () => {
                this.initLoaded = true;
                this.processor.templatesReady();
            }));
            this.defineCommands();
            this.registerExtensions(['eta'], 'markdown');
            // registerMirror(this);
            /* Rerender preview views */
            this.app.workspace.onLayoutReady(() => {
                this.app.workspace.getLeavesOfType("markdown").forEach((leaf) => {
                    if (leaf.view.currentMode.type == "preview") {
                        leaf.view.previewMode.rerender(true);
                    }
                });
            });
        });
    }
    /** Register our commands. */
    defineCommands() {
        this.addCommand({ id: "insert-skribi", name: l['command.insert'],
            editorCallback: (editor, view) => {
                if (!this.initLoaded)
                    return;
                let x = new SuggestionModal(this);
                new Promise((resolve, reject) => x.openAndGetValue(resolve, reject))
                    .then(result => {
                    if (this.eta.hasPartial(result)) {
                        let i = new InsertionModal(this, editor, result);
                        i.open();
                    }
                }, (r) => { });
            } });
        this.addCommand({ id: "reload-scripts", name: l['command.reloadScripts'], callback: () => {
                this.eta.bus.scriptLoader.reload().then(() => console.log("Skribi: Reloaded Scripts"));
            } });
        this.addCommand({ id: "reload-skribis", name: "Reload Skribis", callback: () => {
                Array.from(this.children).forEach(child => child.rerender(child === null || child === void 0 ? void 0 : child.templateKey));
            } });
        this.addCommand({ id: "test-performance", name: l['command.perfTest'], callback: () => __awaiter(this, void 0, void 0, function* () {
                var _a, _b;
                let sel = (_b = (_a = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView)) === null || _a === void 0 ? void 0 : _a.editor) === null || _b === void 0 ? void 0 : _b.getSelection();
                let clip = yield window.navigator.clipboard.readText();
                let fill = (sel || clip) ? {
                    type: l[sel ? 'modal.perf.autofill.selection' : 'modal.perf.autofill.clipboard'],
                    value: sel ? sel : clip
                } : null;
                new TestModal(this, fill).open();
            }) });
    }
    onunload() {
        this.eta.unload();
        console.log('Skribi: Unloading...', this.children);
        Array.from(this.children).forEach((child) => {
            let pre = createEl('code', { text: child.source });
            child.containerEl.replaceWith(pre);
            child.unload();
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = SkribosPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5vZGVfbW9kdWxlcy9ldGEvZGlzdC9ldGEuZXMuanMiLCJzcmMvdHlwZXMvY29uc3QudHMiLCJzcmMvdXRpbC50cyIsInNyYy9ldGEvY29tcC50cyIsInNyYy9ldGEvcHJvdmlkZXJfYWJzLnRzIiwic3JjL2V0YS9wcm92aWRlcnMvYmFzZS50cyIsInNyYy9ldGEvcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2LnRzIiwic3JjL2V0YS9wcm92aWRlcnMvaW50ZWdyYXRpb24vd2VhdGhlci50cyIsInNyYy9ldGEvcHJvdmlkZXJzL3NjcmlwdGxvYWRlci50cyIsInNyYy9ldGEvcHJvdmlkZXJfYnVzLnRzIiwic3JjL2V0YS9jYWNoZXIudHMiLCJzcmMvZXRhL3RlbXBsYXRlcy50cyIsInNyYy9ldGEvZXRhLnRzIiwic3JjL2xhbmcvYmFiZWwudHMiLCJzcmMvbW9kYWwvY29uZmlybWF0aW9uTW9kYWwudHMiLCJzcmMvc2V0dGluZ3MudHMiLCJzcmMvcmVuZGVyL3JlZ2VudC50cyIsInNyYy9yZW5kZXIvZW1iZWQudHMiLCJzcmMvcmVuZGVyL3BhcnNlLnRzIiwic3JjL3JlbmRlci9zdHlsZVNjb3BlLnRzIiwic3JjL3JlbmRlci9wcm9jZXNzb3IudHMiLCJzcmMvcmVuZGVyL2NoaWxkLnRzIiwic3JjL21vZGFsL3N1Z2dlc3Rpb25Nb2RhbC50cyIsInNyYy90eXBlcy90eXBlcy50cyIsInNyYy9tb2RhbC9pbnNlcnRpb25Nb2RhbC50cyIsInNyYy9tb2RhbC90ZXN0TW9kYWwudHMiLCJzcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcbiIsImltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IHJlc29sdmUsIGRpcm5hbWUsIGV4dG5hbWUgfSBmcm9tICdwYXRoJztcblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuXHJcbnZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn07XG5cbmZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKG9iaiwgcHJvdG8pIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihvYmosIHByb3RvKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIG9iai5fX3Byb3RvX18gPSBwcm90bztcclxuICAgIH1cclxufVxyXG4vLyBUaGlzIGlzIHByZXR0eSBtdWNoIHRoZSBvbmx5IHdheSB0byBnZXQgbmljZSwgZXh0ZW5kZWQgRXJyb3JzXHJcbi8vIHdpdGhvdXQgdXNpbmcgRVM2XHJcbi8qKlxyXG4gKiBUaGlzIHJldHVybnMgYSBuZXcgRXJyb3Igd2l0aCBhIGN1c3RvbSBwcm90b3R5cGUuIE5vdGUgdGhhdCBpdCdzIF9ub3RfIGEgY29uc3RydWN0b3JcclxuICpcclxuICogQHBhcmFtIG1lc3NhZ2UgRXJyb3IgbWVzc2FnZVxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiB0aHJvdyBFdGFFcnIoXCJ0ZW1wbGF0ZSBub3QgZm91bmRcIilcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBFdGFFcnIobWVzc2FnZSkge1xyXG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuICAgIHNldFByb3RvdHlwZU9mKGVyciwgRXRhRXJyLnByb3RvdHlwZSk7XHJcbiAgICByZXR1cm4gZXJyO1xyXG59XHJcbkV0YUVyci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSwge1xyXG4gICAgbmFtZTogeyB2YWx1ZTogJ0V0YSBFcnJvcicsIGVudW1lcmFibGU6IGZhbHNlIH1cclxufSk7XHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gRXRhRXJyIHdpdGggYSBuaWNlbHkgZm9ybWF0dGVkIGVycm9yIGFuZCBtZXNzYWdlIHNob3dpbmcgd2hlcmUgaW4gdGhlIHRlbXBsYXRlIHRoZSBlcnJvciBvY2N1cnJlZC5cclxuICovXHJcbmZ1bmN0aW9uIFBhcnNlRXJyKG1lc3NhZ2UsIHN0ciwgaW5keCkge1xyXG4gICAgdmFyIHdoaXRlc3BhY2UgPSBzdHIuc2xpY2UoMCwgaW5keCkuc3BsaXQoL1xcbi8pO1xyXG4gICAgdmFyIGxpbmVObyA9IHdoaXRlc3BhY2UubGVuZ3RoO1xyXG4gICAgdmFyIGNvbE5vID0gd2hpdGVzcGFjZVtsaW5lTm8gLSAxXS5sZW5ndGggKyAxO1xyXG4gICAgbWVzc2FnZSArPVxyXG4gICAgICAgICcgYXQgbGluZSAnICtcclxuICAgICAgICAgICAgbGluZU5vICtcclxuICAgICAgICAgICAgJyBjb2wgJyArXHJcbiAgICAgICAgICAgIGNvbE5vICtcclxuICAgICAgICAgICAgJzpcXG5cXG4nICtcclxuICAgICAgICAgICAgJyAgJyArXHJcbiAgICAgICAgICAgIHN0ci5zcGxpdCgvXFxuLylbbGluZU5vIC0gMV0gK1xyXG4gICAgICAgICAgICAnXFxuJyArXHJcbiAgICAgICAgICAgICcgICcgK1xyXG4gICAgICAgICAgICBBcnJheShjb2xObykuam9pbignICcpICtcclxuICAgICAgICAgICAgJ14nO1xyXG4gICAgdGhyb3cgRXRhRXJyKG1lc3NhZ2UpO1xyXG59XG5cbi8qKlxyXG4gKiBAcmV0dXJucyBUaGUgZ2xvYmFsIFByb21pc2UgZnVuY3Rpb25cclxuICovXHJcbnZhciBwcm9taXNlSW1wbCA9IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLlByb21pc2U7XHJcbi8qKlxyXG4gKiBAcmV0dXJucyBBIG5ldyBBc3luY0Z1bmN0aW9uIGNvbnN0dWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIGdldEFzeW5jRnVuY3Rpb25Db25zdHJ1Y3RvcigpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigncmV0dXJuIChhc3luYyBmdW5jdGlvbigpe30pLmNvbnN0cnVjdG9yJykoKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoXCJUaGlzIGVudmlyb25tZW50IGRvZXNuJ3Qgc3VwcG9ydCBhc3luYy9hd2FpdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBzdHIudHJpbUxlZnQgcG9seWZpbGxcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHN0cmluZ1xyXG4gKiBAcmV0dXJucyBUaGUgc3RyaW5nIHdpdGggbGVmdCB3aGl0ZXNwYWNlIHJlbW92ZWRcclxuICpcclxuICovXHJcbmZ1bmN0aW9uIHRyaW1MZWZ0KHN0cikge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV4dHJhLWJvb2xlYW4tY2FzdFxyXG4gICAgaWYgKCEhU3RyaW5nLnByb3RvdHlwZS50cmltTGVmdCkge1xyXG4gICAgICAgIHJldHVybiBzdHIudHJpbUxlZnQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvXlxccysvLCAnJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIHN0ci50cmltUmlnaHQgcG9seWZpbGxcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHN0cmluZ1xyXG4gKiBAcmV0dXJucyBUaGUgc3RyaW5nIHdpdGggcmlnaHQgd2hpdGVzcGFjZSByZW1vdmVkXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmltUmlnaHQoc3RyKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXh0cmEtYm9vbGVhbi1jYXN0XHJcbiAgICBpZiAoISFTdHJpbmcucHJvdG90eXBlLnRyaW1SaWdodCkge1xyXG4gICAgICAgIHJldHVybiBzdHIudHJpbVJpZ2h0KCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1xccyskLywgJycpOyAvLyBUT0RPOiBkbyB3ZSByZWFsbHkgbmVlZCB0byByZXBsYWNlIEJPTSdzP1xyXG4gICAgfVxyXG59XG5cbi8vIFRPRE86IGFsbG93ICctJyB0byB0cmltIHVwIHVudGlsIG5ld2xpbmUuIFVzZSBbXlxcU1xcblxccl0gaW5zdGVhZCBvZiBcXHNcclxuLyogRU5EIFRZUEVTICovXHJcbmZ1bmN0aW9uIGhhc093blByb3Aob2JqLCBwcm9wKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XHJcbn1cclxuZnVuY3Rpb24gY29weVByb3BzKHRvT2JqLCBmcm9tT2JqKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gZnJvbU9iaikge1xyXG4gICAgICAgIGlmIChoYXNPd25Qcm9wKGZyb21PYmosIGtleSkpIHtcclxuICAgICAgICAgICAgdG9PYmpba2V5XSA9IGZyb21PYmpba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG9PYmo7XHJcbn1cclxuLyoqXHJcbiAqIFRha2VzIGEgc3RyaW5nIHdpdGhpbiBhIHRlbXBsYXRlIGFuZCB0cmltcyBpdCwgYmFzZWQgb24gdGhlIHByZWNlZGluZyB0YWcncyB3aGl0ZXNwYWNlIGNvbnRyb2wgYW5kIGBjb25maWcuYXV0b1RyaW1gXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmltV1Moc3RyLCBjb25maWcsIHdzTGVmdCwgd3NSaWdodCkge1xyXG4gICAgdmFyIGxlZnRUcmltO1xyXG4gICAgdmFyIHJpZ2h0VHJpbTtcclxuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZy5hdXRvVHJpbSkpIHtcclxuICAgICAgICAvLyBraW5kYSBjb25mdXNpbmdcclxuICAgICAgICAvLyBidXQgX319IHdpbGwgdHJpbSB0aGUgbGVmdCBzaWRlIG9mIHRoZSBmb2xsb3dpbmcgc3RyaW5nXHJcbiAgICAgICAgbGVmdFRyaW0gPSBjb25maWcuYXV0b1RyaW1bMV07XHJcbiAgICAgICAgcmlnaHRUcmltID0gY29uZmlnLmF1dG9UcmltWzBdO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbGVmdFRyaW0gPSByaWdodFRyaW0gPSBjb25maWcuYXV0b1RyaW07XHJcbiAgICB9XHJcbiAgICBpZiAod3NMZWZ0IHx8IHdzTGVmdCA9PT0gZmFsc2UpIHtcclxuICAgICAgICBsZWZ0VHJpbSA9IHdzTGVmdDtcclxuICAgIH1cclxuICAgIGlmICh3c1JpZ2h0IHx8IHdzUmlnaHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcmlnaHRUcmltID0gd3NSaWdodDtcclxuICAgIH1cclxuICAgIGlmICghcmlnaHRUcmltICYmICFsZWZ0VHJpbSkge1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBpZiAobGVmdFRyaW0gPT09ICdzbHVycCcgJiYgcmlnaHRUcmltID09PSAnc2x1cnAnKSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci50cmltKCk7XHJcbiAgICB9XHJcbiAgICBpZiAobGVmdFRyaW0gPT09ICdfJyB8fCBsZWZ0VHJpbSA9PT0gJ3NsdXJwJykge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmltbWluZyBsZWZ0JyArIGxlZnRUcmltKVxyXG4gICAgICAgIC8vIGZ1bGwgc2x1cnBcclxuICAgICAgICBzdHIgPSB0cmltTGVmdChzdHIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobGVmdFRyaW0gPT09ICctJyB8fCBsZWZ0VHJpbSA9PT0gJ25sJykge1xyXG4gICAgICAgIC8vIG5sIHRyaW1cclxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvXig/OlxcclxcbnxcXG58XFxyKS8sICcnKTtcclxuICAgIH1cclxuICAgIGlmIChyaWdodFRyaW0gPT09ICdfJyB8fCByaWdodFRyaW0gPT09ICdzbHVycCcpIHtcclxuICAgICAgICAvLyBmdWxsIHNsdXJwXHJcbiAgICAgICAgc3RyID0gdHJpbVJpZ2h0KHN0cik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChyaWdodFRyaW0gPT09ICctJyB8fCByaWdodFRyaW0gPT09ICdubCcpIHtcclxuICAgICAgICAvLyBubCB0cmltXHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoLyg/OlxcclxcbnxcXG58XFxyKSQvLCAnJyk7IC8vIFRPRE86IG1ha2Ugc3VyZSB0aGlzIGdldHMgXFxyXFxuXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyO1xyXG59XHJcbi8qKlxyXG4gKiBBIG1hcCBvZiBzcGVjaWFsIEhUTUwgY2hhcmFjdGVycyB0byB0aGVpciBYTUwtZXNjYXBlZCBlcXVpdmFsZW50c1xyXG4gKi9cclxudmFyIGVzY01hcCA9IHtcclxuICAgICcmJzogJyZhbXA7JyxcclxuICAgICc8JzogJyZsdDsnLFxyXG4gICAgJz4nOiAnJmd0OycsXHJcbiAgICAnXCInOiAnJnF1b3Q7JyxcclxuICAgIFwiJ1wiOiAnJiMzOTsnXHJcbn07XHJcbmZ1bmN0aW9uIHJlcGxhY2VDaGFyKHMpIHtcclxuICAgIHJldHVybiBlc2NNYXBbc107XHJcbn1cclxuLyoqXHJcbiAqIFhNTC1lc2NhcGVzIGFuIGlucHV0IHZhbHVlIGFmdGVyIGNvbnZlcnRpbmcgaXQgdG8gYSBzdHJpbmdcclxuICpcclxuICogQHBhcmFtIHN0ciAtIElucHV0IHZhbHVlICh1c3VhbGx5IGEgc3RyaW5nKVxyXG4gKiBAcmV0dXJucyBYTUwtZXNjYXBlZCBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIFhNTEVzY2FwZShzdHIpIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgLy8gVG8gZGVhbCB3aXRoIFhTUy4gQmFzZWQgb24gRXNjYXBlIGltcGxlbWVudGF0aW9ucyBvZiBNdXN0YWNoZS5KUyBhbmQgTWFya28sIHRoZW4gY3VzdG9taXplZC5cclxuICAgIHZhciBuZXdTdHIgPSBTdHJpbmcoc3RyKTtcclxuICAgIGlmICgvWyY8PlwiJ10vLnRlc3QobmV3U3RyKSkge1xyXG4gICAgICAgIHJldHVybiBuZXdTdHIucmVwbGFjZSgvWyY8PlwiJ10vZywgcmVwbGFjZUNoYXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N0cjtcclxuICAgIH1cclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxudmFyIHRlbXBsYXRlTGl0UmVnID0gL2AoPzpcXFxcW1xcc1xcU118XFwkeyg/Oltee31dfHsoPzpbXnt9XXx7W159XSp9KSp9KSp9fCg/IVxcJHspW15cXFxcYF0pKmAvZztcclxudmFyIHNpbmdsZVF1b3RlUmVnID0gLycoPzpcXFxcW1xcc1xcd1wiJ1xcXFxgXXxbXlxcblxccidcXFxcXSkqPycvZztcclxudmFyIGRvdWJsZVF1b3RlUmVnID0gL1wiKD86XFxcXFtcXHNcXHdcIidcXFxcYF18W15cXG5cXHJcIlxcXFxdKSo/XCIvZztcclxuLyoqIEVzY2FwZSBzcGVjaWFsIHJlZ3VsYXIgZXhwcmVzc2lvbiBjaGFyYWN0ZXJzIGluc2lkZSBhIHN0cmluZyAqL1xyXG5mdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyaW5nKSB7XHJcbiAgICAvLyBGcm9tIE1ETlxyXG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bLiorXFwtP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpOyAvLyAkJiBtZWFucyB0aGUgd2hvbGUgbWF0Y2hlZCBzdHJpbmdcclxufVxyXG5mdW5jdGlvbiBwYXJzZShzdHIsIGNvbmZpZykge1xyXG4gICAgdmFyIGJ1ZmZlciA9IFtdO1xyXG4gICAgdmFyIHRyaW1MZWZ0T2ZOZXh0U3RyID0gZmFsc2U7XHJcbiAgICB2YXIgbGFzdEluZGV4ID0gMDtcclxuICAgIHZhciBwYXJzZU9wdGlvbnMgPSBjb25maWcucGFyc2U7XHJcbiAgICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwbHVnaW4gPSBjb25maWcucGx1Z2luc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBsdWdpbi5wcm9jZXNzVGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9IHBsdWdpbi5wcm9jZXNzVGVtcGxhdGUoc3RyLCBjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyogQWRkaW5nIGZvciBFSlMgY29tcGF0aWJpbGl0eSAqL1xyXG4gICAgaWYgKGNvbmZpZy5ybVdoaXRlc3BhY2UpIHtcclxuICAgICAgICAvLyBDb2RlIHRha2VuIGRpcmVjdGx5IGZyb20gRUpTXHJcbiAgICAgICAgLy8gSGF2ZSB0byB1c2UgdHdvIHNlcGFyYXRlIHJlcGxhY2VzIGhlcmUgYXMgYF5gIGFuZCBgJGAgb3BlcmF0b3JzIGRvbid0XHJcbiAgICAgICAgLy8gd29yayB3ZWxsIHdpdGggYFxccmAgYW5kIGVtcHR5IGxpbmVzIGRvbid0IHdvcmsgd2VsbCB3aXRoIHRoZSBgbWAgZmxhZy5cclxuICAgICAgICAvLyBFc3NlbnRpYWxseSwgdGhpcyByZXBsYWNlcyB0aGUgd2hpdGVzcGFjZSBhdCB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2ZcclxuICAgICAgICAvLyBlYWNoIGxpbmUgYW5kIHJlbW92ZXMgbXVsdGlwbGUgbmV3bGluZXMuXHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL1tcXHJcXG5dKy9nLCAnXFxuJykucmVwbGFjZSgvXlxccyt8XFxzKyQvZ20sICcnKTtcclxuICAgIH1cclxuICAgIC8qIEVuZCBybVdoaXRlc3BhY2Ugb3B0aW9uICovXHJcbiAgICB0ZW1wbGF0ZUxpdFJlZy5sYXN0SW5kZXggPSAwO1xyXG4gICAgc2luZ2xlUXVvdGVSZWcubGFzdEluZGV4ID0gMDtcclxuICAgIGRvdWJsZVF1b3RlUmVnLmxhc3RJbmRleCA9IDA7XHJcbiAgICBmdW5jdGlvbiBwdXNoU3RyaW5nKHN0cm5nLCBzaG91bGRUcmltUmlnaHRPZlN0cmluZykge1xyXG4gICAgICAgIGlmIChzdHJuZykge1xyXG4gICAgICAgICAgICAvLyBpZiBzdHJpbmcgaXMgdHJ1dGh5IGl0IG11c3QgYmUgb2YgdHlwZSAnc3RyaW5nJ1xyXG4gICAgICAgICAgICBzdHJuZyA9IHRyaW1XUyhzdHJuZywgY29uZmlnLCB0cmltTGVmdE9mTmV4dFN0ciwgLy8gdGhpcyB3aWxsIG9ubHkgYmUgZmFsc2Ugb24gdGhlIGZpcnN0IHN0ciwgdGhlIG5leHQgb25lcyB3aWxsIGJlIG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIHNob3VsZFRyaW1SaWdodE9mU3RyaW5nKTtcclxuICAgICAgICAgICAgaWYgKHN0cm5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXBsYWNlIFxcIHdpdGggXFxcXCwgJyB3aXRoIFxcJ1xyXG4gICAgICAgICAgICAgICAgLy8gd2UncmUgZ29pbmcgdG8gY29udmVydCBhbGwgQ1JMRiB0byBMRiBzbyBpdCBkb2Vzbid0IHRha2UgbW9yZSB0aGFuIG9uZSByZXBsYWNlXHJcbiAgICAgICAgICAgICAgICBzdHJuZyA9IHN0cm5nLnJlcGxhY2UoL1xcXFx8Jy9nLCAnXFxcXCQmJykucmVwbGFjZSgvXFxyXFxufFxcbnxcXHIvZywgJ1xcXFxuJyk7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIucHVzaChzdHJuZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YXIgcHJlZml4ZXMgPSBbcGFyc2VPcHRpb25zLmV4ZWMsIHBhcnNlT3B0aW9ucy5pbnRlcnBvbGF0ZSwgcGFyc2VPcHRpb25zLnJhd10ucmVkdWNlKGZ1bmN0aW9uIChhY2N1bXVsYXRvciwgcHJlZml4KSB7XHJcbiAgICAgICAgaWYgKGFjY3VtdWxhdG9yICYmIHByZWZpeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW11bGF0b3IgKyAnfCcgKyBlc2NhcGVSZWdFeHAocHJlZml4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJlZml4KSB7XHJcbiAgICAgICAgICAgIC8vIGFjY3VtdWxhdG9yIGlzIGZhbHN5XHJcbiAgICAgICAgICAgIHJldHVybiBlc2NhcGVSZWdFeHAocHJlZml4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHByZWZpeCBhbmQgYWNjdW11bGF0b3IgYXJlIGJvdGggZmFsc3lcclxuICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xyXG4gICAgICAgIH1cclxuICAgIH0sICcnKTtcclxuICAgIHZhciBwYXJzZU9wZW5SZWcgPSBuZXcgUmVnRXhwKCcoW15dKj8pJyArIGVzY2FwZVJlZ0V4cChjb25maWcudGFnc1swXSkgKyAnKC18Xyk/XFxcXHMqKCcgKyBwcmVmaXhlcyArICcpP1xcXFxzKicsICdnJyk7XHJcbiAgICB2YXIgcGFyc2VDbG9zZVJlZyA9IG5ldyBSZWdFeHAoJ1xcJ3xcInxgfFxcXFwvXFxcXCp8KFxcXFxzKigtfF8pPycgKyBlc2NhcGVSZWdFeHAoY29uZmlnLnRhZ3NbMV0pICsgJyknLCAnZycpO1xyXG4gICAgLy8gVE9ETzogYmVuY2htYXJrIGhhdmluZyB0aGUgXFxzKiBvbiBlaXRoZXIgc2lkZSB2cyB1c2luZyBzdHIudHJpbSgpXHJcbiAgICB2YXIgbTtcclxuICAgIHdoaWxlICgobSA9IHBhcnNlT3BlblJlZy5leGVjKHN0cikpKSB7XHJcbiAgICAgICAgbGFzdEluZGV4ID0gbVswXS5sZW5ndGggKyBtLmluZGV4O1xyXG4gICAgICAgIHZhciBwcmVjZWRpbmdTdHJpbmcgPSBtWzFdO1xyXG4gICAgICAgIHZhciB3c0xlZnQgPSBtWzJdO1xyXG4gICAgICAgIHZhciBwcmVmaXggPSBtWzNdIHx8ICcnOyAvLyBieSBkZWZhdWx0IGVpdGhlciB+LCA9LCBvciBlbXB0eVxyXG4gICAgICAgIHB1c2hTdHJpbmcocHJlY2VkaW5nU3RyaW5nLCB3c0xlZnQpO1xyXG4gICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gbGFzdEluZGV4O1xyXG4gICAgICAgIHZhciBjbG9zZVRhZyA9IHZvaWQgMDtcclxuICAgICAgICB2YXIgY3VycmVudE9iaiA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlICgoY2xvc2VUYWcgPSBwYXJzZUNsb3NlUmVnLmV4ZWMoc3RyKSkpIHtcclxuICAgICAgICAgICAgaWYgKGNsb3NlVGFnWzFdKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHN0ci5zbGljZShsYXN0SW5kZXgsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgIHBhcnNlT3BlblJlZy5sYXN0SW5kZXggPSBsYXN0SW5kZXggPSBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleDtcclxuICAgICAgICAgICAgICAgIHRyaW1MZWZ0T2ZOZXh0U3RyID0gY2xvc2VUYWdbMl07XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFR5cGUgPSBwcmVmaXggPT09IHBhcnNlT3B0aW9ucy5leGVjXHJcbiAgICAgICAgICAgICAgICAgICAgPyAnZSdcclxuICAgICAgICAgICAgICAgICAgICA6IHByZWZpeCA9PT0gcGFyc2VPcHRpb25zLnJhd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICdyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHByZWZpeCA9PT0gcGFyc2VPcHRpb25zLmludGVycG9sYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdpJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnJztcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmogPSB7IHQ6IGN1cnJlbnRUeXBlLCB2YWw6IGNvbnRlbnQgfTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoYXIgPSBjbG9zZVRhZ1swXTtcclxuICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnLyonKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW1lbnRDbG9zZUluZCA9IHN0ci5pbmRleE9mKCcqLycsIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWVudENsb3NlSW5kID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgY29tbWVudCcsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IGNvbW1lbnRDbG9zZUluZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoYXIgPT09IFwiJ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2luZ2xlUXVvdGVSZWcubGFzdEluZGV4ID0gY2xvc2VUYWcuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpbmdsZVF1b3RlTWF0Y2ggPSBzaW5nbGVRdW90ZVJlZy5leGVjKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpbmdsZVF1b3RlTWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSBzaW5nbGVRdW90ZVJlZy5sYXN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgc3RyaW5nJywgc3RyLCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZVF1b3RlUmVnLmxhc3RJbmRleCA9IGNsb3NlVGFnLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb3VibGVRdW90ZU1hdGNoID0gZG91YmxlUXVvdGVSZWcuZXhlYyhzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb3VibGVRdW90ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gZG91YmxlUXVvdGVSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHN0cmluZycsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoYXIgPT09ICdgJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlTGl0UmVnLmxhc3RJbmRleCA9IGNsb3NlVGFnLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZUxpdE1hdGNoID0gdGVtcGxhdGVMaXRSZWcuZXhlYyhzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZUxpdE1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gdGVtcGxhdGVMaXRSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHN0cmluZycsIHN0ciwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudE9iaikge1xyXG4gICAgICAgICAgICBidWZmZXIucHVzaChjdXJyZW50T2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCB0YWcnLCBzdHIsIG0uaW5kZXggKyBwcmVjZWRpbmdTdHJpbmcubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdXNoU3RyaW5nKHN0ci5zbGljZShsYXN0SW5kZXgsIHN0ci5sZW5ndGgpLCBmYWxzZSk7XHJcbiAgICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwbHVnaW4gPSBjb25maWcucGx1Z2luc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBsdWdpbi5wcm9jZXNzQVNUKSB7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBwbHVnaW4ucHJvY2Vzc0FTVChidWZmZXIsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYnVmZmVyO1xyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogQ29tcGlsZXMgYSB0ZW1wbGF0ZSBzdHJpbmcgdG8gYSBmdW5jdGlvbiBzdHJpbmcuIE1vc3Qgb2Z0ZW4gdXNlcnMganVzdCB1c2UgYGNvbXBpbGUoKWAsIHdoaWNoIGNhbGxzIGBjb21waWxlVG9TdHJpbmdgIGFuZCBjcmVhdGVzIGEgbmV3IGZ1bmN0aW9uIHVzaW5nIHRoZSByZXN1bHRcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogY29tcGlsZVRvU3RyaW5nKFwiSGkgPCU9IGl0LnVzZXIgJT5cIiwgZXRhLmNvbmZpZylcclxuICogLy8gXCJ2YXIgdFI9JycsaW5jbHVkZT1FLmluY2x1ZGUuYmluZChFKSxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSk7dFIrPSdIaSAnO3RSKz1FLmUoaXQudXNlcik7aWYoY2Ipe2NiKG51bGwsdFIpfSByZXR1cm4gdFJcIlxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGVUb1N0cmluZyhzdHIsIGNvbmZpZykge1xyXG4gICAgdmFyIGJ1ZmZlciA9IHBhcnNlKHN0ciwgY29uZmlnKTtcclxuICAgIHZhciByZXMgPSBcInZhciB0Uj0nJyxfX2wsX19sUFwiICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGUgPyAnLGluY2x1ZGU9RS5pbmNsdWRlLmJpbmQoRSknIDogJycpICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGVGaWxlID8gJyxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSknIDogJycpICtcclxuICAgICAgICAnXFxuZnVuY3Rpb24gbGF5b3V0KHAsZCl7X19sPXA7X19sUD1kfVxcbicgK1xyXG4gICAgICAgIChjb25maWcudXNlV2l0aCA/ICd3aXRoKCcgKyBjb25maWcudmFyTmFtZSArICd8fHt9KXsnIDogJycpICtcclxuICAgICAgICBjb21waWxlU2NvcGUoYnVmZmVyLCBjb25maWcpICtcclxuICAgICAgICAoY29uZmlnLmluY2x1ZGVGaWxlXHJcbiAgICAgICAgICAgID8gJ2lmKF9fbCl0Uj0nICtcclxuICAgICAgICAgICAgICAgIChjb25maWcuYXN5bmMgPyAnYXdhaXQgJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAoXCJpbmNsdWRlRmlsZShfX2wsT2JqZWN0LmFzc2lnbihcIiArIGNvbmZpZy52YXJOYW1lICsgXCIse2JvZHk6dFJ9LF9fbFApKVxcblwiKVxyXG4gICAgICAgICAgICA6IGNvbmZpZy5pbmNsdWRlXHJcbiAgICAgICAgICAgICAgICA/ICdpZihfX2wpdFI9JyArXHJcbiAgICAgICAgICAgICAgICAgICAgKGNvbmZpZy5hc3luYyA/ICdhd2FpdCAnIDogJycpICtcclxuICAgICAgICAgICAgICAgICAgICAoXCJpbmNsdWRlKF9fbCxPYmplY3QuYXNzaWduKFwiICsgY29uZmlnLnZhck5hbWUgKyBcIix7Ym9keTp0Un0sX19sUCkpXFxuXCIpXHJcbiAgICAgICAgICAgICAgICA6ICcnKSArXHJcbiAgICAgICAgJ2lmKGNiKXtjYihudWxsLHRSKX0gcmV0dXJuIHRSJyArXHJcbiAgICAgICAgKGNvbmZpZy51c2VXaXRoID8gJ30nIDogJycpO1xyXG4gICAgaWYgKGNvbmZpZy5wbHVnaW5zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWcucGx1Z2lucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcGx1Z2luID0gY29uZmlnLnBsdWdpbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChwbHVnaW4ucHJvY2Vzc0ZuU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXMgPSBwbHVnaW4ucHJvY2Vzc0ZuU3RyaW5nKHJlcywgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuLyoqXHJcbiAqIExvb3BzIHRocm91Z2ggdGhlIEFTVCBnZW5lcmF0ZWQgYnkgYHBhcnNlYCBhbmQgdHJhbnNmb3JtIGVhY2ggaXRlbSBpbnRvIEpTIGNhbGxzXHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIC8vIEFTVCB2ZXJzaW9uIG9mICdIaSA8JT0gaXQudXNlciAlPidcclxuICogbGV0IHRlbXBsYXRlQVNUID0gWydIaSAnLCB7IHZhbDogJ2l0LnVzZXInLCB0OiAnaScgfV1cclxuICogY29tcGlsZVNjb3BlKHRlbXBsYXRlQVNULCBldGEuY29uZmlnKVxyXG4gKiAvLyBcInRSKz0nSGkgJzt0Uis9RS5lKGl0LnVzZXIpO1wiXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gY29tcGlsZVNjb3BlKGJ1ZmYsIGNvbmZpZykge1xyXG4gICAgdmFyIGkgPSAwO1xyXG4gICAgdmFyIGJ1ZmZMZW5ndGggPSBidWZmLmxlbmd0aDtcclxuICAgIHZhciByZXR1cm5TdHIgPSAnJztcclxuICAgIGZvciAoaTsgaSA8IGJ1ZmZMZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjdXJyZW50QmxvY2sgPSBidWZmW2ldO1xyXG4gICAgICAgIGlmICh0eXBlb2YgY3VycmVudEJsb2NrID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gY3VycmVudEJsb2NrO1xyXG4gICAgICAgICAgICAvLyB3ZSBrbm93IHN0cmluZyBleGlzdHNcclxuICAgICAgICAgICAgcmV0dXJuU3RyICs9IFwidFIrPSdcIiArIHN0ciArIFwiJ1xcblwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBjdXJyZW50QmxvY2sudDsgLy8gfiwgcywgISwgPywgclxyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IGN1cnJlbnRCbG9jay52YWwgfHwgJyc7XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAncicpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJhd1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5maWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJ0UuZmlsdGVyKCcgKyBjb250ZW50ICsgJyknO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuU3RyICs9ICd0Uis9JyArIGNvbnRlbnQgKyAnXFxuJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnaScpIHtcclxuICAgICAgICAgICAgICAgIC8vIGludGVycG9sYXRlXHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAnRS5maWx0ZXIoJyArIGNvbnRlbnQgKyAnKSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmF1dG9Fc2NhcGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJ0UuZSgnICsgY29udGVudCArICcpJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVyblN0ciArPSAndFIrPScgKyBjb250ZW50ICsgJ1xcbic7XHJcbiAgICAgICAgICAgICAgICAvLyByZWZlcmVuY2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnZScpIHtcclxuICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGVcclxuICAgICAgICAgICAgICAgIHJldHVyblN0ciArPSBjb250ZW50ICsgJ1xcbic7IC8vIHlvdSBuZWVkIGEgXFxuIGluIGNhc2UgeW91IGhhdmUgPCUgfSAlPlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldHVyblN0cjtcclxufVxuXG4vKipcclxuICogSGFuZGxlcyBzdG9yYWdlIGFuZCBhY2Nlc3Npbmcgb2YgdmFsdWVzXHJcbiAqXHJcbiAqIEluIHRoaXMgY2FzZSwgd2UgdXNlIGl0IHRvIHN0b3JlIGNvbXBpbGVkIHRlbXBsYXRlIGZ1bmN0aW9uc1xyXG4gKiBJbmRleGVkIGJ5IHRoZWlyIGBuYW1lYCBvciBgZmlsZW5hbWVgXHJcbiAqL1xyXG52YXIgQ2FjaGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ2FjaGVyKGNhY2hlKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xyXG4gICAgfVxyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5kZWZpbmUgPSBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcclxuICAgICAgICB0aGlzLmNhY2hlW2tleV0gPSB2YWw7XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgLy8gc3RyaW5nIHwgYXJyYXkuXHJcbiAgICAgICAgLy8gVE9ETzogYWxsb3cgYXJyYXkgb2Yga2V5cyB0byBsb29rIGRvd25cclxuICAgICAgICAvLyBUT0RPOiBjcmVhdGUgcGx1Z2luIHRvIGFsbG93IHJlZmVyZW5jaW5nIGhlbHBlcnMsIGZpbHRlcnMgd2l0aCBkb3Qgbm90YXRpb25cclxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZVtrZXldO1xyXG4gICAgfTtcclxuICAgIENhY2hlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmNhY2hlW2tleV07XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNhY2hlID0ge307XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGNhY2hlT2JqKSB7XHJcbiAgICAgICAgY29weVByb3BzKHRoaXMuY2FjaGUsIGNhY2hlT2JqKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ2FjaGVyO1xyXG59KCkpO1xuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIEV0YSdzIHRlbXBsYXRlIHN0b3JhZ2VcclxuICpcclxuICogU3RvcmVzIHBhcnRpYWxzIGFuZCBjYWNoZWQgdGVtcGxhdGVzXHJcbiAqL1xyXG52YXIgdGVtcGxhdGVzID0gbmV3IENhY2hlcih7fSk7XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogSW5jbHVkZSBhIHRlbXBsYXRlIGJhc2VkIG9uIGl0cyBuYW1lIChvciBmaWxlcGF0aCwgaWYgaXQncyBhbHJlYWR5IGJlZW4gY2FjaGVkKS5cclxuICpcclxuICogQ2FsbGVkIGxpa2UgYGluY2x1ZGUodGVtcGxhdGVOYW1lT3JQYXRoLCBkYXRhKWBcclxuICovXHJcbmZ1bmN0aW9uIGluY2x1ZGVIZWxwZXIodGVtcGxhdGVOYW1lT3JQYXRoLCBkYXRhKSB7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcy5nZXQodGVtcGxhdGVOYW1lT3JQYXRoKTtcclxuICAgIGlmICghdGVtcGxhdGUpIHtcclxuICAgICAgICB0aHJvdyBFdGFFcnIoJ0NvdWxkIG5vdCBmZXRjaCB0ZW1wbGF0ZSBcIicgKyB0ZW1wbGF0ZU5hbWVPclBhdGggKyAnXCInKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0ZW1wbGF0ZShkYXRhLCB0aGlzKTtcclxufVxyXG4vKiogRXRhJ3MgYmFzZSAoZ2xvYmFsKSBjb25maWd1cmF0aW9uICovXHJcbnZhciBjb25maWcgPSB7XHJcbiAgICBhc3luYzogZmFsc2UsXHJcbiAgICBhdXRvRXNjYXBlOiB0cnVlLFxyXG4gICAgYXV0b1RyaW06IFtmYWxzZSwgJ25sJ10sXHJcbiAgICBjYWNoZTogZmFsc2UsXHJcbiAgICBlOiBYTUxFc2NhcGUsXHJcbiAgICBpbmNsdWRlOiBpbmNsdWRlSGVscGVyLFxyXG4gICAgcGFyc2U6IHtcclxuICAgICAgICBleGVjOiAnJyxcclxuICAgICAgICBpbnRlcnBvbGF0ZTogJz0nLFxyXG4gICAgICAgIHJhdzogJ34nXHJcbiAgICB9LFxyXG4gICAgcGx1Z2luczogW10sXHJcbiAgICBybVdoaXRlc3BhY2U6IGZhbHNlLFxyXG4gICAgdGFnczogWyc8JScsICclPiddLFxyXG4gICAgdGVtcGxhdGVzOiB0ZW1wbGF0ZXMsXHJcbiAgICB1c2VXaXRoOiBmYWxzZSxcclxuICAgIHZhck5hbWU6ICdpdCdcclxufTtcclxuLyoqXHJcbiAqIFRha2VzIG9uZSBvciB0d28gcGFydGlhbCAobm90IG5lY2Vzc2FyaWx5IGNvbXBsZXRlKSBjb25maWd1cmF0aW9uIG9iamVjdHMsIG1lcmdlcyB0aGVtIDEgbGF5ZXIgZGVlcCBpbnRvIGV0YS5jb25maWcsIGFuZCByZXR1cm5zIHRoZSByZXN1bHRcclxuICpcclxuICogQHBhcmFtIG92ZXJyaWRlIFBhcnRpYWwgY29uZmlndXJhdGlvbiBvYmplY3RcclxuICogQHBhcmFtIGJhc2VDb25maWcgUGFydGlhbCBjb25maWd1cmF0aW9uIG9iamVjdCB0byBtZXJnZSBiZWZvcmUgYG92ZXJyaWRlYFxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBsZXQgY3VzdG9tQ29uZmlnID0gZ2V0Q29uZmlnKHt0YWdzOiBbJyEjJywgJyMhJ119KVxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGdldENvbmZpZyhvdmVycmlkZSwgYmFzZUNvbmZpZykge1xyXG4gICAgLy8gVE9ETzogcnVuIG1vcmUgdGVzdHMgb24gdGhpc1xyXG4gICAgdmFyIHJlcyA9IHt9OyAvLyBMaW5rZWRcclxuICAgIGNvcHlQcm9wcyhyZXMsIGNvbmZpZyk7IC8vIENyZWF0ZXMgZGVlcCBjbG9uZSBvZiBldGEuY29uZmlnLCAxIGxheWVyIGRlZXBcclxuICAgIGlmIChiYXNlQ29uZmlnKSB7XHJcbiAgICAgICAgY29weVByb3BzKHJlcywgYmFzZUNvbmZpZyk7XHJcbiAgICB9XHJcbiAgICBpZiAob3ZlcnJpZGUpIHtcclxuICAgICAgICBjb3B5UHJvcHMocmVzLCBvdmVycmlkZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qKiBVcGRhdGUgRXRhJ3MgYmFzZSBjb25maWcgKi9cclxuZnVuY3Rpb24gY29uZmlndXJlKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBjb3B5UHJvcHMoY29uZmlnLCBvcHRpb25zKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIFRha2VzIGEgdGVtcGxhdGUgc3RyaW5nIGFuZCByZXR1cm5zIGEgdGVtcGxhdGUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHdpdGggKGRhdGEsIGNvbmZpZywgW2NiXSlcclxuICpcclxuICogQHBhcmFtIHN0ciAtIFRoZSB0ZW1wbGF0ZSBzdHJpbmdcclxuICogQHBhcmFtIGNvbmZpZyAtIEEgY3VzdG9tIGNvbmZpZ3VyYXRpb24gb2JqZWN0IChvcHRpb25hbClcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogbGV0IGNvbXBpbGVkRm4gPSBldGEuY29tcGlsZShcIkhpIDwlPSBpdC51c2VyICU+XCIpXHJcbiAqIC8vIGZ1bmN0aW9uIGFub255bW91cygpXHJcbiAqIGxldCBjb21waWxlZEZuU3RyID0gY29tcGlsZWRGbi50b1N0cmluZygpXHJcbiAqIC8vIFwiZnVuY3Rpb24gYW5vbnltb3VzKGl0LEUsY2JcXG4pIHtcXG52YXIgdFI9JycsaW5jbHVkZT1FLmluY2x1ZGUuYmluZChFKSxpbmNsdWRlRmlsZT1FLmluY2x1ZGVGaWxlLmJpbmQoRSk7dFIrPSdIaSAnO3RSKz1FLmUoaXQudXNlcik7aWYoY2Ipe2NiKG51bGwsdFIpfSByZXR1cm4gdFJcXG59XCJcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjb21waWxlKHN0ciwgY29uZmlnKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGdldENvbmZpZyhjb25maWcgfHwge30pO1xyXG4gICAgLyogQVNZTkMgSEFORExJTkcgKi9cclxuICAgIC8vIFRoZSBiZWxvdyBjb2RlIGlzIG1vZGlmaWVkIGZyb20gbWRlL2Vqcy4gQWxsIGNyZWRpdCBzaG91bGQgZ28gdG8gdGhlbS5cclxuICAgIHZhciBjdG9yID0gb3B0aW9ucy5hc3luYyA/IGdldEFzeW5jRnVuY3Rpb25Db25zdHJ1Y3RvcigpIDogRnVuY3Rpb247XHJcbiAgICAvKiBFTkQgQVNZTkMgSEFORExJTkcgKi9cclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBjdG9yKG9wdGlvbnMudmFyTmFtZSwgJ0UnLCAvLyBFdGFDb25maWdcclxuICAgICAgICAnY2InLCAvLyBvcHRpb25hbCBjYWxsYmFja1xyXG4gICAgICAgIGNvbXBpbGVUb1N0cmluZyhzdHIsIG9wdGlvbnMpKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXctZnVuY1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFN5bnRheEVycm9yKSB7XHJcbiAgICAgICAgICAgIHRocm93IEV0YUVycignQmFkIHRlbXBsYXRlIHN5bnRheFxcblxcbicgK1xyXG4gICAgICAgICAgICAgICAgZS5tZXNzYWdlICtcclxuICAgICAgICAgICAgICAgICdcXG4nICtcclxuICAgICAgICAgICAgICAgIEFycmF5KGUubWVzc2FnZS5sZW5ndGggKyAxKS5qb2luKCc9JykgK1xyXG4gICAgICAgICAgICAgICAgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgY29tcGlsZVRvU3RyaW5nKHN0ciwgb3B0aW9ucykgK1xyXG4gICAgICAgICAgICAgICAgJ1xcbicgLy8gVGhpcyB3aWxsIHB1dCBhbiBleHRyYSBuZXdsaW5lIGJlZm9yZSB0aGUgY2FsbHN0YWNrIGZvciBleHRyYSByZWFkYWJpbGl0eVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxudmFyIF9CT00gPSAvXlxcdUZFRkYvO1xyXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIEdldCB0aGUgcGF0aCB0byB0aGUgaW5jbHVkZWQgZmlsZSBmcm9tIHRoZSBwYXJlbnQgZmlsZSBwYXRoIGFuZCB0aGVcclxuICogc3BlY2lmaWVkIHBhdGguXHJcbiAqXHJcbiAqIElmIGBuYW1lYCBkb2VzIG5vdCBoYXZlIGFuIGV4dGVuc2lvbiwgaXQgd2lsbCBkZWZhdWx0IHRvIGAuZXRhYFxyXG4gKlxyXG4gKiBAcGFyYW0gbmFtZSBzcGVjaWZpZWQgcGF0aFxyXG4gKiBAcGFyYW0gcGFyZW50ZmlsZSBwYXJlbnQgZmlsZSBwYXRoXHJcbiAqIEBwYXJhbSBpc0RpcmVjdG9yeSB3aGV0aGVyIHBhcmVudGZpbGUgaXMgYSBkaXJlY3RvcnlcclxuICogQHJldHVybiBhYnNvbHV0ZSBwYXRoIHRvIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRXaG9sZUZpbGVQYXRoKG5hbWUsIHBhcmVudGZpbGUsIGlzRGlyZWN0b3J5KSB7XHJcbiAgICB2YXIgaW5jbHVkZVBhdGggPSByZXNvbHZlKGlzRGlyZWN0b3J5ID8gcGFyZW50ZmlsZSA6IGRpcm5hbWUocGFyZW50ZmlsZSksIC8vIHJldHVybnMgZGlyZWN0b3J5IHRoZSBwYXJlbnQgZmlsZSBpcyBpblxyXG4gICAgbmFtZSAvLyBmaWxlXHJcbiAgICApICsgKGV4dG5hbWUobmFtZSkgPyAnJyA6ICcuZXRhJyk7XHJcbiAgICByZXR1cm4gaW5jbHVkZVBhdGg7XHJcbn1cclxuLyoqXHJcbiAqIEdldCB0aGUgYWJzb2x1dGUgcGF0aCB0byBhbiBpbmNsdWRlZCB0ZW1wbGF0ZVxyXG4gKlxyXG4gKiBJZiB0aGlzIGlzIGNhbGxlZCB3aXRoIGFuIGFic29sdXRlIHBhdGggKGZvciBleGFtcGxlLCBzdGFydGluZyB3aXRoICcvJyBvciAnQzpcXCcpXHJcbiAqIHRoZW4gRXRhIHdpbGwgYXR0ZW1wdCB0byByZXNvbHZlIHRoZSBhYnNvbHV0ZSBwYXRoIHdpdGhpbiBvcHRpb25zLnZpZXdzLiBJZiBpdCBjYW5ub3QsXHJcbiAqIEV0YSB3aWxsIGZhbGxiYWNrIHRvIG9wdGlvbnMucm9vdCBvciAnLydcclxuICpcclxuICogSWYgdGhpcyBpcyBjYWxsZWQgd2l0aCBhIHJlbGF0aXZlIHBhdGgsIEV0YSB3aWxsOlxyXG4gKiAtIExvb2sgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgdGVtcGxhdGUgKGlmIHRoZSBjdXJyZW50IHRlbXBsYXRlIGhhcyB0aGUgYGZpbGVuYW1lYCBwcm9wZXJ0eSlcclxuICogLSBMb29rIGluc2lkZSBlYWNoIGRpcmVjdG9yeSBpbiBvcHRpb25zLnZpZXdzXHJcbiAqXHJcbiAqIE5vdGU6IGlmIEV0YSBpcyB1bmFibGUgdG8gZmluZCBhIHRlbXBsYXRlIHVzaW5nIHBhdGggYW5kIG9wdGlvbnMsIGl0IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqXHJcbiAqIEBwYXJhbSBwYXRoICAgIHNwZWNpZmllZCBwYXRoXHJcbiAqIEBwYXJhbSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHJldHVybiBhYnNvbHV0ZSBwYXRoIHRvIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRQYXRoKHBhdGgsIG9wdGlvbnMpIHtcclxuICAgIHZhciBpbmNsdWRlUGF0aCA9IGZhbHNlO1xyXG4gICAgdmFyIHZpZXdzID0gb3B0aW9ucy52aWV3cztcclxuICAgIHZhciBzZWFyY2hlZFBhdGhzID0gW107XHJcbiAgICAvLyBJZiB0aGVzZSBmb3VyIHZhbHVlcyBhcmUgdGhlIHNhbWUsXHJcbiAgICAvLyBnZXRQYXRoKCkgd2lsbCByZXR1cm4gdGhlIHNhbWUgcmVzdWx0IGV2ZXJ5IHRpbWUuXHJcbiAgICAvLyBXZSBjYW4gY2FjaGUgdGhlIHJlc3VsdCB0byBhdm9pZCBleHBlbnNpdmVcclxuICAgIC8vIGZpbGUgb3BlcmF0aW9ucy5cclxuICAgIHZhciBwYXRoT3B0aW9ucyA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBmaWxlbmFtZTogb3B0aW9ucy5maWxlbmFtZSxcclxuICAgICAgICBwYXRoOiBwYXRoLFxyXG4gICAgICAgIHJvb3Q6IG9wdGlvbnMucm9vdCxcclxuICAgICAgICB2aWV3czogb3B0aW9ucy52aWV3c1xyXG4gICAgfSk7XHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLmZpbGVwYXRoQ2FjaGUgJiYgb3B0aW9ucy5maWxlcGF0aENhY2hlW3BhdGhPcHRpb25zXSkge1xyXG4gICAgICAgIC8vIFVzZSB0aGUgY2FjaGVkIGZpbGVwYXRoXHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZmlsZXBhdGhDYWNoZVtwYXRoT3B0aW9uc107XHJcbiAgICB9XHJcbiAgICAvKiogQWRkIGEgZmlsZXBhdGggdG8gdGhlIGxpc3Qgb2YgcGF0aHMgd2UndmUgY2hlY2tlZCBmb3IgYSB0ZW1wbGF0ZSAqL1xyXG4gICAgZnVuY3Rpb24gYWRkUGF0aFRvU2VhcmNoZWQocGF0aFNlYXJjaGVkKSB7XHJcbiAgICAgICAgaWYgKCFzZWFyY2hlZFBhdGhzLmluY2x1ZGVzKHBhdGhTZWFyY2hlZCkpIHtcclxuICAgICAgICAgICAgc2VhcmNoZWRQYXRocy5wdXNoKHBhdGhTZWFyY2hlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUYWtlIGEgZmlsZXBhdGggKGxpa2UgJ3BhcnRpYWxzL215cGFydGlhbC5ldGEnKS4gQXR0ZW1wdCB0byBmaW5kIHRoZSB0ZW1wbGF0ZSBmaWxlIGluc2lkZSBgdmlld3NgO1xyXG4gICAgICogcmV0dXJuIHRoZSByZXN1bHRpbmcgdGVtcGxhdGUgZmlsZSBwYXRoLCBvciBgZmFsc2VgIHRvIGluZGljYXRlIHRoYXQgdGhlIHRlbXBsYXRlIHdhcyBub3QgZm91bmQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZpZXdzIHRoZSBmaWxlcGF0aCB0aGF0IGhvbGRzIHRlbXBsYXRlcywgb3IgYW4gYXJyYXkgb2YgZmlsZXBhdGhzIHRoYXQgaG9sZCB0ZW1wbGF0ZXNcclxuICAgICAqIEBwYXJhbSBwYXRoIHRoZSBwYXRoIHRvIHRoZSB0ZW1wbGF0ZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzZWFyY2hWaWV3cyh2aWV3cywgcGF0aCkge1xyXG4gICAgICAgIHZhciBmaWxlUGF0aDtcclxuICAgICAgICAvLyBJZiB2aWV3cyBpcyBhbiBhcnJheSwgdGhlbiBsb29wIHRocm91Z2ggZWFjaCBkaXJlY3RvcnlcclxuICAgICAgICAvLyBBbmQgYXR0ZW1wdCB0byBmaW5kIHRoZSB0ZW1wbGF0ZVxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZpZXdzKSAmJlxyXG4gICAgICAgICAgICB2aWV3cy5zb21lKGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlUGF0aCA9IGdldFdob2xlRmlsZVBhdGgocGF0aCwgdiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhpc3RzU3luYyhmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIH0pKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBhYm92ZSByZXR1cm5lZCB0cnVlLCB3ZSBrbm93IHRoYXQgdGhlIGZpbGVQYXRoIHdhcyBqdXN0IHNldCB0byBhIHBhdGhcclxuICAgICAgICAgICAgLy8gVGhhdCBleGlzdHMgKEFycmF5LnNvbWUoKSByZXR1cm5zIGFzIHNvb24gYXMgaXQgZmluZHMgYSB2YWxpZCBlbGVtZW50KVxyXG4gICAgICAgICAgICByZXR1cm4gZmlsZVBhdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2aWV3cyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gU2VhcmNoIGZvciB0aGUgZmlsZSBpZiB2aWV3cyBpcyBhIHNpbmdsZSBkaXJlY3RvcnlcclxuICAgICAgICAgICAgZmlsZVBhdGggPSBnZXRXaG9sZUZpbGVQYXRoKHBhdGgsIHZpZXdzLCB0cnVlKTtcclxuICAgICAgICAgICAgYWRkUGF0aFRvU2VhcmNoZWQoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlUGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBVbmFibGUgdG8gZmluZCBhIGZpbGVcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBQYXRoIHN0YXJ0cyB3aXRoICcvJywgJ0M6XFwnLCBldGMuXHJcbiAgICB2YXIgbWF0Y2ggPSAvXltBLVphLXpdKzpcXFxcfF5cXC8vLmV4ZWMocGF0aCk7XHJcbiAgICAvLyBBYnNvbHV0ZSBwYXRoLCBsaWtlIC9wYXJ0aWFscy9wYXJ0aWFsLmV0YVxyXG4gICAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCkge1xyXG4gICAgICAgIC8vIFdlIGhhdmUgdG8gdHJpbSB0aGUgYmVnaW5uaW5nICcvJyBvZmYgdGhlIHBhdGgsIG9yIGVsc2VcclxuICAgICAgICAvLyBwYXRoLnJlc29sdmUoZGlyLCBwYXRoKSB3aWxsIGFsd2F5cyByZXNvbHZlIHRvIGp1c3QgcGF0aFxyXG4gICAgICAgIHZhciBmb3JtYXR0ZWRQYXRoID0gcGF0aC5yZXBsYWNlKC9eXFwvKi8sICcnKTtcclxuICAgICAgICAvLyBGaXJzdCwgdHJ5IHRvIHJlc29sdmUgdGhlIHBhdGggd2l0aGluIG9wdGlvbnMudmlld3NcclxuICAgICAgICBpbmNsdWRlUGF0aCA9IHNlYXJjaFZpZXdzKHZpZXdzLCBmb3JtYXR0ZWRQYXRoKTtcclxuICAgICAgICBpZiAoIWluY2x1ZGVQYXRoKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoYXQgZmFpbHMsIHNlYXJjaFZpZXdzIHdpbGwgcmV0dXJuIGZhbHNlLiBUcnkgdG8gZmluZCB0aGUgcGF0aFxyXG4gICAgICAgICAgICAvLyBpbnNpZGUgb3B0aW9ucy5yb290IChieSBkZWZhdWx0ICcvJywgdGhlIGJhc2Ugb2YgdGhlIGZpbGVzeXN0ZW0pXHJcbiAgICAgICAgICAgIHZhciBwYXRoRnJvbVJvb3QgPSBnZXRXaG9sZUZpbGVQYXRoKGZvcm1hdHRlZFBhdGgsIG9wdGlvbnMucm9vdCB8fCAnLycsIHRydWUpO1xyXG4gICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChwYXRoRnJvbVJvb3QpO1xyXG4gICAgICAgICAgICBpbmNsdWRlUGF0aCA9IHBhdGhGcm9tUm9vdDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBSZWxhdGl2ZSBwYXRoc1xyXG4gICAgICAgIC8vIExvb2sgcmVsYXRpdmUgdG8gYSBwYXNzZWQgZmlsZW5hbWUgZmlyc3RcclxuICAgICAgICBpZiAob3B0aW9ucy5maWxlbmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZVBhdGggPSBnZXRXaG9sZUZpbGVQYXRoKHBhdGgsIG9wdGlvbnMuZmlsZW5hbWUpO1xyXG4gICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIGlmIChleGlzdHNTeW5jKGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgaW5jbHVkZVBhdGggPSBmaWxlUGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUaGVuIGxvb2sgZm9yIHRoZSB0ZW1wbGF0ZSBpbiBvcHRpb25zLnZpZXdzXHJcbiAgICAgICAgaWYgKCFpbmNsdWRlUGF0aCkge1xyXG4gICAgICAgICAgICBpbmNsdWRlUGF0aCA9IHNlYXJjaFZpZXdzKHZpZXdzLCBwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpbmNsdWRlUGF0aCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoJ0NvdWxkIG5vdCBmaW5kIHRoZSB0ZW1wbGF0ZSBcIicgKyBwYXRoICsgJ1wiLiBQYXRocyB0cmllZDogJyArIHNlYXJjaGVkUGF0aHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIElmIGNhY2hpbmcgYW5kIGZpbGVwYXRoQ2FjaGUgYXJlIGVuYWJsZWQsXHJcbiAgICAvLyBjYWNoZSB0aGUgaW5wdXQgJiBvdXRwdXQgb2YgdGhpcyBmdW5jdGlvbi5cclxuICAgIGlmIChvcHRpb25zLmNhY2hlICYmIG9wdGlvbnMuZmlsZXBhdGhDYWNoZSkge1xyXG4gICAgICAgIG9wdGlvbnMuZmlsZXBhdGhDYWNoZVtwYXRoT3B0aW9uc10gPSBpbmNsdWRlUGF0aDtcclxuICAgIH1cclxuICAgIHJldHVybiBpbmNsdWRlUGF0aDtcclxufVxyXG4vKipcclxuICogUmVhZHMgYSBmaWxlIHN5bmNocm9ub3VzbHlcclxuICovXHJcbmZ1bmN0aW9uIHJlYWRGaWxlKGZpbGVQYXRoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiByZWFkRmlsZVN5bmMoZmlsZVBhdGgpLnRvU3RyaW5nKCkucmVwbGFjZShfQk9NLCAnJyk7IC8vIFRPRE86IGlzIHJlcGxhY2luZyBCT00ncyBuZWNlc3Nhcnk/XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICB0aHJvdyBFdGFFcnIoXCJGYWlsZWQgdG8gcmVhZCB0ZW1wbGF0ZSBhdCAnXCIgKyBmaWxlUGF0aCArIFwiJ1wiKTtcclxuICAgIH1cclxufVxuXG4vLyBleHByZXNzIGlzIHNldCBsaWtlOiBhcHAuZW5naW5lKCdodG1sJywgcmVxdWlyZSgnZXRhJykucmVuZGVyRmlsZSlcclxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBSZWFkcyBhIHRlbXBsYXRlLCBjb21waWxlcyBpdCBpbnRvIGEgZnVuY3Rpb24sIGNhY2hlcyBpdCBpZiBjYWNoaW5nIGlzbid0IGRpc2FibGVkLCByZXR1cm5zIHRoZSBmdW5jdGlvblxyXG4gKlxyXG4gKiBAcGFyYW0gZmlsZVBhdGggQWJzb2x1dGUgcGF0aCB0byB0ZW1wbGF0ZSBmaWxlXHJcbiAqIEBwYXJhbSBvcHRpb25zIEV0YSBjb25maWd1cmF0aW9uIG92ZXJyaWRlc1xyXG4gKiBAcGFyYW0gbm9DYWNoZSBPcHRpb25hbGx5LCBtYWtlIEV0YSBub3QgY2FjaGUgdGhlIHRlbXBsYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBsb2FkRmlsZShmaWxlUGF0aCwgb3B0aW9ucywgbm9DYWNoZSkge1xyXG4gICAgdmFyIGNvbmZpZyA9IGdldENvbmZpZyhvcHRpb25zKTtcclxuICAgIHZhciB0ZW1wbGF0ZSA9IHJlYWRGaWxlKGZpbGVQYXRoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGNvbXBpbGVkVGVtcGxhdGUgPSBjb21waWxlKHRlbXBsYXRlLCBjb25maWcpO1xyXG4gICAgICAgIGlmICghbm9DYWNoZSkge1xyXG4gICAgICAgICAgICBjb25maWcudGVtcGxhdGVzLmRlZmluZShjb25maWcuZmlsZW5hbWUsIGNvbXBpbGVkVGVtcGxhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29tcGlsZWRUZW1wbGF0ZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgRXRhRXJyKCdMb2FkaW5nIGZpbGU6ICcgKyBmaWxlUGF0aCArICcgZmFpbGVkOlxcblxcbicgKyBlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBHZXQgdGhlIHRlbXBsYXRlIGZyb20gYSBzdHJpbmcgb3IgYSBmaWxlLCBlaXRoZXIgY29tcGlsZWQgb24tdGhlLWZseSBvclxyXG4gKiByZWFkIGZyb20gY2FjaGUgKGlmIGVuYWJsZWQpLCBhbmQgY2FjaGUgdGhlIHRlbXBsYXRlIGlmIG5lZWRlZC5cclxuICpcclxuICogSWYgYG9wdGlvbnMuY2FjaGVgIGlzIHRydWUsIHRoaXMgZnVuY3Rpb24gcmVhZHMgdGhlIGZpbGUgZnJvbVxyXG4gKiBgb3B0aW9ucy5maWxlbmFtZWAgc28gaXQgbXVzdCBiZSBzZXQgcHJpb3IgdG8gY2FsbGluZyB0aGlzIGZ1bmN0aW9uLlxyXG4gKlxyXG4gKiBAcGFyYW0gb3B0aW9ucyAgIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHJldHVybiBFdGEgdGVtcGxhdGUgZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZUNhY2hlKG9wdGlvbnMpIHtcclxuICAgIHZhciBmaWxlbmFtZSA9IG9wdGlvbnMuZmlsZW5hbWU7XHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSkge1xyXG4gICAgICAgIHZhciBmdW5jID0gb3B0aW9ucy50ZW1wbGF0ZXMuZ2V0KGZpbGVuYW1lKTtcclxuICAgICAgICBpZiAoZnVuYykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuYztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGxvYWRGaWxlKGZpbGVuYW1lLCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIC8vIENhY2hpbmcgaXMgZGlzYWJsZWQsIHNvIHBhc3Mgbm9DYWNoZSA9IHRydWVcclxuICAgIHJldHVybiBsb2FkRmlsZShmaWxlbmFtZSwgb3B0aW9ucywgdHJ1ZSk7XHJcbn1cclxuLyoqXHJcbiAqIFRyeSBjYWxsaW5nIGhhbmRsZUNhY2hlIHdpdGggdGhlIGdpdmVuIG9wdGlvbnMgYW5kIGRhdGEgYW5kIGNhbGwgdGhlXHJcbiAqIGNhbGxiYWNrIHdpdGggdGhlIHJlc3VsdC4gSWYgYW4gZXJyb3Igb2NjdXJzLCBjYWxsIHRoZSBjYWxsYmFjayB3aXRoXHJcbiAqIHRoZSBlcnJvci4gVXNlZCBieSByZW5kZXJGaWxlKCkuXHJcbiAqXHJcbiAqIEBwYXJhbSBkYXRhIHRlbXBsYXRlIGRhdGFcclxuICogQHBhcmFtIG9wdGlvbnMgY29tcGlsYXRpb24gb3B0aW9uc1xyXG4gKiBAcGFyYW0gY2IgY2FsbGJhY2tcclxuICovXHJcbmZ1bmN0aW9uIHRyeUhhbmRsZUNhY2hlKGRhdGEsIG9wdGlvbnMsIGNiKSB7XHJcbiAgICBpZiAoY2IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBOb3RlOiBpZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSByZW5kZXJpbmcgdGhlIHRlbXBsYXRlLFxyXG4gICAgICAgICAgICAvLyBJdCB3aWxsIGJ1YmJsZSB1cCBhbmQgYmUgY2F1Z2h0IGhlcmVcclxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZShvcHRpb25zKTtcclxuICAgICAgICAgICAgdGVtcGxhdGVGbihkYXRhLCBvcHRpb25zLCBjYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gTm8gY2FsbGJhY2ssIHRyeSByZXR1cm5pbmcgYSBwcm9taXNlXHJcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlSW1wbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IHByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZShvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGVtcGxhdGVGbihkYXRhLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgRXRhRXJyKFwiUGxlYXNlIHByb3ZpZGUgYSBjYWxsYmFjayBmdW5jdGlvbiwgdGhpcyBlbnYgZG9lc24ndCBzdXBwb3J0IFByb21pc2VzXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2V0IHRoZSB0ZW1wbGF0ZSBmdW5jdGlvbi5cclxuICpcclxuICogSWYgYG9wdGlvbnMuY2FjaGVgIGlzIGB0cnVlYCwgdGhlbiB0aGUgdGVtcGxhdGUgaXMgY2FjaGVkLlxyXG4gKlxyXG4gKiBUaGlzIHJldHVybnMgYSB0ZW1wbGF0ZSBmdW5jdGlvbiBhbmQgdGhlIGNvbmZpZyBvYmplY3Qgd2l0aCB3aGljaCB0aGF0IHRlbXBsYXRlIGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqXHJcbiAqIEl0J3MgaW1wb3J0YW50IHRoYXQgdGhpcyByZXR1cm5zIGEgY29uZmlnIG9iamVjdCB3aXRoIGBmaWxlbmFtZWAgc2V0LlxyXG4gKiBPdGhlcndpc2UsIHRoZSBpbmNsdWRlZCBmaWxlIHdvdWxkIG5vdCBiZSBhYmxlIHRvIHVzZSByZWxhdGl2ZSBwYXRoc1xyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aCBwYXRoIGZvciB0aGUgc3BlY2lmaWVkIGZpbGUgKGlmIHJlbGF0aXZlLCBzcGVjaWZ5IGB2aWV3c2Agb24gYG9wdGlvbnNgKVxyXG4gKiBAcGFyYW0gb3B0aW9ucyBjb21waWxhdGlvbiBvcHRpb25zXHJcbiAqIEByZXR1cm4gW0V0YSB0ZW1wbGF0ZSBmdW5jdGlvbiwgbmV3IGNvbmZpZyBvYmplY3RdXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlRmlsZShwYXRoLCBvcHRpb25zKSB7XHJcbiAgICAvLyB0aGUgYmVsb3cgY3JlYXRlcyBhIG5ldyBvcHRpb25zIG9iamVjdCwgdXNpbmcgdGhlIHBhcmVudCBmaWxlcGF0aCBvZiB0aGUgb2xkIG9wdGlvbnMgb2JqZWN0IGFuZCB0aGUgcGF0aFxyXG4gICAgdmFyIG5ld0ZpbGVPcHRpb25zID0gZ2V0Q29uZmlnKHsgZmlsZW5hbWU6IGdldFBhdGgocGF0aCwgb3B0aW9ucykgfSwgb3B0aW9ucyk7XHJcbiAgICAvLyBUT0RPOiBtYWtlIHN1cmUgcHJvcGVydGllcyBhcmUgY3VycmVjdGx5IGNvcGllZCBvdmVyXHJcbiAgICByZXR1cm4gW2hhbmRsZUNhY2hlKG5ld0ZpbGVPcHRpb25zKSwgbmV3RmlsZU9wdGlvbnNdO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckZpbGUoZmlsZW5hbWUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIC8qXHJcbiAgICBIZXJlIHdlIGhhdmUgc29tZSBmdW5jdGlvbiBvdmVybG9hZGluZy5cclxuICAgIEVzc2VudGlhbGx5LCB0aGUgZmlyc3QgMiBhcmd1bWVudHMgdG8gcmVuZGVyRmlsZSBzaG91bGQgYWx3YXlzIGJlIHRoZSBmaWxlbmFtZSBhbmQgZGF0YVxyXG4gICAgSG93ZXZlciwgd2l0aCBFeHByZXNzLCBjb25maWd1cmF0aW9uIG9wdGlvbnMgd2lsbCBiZSBwYXNzZWQgYWxvbmcgd2l0aCB0aGUgZGF0YS5cclxuICAgIFRodXMsIEV4cHJlc3Mgd2lsbCBjYWxsIHJlbmRlckZpbGUgd2l0aCAoZmlsZW5hbWUsIGRhdGFBbmRPcHRpb25zLCBjYilcclxuICAgIEFuZCB3ZSB3YW50IHRvIGFsc28gbWFrZSAoZmlsZW5hbWUsIGRhdGEsIG9wdGlvbnMsIGNiKSBhdmFpbGFibGVcclxuICAgICovXHJcbiAgICB2YXIgcmVuZGVyQ29uZmlnO1xyXG4gICAgdmFyIGNhbGxiYWNrO1xyXG4gICAgZGF0YSA9IGRhdGEgfHwge307IC8vIElmIGRhdGEgaXMgdW5kZWZpbmVkLCB3ZSBkb24ndCB3YW50IGFjY2Vzc2luZyBkYXRhLnNldHRpbmdzIHRvIGVycm9yXHJcbiAgICAvLyBGaXJzdCwgYXNzaWduIG91ciBjYWxsYmFjayBmdW5jdGlvbiB0byBgY2FsbGJhY2tgXHJcbiAgICAvLyBXZSBjYW4gbGVhdmUgaXQgdW5kZWZpbmVkIGlmIG5laXRoZXIgcGFyYW1ldGVyIGlzIGEgZnVuY3Rpb247XHJcbiAgICAvLyBDYWxsYmFja3MgYXJlIG9wdGlvbmFsXHJcbiAgICBpZiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgLy8gVGhlIDR0aCBhcmd1bWVudCBpcyB0aGUgY2FsbGJhY2tcclxuICAgICAgICBjYWxsYmFjayA9IGNiO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIC8vIFRoZSAzcmQgYXJnIGlzIHRoZSBjYWxsYmFja1xyXG4gICAgICAgIGNhbGxiYWNrID0gY29uZmlnO1xyXG4gICAgfVxyXG4gICAgLy8gSWYgdGhlcmUgaXMgYSBjb25maWcgb2JqZWN0IHBhc3NlZCBpbiBleHBsaWNpdGx5LCB1c2UgaXRcclxuICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIHJlbmRlckNvbmZpZyA9IGdldENvbmZpZyhjb25maWcgfHwge30pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBnZXQgdGhlIGNvbmZpZyBmcm9tIHRoZSBkYXRhIG9iamVjdFxyXG4gICAgICAgIC8vIEFuZCB0aGVuIGdyYWIgc29tZSBjb25maWcgb3B0aW9ucyBmcm9tIGRhdGEuc2V0dGluZ3NcclxuICAgICAgICAvLyBXaGljaCBpcyB3aGVyZSBFeHByZXNzIHNvbWV0aW1lcyBzdG9yZXMgdGhlbVxyXG4gICAgICAgIHJlbmRlckNvbmZpZyA9IGdldENvbmZpZyhkYXRhKTtcclxuICAgICAgICBpZiAoZGF0YS5zZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBQdWxsIGEgZmV3IHRoaW5ncyBmcm9tIGtub3duIGxvY2F0aW9uc1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5ncy52aWV3cykge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyQ29uZmlnLnZpZXdzID0gZGF0YS5zZXR0aW5ncy52aWV3cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5nc1sndmlldyBjYWNoZSddKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJDb25maWcuY2FjaGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFVuZG9jdW1lbnRlZCBhZnRlciBFeHByZXNzIDIsIGJ1dCBzdGlsbCB1c2FibGUsIGVzcC4gZm9yXHJcbiAgICAgICAgICAgIC8vIGl0ZW1zIHRoYXQgYXJlIHVuc2FmZSB0byBiZSBwYXNzZWQgYWxvbmcgd2l0aCBkYXRhLCBsaWtlIGByb290YFxyXG4gICAgICAgICAgICB2YXIgdmlld09wdHMgPSBkYXRhLnNldHRpbmdzWyd2aWV3IG9wdGlvbnMnXTtcclxuICAgICAgICAgICAgaWYgKHZpZXdPcHRzKSB7XHJcbiAgICAgICAgICAgICAgICBjb3B5UHJvcHMocmVuZGVyQ29uZmlnLCB2aWV3T3B0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBTZXQgdGhlIGZpbGVuYW1lIG9wdGlvbiBvbiB0aGUgdGVtcGxhdGVcclxuICAgIC8vIFRoaXMgd2lsbCBmaXJzdCB0cnkgdG8gcmVzb2x2ZSB0aGUgZmlsZSBwYXRoIChzZWUgZ2V0UGF0aCBmb3IgZGV0YWlscylcclxuICAgIHJlbmRlckNvbmZpZy5maWxlbmFtZSA9IGdldFBhdGgoZmlsZW5hbWUsIHJlbmRlckNvbmZpZyk7XHJcbiAgICByZXR1cm4gdHJ5SGFuZGxlQ2FjaGUoZGF0YSwgcmVuZGVyQ29uZmlnLCBjYWxsYmFjayk7XHJcbn1cclxuZnVuY3Rpb24gcmVuZGVyRmlsZUFzeW5jKGZpbGVuYW1lLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICByZXR1cm4gcmVuZGVyRmlsZShmaWxlbmFtZSwgdHlwZW9mIGNvbmZpZyA9PT0gJ2Z1bmN0aW9uJyA/IF9fYXNzaWduKF9fYXNzaWduKHt9LCBkYXRhKSwgeyBhc3luYzogdHJ1ZSB9KSA6IGRhdGEsIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnID8gX19hc3NpZ24oX19hc3NpZ24oe30sIGNvbmZpZyksIHsgYXN5bmM6IHRydWUgfSkgOiBjb25maWcsIGNiKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIENhbGxlZCB3aXRoIGBpbmNsdWRlRmlsZShwYXRoLCBkYXRhKWBcclxuICovXHJcbmZ1bmN0aW9uIGluY2x1ZGVGaWxlSGVscGVyKHBhdGgsIGRhdGEpIHtcclxuICAgIHZhciB0ZW1wbGF0ZUFuZENvbmZpZyA9IGluY2x1ZGVGaWxlKHBhdGgsIHRoaXMpO1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlQW5kQ29uZmlnWzBdKGRhdGEsIHRlbXBsYXRlQW5kQ29uZmlnWzFdKTtcclxufVxuXG4vKiBFTkQgVFlQRVMgKi9cclxuZnVuY3Rpb24gaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUgJiYgb3B0aW9ucy5uYW1lICYmIG9wdGlvbnMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudGVtcGxhdGVzLmdldChvcHRpb25zLm5hbWUpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRlbXBsYXRlRnVuYyA9IHR5cGVvZiB0ZW1wbGF0ZSA9PT0gJ2Z1bmN0aW9uJyA/IHRlbXBsYXRlIDogY29tcGlsZSh0ZW1wbGF0ZSwgb3B0aW9ucyk7XHJcbiAgICAvLyBOb3RlIHRoYXQgd2UgZG9uJ3QgaGF2ZSB0byBjaGVjayBpZiBpdCBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgY2FjaGU7XHJcbiAgICAvLyBpdCB3b3VsZCBoYXZlIHJldHVybmVkIGVhcmxpZXIgaWYgaXQgaGFkXHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLm5hbWUpIHtcclxuICAgICAgICBvcHRpb25zLnRlbXBsYXRlcy5kZWZpbmUob3B0aW9ucy5uYW1lLCB0ZW1wbGF0ZUZ1bmMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBsYXRlRnVuYztcclxufVxyXG4vKipcclxuICogUmVuZGVyIGEgdGVtcGxhdGVcclxuICpcclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIHN0cmluZywgRXRhIHdpbGwgY29tcGlsZSBpdCB0byBhIGZ1bmN0aW9uIGFuZCB0aGVuIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIHRlbXBsYXRlIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIGl0IHdpdGggdGhlIHByb3ZpZGVkIGRhdGEuXHJcbiAqXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGBmYWxzZWAsIEV0YSB3aWxsIHJldHVybiB0aGUgcmVuZGVyZWQgdGVtcGxhdGUuXHJcbiAqXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGB0cnVlYCBhbmQgdGhlcmUncyBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIHRoZSBjYWxsYmFjayB3aXRoIGAoZXJyLCByZW5kZXJlZFRlbXBsYXRlKWAuXHJcbiAqIElmIGBjb25maWcuYXN5bmNgIGlzIGB0cnVlYCBhbmQgdGhlcmUncyBub3QgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSByZW5kZXJlZCB0ZW1wbGF0ZS5cclxuICpcclxuICogSWYgYGNvbmZpZy5jYWNoZWAgaXMgYHRydWVgIGFuZCBgY29uZmlnYCBoYXMgYSBgbmFtZWAgb3IgYGZpbGVuYW1lYCBwcm9wZXJ0eSwgRXRhIHdpbGwgY2FjaGUgdGhlIHRlbXBsYXRlIG9uIHRoZSBmaXJzdCByZW5kZXIgYW5kIHVzZSB0aGUgY2FjaGVkIHRlbXBsYXRlIGZvciBhbGwgc3Vic2VxdWVudCByZW5kZXJzLlxyXG4gKlxyXG4gKiBAcGFyYW0gdGVtcGxhdGUgVGVtcGxhdGUgc3RyaW5nIG9yIHRlbXBsYXRlIGZ1bmN0aW9uXHJcbiAqIEBwYXJhbSBkYXRhIERhdGEgdG8gcmVuZGVyIHRoZSB0ZW1wbGF0ZSB3aXRoXHJcbiAqIEBwYXJhbSBjb25maWcgT3B0aW9uYWwgY29uZmlnIG9wdGlvbnNcclxuICogQHBhcmFtIGNiIENhbGxiYWNrIGZ1bmN0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXIodGVtcGxhdGUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIHZhciBvcHRpb25zID0gZ2V0Q29uZmlnKGNvbmZpZyB8fCB7fSk7XHJcbiAgICBpZiAob3B0aW9ucy5hc3luYykge1xyXG4gICAgICAgIGlmIChjYikge1xyXG4gICAgICAgICAgICAvLyBJZiB1c2VyIHBhc3NlcyBjYWxsYmFja1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gTm90ZTogaWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcmVuZGVyaW5nIHRoZSB0ZW1wbGF0ZSxcclxuICAgICAgICAgICAgICAgIC8vIEl0IHdpbGwgYnViYmxlIHVwIGFuZCBiZSBjYXVnaHQgaGVyZVxyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlRm4gPSBoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlRm4oZGF0YSwgb3B0aW9ucywgY2IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYihlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBObyBjYWxsYmFjaywgdHJ5IHJldHVybmluZyBhIHByb21pc2VcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlSW1wbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBwcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKShkYXRhLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFdGFFcnIoXCJQbGVhc2UgcHJvdmlkZSBhIGNhbGxiYWNrIGZ1bmN0aW9uLCB0aGlzIGVudiBkb2Vzbid0IHN1cHBvcnQgUHJvbWlzZXNcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gaGFuZGxlQ2FjaGUkMSh0ZW1wbGF0ZSwgb3B0aW9ucykoZGF0YSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFJlbmRlciBhIHRlbXBsYXRlIGFzeW5jaHJvbm91c2x5XHJcbiAqXHJcbiAqIElmIGB0ZW1wbGF0ZWAgaXMgYSBzdHJpbmcsIEV0YSB3aWxsIGNvbXBpbGUgaXQgdG8gYSBmdW5jdGlvbiBhbmQgY2FsbCBpdCB3aXRoIHRoZSBwcm92aWRlZCBkYXRhLlxyXG4gKiBJZiBgdGVtcGxhdGVgIGlzIGEgZnVuY3Rpb24sIEV0YSB3aWxsIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICpcclxuICogSWYgdGhlcmUgaXMgYSBjYWxsYmFjayBmdW5jdGlvbiwgRXRhIHdpbGwgY2FsbCBpdCB3aXRoIGAoZXJyLCByZW5kZXJlZFRlbXBsYXRlKWAuXHJcbiAqIElmIHRoZXJlIGlzIG5vdCBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlbmRlcmVkIHRlbXBsYXRlXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZW1wbGF0ZSBUZW1wbGF0ZSBzdHJpbmcgb3IgdGVtcGxhdGUgZnVuY3Rpb25cclxuICogQHBhcmFtIGRhdGEgRGF0YSB0byByZW5kZXIgdGhlIHRlbXBsYXRlIHdpdGhcclxuICogQHBhcmFtIGNvbmZpZyBPcHRpb25hbCBjb25maWcgb3B0aW9uc1xyXG4gKiBAcGFyYW0gY2IgQ2FsbGJhY2sgZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIHJlbmRlckFzeW5jKHRlbXBsYXRlLCBkYXRhLCBjb25maWcsIGNiKSB7XHJcbiAgICAvLyBVc2luZyBPYmplY3QuYXNzaWduIHRvIGxvd2VyIGJ1bmRsZSBzaXplLCB1c2luZyBzcHJlYWQgb3BlcmF0b3IgbWFrZXMgaXQgbGFyZ2VyIGJlY2F1c2Ugb2YgdHlwZXNjcmlwdCBpbmplY3RlZCBwb2x5ZmlsbHNcclxuICAgIHJldHVybiByZW5kZXIodGVtcGxhdGUsIGRhdGEsIE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZywgeyBhc3luYzogdHJ1ZSB9KSwgY2IpO1xyXG59XG5cbi8vIEBkZW5vaWZ5LWlnbm9yZVxyXG5jb25maWcuaW5jbHVkZUZpbGUgPSBpbmNsdWRlRmlsZUhlbHBlcjtcclxuY29uZmlnLmZpbGVwYXRoQ2FjaGUgPSB7fTtcblxuZXhwb3J0IHsgcmVuZGVyRmlsZSBhcyBfX2V4cHJlc3MsIGNvbXBpbGUsIGNvbXBpbGVUb1N0cmluZywgY29uZmlnLCBjb25maWd1cmUsIGNvbmZpZyBhcyBkZWZhdWx0Q29uZmlnLCBnZXRDb25maWcsIGxvYWRGaWxlLCBwYXJzZSwgcmVuZGVyLCByZW5kZXJBc3luYywgcmVuZGVyRmlsZSwgcmVuZGVyRmlsZUFzeW5jLCB0ZW1wbGF0ZXMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV0YS5lcy5qcy5tYXBcbiIsImltcG9ydCB7IEFyZ1NldCB9IGZyb20gXCIuL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY29uc3QgVkFSX05BTUU6IHN0cmluZyA9ICdzaydcclxuXHJcbmV4cG9ydCBjb25zdCBERUxJTUlURVJTOiBBcmdTZXQgPSB7XHJcblx0XCJQQVNTX1ZBTFVFXCI6IFtcIjpcIl1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFNLX0RFUFRIX0xJTUlUID0gNTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbnVtIE1vZGVzIHtcclxuXHRnZW5lcmFsID0gXCJHRU5FUkFMXCIsXHJcblx0YmxvY2sgPSBcIkJMT0NLXCIsXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlbnVtIEZsYWdzIHtcclxuXHRub25lID0gMCxcclxuXHR0ZW1wbGF0ZSA9IDEsXHJcblx0aW50ZXJwID0gMixcclxuXHRyYXcgPSAzLFxyXG5cdGxpdGVyYWwgPSA0LFxyXG5cdGV2YWwgPSA1XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBFQkFSID0gYFxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcbmAiLCJpbXBvcnQgeyBBcHAsIE1hcmtkb3duVmlldywgbm9ybWFsaXplUGF0aCwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIFRGb2xkZXIsIFZhdWx0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEVCQVIgfSBmcm9tIFwiLi90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXggfSBmcm9tIFwiLi90eXBlcy90eXBlc1wiO1xyXG5cclxuZGVjbGFyZSBnbG9iYWwge1xyXG5cdGludGVyZmFjZSBFbGVtZW50IHtcclxuXHRcdGFkZENsYXp6KHRoaXM6IEVsZW1lbnQsIHN0cjogc3RyaW5nIHwgc3RyaW5nW10pOiB2b2lkO1xyXG5cdFx0YWRkQ2xhenoodGhpczogRWxlbWVudCwgLi4uc3RyOiBzdHJpbmdbXSk6IHZvaWQ7XHJcblx0fVxyXG59XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5hZGRDbGF6eiA9IGZ1bmN0aW9uIChzdHI6IHN0cmluZyB8IHN0cmluZ1tdKSB7XHJcblx0aWYgKEFycmF5LmlzQXJyYXkoc3RyKSkge1xyXG5cdFx0dGhpcy5hZGRDbGFzcyguLi5zdHIpXHJcblx0fSBlbHNlIHRoaXMuYWRkQ2xhc3Moc3RyKVxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVuc3VyZUFycmF5PFQ+KG9iajogVCB8IFRbXSk6IEFycmF5PFQ+IHtcclxuXHRyZXR1cm4gQXJyYXkuaXNBcnJheShvYmopID8gb2JqIDogW29ial1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVzKGFwcDogQXBwLCBkaXI6IHN0cmluZyk6IFRGaWxlW10ge1xyXG5cdGxldCBkaXJQYXRoID0gbm9ybWFsaXplUGF0aChkaXIpXHJcblx0bGV0IGZvID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkaXJQYXRoKTtcclxuXHJcblx0aWYgKCFmbyB8fCAhKGZvIGluc3RhbmNlb2YgVEZvbGRlcikpIHRocm93IGBTa3JpYmk6IENvdWxkIG5vdCBmaW5kIGZvbGRlciAnJHtkaXJQYXRofSdgO1xyXG5cclxuXHRsZXQgZmlsZXM6IFRGaWxlW10gPSBbXTtcclxuXHRWYXVsdC5yZWN1cnNlQ2hpbGRyZW4oZm8sIChmaSkgPT4ge1xyXG5cdFx0aWYgKGZpIGluc3RhbmNlb2YgVEZpbGUpIGZpbGVzLnB1c2goZmkpXHJcblx0fSlcclxuXHJcblx0Ly8gY29uc29sZS5sb2coZmlsZXMpXHJcblx0cmV0dXJuIGZpbGVzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tGaWxlRXh0KGZpbGVzOiBURmlsZVtdIHwgVEZpbGUsIGV4dHM6IHN0cmluZ1tdIHwgc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0ZXh0cyA9IHRvQXJyYXkoZXh0cyk7IFxyXG5cdHJldHVybiB0b0FycmF5KGZpbGVzKS5ldmVyeSgoZikgPT4ge3JldHVybiBleHRzLmNvbnRhaW5zKGYuZXh0ZW5zaW9uKX0pXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJGaWxlRXh0KGZpbGVzOiBURmlsZVtdIHwgVEZpbGUsIGV4dHM6IHN0cmluZ1tdIHwgc3RyaW5nKTogVEZpbGVbXSB7XHJcblx0ZXh0cyA9IHRvQXJyYXkoZXh0cylcclxuXHRyZXR1cm4gdG9BcnJheShmaWxlcykuZmlsdGVyKChmKSA9PiB7aWYgKGNoZWNrRmlsZUV4dChmLCBleHRzKSkgcmV0dXJuIGZ9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheShhcmdzOiBhbnkgfCBhbnlbXSk6IGFueVtdIHtcclxuXHRyZXR1cm4gKEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNJbkZvbGRlcihlOiBUQWJzdHJhY3RGaWxlLCBkaXI6IHN0cmluZykge1xyXG5cdGxldCBib28gPSAobm9ybWFsaXplUGF0aCgoLy4rXFwvL2cpLmV4ZWMoZS5wYXRoKVswXSkgPT0gbm9ybWFsaXplUGF0aChkaXIpKVxyXG5cclxuXHRyZXR1cm4gYm9vXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGFudChvYmo6IGFueSkge1xyXG5cdHJldHVybiAhKChvYmogPT09IG51bGwgKSB8fCAob2JqID09PSB1bmRlZmluZWQpKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm91bmRUbyh4OiBhbnksIHRvPzogbnVtYmVyKTogbnVtYmVyIHtcclxuICByZXR1cm4gcGFyc2VGbG9hdChwYXJzZUZsb2F0KHgpLnRvUHJlY2lzaW9uKHRvID8/IDQpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VmVyYm9zaXR5KCkge1xyXG5cdC8vQHRzLWlnbm9yZVxyXG5cdHJldHVybiB3aW5kb3cuYXBwLnBsdWdpbnMucGx1Z2luc1tcIm9ic2lkaWFuLXNrcmliaVwiXT8uc2V0dGluZ3MudmVyYm9zZUxvZ2dpbmcgfHwgZmFsc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2TG9nKC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0aWYgKGdldFZlcmJvc2l0eSgpKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcIlNrcmliaTpcIiwgLi4uYXJncyApXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdldhcm4oLi4uYXJnczogYW55W10pIHtcclxuXHRpZiAoZ2V0VmVyYm9zaXR5KCkpIHtcclxuXHRcdGNvbnNvbGUud2FybihcIlNrcmliaTpcIiwgLi4uYXJncylcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkTG9nKC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0Ly9AdHMtaWdub3JlXHJcblx0aWYgKHdpbmRvdz8uYXBwLnBsdWdpbnMucGx1Z2luc1tcIm9ic2lkaWFuLXNrcmliaVwiXT8uc2V0dGluZ3M/LmRldkxvZ2dpbmcgfHwgZmFsc2UpIHtcclxuXHRcdGNvbnNvbGUubG9nKC4uLmFyZ3MpXHJcblx0fVxyXG59XHJcblxyXG4vKiBUYWtlcyBhbiBhcnJheSBvZiBzdHJpbmdzIGFuZCByZXR1cm5zIGEgcmVjb3JkIG9mIGtleS92YWx1ZSBwYWlycyBmb3IgZWFjaCwgd2hlcmUgdGhlIGtleSBhbmQgdmFsdWUgYXJlIHRoZSBzYW1lICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0b0R1cGVSZWNvcmQoYXJyOiBzdHJpbmdbXSk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xyXG4gIHJldHVybiBhcnIucmVkdWNlKChhLCBpKSA9PiAoey4uLmEsIFtpXTogaX0pLCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KVxyXG59XHJcblxyXG4vKiogXHJcbiAqIEBwYXJhbSBpbnB1dCBBbiBvYmplY3QgdG8gY2xvbmVcclxuICogQHBhcmFtIGtleXMgVGhlIGtleXMgb2YgcHJvcGVydGllcyB0byBvbWl0IGZyb20gdGhlIGNsb25lXHJcbiAqIEByZXR1cm5zIEEgY2xvbmUgb2YgJ2lucHV0JyB3aXRob3V0IHRoZSBvbWl0dGVkIHByb3BlcnRpZXMgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhvdXRLZXk8VCBleHRlbmRzIHsgW0sgaW4ga2V5b2YgVF06IHN0cmluZyB8IG51bWJlciB8IHN5bWJvbCB9PihpbnB1dDoge1tpbmRleDogc3RyaW5nXTogYW55fSwga2V5OiBzdHJpbmcgfCBzdHJpbmdbXSkge1xyXG4gIGNvbnN0IGNsb25lID0geyAuLi5pbnB1dCB9O1xyXG4gIGlmIChBcnJheS5pc0FycmF5KGtleSkpIHtcclxuICAgICAgKGtleSBhcyBzdHJpbmdbXSkuZm9yRWFjaCgoaykgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlIGNsb25lW2tdXHJcbiAgICAgIH0pXHJcbiAgfSBlbHNlIHsgZGVsZXRlIGNsb25lW2tleV0gfVxyXG4gIHJldHVybiBjbG9uZTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGFzeW5jRnVuYyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihhc3luYyBmdW5jdGlvbigpe30pLmNvbnN0cnVjdG9yXHJcbmV4cG9ydCBjb25zdCBwcm9taXNlSW1wbDogUHJvbWlzZUNvbnN0cnVjdG9yID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCkuUHJvbWlzZVxyXG5leHBvcnQgY29uc3QgZ2V0QXN5bmNDb25zdHJ1Y3RvciA9ICgpOiBGdW5jdGlvbkNvbnN0cnVjdG9yID0+IG5ldyBGdW5jdGlvbigncmV0dXJuIChhc3luYyBmdW5jdGlvbigpe30pLmNvbnN0cnVjdG9yJykoKVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSBBcHBcclxuICogQHBhcmFtIGZsaXAgSWYgdHJ1ZSwgdGFyZ2V0IGlzIGVkaXRvciBtb2RlLiBPdGhlcndpc2UsIHRhcmdldCBpcyBwcmV2aWV3IG1vZGUuXHJcbiAqIEByZXR1cm5zIEZpcnN0IG1hcmtkb3duIHZpZXcgb2YgdGFyZ2V0IG1vZGUgd2l0aCBzYW1lIGZpbGUgYXMgYWN0aXZlIHZpZXcsIG9yIGFjdGl2ZSB2aWV3IGlmIG5vbmUgd2FzIGZvdW5kLiBOdWxsIGlmIG5vIGFjdGl2ZSB2aWV3IGV4aXN0cy4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXZpZXdWaWV3KGFwcDogQXBwLCBmbGlwPzogYm9vbGVhbik6IE1hcmtkb3duVmlldyB8IG51bGwge1xyXG5cdGxldCB0MSA9IGZsaXAgPyBcInByZXZpZXdcIiA6IFwic291cmNlXCJcclxuXHRsZXQgdDIgPSBmbGlwID8gXCJzb3VyY2VcIiA6IFwicHJldmlld1wiXHJcblxyXG5cdHRyeSB7XHJcblx0dmFyIHZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRpZiAodmlldy5nZXRNb2RlKCkgPT0gdDEpIHtcclxuXHRcdGFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIikuZm9yRWFjaCgobGVhZikgPT4ge1xyXG5cdFx0XHRpZiAoKGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLmdldE1vZGUoKSA9PSB0Mikge1xyXG5cdFx0XHRcdGxldCB6ID0gKGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLnByZXZpZXdNb2RlXHJcblx0XHRcdFx0aWYgKHouZ2V0RmlsZSgpID09IHZpZXcuZmlsZSkge1xyXG5cdFx0XHRcdFx0dmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXdcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0fVxyXG5cdH0gY2F0Y2ggKGUpIHtcclxuXHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdmlldyB8fCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgaXNGdW5jID0gKGZ1bmM6IGFueSk6IGZ1bmMgaXMgRnVuY3Rpb24gPT4gKGZ1bmMgaW5zdGFuY2VvZiBGdW5jdGlvbilcclxuZXhwb3J0IGNvbnN0IGlzRmlsZSA9IChpdGVtOiBhbnkpOiBpdGVtIGlzIFRGaWxlID0+IChpdGVtKSBpbnN0YW5jZW9mIFRGaWxlOyBcclxuXHJcbmZ1bmN0aW9uIGludm9rZU1ldGhvZE9mQW5kUmV0dXJuPFQ+KGZ1bmM6IGtleW9mIFQsIG9iamVjdHM6IFN0cmluZ2RleDxUPikge1xyXG4gIGxldCByZXRzOiBTdHJpbmdkZXggPSB7fTtcclxuICBmb3IgKGxldCBvIG9mIE9iamVjdC5lbnRyaWVzKG9iamVjdHMpKSB7XHJcbiAgICBpZiAoKG8gIT0gbnVsbCkgJiYgKGlzRnVuYyhvW2Z1bmNdKSkpIHtcclxuICAgICAgcmV0c1tvWzBdXSA9IChvWzFdW2Z1bmNdIGFzIEZ1bmN0aW9uKSgpXHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiByZXRzXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIE5vblVuZGVmaW5lZDxBPiA9IEEgZXh0ZW5kcyB1bmRlZmluZWQgPyBuZXZlciA6IEE7XHJcbmV4cG9ydCB0eXBlIEZ1bmN0aW9uS2V5czxUIGV4dGVuZHMgb2JqZWN0PiA9IHtcclxuICBbSyBpbiBrZXlvZiBUXS0/OiBOb25VbmRlZmluZWQ8VFtLXT4gZXh0ZW5kcyBGdW5jdGlvbiA/IEsgOiBuZXZlcjtcclxufVtrZXlvZiBUXTtcclxuXHJcbnR5cGUgUGFyYW1ldGVyc09mPFQgZXh0ZW5kcyAoLi4uYXJnczogYW55KSA9PiBhbnk+ID0ge1xyXG5cdFtQIGluIGtleW9mIFBhcmFtZXRlcnM8VD5dLT86IFBhcmFtZXRlcnM8VD59W2tleW9mIFRdO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGludm9rZU1ldGhvZE9mPFQ+KGZ1bmM6IGtleW9mIFQsIC4uLm9iamVjdHM6IFRbXSkge1xyXG5cdGZvciAobGV0IG8gb2Ygb2JqZWN0cykge1xyXG4gICAgaWYgKChvICE9IG51bGwpICYmIChpc0Z1bmMob1tmdW5jXSkpKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgKG9bZnVuY10gYXMgdW5rbm93biBhcyBGdW5jdGlvbikoKVxyXG4gICAgICB9IGNhdGNoKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgaW52b2tlTWV0aG9kT2Y6IGNhdWdodCBlcnJvciEgXFxuYCwgYEtleSBjYWxsZWQgYXMgbWV0aG9kOmAsIGZ1bmMsICBgQ2FsbGVkIG9uOmAsIG8sIGBFcnJvcjpgLCBlcnIpXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnZva2VNZXRob2RXaXRoPFQgZXh0ZW5kcyBvYmplY3Q+KG9iamVjdHM6IFQgfCBUW10sIGtleTogRnVuY3Rpb25LZXlzPFQ+LCAuLi5hcmdzOiAvKiBQYXJhbWV0ZXJzT2Y8VFtrZXldPiAqLyBhbnlbXSk6IHZvaWQge1xyXG5cdGZvciAobGV0IG8gb2YgZW5zdXJlQXJyYXkob2JqZWN0cykpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdChvW2tleV0gYXMgdW5rbm93biBhcyBGdW5jdGlvbikoLi4uYXJncylcclxuXHRcdH0gY2F0Y2goZXJyKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybihgaW52b2tlTWV0aG9kV2l0aDogY2F1Z2h0IGVycm9yISBcXG4gS2V5OiAnJHtrZXl9JyBjYWxsZWQgb246YCwgbywgRUJBUiwgZXJyKVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGF2ZXJhZ2UoLi4ubnVtYmVyczogbnVtYmVyW10pIHtcclxuICByZXR1cm4gbnVtYmVycy5yZWR1Y2UoKHZhbCwgY3VyKSA9PiB2YWwrY3VyKS9udW1iZXJzLmxlbmd0aFxyXG59XHJcblxyXG4vKiBHZXQgbGluayB0byBkb2N1bWVudGF0aW9uIHBhZ2UuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsaW5rRG9jcyhwYWdlOiBzdHJpbmcpIHtcclxuXHQvLyByZXR1cm4gYGh0dHBzOi8vYXp1bGFsb2kubmV0L29ic2lkaWFuLXNrcmliaS8ke3BhZ2V9YFxyXG5cdHJldHVybiBgaHR0cHM6Ly9henVsYWxvaS5naXRodWIuaW8vb2JzaWRpYW4tc2tyaWJpLyR7cGFnZX1gXHJcbn1cclxuXHJcbi8qIFByZWZpeGVzIHN0cmluZyB3aXRoIHBsdWdpbiBuYW1lLiBNYWtlcyByZXVzaW5nIGNvZGUgYWNyb3NzIHBsdWdpbnMgZWFzaWVyLiAqL1xyXG5leHBvcnQgZnVuY3Rpb24ga2xzKGNsczogc3RyaW5nKSB7cmV0dXJuIGBza3JpYmktJHtjbHN9YH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNoKHN0cjogc3RyaW5nKSB7XHJcblx0bGV0IGhhc2ggPSA1MzgxO1xyXG5cdGxldCBpID0gc3RyLmxlbmd0aDtcclxuXHR3aGlsZSAoaSkge1xyXG5cdFx0aGFzaCA9IChoYXNoICogMzMpIF4gc3RyLmNoYXJDb2RlQXQoLS1pKTtcclxuXHR9XHJcblx0cmV0dXJuIGhhc2ggPj4+IDA7XHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBQYXJ0aWFsQ29uZmlnIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbmZpZ1wiXHJcbmltcG9ydCB7IENhbGxiYWNrRm4gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvZmlsZS1oYW5kbGVyc1wiXHJcbmltcG9ydCB7IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIHNjb3BlZFZhcnMgfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCJcclxuaW1wb3J0IHsgZExvZywgZ2V0QXN5bmNDb25zdHJ1Y3RvciwgcHJvbWlzZUltcGwgfSBmcm9tIFwic3JjL3V0aWxcIlxyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCJcclxuXHJcbi8qKiBBZGRzIHRoZSBlbnRyaWVzIG9mIHNjb3BlIHRvIGEgZnVuY3Rpb24gc3RyaW5nLiBcclxuKiBAcGFyYW0gZnVuY3Rpb25TdHJpbmcgQSBzdHJpbmcgZnVuY3Rpb24gY29tcGlsZWQgYnkgRXRhJ3MgY29tcGlsZVRvU3RyaW5nKCkgXHJcbiogQHBhcmFtIGtleXMgQXJyYXkgb2Yga2V5cyB0aGF0IHRoZSByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGV4cGVjdCB0byBiZSBwcmVzZW50IGluIGl0cyBzY29wZSBhcmd1bWVudFxyXG4qIEBwYXJhbSBhc3luYyBJZiB0cnVlLCByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGJlIGFzeW5jaHJvbm91cyAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVdpdGgoZnVuY3Rpb25TdHJpbmc6IHN0cmluZywga2V5czogc3RyaW5nW10sIGFzeW5jPzogYm9vbGVhbik6IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQge1xyXG4gIHZhciBhID0gXCJcIjsgdmFyIGIgPSBcIlwiO1xyXG4gIGZvciAobGV0IGsgb2Yga2V5cykge1xyXG4gICAgYSArPSBgJHtrfSxgXHJcbiAgICBiICs9IGAnJHtrfScsYFxyXG4gIH1cclxuICBsZXQgZnVuYyA9IGB2YXIgeyR7YS5zdWJzdHIoMCwgYS5sZW5ndGgtMSl9fSA9IHNjb3BlO1xcbmAgKyBmdW5jdGlvblN0cmluZ1xyXG4gIGxldCBjb25zdHJ1Y3RvciA9IChhc3luYykgPyBnZXRBc3luY0NvbnN0cnVjdG9yKCkgOiBGdW5jdGlvbiBcclxuICBsZXQgY29tcGlsZWQgPSBuZXcgY29uc3RydWN0b3IoJ3Njb3BlJywgZnVuYylcclxuICByZXR1cm4gY29tcGlsZWQgYXMgVGVtcGxhdGVGdW5jdGlvblNjb3BlZFxyXG59XHJcblxyXG4vKiBWZXJzaW9uIG9mIEV0YSdzIHJlbmRlciBmdW5jdGlvbiwgbW9kaWZpZWQgdG8gaGFuZGxlIHNjb3BlZCB0ZW1wbGF0ZXMgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckV0YShcclxuICBoYW5kbGVyOiBFdGFIYW5kbGVyLFxyXG4gIHRlbXBsYXRlOiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLFxyXG4gIGRhdGE6IG9iamVjdCxcclxuICBjb25maWc/OiBQYXJ0aWFsQ29uZmlnLFxyXG4gIGNiPzogQ2FsbGJhY2tGbixcclxuICBzY29wZT86IHNjb3BlZFZhcnMsXHJcbiAgYmluZGVyPzogYW55XHJcbiAgKTogc3RyaW5nIHwgUHJvbWlzZTxzdHJpbmc+IHwgdm9pZCB7XHJcbiAgY29uc3Qgb3B0aW9ucyA9IEV0YS5nZXRDb25maWcoY29uZmlnIHx8IHt9KVxyXG5cclxuICBpZiAob3B0aW9ucy5hc3luYykge1xyXG4gICAgLy8gaWYgKGNiKSB7XHJcbiAgICAgIC8vIHRyeSB7IFxyXG4gICAgICAgIC8vIGNvbnN0IHRlbXBsYXRlRm4gPSBoYW5kbGVyLmdldENhY2hlZCh0ZW1wbGF0ZSwgb3B0aW9ucywgc2NvcGUsIGJpbmRlcilcclxuICAgICAgICAvLyB0ZW1wbGF0ZUZuKHNjb3BlKVxyXG4gICAgICAvLyB9IGNhdGNoKGUpIHtcclxuICAgICAgICAvLyByZXR1cm4gY2IoZSlcclxuICAgICAgLy8gfVxyXG4gICAgLy8gfSBlbHNlIHtcclxuXHJcbiAgICAgIC8vIHJldHVybiAoYXN5bmMgKCkgPT4gaGFuZGxlci5nZXRDYWNoZWQodGVtcGxhdGUsIG9wdGlvbnMsIHNjb3BlLCBiaW5kZXIpKHNjb3BlKSkoKVxyXG4gICAgICByZXR1cm4gbmV3IHByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlOiBGdW5jdGlvbiwgcmVqZWN0OiBGdW5jdGlvbikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICByZXNvbHZlKGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKShzY29wZSkpXHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgcmVqZWN0KGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgLy8gfVxyXG4gIH0gZWxzZSB7XHJcbiAgICBsZXQgZnVuYyA9IGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKVxyXG4gICAgZExvZyhgUmVuZGVyaW5nIGZ1bmN0aW9uYCwgZnVuYylcclxuICAgIHJldHVybiBmdW5jKHNjb3BlKVxyXG4gIH1cclxufVxyXG5cclxuLyogVmVyc2lvbiBvZiBFdGEncyBhc3luYyByZW5kZXIgZnVuY3Rpb24sIGp1c3Qgc2V0cyBhc3luYyB0byB0cnVlICovXHJcbi8qIE5vdGU6IHBlcmYgaW1wYWN0IG9mIHVzaW5nIGFzeW5jIHRlbXBsYXRlZnVuY3Rpb25zIGlzIG5lZ2xpZ2libGUgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckV0YUFzeW5jKFxyXG4gIGhhbmRsZXI6IEV0YUhhbmRsZXIsXHJcbiAgdGVtcGxhdGU6IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsXHJcbiAgZGF0YTogb2JqZWN0LFxyXG4gIGNvbmZpZz86IFBhcnRpYWxDb25maWcsXHJcbiAgY2I/OiBDYWxsYmFja0ZuLFxyXG4gIHNjb3BlPzogc2NvcGVkVmFycyxcclxuICBiaW5kZXI/OiBhbnlcclxuICApOiBzdHJpbmcgfCBQcm9taXNlPHN0cmluZz4gfCB2b2lkIHtcclxuICAgIHJldHVybiByZW5kZXJFdGEoaGFuZGxlciwgdGVtcGxhdGUsIGRhdGEsIE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZywge2FzeW5jOiB0cnVlfSksIGNiLCBzY29wZSwgYmluZGVyKVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBpc0V4dGFudCB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBQcm92aWRlckJ1cyB9IGZyb20gXCIuL3Byb3ZpZGVyX2J1c1wiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJUHJvdmlkZXIge1xyXG4gIGlkOiBzdHJpbmdcclxuICBidXM6IFByb3ZpZGVyQnVzXHJcbiAgZnVuY3Rpb25zOiBNYXA8c3RyaW5nLCBhbnk+O1xyXG4gIGNyZWF0ZU9iamVjdCgpOiBTdHJpbmdkZXg7XHJcbiAgaW5pdCgpOiBQcm9taXNlPHZvaWQ+OyAgICAgICAgICAgICAgICAgICAvLyBDYWxsZWQgb25jZSwgb24gYnVzIGxvYWRcclxuICB1bmxvYWQoKTogdm9pZDsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGVkIG9uY2UsIG9uIGJ1cyB1bmxvYWRcclxuICByZWxvYWQoKTogUHJvbWlzZTxhbnk+OyAgICAgICAgICAgICAgICAgLy8gTWF5IGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lc1xyXG5cclxuICBzZXREaXJ0eSgpOiB2b2lkO1xyXG4gIHBvc3REaXJ0eT8oKTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFByb3ZpZGVyIGltcGxlbWVudHMgSVByb3ZpZGVyIHtcclxuICBpZDogc3RyaW5nXHJcbiAgYnVzOiBQcm92aWRlckJ1cztcclxuICBmdW5jdGlvbnM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKClcclxuICBpbml0TG9hZGVkID0gZmFsc2U7XHJcbiAgaXNEaXJ0eTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihidXM6IFByb3ZpZGVyQnVzLCBpZDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmJ1cyA9IGJ1c1xyXG4gICAgdGhpcy5pZCA9IGlkXHJcbiAgfVxyXG5cclxuICBbaW5kZXg6IHN0cmluZ106IGFueTtcclxuXHJcbiAgY3JlYXRlT2JqZWN0KCk6IFN0cmluZ2RleCB7XHJcbiAgICByZXR1cm4gey4uLk9iamVjdC5mcm9tRW50cmllcyh0aGlzLmZ1bmN0aW9ucyl9XHJcbiAgfVxyXG5cclxuICBpbml0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdGhpcy5pbml0TG9hZGVkID0gdHJ1ZVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKTogdm9pZCB7fVxyXG4gIHJlbG9hZCgpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gY2xlYW4gSWYgdHJ1ZSwgcHJvdmlkZXIuaXNEaXJ0eSA9IGZhbHNlICovXHJcbiAgc2V0RGlydHkoZGlydHk/OiBib29sZWFuKSB7XHJcbiAgICB0aGlzLmlzRGlydHkgPSBpc0V4dGFudChkaXJ0eSkgPyBkaXJ0eSA6IHRydWVcclxuICAgIHRoaXMuYnVzLnByb3ZpZGVyTm90aWZpY2F0aW9uRGlydHkodGhpcywgdGhpcy5pc0RpcnR5KVxyXG4gIH1cclxuXHJcbiAgLyogTWF5IGJlIGNhbGxlZCB3aXRob3V0IGRhdGEuICovXHJcbiAgcG9zdERpcnR5KC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7fVxyXG59XHJcblxyXG4vKiogXHJcbiAqIFByZWRpY2F0ZWQgcHJvdmlkZXJzIGFyZSByZXNwb25zaWJsZSBmb3IgbW9kdWxlcyB0aGF0IHJlcXVpcmUgY2VydGFpbiBjb25kaXRpb25zIHRvIGZ1bmN0aW9uICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVByb3ZpZGVyUHJlZGljYXRlZCBleHRlbmRzIElQcm92aWRlciB7XHJcbiAgcHJlZGljYXRlQ2hlY2soKTogYm9vbGVhblxyXG4gIHByZWRpY2F0ZUVycm9yKCk6IHN0cmluZ1xyXG4gIGdldFByZWRpY2F0ZSgpOiBQbHVnaW5cclxufVxyXG4gXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQcm92aWRlclByZWRpY2F0ZWQgZXh0ZW5kcyBQcm92aWRlciBpbXBsZW1lbnRzIElQcm92aWRlclByZWRpY2F0ZWQge1xyXG4gIHByZWRpY2F0ZVBsdWdpbk5hbWU6IHN0cmluZyA9ICcnXHJcbiAgXHJcbiAgZ2V0UHJlZGljYXRlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zPy5bdGhpcy5wcmVkaWNhdGVQbHVnaW5OYW1lXSB8fCBudWxsXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJucyB0cnVlIG9ubHkgd2hlbiB0aGUgcHJlZGljYXRlIGNvbmRpdGlvbiBpcyBtZXQgKi9cclxuICBwcmVkaWNhdGVDaGVjaygpIHtcclxuICAgIHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uYXBwLnBsdWdpbnMuZW5hYmxlZFBsdWdpbnMuaGFzKHRoaXMucHJlZGljYXRlUGx1Z2luTmFtZSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm5zIEFuIGVycm9yIHN0cmluZyBkZXNjcmliaW5nIHRoZSB1bm1ldCBwcmVkaWNhdGUgY29uZGl0aW9uICovXHJcbiAgcHJlZGljYXRlRXJyb3IoKSB7XHJcbiAgICByZXR1cm4gYEludGVncmF0aW9uIE1vZHVsZSAnJHt0aGlzLmlkfScgbm90IGF2YWlsYWJsZSwgY291bGQgbm90IGZpbmQgcmVxdWlyZWQgcGx1Z2luOiAnJHt0aGlzLnByZWRpY2F0ZVBsdWdpbk5hbWV9J2BcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcInNyYy9ldGEvcHJvdmlkZXJfYWJzXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXggfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJTSyBleHRlbmRzIFByb3ZpZGVyIHtcclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgcmV0dXJuIHN1cGVyLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlT2JqZWN0KCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVuZGVyOiBmdW5jdGlvbihzdHI6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBlID0gY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCJ9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzKVxyXG4gICAgICAgIE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oc3RyLCBlLCB0aGlzLmN0eC5maWxlLnBhdGgsIG51bGwpO1xyXG4gICAgICAgIHJldHVybiBlLmlubmVySFRNTFxyXG4gICAgICB9LFxyXG4gICAgICBoYXM6IGZ1bmN0aW9uKHY6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiAhKCh0aGlzLnY/Llt2XSA9PSBudWxsKSB8fCAodGhpcy52Py5bdl0gPT0gdW5kZWZpbmVkKSlcclxuICAgICAgfSxcclxuICAgICAgYWJvcnQ6IGZ1bmN0aW9uKHM6IHN0cmluZyB8IFN0cmluZ2RleCkge1xyXG4gICAgICAgIGxldCBhYm9ydFBhY2tldCA9IFN0cmluZy5pc1N0cmluZyhzKSBcclxuICAgICAgICA/IHtoYXNEYXRhOiB0cnVlLCBmbGFnOiAnYWJvcnQnLCBob3Zlcjogc30gXHJcbiAgICAgICAgOiBPYmplY3QuYXNzaWduKHtoYXNEYXRhOiB0cnVlLCBmbGFnOiAnYWJvcnQnfSwgcylcclxuICAgICAgICB0aHJvdyBhYm9ydFBhY2tldFxyXG4gICAgICB9LFxyXG4gICAgICBnZXRUZW1wbGF0ZVNvdXJjZTogZnVuY3Rpb24oczogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMuY3R4LnBsdWdpbiBhcyBTa3JpYm9zUGx1Z2luXHJcblxyXG4gICAgICAgIHJldHVybiBwbHVnaW4uaW5pdExvYWRlZCBcclxuICAgICAgICA/IHBsdWdpbi5ldGEubG9hZGVyLnRlbXBsYXRlU291cmNlLmdldChzKSBcclxuICAgICAgICA6ICgoKSA9PiB7IHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB4ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ3NrcmliaTp0ZW1wbGF0ZS1pbml0LWNvbXBsZXRlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9mZnJlZih4KVxyXG4gICAgICAgICAgICAgIHJlc29sdmUocGx1Z2luLmV0YS5sb2FkZXIudGVtcGxhdGVTb3VyY2UuZ2V0KHMpKVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHgpXHJcbiAgICAgICAgICB9KX0pKClcclxuICAgICAgfSxcclxuICAgICAgZ2V0U3R5bGU6IGZ1bmN0aW9uKHM6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMuY3R4LnBsdWdpbiBhcyBTa3JpYm9zUGx1Z2luXHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcylcclxuICAgICAgICByZXR1cm4gcGx1Z2luLmluaXRMb2FkZWQgXHJcbiAgICAgICAgPyBQcm9taXNlLnJlc29sdmUocGx1Z2luLmV0YS5sb2FkZXIuc3R5bGVDYWNoZS5nZXQocykpIFxyXG4gICAgICAgIDogKCgpID0+IHsgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGV0IHggPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5vbignc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgcGx1Z2luLmFwcC53b3Jrc3BhY2Uub2ZmcmVmKHgpXHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShwbHVnaW4uZXRhLmxvYWRlci5zdHlsZUNhY2hlLmdldChzKSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh4KVxyXG4gICAgICAgICAgfSl9KSgpXHJcbiAgICAgIH0sXHJcbiAgICAgIGluY2x1ZGVTdHlsZTogYXN5bmMgZnVuY3Rpb24oczogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3R4LnBsdWdpbi5ldGEubG9hZGVyLnN0eWxlQ2FjaGUuaGFzKHMpKSB7XHJcbiAgICAgICAgICB0aGlzLmNoaWxkLl9jLmxpc3RlbkZvcihcInN0eWxlXCIsIHMpXHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZC5hZGRTdHlsZShhd2FpdCB0aGlzLmdldFN0eWxlKHMpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufSIsImltcG9ydCB7IEV2ZW50UmVmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbi8vIGltcG9ydCB7IERhdGF2aWV3SW5saW5lQXBpIH0gZnJvbSBcIm9ic2lkaWFuLWRhdGF2aWV3L2xpYi9hcGkvaW5saW5lLWFwaVwiO1xyXG5pbXBvcnQgeyBQcm92aWRlclByZWRpY2F0ZWQgfSBmcm9tIFwic3JjL2V0YS9wcm92aWRlcl9hYnNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlckRhdGF2aWV3IGV4dGVuZHMgUHJvdmlkZXJQcmVkaWNhdGVkIHtcclxuICBwcmVkaWNhdGVQbHVnaW5OYW1lID0gJ2RhdGF2aWV3J1xyXG4gIC8vIGR2cDogRGF0YXZpZXdQbHVnaW4gPSBudWxsXHJcblxyXG4gIGV2ZW50UmVmX0FQSV9SRUFEWTogRXZlbnRSZWZcclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIC8vIHRoaXMuZHZwID0gdGhpcy5idXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXcgYXMgRGF0YXZpZXdQbHVnaW4gfHwgbnVsbFxyXG5cclxuICAgIHRoaXMuZXZlbnRSZWZfQVBJX1JFQURZID0gdGhpcy5idXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdkYXRhdmlldzphcGktcmVhZHknLCAoYXBpKSA9PiB7dGhpcy5hcGlSZWFkeSgpfSlcclxuXHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmJ1cy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub2ZmcmVmKHRoaXMuZXZlbnRSZWZfQVBJX1JFQURZKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlT2JqZWN0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zPy5kYXRhdmlldz8uYXBpIHx8IG51bGxcclxuICB9XHJcblxyXG4gIGFwaVJlYWR5KCkge1xyXG5cclxuICB9XHJcblxyXG4gIC8vIGNyZWF0ZUR5bmFtaWMoc3RhdGU6IER5bmFtaWNTdGF0ZSkge1xyXG4gICAgLy8gbGV0IGFwaSA9IG5ldyBEYXRhdmlld0lubGluZUFwaSh0aGlzLmR2cC5pbmRleCwgc3RhdGUuY2hpbGQsIHN0YXRlLmVsLCB0aGlzLmJ1cy5wbHVnaW4uYXBwLCB0aGlzLmR2cC5zZXR0aW5ncywgc3RhdGUuZmlsZS5wYXRoKVxyXG5cclxuICAgIC8vIHJldHVybiB0aGlzPy5kdnA/LmFwaSB8fCBudWxsXHJcbiAgLy8gfVxyXG59XHJcbiIsImltcG9ydCB7IFByb3ZpZGVyUHJlZGljYXRlZCB9IGZyb20gXCIuLi8uLi9wcm92aWRlcl9hYnNcIjtcclxuaW1wb3J0IHR5cGUgV2VhdGhlckFQSSBmcm9tIFwiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4td2VhdGhlci9zcmMvYXBpXCI7XHJcbmltcG9ydCB7IEV2ZW50UmVmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJXZWF0aGVyIGV4dGVuZHMgUHJvdmlkZXJQcmVkaWNhdGVkIHtcclxuICBwcmVkaWNhdGVQbHVnaW5OYW1lOiBzdHJpbmcgPSAnb2JzaWRpYW4td2VhdGhlcidcclxuXHJcbiAgcHJpdmF0ZSBldmVudFJlZnM6IHtcclxuICAgIHJlYWR5OiBFdmVudFJlZiBcclxuICAgIHVubG9hZDogRXZlbnRSZWZcclxuICAgIHRpY2s6IEV2ZW50UmVmXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgdGhpcy5ldmVudFJlZnMgPSB7XHJcbiAgICAgIHJlYWR5OiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXJlYWR5XCIsICgpID0+IHt9KSxcclxuICAgICAgdW5sb2FkOiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXVubG9hZFwiLCAoKSA9PiB7fSksXHJcbiAgICAgIHRpY2s6IHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwiYXotd2VhdGhlcjphcGktdGlja1wiLCAoKSA9PiB7fSlcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmZ1bmN0aW9ucy5zZXQoXCJjaGVja1wiLCB0aGlzLnByb3ZpZGVfcHJlZGljYXRlKCkpXHJcbiAgICB0aGlzLmZ1bmN0aW9ucy5zZXQoXCJjYWNoZVwiLCB0aGlzLnByb3ZpZGVfZGlzcGVuc2VDYWNoZSgpKVxyXG4gICAgdGhpcy5mdW5jdGlvbnMuc2V0KFwidGlja0V2ZW50UmVmXCIsIHRoaXMucHJvdmlkZV90aWNrRXZlbnRSZWYoKSlcclxuXHJcbiAgICByZXR1cm4gc3VwZXIuaW5pdCgpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICBmb3IgKGxldCByIG9mIE9iamVjdC52YWx1ZXModGhpcy5ldmVudFJlZnMpKSB7XHJcbiAgICAgIHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9mZnJlZihyKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyogUHJvdmlzaW9ucyAqL1xyXG5cclxuICBwcm92aWRlX3ByZWRpY2F0ZSgpOiBGdW5jdGlvbiB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gKCEhdGhpcy53ZWF0aGVyQVBJKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJvdmlkZV9kaXNwZW5zZUNhY2hlKCk6IEZ1bmN0aW9uIHtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIGxldCBwOiBhbnkgPSB0aGlzLmdldFByZWRpY2F0ZSgpO1xyXG4gICAgICByZXR1cm4gcD8uQVBJPy5kaXNwZW5zZUNhY2hlLmJpbmQocC5BUEkpKClcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICBwcm92aWRlX3RpY2tFdmVudFJlZigpOiBGdW5jdGlvbiB7XHJcbiAgICByZXR1cm4gKGNiOiBGdW5jdGlvbikgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJhei13ZWF0aGVyOmFwaS10aWNrXCIsICguLi5hOiBhbnkpID0+IGNiKC4uLmEpKVxyXG4gICAgfVxyXG4gIH1cclxufSIsImltcG9ydCB7IEZpbGVTeXN0ZW1BZGFwdGVyLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBGaWxlTWluZGVyLCBTdHJpbmdkZXggfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGRMb2csIGZpbHRlckZpbGVFeHQsIGdldEZpbGVzLCBpc0V4dGFudCwgaXNGaWxlLCBpc0luRm9sZGVyLCB2TG9nLCB3aXRob3V0S2V5IH0gZnJvbSBcInNyYy91dGlsXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcIi4uL3Byb3ZpZGVyX2Fic1wiO1xyXG5cclxuLy8gVE9ETzogYWRkIHN5c3RlbSB0byBhdXRvLXJlbG9hZCBza3JpYmlzIHdoZW4gbW9kdWxlIGNhY2hlIGNoYW5nZXMgXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlclNjcmlwdGxvYWRlciBleHRlbmRzIFByb3ZpZGVyIGltcGxlbWVudHMgRmlsZU1pbmRlciB7XHJcbiAgbG9hZGVkTW9kdWxlczogTWFwPHN0cmluZywge25hbWU/OiBzdHJpbmcsIHByb3BlcnRpZXM6IFN0cmluZ2RleH0+ID0gbmV3IE1hcCgpXHJcblxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pbml0TG9hZCgpLnRoZW4oKCkgPT4gc3VwZXIuaW5pdCgpKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5sb2FkQW5kU2V0KC4uLmdldEZpbGVzKHRoaXMuYnVzLnBsdWdpbi5hcHAsIHRoaXMuYnVzLnBsdWdpbi5zZXR0aW5ncy5zY3JpcHRGb2xkZXIpKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZEFuZFNldCguLi5maWxlOiBURmlsZVtdKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZWFkRmlsZXMoLi4uZmlsZSlcclxuICAgIC50aGVuKChyZXQpID0+IHsvKnZMb2coJ0xvYWRpbmcgSlMgbW9kdWxlcy4uLicsIHJldCk7Ki8gdGhpcy5zdGFzaE1vZHVsZShyZXQpOyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KTtcclxuICB9XHJcblxyXG4gIHN0YXNoTW9kdWxlKG1vZHVsZXM6IFtzdHJpbmcsIFN0cmluZ2RleF1bXSkge1xyXG4gICAgZExvZygnU2NyaXB0bG9hZGVyOiBzdGFzaE1vZHVsZScsIG1vZHVsZXMpXHJcblxyXG4gICAgbW9kdWxlcy5mb3JFYWNoKChyKSA9PiB7XHJcbiAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkZWRNb2R1bGVzLmRlbGV0ZShyWzBdKVxyXG4gICAgICAgIHRoaXMubG9hZGVkTW9kdWxlcy5zZXQoclswXSwge1xyXG4gICAgICAgICAgbmFtZTogKFN0cmluZy5pc1N0cmluZyhyWzFdPy5fbmFtZSA/PyBudWxsKSA/IHJbMV0uX25hbWUgOiBudWxsKSwgXHJcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB3aXRob3V0S2V5KHJbMV0sICdfbmFtZScpXHJcbiAgICAgICAgICB9ICAgICAgICAgIFxyXG4gICAgICAgIClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNyZWF0ZU9iamVjdCgpOiBTdHJpbmdkZXgge1xyXG4gICAgbGV0IGV4cG9ydHM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKClcclxuICAgIHRoaXMubG9hZGVkTW9kdWxlcy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XHJcbiAgICAgIGxldCBzaW5nbGUgPSAoT2JqZWN0LmtleXModmFsdWUucHJvcGVydGllcykubGVuZ3RoID09IDEpIFxyXG5cclxuICAgICAgZXhwb3J0cy5zZXQoKHZhbHVlLm5hbWUgPz8gKHNpbmdsZSA/IE9iamVjdC5rZXlzKHZhbHVlLnByb3BlcnRpZXMpWzBdIDoga2V5KSksXHJcbiAgICAgICAgc2luZ2xlID8gT2JqZWN0LnZhbHVlcyh2YWx1ZS5wcm9wZXJ0aWVzKVswXSA6IHZhbHVlLnByb3BlcnRpZXNcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gey4uLk9iamVjdC5mcm9tRW50cmllcyhleHBvcnRzKX1cclxuICB9XHJcblxyXG4gIGFzeW5jIHJlYWRGaWxlcyguLi5maWxlczogVEZpbGVbXSk6IFByb21pc2U8W3N0cmluZywgU3RyaW5nZGV4XVtdPiB7XHJcbiAgICBsZXQgZmlsdGVyZWQgPSBmaWx0ZXJGaWxlRXh0KGZpbGVzLCBcImpzXCIpXHJcbiAgICBjb25zdCByZWFkcyA9IGZpbHRlcmVkLm1hcChhc3luYyAoZikgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmICghKHRoaXMuYnVzLnBsdWdpbi5hcHAudmF1bHQuYWRhcHRlciBpbnN0YW5jZW9mIEZpbGVTeXN0ZW1BZGFwdGVyKSkgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XHJcbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLmJ1cy5wbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZ2V0QmFzZVBhdGgoKSArIFwiL1wiICsgZi5wYXRoXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHJlc1BhdGggPSB3aW5kb3cucmVxdWlyZS5yZXNvbHZlKHBhdGgpXHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHdpbmRvdy5yZXF1aXJlLmNhY2hlKS5jb250YWlucyhyZXNQYXRoKSkgZGVsZXRlIHdpbmRvdy5yZXF1aXJlLmNhY2hlW3dpbmRvdy5yZXF1aXJlLnJlc29sdmUocmVzUGF0aCldXHJcblxyXG4gICAgICAgIGNvbnN0IG1vZCA9IHJlcXVpcmUocGF0aClcclxuXHJcbiAgICAgICAgcmV0dXJuIChpc0V4dGFudChtb2QpKSBcclxuICAgICAgICAgID8gUHJvbWlzZS5yZXNvbHZlKFtmLmJhc2VuYW1lLCBtb2RdKVxyXG4gICAgICAgICAgOiBQcm9taXNlLnJlamVjdCgpXHJcbiAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihlKVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpXHJcbiAgICAgIH0gICAgICBcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChyZWFkcylcclxuICAgIC50aGVuKChzZXR0bGVkKSA9PiB7IHJldHVybiBzZXR0bGVkXHJcbiAgICAgIC5maWx0ZXIoKHIpID0+IHtyZXR1cm4gci5zdGF0dXMgPT0gXCJmdWxmaWxsZWRcIn0pXHJcbiAgICAgIC5tYXAoKHYpID0+IHtyZXR1cm4gKHYgYXMgUHJvbWlzZUZ1bGZpbGxlZFJlc3VsdDxbc3RyaW5nLCBTdHJpbmdkZXhdPikudmFsdWV9KVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNsZWFySlMoLi4uaXRlbXM6IEFycmF5PFRGaWxlIHwgc3RyaW5nPik6IHZvaWQge1xyXG4gICAgbGV0IG5hbWVzID0gaXRlbXMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgIGlmIChpc0ZpbGUoaXRlbSkpIHJldHVybiBmaWx0ZXJGaWxlRXh0KGl0ZW0sICdqcycpWzBdLmJhc2VuYW1lXHJcbiAgICAgIGVsc2UgaWYgKFN0cmluZy5pc1N0cmluZyhpdGVtKSkgcmV0dXJuIGl0ZW0gXHJcbiAgICB9KVxyXG5cclxuICAgIGZvciAobGV0IG5hbWUgb2YgbmFtZXMpIHRoaXMubG9hZGVkTW9kdWxlcy5kZWxldGUobmFtZSlcclxuICB9XHJcblxyXG4gIGFzeW5jIHJlbG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMubG9hZGVkTW9kdWxlcy5jbGVhcigpXHJcbiAgICBhd2FpdCB0aGlzLmluaXRMb2FkKClcclxuICAgIHJldHVybiBzdXBlci5yZWxvYWQoKVxyXG4gIH1cclxuXHJcbiAgcG9zdERpcnR5KCkge1xyXG4gICAgaWYgKHRoaXMuYnVzLnBsdWdpbi5zZXR0aW5ncy5hdXRvUmVsb2FkKSB7XHJcbiAgICAgIEFycmF5LmZyb20odGhpcy5idXMucGx1Z2luLmNoaWxkcmVuKS5mb3JFYWNoKGNoaWxkID0+IGNoaWxkLnNjcmlwdHNVcGRhdGVkKCkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKiBGaWxlTWluZGVyIEZ1bmN0aW9ucyAqL1xyXG5cclxuICBnZXQgZGlyZWN0b3J5KCk6IHN0cmluZyB7IHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uc2V0dGluZ3Muc2NyaXB0Rm9sZGVyIH1cclxuXHJcbiAgZmlsZVVwZGF0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgaW4gc2NyaXB0IGRpcmVjdG9yeSBtb2RpZmllZCwgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5jbGVhckpTKGZpbGUpXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB0aGlzLmNsZWFySlMoZmlsZSkpXHJcbiAgfVxyXG5cclxuICBmaWxlRGVsZXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyByZW1vdmVkIGZyb20gc2NyaXB0IGRpcmVjdG9yeSwgdW5sb2FkaW5nLi4uYClcclxuICAgIHRoaXMuY2xlYXJKUyhmaWxlKVxyXG4gICAgdGhpcy5zZXREaXJ0eSgpXHJcbiAgfVxyXG5cclxuICBmaWxlQWRkZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYEZpbGUgJyR7ZmlsZS5uYW1lfScgYWRkZWQgdG8gc2NyaXB0IGRpcmVjdG9yeSwgbG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB0aGlzLmNsZWFySlMoZmlsZSkpXHJcbiAgfVxyXG5cclxuICBmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBTY3JpcHQgZmlsZSAnJHtvbGROYW1lfScgcmVuYW1lZCB0byAnJHtmaWxlLm5hbWV9JywgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5jbGVhckpTKG9sZE5hbWUpXHJcbiAgICB0aGlzLmxvYWRBbmRTZXQoZmlsZSlcclxuICAgIC50aGVuKCgpID0+IHt0aGlzLnNldERpcnR5KCl9LCAoKSA9PiB7fSlcclxuICB9XHJcblxyXG4gIGRpcmVjdG9yeUNoYW5nZWQoKTogdm9pZCB7XHJcbiAgICB2TG9nKGBTY3JpcHQgZGlyZWN0b3J5IGNoYW5nZWQsIHJlbG9hZGluZyBzY3JpcHRzLi4uYClcclxuICAgIHRoaXMucmVsb2FkKCkudGhlbigoKSA9PiB0aGlzLnNldERpcnR5KCksIChlKSA9PiB7Y29uc29sZS53YXJuKGUpfSlcclxuICB9XHJcblxyXG4gIGlzSW5Eb21haW4oZmlsZTogVEFic3RyYWN0RmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGlzSW5Gb2xkZXIoZmlsZSwgdGhpcy5kaXJlY3RvcnkpXHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEFwcCwgTWFya2Rvd25SZW5kZXJlciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcclxuaW1wb3J0IHsgVkFSX05BTUUgfSBmcm9tIFwic3JjL3R5cGVzL2NvbnN0XCI7XHJcbmltcG9ydCB7IER5bmFtaWNTdGF0ZSwgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBlbnN1cmVBcnJheSwgaXNGdW5jIH0gZnJvbSBcInNyYy91dGlsXCI7XHJcbmltcG9ydCB7IEV0YUhhbmRsZXIgfSBmcm9tIFwiLi9ldGFcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJTSyB9IGZyb20gXCIuL3Byb3ZpZGVycy9iYXNlXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyRGF0YXZpZXcgfSBmcm9tIFwiLi9wcm92aWRlcnMvaW50ZWdyYXRpb24vZHZcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJXZWF0aGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL2ludGVncmF0aW9uL3dlYXRoZXJcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJTY3JpcHRsb2FkZXIgfSBmcm9tIFwiLi9wcm92aWRlcnMvc2NyaXB0bG9hZGVyXCI7XHJcbmltcG9ydCB7IElQcm92aWRlciwgUHJvdmlkZXIsIFByb3ZpZGVyUHJlZGljYXRlZCB9IGZyb20gXCIuL3Byb3ZpZGVyX2Fic1wiO1xyXG5cclxuY29uc3Qgb2JzaWRpYW5Nb2R1bGUgPSByZXF1aXJlKFwib2JzaWRpYW5cIik7XHJcblxyXG5jb25zdCBNT0RVTEVfTkFNRV9JTlRFR1JBVElPTlM6IHN0cmluZyA9ICdpbnQnO1xyXG5cclxudHlwZSBQcm92aWRlcmlzaCA9IElQcm92aWRlclxyXG5cclxuLyogSGFuZGxlcyBhbGwgc2NyaXB0IGZ1bmN0aW9uIHByb3ZpZGVycyAqL1xyXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJCdXMge1xyXG5cclxuICBoYW5kbGVyOiBFdGFIYW5kbGVyXHJcbiAgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG4gIHByb3ZpZGVyczogTWFwPHN0cmluZywgUHJvdmlkZXI+ID0gbmV3IE1hcCgpXHJcbiAgcHJvdmlkZXJzUHJlZGljYXRlZDogTWFwPHN0cmluZywgUHJvdmlkZXJQcmVkaWNhdGVkPiA9IG5ldyBNYXAoKVxyXG5cclxuICAvKiBIYXMgYSByZWZlcmVuY2Ugc28gdGhhdCBpdCBjYW4gYmUgbm90aWZpZWQgYnkgdXBkYXRlIGV2ZW50cyAqL1xyXG4gIHNjcmlwdExvYWRlcjogUHJvdmlkZXJTY3JpcHRsb2FkZXI7XHJcblxyXG4gIHNrQmFzZTogUHJvdmlkZXJTSztcclxuXHJcbiAgcHJpdmF0ZSBzY29wZVN0YXRpYzogU3RyaW5nZGV4ID0ge31cclxuXHJcbiAgLy8gSW5kaWNhdGVzIHRoYXQgYSBwcm92aWRlciBoYXMgYmVlbiBhZGRlZCBvciByZW1vdmVkLCBhbmQgdGhlIHN0YXRpYyBzY29wZSBzaG91bGQgYmUgcmVnZW5lcmF0ZWQuXHJcbiAgaXNTdGF0aWNTY29wZURpcnR5OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGhhbmRsZXI6IEV0YUhhbmRsZXIpIHtcclxuICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXJcclxuICAgIHRoaXMucGx1Z2luID0gaGFuZGxlci5wbHVnaW5cclxuXHJcbiAgICB0aGlzLnNjcmlwdExvYWRlciA9IG5ldyBQcm92aWRlclNjcmlwdGxvYWRlcih0aGlzLCAnanMnKTsgLy8gYXNzaWduZWQgaGVyZSBzbyB0aGF0IHdlIGNhbiByZWdpc3RlciBmaWxlIGV2ZW50cyBpbiBoYW5kbGVyXHJcbiAgfVxyXG5cclxuICAvKiBDb25zdHJ1Y3QgYWxsIHByb3ZpZGVycyBidXQgZG8gbm90IGluaXRpYWxpemUgdGhlbSB5ZXQsIHNvIHRoYXQgd2UgY2FuIGNvbXBpbGUgYW5kIGNhY2hlIHRlbXBsYXRlcyBBU0FQICovXHJcbiAgYXN5bmMgcHJlSW5pdCgpIHtcclxuICAgIHRoaXMuYWRkVG8odGhpcy5wcm92aWRlcnMsIHRoaXMuc2NyaXB0TG9hZGVyKVxyXG4gICAgdGhpcy5hZGRUbyh0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQsIG5ldyBQcm92aWRlckRhdGF2aWV3KHRoaXMsICdkdicpKVxyXG4gICAgdGhpcy5hZGRUbyh0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQsIG5ldyBQcm92aWRlcldlYXRoZXIodGhpcywgJ3dlYXRoZXInKSlcclxuICAgIHRoaXMuc2tCYXNlID0gbmV3IFByb3ZpZGVyU0sodGhpcywgVkFSX05BTUUpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICBjb25zdCBpbml0cyA9IE9iamVjdC52YWx1ZXModGhpcy5leGVjT25Qcm92aWRlcnMoJ2luaXQnKSlcclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoaW5pdHMpXHJcbiAgICB0aGlzLmNyZWF0ZVN0YXRpY1Njb3BlKClcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRUbyhwcm92aWRlcnM6IE1hcDxzdHJpbmcsIElQcm92aWRlcj4sIHByb3ZpZGVyOiBQcm92aWRlcikge1xyXG4gICAgcHJvdmlkZXJzLnNldChwcm92aWRlci5pZCwgcHJvdmlkZXIpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbnRlZ3JhdGlvbiBwb2ludCBmb3Igb3RoZXIgcGx1Z2lucyB0byBhZGQgYSBwcm92aWRlciBcclxuICAgKiBAcGFyYW0gcHJvdmlkZXIgUHJvdmlkZXIgaW1wbGVtZW50YXRpb24gdG8gYWRkICovXHJcbiAgcHVibGljIGFkZFByb3ZpZGVyID0gKHByb3ZpZGVyOiBQcm92aWRlcikgPT4ge1xyXG4gICAgdGhpcy5wcm92aWRlcnMuc2V0KHByb3ZpZGVyLmlkLCBwcm92aWRlcilcclxuICAgIHRoaXMuaXNTdGF0aWNTY29wZURpcnR5ID0gdHJ1ZVxyXG4gICAgdGhpcy5oYW5kbGVyLnJlY29tcGlsZVRlbXBsYXRlcygpXHJcbiAgfVxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIEludGVncmF0aW9uIHBvaW50IGZvciBvdGhlciBwbHVnaW5zIHRvIGFkZCBhIHByZWRpY2F0ZWQgcHJvdmlkZXJcclxuICAgKiBAcGFyYW0gcHJvdmlkZXIgUHJvdmlkZXJQcmVkaWNhdGVkIGltcGxlbWVudGF0aW9uIHRvIGFkZCAqL1xyXG4gIGFkZFByb3ZpZGVyUHJlZGljYXRlZCA9IChwcm92aWRlcjogUHJvdmlkZXJQcmVkaWNhdGVkKSA9PiB7XHJcbiAgICB0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQuc2V0KHByb3ZpZGVyLmlkLCBwcm92aWRlcilcclxuICB9XHJcblxyXG4gIHVubG9hZCgpIHtcclxuICAgIHRoaXMuZXhlY09uUHJvdmlkZXJzKCd1bmxvYWQnKVxyXG4gIH1cclxuXHJcbiAgLyogSW52b2tlZCBieSBwcm92aWRlcnMgdG8gaW5kaWNhdGUgdGhlaXIgcHJvdmlzaW9uIG11c3QgYmUgcmVnZW5lcmF0ZWQgKi9cclxuICBwcm92aWRlck5vdGlmaWNhdGlvbkRpcnR5KHByb3ZpZGVyOiBQcm92aWRlciwgaXNEaXJ0eTogYm9vbGVhbiwgLi4uZGF0YTogYW55W10pIHtcclxuICAgIGlmIChpc0RpcnR5KSB0aGlzLnJlZnJlc2hQcm92aWRlcihwcm92aWRlciwgLi4uZGF0YSlcclxuICB9XHJcblxyXG4gIC8qIFJlZ2VuZXJhdGUgdGhlIHByb3Zpc2lvbiBvZiBhIHNpbmdsZSBwcm92aWRlciwgYW5kIHBhc3MgZGF0YSB0byBpdHMgcG9zdCBmdW5jdGlvbiAqL1xyXG4gIHJlZnJlc2hQcm92aWRlcihwcm92aWRlcjogUHJvdmlkZXIsIC4uLmRhdGE6IGFueVtdKSB7XHJcbiAgICBwcm92aWRlci5zZXREaXJ0eShmYWxzZSlcclxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5zY29wZVN0YXRpYywge1twcm92aWRlci5pZF06IHByb3ZpZGVyLmNyZWF0ZU9iamVjdCgpfSlcclxuICAgIHByb3ZpZGVyLnBvc3REaXJ0eSguLi5kYXRhKVxyXG4gIH1cclxuXHJcbiAgLyogQ2xlYW4gZGlydHkgcHJvdmlkZXJzIGJ5IHJlZ2VuZXJhdGluZyB0aGVpciBwcm92aXNpb24gKi9cclxuICByZWZyZXNoUHJvdmlkZXJzKC4uLnByb3ZpZGVyczogUHJvdmlkZXJbXSkge1xyXG4gICAgbGV0IHByb3h5OiBhbnkgPSB7fTtcclxuXHJcbiAgICBmb3IgKGxldCBwcm92aWRlciBvZiBwcm92aWRlcnMpIHtcclxuICAgICAgcHJveHlbcHJvdmlkZXIuaWRdID0gcHJvdmlkZXIuY3JlYXRlT2JqZWN0KClcclxuICAgICAgcHJvdmlkZXIuc2V0RGlydHkoZmFsc2UpXHJcbiAgICB9XHJcblxyXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnNjb3BlU3RhdGljLCBwcm94eSlcclxuXHJcbiAgICBwcm92aWRlcnMuZm9yRWFjaChwcm92aWRlciA9PiBwcm92aWRlci5wb3N0RGlydHkoKSlcclxuICB9XHJcblxyXG4gIC8qIFJlbG9hZHMgYWxsIHByb3ZpZGVycyAqL1xyXG4gIGFzeW5jIHJlbG9hZFByb3ZpZGVycygpIHtcclxuICAgIGxldCBwcm9tcyA9IHRoaXMuZXhlY09uUHJvdmlkZXJzKCdyZWxvYWQnKVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbFNldHRsZWQoT2JqZWN0LnZhbHVlcyhwcm9tcykpXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0U2NvcGVLZXlzKCkge1xyXG4gICAgcmV0dXJuIFsuLi50aGlzLnByb3ZpZGVycy5rZXlzKCksIE1PRFVMRV9OQU1FX0lOVEVHUkFUSU9OUywgJ21vbWVudCcsICdvYnNpZGlhbiddXHJcbiAgfVxyXG5cclxuICAvKiBSZXRyaWV2ZXMgcHJvdmlkZXJzIG9iamVjdCAqL1xyXG4gIHB1YmxpYyBnZXRTY29wZShjdHg/OiBEeW5hbWljU3RhdGUsIHJlZnJlc2g/OiBib29sZWFuKSB7XHJcbiAgICBsZXQgZGlydGllcyA9IE9iamVjdC52YWx1ZXModGhpcy5wcm92aWRlcnMpLmZpbHRlcigocDogUHJvdmlkZXIpID0+IHtyZXR1cm4gcC5pc0RpcnR5fSlcclxuICAgIGlmIChkaXJ0aWVzKSB0aGlzLnJlZnJlc2hQcm92aWRlcnMoLi4uZGlydGllcylcclxuXHJcbiAgICBpZiAodGhpcy5pc1N0YXRpY1Njb3BlRGlydHkpIHRoaXMuY3JlYXRlU3RhdGljU2NvcGUoKVxyXG5cclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNjb3BlU3RhdGljLCB7W01PRFVMRV9OQU1FX0lOVEVHUkFUSU9OU106IHRoaXMuY3JlYXRlUHJlZGljYXRlZFNjb3BlKGN0eCB8fCBudWxsKX0pXHJcbiAgfVxyXG5cclxuICAvKiBDcmVhdGVzIHNjb3BlIG9iamVjdC4gU2hvdWxkIG5vdCBiZSB1c2VkIHRvIGdldCB0aGUgc2NvcGUuICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVTdGF0aWNTY29wZSgpIHtcclxuICAgIGxldCBzcGFjZXM6IHtba2V5OiBzdHJpbmddOiBhbnl9ID0ge307XHJcbiAgICBcclxuICAgIGZvciAobGV0IHAgb2YgdGhpcy5wcm92aWRlcnMpIHNwYWNlc1twWzBdXSA9IHBbMV0uY3JlYXRlT2JqZWN0KCk7XHJcblxyXG4gICAgc3BhY2VzWydtb21lbnQnXSA9IHdpbmRvdy5tb21lbnRcclxuICAgIHNwYWNlc1snb2JzaWRpYW4nXSA9IG9ic2lkaWFuTW9kdWxlXHJcbiAgICBcclxuICAgIHRoaXMuc2NvcGVTdGF0aWMgPSBzcGFjZXNcclxuICAgIHRoaXMuaXNTdGF0aWNTY29wZURpcnR5ID0gZmFsc2VcclxuICAgIHJldHVybiB0aGlzLnNjb3BlU3RhdGljXHJcbiAgfVxyXG5cclxuICAvKiBQcmVkaWNhdGVkIHByb3ZpZGVycyAqL1xyXG4gIGNyZWF0ZVByZWRpY2F0ZWRTY29wZShjdHg/OiBEeW5hbWljU3RhdGUpIHtcclxuICAgIGxldCBzcGFjZXM6IHtba2V5OiBzdHJpbmddOiBhbnl9ID0ge307XHJcbiAgIFxyXG4gICAgZm9yIChsZXQgcCBvZiB0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNwYWNlcywgcFswXSwgeyBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKHBbMV0ucHJlZGljYXRlQ2hlY2soKSkgcmV0dXJuIHBbMV0uY3JlYXRlT2JqZWN0KClcclxuICAgICAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKHBbMV0ucHJlZGljYXRlRXJyb3IoKSlcclxuICAgICAgICB9IFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gc3BhY2VzXHJcbiAgfVxyXG5cclxuICAvKiBHZXQgdGhlIGJhc2UgcHJvdmlkZXIgc2NvcGUgKi9cclxuICBnZXRTY29wZVNLKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2tCYXNlLmNyZWF0ZU9iamVjdCgpXHJcbiAgfVxyXG5cclxuICAvKiBJbnZva2UgZnVuY3Rpb24gb24gYWxsIHByb3ZpZGVycyBhbmQgcmV0dXJuIGFycmF5IG9mIHJlc3VsdHMgKi9cclxuICBleGVjT25Qcm92aWRlcnMoZnVuYzogKGtleW9mIElQcm92aWRlcikpOiBTdHJpbmdkZXgge1xyXG4gICAgbGV0IHJldHM6IFN0cmluZ2RleCA9IHt9O1xyXG5cclxuICAgIGNvbnN0IGludm9rZSA9IChwcm92aWRlcnM6IE1hcDxzdHJpbmcsIFByb3ZpZGVyPikgPT4ge1xyXG4gICAgICBmb3IgKGxldCBwIG9mIHByb3ZpZGVycykgaWYgKChwICE9IG51bGwpICYmIChpc0Z1bmMocFsxXVtmdW5jXSkpKSB7cmV0c1twWzBdXSA9IChwWzFdW2Z1bmNdIGFzIEZ1bmN0aW9uKSgpfVxyXG4gICAgfVxyXG5cclxuICAgIGludm9rZSh0aGlzLnByb3ZpZGVycylcclxuICAgIGludm9rZSh0aGlzLnByb3ZpZGVyc1ByZWRpY2F0ZWQpXHJcblxyXG4gICAgcmV0dXJuIHJldHNcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmlkZXJCdXMge1xyXG4gIGV4ZWNPblByb3ZpZGVycyhmdW5jOiAncmVsb2FkJyk6IHtbaW5kZXg6IHN0cmluZ106IFByb21pc2U8dm9pZD59XHJcbiAgZXhlY09uUHJvdmlkZXIoZnVuYzogJ2luaXQnKToge1tpbmRleDogc3RyaW5nXTogUHJvbWlzZTx2b2lkPn1cclxufVxyXG4iLCIvKiBUaGlzIGlzIHNsaWdodGx5IG1vZGlmaWVkIGZyb20gRXRhICovXHJcblxyXG5leHBvcnQgY2xhc3MgQ2FjaGVyPFQ+IHtcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhY2hlOiBSZWNvcmQ8c3RyaW5nLCBUPikge31cclxuICBkZWZpbmUoa2V5OiBzdHJpbmcsIHZhbDogVCk6IHZvaWQge3RoaXMuY2FjaGVba2V5XSA9IHZhbH1cclxuICBnZXQoa2V5OiBzdHJpbmcpOiBUIHtyZXR1cm4gdGhpcy5jYWNoZVtrZXldfVxyXG4gIHJlbW92ZShrZXk6IHN0cmluZyk6IHZvaWQge2RlbGV0ZSB0aGlzLmNhY2hlW2tleV19XHJcbiAgcmVzZXQoKTogdm9pZCB7dGhpcy5jYWNoZSA9IHt9fVxyXG4gIGxvYWQoY2FjaGVPYmo6IFJlY29yZDxzdHJpbmcsIFQ+KTogdm9pZCB7Y29weVByb3BzKHRoaXMuY2FjaGUsIGNhY2hlT2JqKX1cclxuICBoYXMoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAhKCh0aGlzLmNhY2hlW2tleV0gPT09IG51bGwgKSB8fCAodGhpcy5jYWNoZVtrZXldID09PSB1bmRlZmluZWQpKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlQcm9wczxUPih0b09iajogVCwgZnJvbU9iajogVCk6IFQge1xyXG4gIGZvciAoY29uc3Qga2V5IGluIGZyb21PYmopIHtcclxuICAgIGlmIChoYXNPd25Qcm9wKChmcm9tT2JqIGFzIHVua25vd24pIGFzIG9iamVjdCwga2V5KSkge1xyXG4gICAgICB0b09ialtrZXldID0gZnJvbU9ialtrZXldXHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB0b09ialxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duUHJvcChvYmo6IG9iamVjdCwgcHJvcDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApXHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBGcm9udE1hdHRlckNhY2hlLCBwYXJzZVlhbWwsIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xyXG5pbXBvcnQgeyBFQkFSLCBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IHsgIGdldEZpbGVzLCBpc0V4dGFudCwgaXNGaWxlLCBpc0luRm9sZGVyLCByb3VuZFRvLCB2TG9nLCB2V2Fybiwgd2l0aG91dEtleSB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCI7XHJcbmltcG9ydCB7IENhY2hlciB9IGZyb20gXCIuL2NhY2hlclwiO1xyXG5pbXBvcnQgeyBGaWxlTWluZGVyLCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBjb21waWxlV2l0aCB9IGZyb20gXCIuL2NvbXBcIjtcclxuXHJcbmludGVyZmFjZSBUZW1wbGF0ZUV0YSB7XHJcbiAgc291cmNlOiBzdHJpbmcsXHJcbiAgZnVuY3Rpb246IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsXHJcbiAgZnJvbnRtYXR0ZXI/OiBGcm9udE1hdHRlckNhY2hlXHJcbn1cclxuXHJcbi8qIFJlc3BvbnNpYmxlIGZvciB0aGUgY2FjaGluZyBhbmQgbWFuYWdlbWVudCBvZiB0ZW1wbGF0ZXMuICovXHJcbi8vIFRPRE86IGFkZCBzeXN0ZW0gdG8gYXV0by1yZWxvYWQgc2tyaWJpcyB3aGVuIHJlbGV2YW50IHRlbXBsYXRlIGNhY2hlIGNoYW5nZXMgXHJcbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZUxvYWRlciBpbXBsZW1lbnRzIEZpbGVNaW5kZXIge1xyXG4gIHByaXZhdGUgaGFuZGxlcjogRXRhSGFuZGxlclxyXG4gIHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG4gIHRlbXBsYXRlQ2FjaGU6IENhY2hlcjxUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkPiA9IG5ldyBDYWNoZXI8VGVtcGxhdGVGdW5jdGlvblNjb3BlZD4oe30pXHJcbiAgdGVtcGxhdGVGYWlsdXJlczogTWFwPHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXAoKTtcclxuICB0ZW1wbGF0ZUZyb250bWF0dGVyczogTWFwPHN0cmluZywgRnJvbnRNYXR0ZXJDYWNoZT4gPSBuZXcgTWFwKCk7XHJcbiAgdGVtcGxhdGVTb3VyY2U6IENhY2hlcjxzdHJpbmc+ID0gbmV3IENhY2hlcjxzdHJpbmc+KHt9KVxyXG5cclxuICBzdHlsZUNhY2hlOiBDYWNoZXI8c3RyaW5nPiA9IG5ldyBDYWNoZXI8c3RyaW5nPih7fSlcclxuXHJcbiAgY29uc3RydWN0b3IoaGFuZGxlcjogRXRhSGFuZGxlcikge1xyXG4gICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlclxyXG4gICAgdGhpcy5wbHVnaW4gPSBoYW5kbGVyLnBsdWdpblxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIGluaXQoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiB0aGlzLmluaXRMb2FkKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgaW5pdExvYWQoKSB7XHJcbiAgICBhd2FpdCB0aGlzLmRlZmluZVBhcnRpYWxzKC4uLmdldEZpbGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5kaXJlY3RvcnkpKSBcclxuICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UudHJpZ2dlcignc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICAvKiogXHJcbiAgICogUmVhZHMgcGFzc2VkIGZpbGVzIGFuZCBhdHRlbXB0cyB0byBjYWNoZSB0aGVtLlxyXG4gICAqIEhhbmRsZXMgdGVtcGxhdGVzIGFuZCBzdHlsZXMuIFRlbXBsYXRlcyBhcmUgY29tcGlsZWQgdG8gZnVuY3Rpb25zLiAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGVmaW5lUGFydGlhbHMoLi4uZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG4gICAgdmFyIGZhaWx1cmVDb3VudCA9IDBcclxuICAgIHZhciBzdWNjZXNzQ291bnQgPSAwXHJcblxyXG4gICAgY29uc3Qgc2NvcGVLZXlzID0gdGhpcy5oYW5kbGVyLmJ1cy5nZXRTY29wZUtleXMoKVxyXG5cclxuICAgIGxldCBzdHlsZUZpbGVzOiBURmlsZVtdID0gW11cclxuICAgIGxldCB0ZW1wbGF0ZUZpbGVzOiBURmlsZVtdID0gW10gXHJcbiAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICBzd2l0Y2goZmlsZS5leHRlbnNpb24pIHtcclxuICAgICAgICBjYXNlIFwibWRcIjogdGVtcGxhdGVGaWxlcy5wdXNoKGZpbGUpOyBicmVhaztcclxuICAgICAgICBjYXNlIFwiZXRhXCI6IHRlbXBsYXRlRmlsZXMucHVzaChmaWxlKTsgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImNzc1wiOiBzdHlsZUZpbGVzLnB1c2goZmlsZSk7IGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlYWRUZW1wbGF0ZXMgPSB0ZW1wbGF0ZUZpbGVzLm1hcChhc3luYyBmaWxlID0+IHtcclxuICAgICAgbGV0IHJlYWQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxyXG5cclxuICAgICAgbGV0IGZpbGVGcm9udG1hdHRlciA9IG51bGxcclxuICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09IFwiZXRhXCIpIHtcclxuICAgICAgICBsZXQgZm1TZWFyY2ggPSAoL14tLS1cXG4qKD88ZnJvbnRtYXR0ZXI+Lio/KVxcbiotLS0vcykuZXhlYyhyZWFkKTtcclxuICAgICAgICBpZiAoZm1TZWFyY2guZ3JvdXBzLmZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgeWFtbCA9IHBhcnNlWWFtbChmbVNlYXJjaC5ncm91cHMuZnJvbnRtYXR0ZXIudHJpbSgpKVxyXG4gICAgICAgICAgICBmaWxlRnJvbnRtYXR0ZXIgPSB5YW1sXHJcbiAgICAgICAgICAgIHJlYWQgPSByZWFkLnN1YnN0cihmbVNlYXJjaFswXS5sZW5ndGgpXHJcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHZXYXJuKGBFcnJvciBwYXJzaW5nIGZyb250bWF0dGVyIG9mICR7ZmlsZS5uYW1lfSwgcGxlYXNlIHJlcG9ydC5gLCBFQkFSLCBlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvKiBNYXJrZG93biBmaWxlcyBjYW4gY2hlY2sgZm9yIGNhY2hlZCBmcm9udG1hdHRlciB3aGljaCBpcyBtYXliZSBmYXN0ZXIgKi9cclxuICAgICAgICBmaWxlRnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyXHJcbiAgICAgICAgaWYgKGZpbGVGcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgbGV0IGZtU2VhcmNoID0gKC8oPzxmcm9udG1hdHRlcj5eLS0tLio/KD89XFxuLS0tKVxcbi0tLSkvcykuZXhlYyhyZWFkKTtcclxuICAgICAgICAgIGxldCBmbVRleHQgPSBmbVNlYXJjaD8uZ3JvdXBzPy5mcm9udG1hdHRlciA/PyBudWxsXHJcbiAgICAgICAgICBpZiAoaXNFeHRhbnQoZm1UZXh0KSkgeyByZWFkID0gcmVhZC5zdWJzdHIoZm1UZXh0Lmxlbmd0aCl9ICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCBjb21waWxlZFN0cmluZyA9IEV0YS5jb21waWxlVG9TdHJpbmcocmVhZCwgRXRhLmdldENvbmZpZyh7dmFyTmFtZTogVkFSX05BTUUsIG5hbWU6IGZpbGUuYmFzZW5hbWV9KSlcclxuICAgICAgICB2YXIgY29tcGlsZWQgPSBjb21waWxlV2l0aChjb21waWxlZFN0cmluZywgW1ZBUl9OQU1FLCAnRScsICdjYicsIC4uLnNjb3BlS2V5c10sIChyZWFkLmNvbnRhaW5zKCdhd2FpdCcpKSlcclxuICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlRmFpbHVyZXMuc2V0KGZpbGUuYmFzZW5hbWUsIGVyciB8fCBgVGVtcGxhdGUgZmFpbGVkIHRvIGNvbXBpbGU6IFVua25vd24gRXJyb3JgKVxyXG4gICAgICAgIGNvbnNvbGUud2FybihgU2tyaWJpOiB0ZW1wbGF0ZSAnJHtmaWxlLmJhc2VuYW1lfScgZmFpbGVkIHRvIGNvbXBpbGVgLCBFQkFSLCBlcnIsIEVCQVIsIHJlYWQpXHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlbW92ZShmaWxlLmJhc2VuYW1lKVxyXG4gICAgICAgIHRoaXMudGVtcGxhdGVGcm9udG1hdHRlcnMuZGVsZXRlKGZpbGUuYmFzZW5hbWUpXHJcbiAgICAgICAgZmFpbHVyZUNvdW50KytcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHRoaXMudGVtcGxhdGVGYWlsdXJlcy5kZWxldGUoZmlsZS5iYXNlbmFtZSlcclxuICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLmRlZmluZShmaWxlLmJhc2VuYW1lLCBjb21waWxlZClcclxuICAgICAgdGhpcy50ZW1wbGF0ZVNvdXJjZS5kZWZpbmUoZmlsZS5iYXNlbmFtZSwgcmVhZClcclxuICAgICAgaWYgKGZpbGVGcm9udG1hdHRlcikgdGhpcy50ZW1wbGF0ZUZyb250bWF0dGVycy5zZXQoZmlsZS5iYXNlbmFtZSwgd2l0aG91dEtleShmaWxlRnJvbnRtYXR0ZXIsICdwb3NpdGlvbicpIGFzIEZyb250TWF0dGVyQ2FjaGUpXHJcbiAgICAgIHN1Y2Nlc3NDb3VudCsrXHJcblxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgcmVhZFN0eWxlcyA9IHN0eWxlRmlsZXMubWFwKGFzeW5jIGZpbGUgPT4ge1xyXG4gICAgICBsZXQgcmVhZCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpXHJcbiAgICAgIHRoaXMuc3R5bGVDYWNoZS5kZWZpbmUoZmlsZS5iYXNlbmFtZSwgcmVhZClcclxuICAgIH0pXHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHJlYWRUZW1wbGF0ZXMuY29uY2F0KHJlYWRTdHlsZXMpKVxyXG5cclxuICAgIGlmICgoIXRoaXMucGx1Z2luLmluaXRMb2FkZWQpICYmIGZpbGVzLmxlbmd0aCkge1xyXG4gICAgICBsZXQgc3RyID0gYCR7c3VjY2Vzc0NvdW50fSB0ZW1wbGF0ZSR7KHN1Y2Nlc3NDb3VudCA9PSAxKSA/ICcnIDogJ3MnfWBcclxuICAgICAgaWYgKGZhaWx1cmVDb3VudCkgc3RyICs9IGBcXG4gT2YgJHt0ZW1wbGF0ZUZpbGVzLmxlbmd0aH0gdG90YWwgdGVtcGxhdGVzLCAke2ZhaWx1cmVDb3VudH0gZmFpbGVkIHRvIGNvbXBpbGUuYFxyXG4gICAgICBjb25zb2xlLmxvZyhgU2tyaWJpOiBMb2FkZWQgYCArIHN0cilcclxuICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uaW5pdExvYWRlZCkge1xyXG4gICAgICAvKiBPdGhlciB0aGFuIGR1cmluZyBpbml0LCBkZWZpbmVQYXJ0aWFscyBpcyBjYWxsZWQgb24gc2luZ2xlIGZpbGVzIGF0IGEgdGltZS4gICovXHJcblxyXG4gICAgICBpZiAodGVtcGxhdGVGaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgQXJyYXkuZnJvbSh0aGlzLnBsdWdpbi5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgICAgIGNoaWxkLnRlbXBsYXRlc1VwZGF0ZWQodGVtcGxhdGVGaWxlc1swXS5iYXNlbmFtZSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHZMb2coYFVwZGF0ZWQgdGVtcGxhdGUgJyR7dGVtcGxhdGVGaWxlc1swXS5iYXNlbmFtZX0nIGluICR7cm91bmRUbyh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUsIDQpfW1zYClcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHN0eWxlRmlsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIEFycmF5LmZyb20odGhpcy5wbHVnaW4uY2hpbGRyZW4pLmZvckVhY2goKGNoaWxkKSA9PiB7XHJcbiAgICAgICAgICBjaGlsZC5zdHlsZXNVcGRhdGVkKHN0eWxlRmlsZXNbMF0uYmFzZW5hbWUpXHJcbiAgICAgICAgfSlcclxuICAgICAgICB2TG9nKGBVcGRhdGUgc3R5bGUgJyR7c3R5bGVGaWxlc1swXS5iYXNlbmFtZX0nYClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgLyogRGVsZXRlcyBjYWNoZSBlbnRyaWVzIGJ5IHN0cmluZyBuYW1lIG9yIGZpbGUgb2Ygb3JpZ2luICovXHJcbiAgZGVsZXRlUGFydGlhbCguLi5pdGVtczogQXJyYXk8VEZpbGUgfCBzdHJpbmc+KTogdm9pZCB7XHJcbiAgICBmb3IgKGxldCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGxldCBuYW1lID0gaXNGaWxlKGl0ZW0pID8gaXRlbS5iYXNlbmFtZSA6IGl0ZW1cclxuICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLnJlbW92ZShuYW1lKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlUGFydGlhbEJ5TmFtZSguLi5pdGVtczogQXJyYXk8c3RyaW5nPikge1xyXG4gICAgZm9yIChsZXQgaXRlbSBvZiBpdGVtcykge1xyXG4gICAgICBsZXQgc3BsaXQgPSAoLyg/PG5hbWU+W15dKylcXC4oPzxleHRlbnNpb24+W15dKykkL2cpLmV4ZWMoaXRlbSlcclxuICAgICAgaWYgKCEoT2JqZWN0LmtleXMoc3BsaXQ/Lmdyb3Vwcyk/Lmxlbmd0aCA/PyAwID4gMCkpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ1NrcmliaTogVGVtcGxhdGVMb2FkZXIuZGVsZXRlUGFydGlhbEJ5TmFtZSgpIGNvdWxkIG5vdCBwYXJzZSBuYW1lIFxcbicsIGl0ZW0pXHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgKChzcGxpdC5ncm91cHNbJ2V4dGVuc2lvbiddID09IFwiY3NzXCIpID8gdGhpcy5zdHlsZUNhY2hlIDogdGhpcy50ZW1wbGF0ZUNhY2hlKVxyXG4gICAgICAucmVtb3ZlKHNwbGl0Lmdyb3Vwc1snbmFtZSddKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIHJlbG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMudGVtcGxhdGVDYWNoZS5yZXNldCgpXHJcbiAgICByZXR1cm4gdGhpcy5kZWZpbmVQYXJ0aWFscyguLi5nZXRGaWxlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZGlyZWN0b3J5KSlcclxuICB9XHJcblxyXG4gIC8qIEZpbGVNaW5kZXIgRnVuY3Rpb25zICovXHJcbiAgXHJcbiAgZ2V0IGRpcmVjdG9yeSgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIgfVxyXG5cclxuICBmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBpbiB0ZW1wbGF0ZSBkaXJlY3RvcnkgbW9kaWZpZWQsIHVwZGF0aW5nLi4uYClcclxuICAgIHRoaXMuZGVmaW5lUGFydGlhbHMoZmlsZSlcclxuICB9XHJcblxyXG4gIC8vIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUgfCBzdHJpbmcpOiB2b2lkIHsgLy8gbmV2ZXIgYWN0dWFsbHkgY2FsbGVkIGFzIHN0cmluZyBJIGp1c3Qgd3JvdGUgaXQgdG8gaGFuZGxlIGl0IGZvciBzb21lIHJlYXNvblxyXG4gIC8vICAgbGV0IGlzZiA9IGlzRmlsZShmaWxlKVxyXG4gIC8vICAgaWYgKCghaXNmICYmICEoU3RyaW5nLmlzU3RyaW5nKGZpbGUpICYmIHRoaXMudGVtcGxhdGVDYWNoZS5nZXQoZmlsZSkpKSkgcmV0dXJuO1xyXG4gIC8vICAgdkxvZyhgRmlsZSAnJHtpc2YgPyAoZmlsZSBhcyBURmlsZSkubmFtZSA6IGZpbGV9JyByZW1vdmVkIGZyb20gdGVtcGxhdGUgZGlyZWN0b3J5LCB1bmxvYWRpbmcuLi5gKVxyXG4gIC8vICAgdGhpcy5kZWxldGVQYXJ0aWFsKGZpbGUgYXMgKFRGaWxlIHwgc3RyaW5nKSlcclxuICAvLyB9XHJcblxyXG4gIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIHJlbW92ZWQgZnJvbSB0ZW1wbGF0ZSBkaXJlY3RvcnksIHVubG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmRlbGV0ZVBhcnRpYWxCeU5hbWUoZmlsZS5uYW1lKVxyXG4gIH1cclxuXHJcbiAgZmlsZUFkZGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIGFkZGVkIHRvIHRlbXBsYXRlIGRpcmVjdG9yeSwgbG9hZGluZy4uLmApXHJcbiAgICB0aGlzLmRlZmluZVBhcnRpYWxzKGZpbGUpXHJcbiAgfVxyXG5cclxuICBmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBUZW1wbGF0ZSBmaWxlICcke29sZE5hbWV9JyByZW5hbWVkIHRvICcke2ZpbGUubmFtZX0nLCB1cGRhdGluZy4uLmApXHJcblxyXG4gICAgdGhpcy5kZWxldGVQYXJ0aWFsQnlOYW1lKG9sZE5hbWUpXHJcbiAgICB0aGlzLmRlZmluZVBhcnRpYWxzKGZpbGUpXHJcbiAgfVxyXG5cclxuICBkaXJlY3RvcnlDaGFuZ2VkKCk6IHZvaWQge1xyXG4gICAgdkxvZyhgVGVtcGxhdGUgZGlyZWN0b3J5IGNoYW5nZWQsIHJlbG9hZGluZyB0ZW1wbGF0ZXMuLi5gKVxyXG4gICAgdGhpcy5yZWxvYWQoKVxyXG4gIH1cclxuXHJcbiAgaXNJbkRvbWFpbihmaWxlOiBUQWJzdHJhY3RGaWxlKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gaXNJbkZvbGRlcihmaWxlLCB0aGlzLmRpcmVjdG9yeSlcclxuICB9XHJcbn0iLCJpbXBvcnQgKiBhcyBFdGEgZnJvbSBcImV0YVwiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZUZ1bmN0aW9uIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbXBpbGVcIjtcclxuaW1wb3J0IHsgRXRhQ29uZmlnIH0gZnJvbSBcImV0YS9kaXN0L3R5cGVzL2NvbmZpZ1wiO1xyXG5pbXBvcnQgeyBub3JtYWxpemVQYXRoLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBFQkFSLCBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgRmlsZU1pbmRlciwgc2NvcGVkVmFycywgU3RyaW5nZGV4LCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcIi4uL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50IH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuaW1wb3J0IHsgcmVuZGVyRXRhQXN5bmMsIHJlbmRlckV0YSwgY29tcGlsZVdpdGggfSBmcm9tIFwiLi9jb21wXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyQnVzIH0gZnJvbSBcIi4vcHJvdmlkZXJfYnVzXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlTG9hZGVyIH0gZnJvbSBcIi4vdGVtcGxhdGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRXRhSGFuZGxlciB7XHJcbiAgcGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG4gIGJ1czogUHJvdmlkZXJCdXM7XHJcbiAgbG9hZGVyOiBUZW1wbGF0ZUxvYWRlcjtcclxuXHJcbiAgdGVtcGxhdGVzRGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgZ2V0IHRlbXBsYXRlcygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZX1cclxuICBnZXQgZmFpbGVkVGVtcGxhdGVzKCkge3JldHVybiB0aGlzLmxvYWRlci50ZW1wbGF0ZUZhaWx1cmVzfVxyXG4gIGdldCB0ZW1wbGF0ZUZyb250bWF0dGVycygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVGcm9udG1hdHRlcnN9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmJ1cyA9IG5ldyBQcm92aWRlckJ1cyh0aGlzKVxyXG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgVGVtcGxhdGVMb2FkZXIodGhpcylcclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UubGF5b3V0UmVhZHkpXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB0aGlzLmluaXQuYmluZCh0aGlzKSgpKVxyXG4gICAgZWxzZSB0aGlzLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIHRoaXMuaW5pdExvYWQoKS50aGVuKCgpID0+IHtcclxuICAgICAgdGhpcy5yZWdpc3RlckZpbGVFdmVudHMoKVxyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBTa3JpYmk6IEV0YUhhbmRsZXIgZmFpbGVkIHRvIGluaXRpYWxpemUhYCwgRUJBUiwgZXJyKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyRmlsZUV2ZW50cygpIHtcclxuICAgIC8qIEJlY2F1c2UgdGhlIEZpbGVNaW5kZXIgaW5kZXggZG9lcyBub3QgY2hhbmdlLCB3ZSBkb24ndCBuZWVkIHRoZSBldmVudCByZWZzICovXHJcblxyXG4gICAgY29uc3QgbWluZGVyczogRmlsZU1pbmRlcltdID0gW3RoaXMuYnVzLnNjcmlwdExvYWRlciwgdGhpcy5sb2FkZXJdXHJcbiAgICBmb3IgKGxldCBtaW5kZXIgb2YgbWluZGVycykge1xyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignbW9kaWZ5JywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZVVwZGF0ZWQoZmlsZSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignZGVsZXRlJywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZURlbGV0ZWQoZmlsZSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignY3JlYXRlJywgZmlsZSA9PiB7XHJcbiAgICAgICAgaWYgKG1pbmRlci5pc0luRG9tYWluKGZpbGUpKSBtaW5kZXIuZmlsZUFkZGVkKGZpbGUpXHJcbiAgICAgIH0pKVxyXG5cclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XHJcbiAgICAgICAgICBsZXQgb3VyRGlyID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3JtYWxpemVQYXRoKG1pbmRlci5kaXJlY3RvcnkpKVxyXG4gICAgICAgICAgbGV0IG9sZERpciA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplUGF0aCgoLy4rXFwvL2cpLmV4ZWMob2xkUGF0aClbMF0pKVxyXG4gICAgICAgICAgaWYgKGZpbGUucGFyZW50ID09IG91ckRpcikge1xyXG4gICAgICAgICAgICAvLyBOZXcgbG9jYXRpb24gb2YgZmlsZSBpcyBpbiBvdXIgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnBhcmVudCA9PSBvbGREaXIpIHtcclxuICAgICAgICAgICAgICAvLyBGaWxlIGRpZCBub3QgbW92ZSBidXQgd2FzIHJlbmFtZWRcclxuICAgICAgICAgICAgICBtaW5kZXIuZmlsZVJlbmFtZWQoZmlsZSwgKC8oW2EtekEtWjAtOS1fLl0rXFwuLiopL2cpLmV4ZWMob2xkUGF0aClbMF0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gRmlsZSB3YXMgbW92ZWQgZnJvbSBlbHNld2hlcmUgaW50byB0aGUgdGVtcGxhdGUgZGlyZWN0b3J5XHJcbiAgICAgICAgICAgICAgbWluZGVyLmZpbGVBZGRlZChmaWxlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG9sZERpciA9PSBvdXJEaXIpIHtcclxuICAgICAgICAgICAgLy8gRmlsZSB1c2VkIHRvIGJlIGluIHRlbXBsYXRlcyBkaXJlY3RvcnkgYW5kIGlzIG5vIGxvbmdlclxyXG4gICAgICAgICAgICBtaW5kZXIuZmlsZURlbGV0ZWQoZmlsZSlcclxuICAgICAgICAgIH1cclxuICAgICAgfSkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0TG9hZCgpIHtcclxuICAgIGxldCB7YTogYSwgYjogYn0gPSBhd2FpdCB0aGlzLmJ1cy5wcmVJbml0KCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHJldHVybiB7YTogdGhpcy5idXMuaW5pdCgpLCBiOiB0aGlzLmxvYWRlci5pbml0KCl9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbYSwgYl0pXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmJ1cy51bmxvYWQoKVxyXG4gIH1cclxuXHJcbiAgcmVjb21waWxlVGVtcGxhdGVzKCkge1xyXG4gICAgLy8gSWYgdGhlIGJ1cyBzY29wZSBjaGFuZ2VzLCB0aGUgdGVtcGxhdGVzIG11c3QgYmUgcmVjb21waWxlZC4gXHJcbiAgICAvLyBUaGUgYnVzIHNjb3BlIHNob3VsZCBub3QgY2hhbmdlIHBvc3QtaW5pdCB1bmxlc3MgYW4gZXh0ZXJuYWwgc291cmNlIG1vZGlmaWVzIHRoZSBwcm92aWRlciBsaXN0LlxyXG4gICAgdGhpcy5sb2FkZXIucmVsb2FkKClcclxuICB9XHJcblxyXG4gIGdldFBhcnRpYWwoaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMubG9hZGVyLnRlbXBsYXRlQ2FjaGUuZ2V0KGlkKVxyXG4gIH1cclxuXHJcbiAgaGFzUGFydGlhbChpZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gaXNFeHRhbnQodGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZS5nZXQoaWQpKVxyXG4gIH1cclxuXHJcbiAgZ2V0Q2FjaGVLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudGVtcGxhdGVzLmNhY2hlKVxyXG4gIH1cclxuXHJcbiAgLyoqICAgXHJcbiAgKiBQcmltYXJ5IHNrcmliaSByZW5kZXIgZnVuY3Rpb24uIFJlbmRlcnMgYXN5bmNocm9ub3VzbHkgKFRlbXBsYXRlRnVuY3Rpb24gbWF5IG9yIG1heSBub3QgYmUgYXN5bmMpXHJcbiAgKiBAcGFyYW0gY29udGVudCBTdHJpbmcgb3Igc2NvcGVkIHRlbXBsYXRlIGZ1bmN0aW9uIHRvIHJlbmRlclxyXG4gICogQHBhcmFtIGN0eEluIENvbnRleHQgb2JqZWN0IHRvIGJlIGFkZGVkIHRvIGBza2Agb2JqZWN0XHJcbiAgKiBAcGFyYW0gZmlsZSBGaWxlIGluIHdoaWNoIHRoZSBza3JpYmkgaXMgYmVpbmcgcmVuZGVyZWQgIFxyXG4gICogQHJldHVybnMgW3JlbmRlcmVkIHN0cmluZywgcmV0dXJuZWQgcGFja2V0IChjdXJyZW50bHkgdW51c2VkKV0gKi9cclxuICBhc3luYyByZW5kZXJBc3luYyhjb250ZW50OiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBjdHhJbj86IGFueSwgZmlsZT86IFRGaWxlKTogUHJvbWlzZTxbc3RyaW5nLCBTdHJpbmdkZXhdPiB7XHJcbiAgICAvKiBVc2VkIHRvIHBhc3MgZGF0YSB1cCB0byB0aGUgcmVuZGVyIHByb2Nlc3MgZnJvbSB0aGUgc2tyaWJpIGZ1bmN0aW9uICovXHJcbiAgICBsZXQgcGFja2V0OiBTdHJpbmdkZXggPSB7fTtcclxuICAgIGZ1bmN0aW9uIHVwKCkge1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24oeDogc3RyaW5nLCB5OiBhbnkpIHtcclxuICAgICAgICBwYWNrZXRbeF0gPSB5XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBsZXQgY2ZnID0gRXRhLmdldENvbmZpZyh7dmFyTmFtZTogVkFSX05BTUV9KVxyXG5cclxuICAgIC8qIHRoZSAndGhpcycgb2JqZWN0IG9mIHRoZSBzayBjb250ZXh0Ki9cclxuICAgIGxldCBiaW5kZXIgPSB7fVxyXG5cclxuICAgIC8qIFRoZSAnc2snIG9iamVjdCAqL1xyXG4gICAgbGV0IHNrID0gT2JqZWN0LmFzc2lnbih7fSxcclxuICAgICAgY3R4SW4gfHwge30sIFxyXG4gICAgICB7XHJcbiAgICAgICAgdGhpczogYmluZGVyLCBcclxuICAgICAgICBnZXRFbnY6IGdldEVudiwgXHJcbiAgICAgICAgdXA6IHVwKCksIFxyXG4gICAgICAgIGN0eDoge1xyXG4gICAgICAgICAgZmlsZTogZmlsZSB8fCBudWxsLFxyXG4gICAgICAgICAgcGx1Z2luOiB0aGlzLnBsdWdpbixcclxuICAgICAgICAgIGFwcDogdGhpcy5wbHVnaW4uYXBwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0aGlzLmJ1cy5nZXRTY29wZVNLKClcclxuICAgIClcclxuXHJcbiAgICAvKiBTY29wZSB0byBwYXNzIHRvIHRoZSBmdW5jdGlvbi4gTXVzdCBjb250YWluIGFsbCBrZXlzIHRoYXQgZnVuY3Rpb24gd2FzIGNvbXBpbGVkIHdpdGguICovXHJcbiAgICBsZXQgc2NvcGU6IHNjb3BlZFZhcnMgPSB7XHJcbiAgICAgICdzayc6IHNrLFxyXG4gICAgICAnRSc6IGNmZyxcclxuICAgICAgJ2NiJzogbnVsbCxcclxuICAgICAgLi4udGhpcy5idXMuZ2V0U2NvcGUoKSxcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRFbnYoKSB7XHJcbiAgICAgIHJldHVybiBzY29wZVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZW4gPSAoY29udGVudC50b1N0cmluZygpLmNvbnRhaW5zKCdhd2FpdCcpKSAvLyBUaGlzIHdpbGwgY2F0Y2ggc3RyaW5ncyBjb250YWluaW5nIGF3YWl0IGFzIHdlbGwsIG1heWJlIGEgZmxhZyBzaG91bGQgYmUgdXNlZCBpbnN0ZWFkXHJcbiAgICAgID8gcmVuZGVyRXRhQXN5bmModGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuICAgICAgOiByZW5kZXJFdGEodGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuXHJcbiAgICBpZiAocmVuIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICByZXR1cm4gYXdhaXQgcmVuLnRoZW4oKHIpID0+IHtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyLCBwYWNrZXRdKX0sIChyKSA9PiB7cmV0dXJuIFByb21pc2UucmVqZWN0KHIpfSlcclxuICAgIH0gZWxzZSBpZiAoU3RyaW5nLmlzU3RyaW5nKHJlbikpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcmVuIGFzIHN0cmluZywgcGFja2V0XSkgfVxyXG4gICAgZWxzZSByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJFdGFIYW5kbGVyLnJlbmRlckFzeW5jOiBVbmtub3duIEVycm9yXCIpXHJcbiAgfVxyXG5cclxuICAvKiB0aGlzIGlzIHNvbWVob3cgMS4zeCBzbG93ZXIgdGhhbiByZW5kZXJBc3luYyAqL1xyXG4gIGFzeW5jIHJlbmRlckFzeW5jTmFpdmUoY29udGVudDogc3RyaW5nIHwgRnVuY3Rpb24sIGN0eEluPzogYW55LCB2YXJOYW1lPzogYW55KSB7XHJcbiAgICBjb25zb2xlLmxvZygnU2tyaWJvczogcmVuZGVyQXN5bmNOYWl2ZSBpbnZva2VkJywgY29udGVudCwgY3R4SW4pXHJcbiAgICBsZXQgY29udGV4dCA9IE9iamVjdC5hc3NpZ24oe30sIGN0eEluIHx8IHt9KVxyXG4gICAgbGV0IHJlbiA9IEV0YS5yZW5kZXJBc3luYyhjb250ZW50IGFzIChzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uKSwgY29udGV4dCwge3Zhck5hbWU6IHZhck5hbWUgPz8gVkFSX05BTUV9KVxyXG5cclxuICAgIGlmIChyZW4gaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCByZW4udGhlbigocikgPT4ge3JldHVybiBQcm9taXNlLnJlc29sdmUocil9LCAocikgPT4ge3JldHVybiBQcm9taXNlLnJlamVjdChyKX0pXHJcbiAgICB9IGVsc2UgaWYgKFN0cmluZy5pc1N0cmluZyhyZW4pKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUocmVuIGFzIHN0cmluZykgfVxyXG4gICAgZWxzZSByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJVbmtub3duIGVycm9yXCIpXHJcbiAgfVxyXG5cclxuICByZW5kZXIoY29udGVudDogc3RyaW5nLCBjdHhJbj86IGFueSkge1xyXG4gICAgbGV0IGNvbnRleHQgPSBjdHhJbiB8fCB7fTtcclxuXHJcbiAgICBjb250ZW50ID0gRXRhLnJlbmRlcihjb250ZW50LCBjb250ZXh0LCB7IFxyXG4gICAgICB2YXJOYW1lOiBWQVJfTkFNRVxyXG4gICAgfSkgYXMgc3RyaW5nO1xyXG5cclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxuXHJcbiAgLyoqIFRlbXBsYXRlRnVuY3Rpb24gaGFuZGxlciwgd2lsbCByZXR1cm4gY2FjaGVkIG9yIGNvbXBpbGVkIGZ1bmN0aW9uLCBhcHByb3ByaWF0ZWx5IGJvdW5kIGFuZCBzY29wZWRcclxuICAgKiBAcGFyYW0gdGVtcGxhdGUgU3RyaW5nIG9yIHNjb3BlZCB0ZW1wbGF0ZSBmdW5jdGlvblxyXG4gICAqIEBwYXJhbSBvcHRpb25zIEV0YUNvbmZpZyBcclxuICAgKiBAcGFyYW0gc2NvcGUgT2JqZWN0IGNvbnRhaW5pbmcgb2JqZWN0cyB0aGF0IHNob3VsZCBiZSBhdmFpbGFibGUgaW4gdGhlIHJldHVybmVkIGZ1bmN0aW9uJ3Mgc2NvcGUgXHJcbiAgICogQHBhcmFtIGJpbmRlciBPYmplY3QgdG8gd2hpY2ggdGhlIHJldHVybmVkIGZ1bmN0aW9uIHdpbGwgYmUgYm91bmQgKi9cclxuICBnZXRDYWNoZWQodGVtcGxhdGU6IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIG9wdGlvbnM6IEV0YUNvbmZpZywgc2NvcGU/OiBTdHJpbmdkZXgsIGJpbmRlcj86IGFueSk6IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQge1xyXG4gICAgaWYgKG9wdGlvbnMubmFtZSAmJiB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKSkge1xyXG4gICAgICByZXR1cm4gKGJpbmRlcikgPyB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKS5iaW5kKGJpbmRlcikgOiB0aGlzLnRlbXBsYXRlcy5nZXQob3B0aW9ucy5uYW1lKVxyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgdGVtcGxhdGVGdW5jID0gdHlwZW9mIHRlbXBsYXRlID09PSAnZnVuY3Rpb24nID8gdGVtcGxhdGUgOiBjb21waWxlV2l0aChFdGEuY29tcGlsZVRvU3RyaW5nKHRlbXBsYXRlLCBvcHRpb25zKSwgT2JqZWN0LmtleXMoc2NvcGUpLCBvcHRpb25zLmFzeW5jKVxyXG4gIFxyXG4gICAgaWYgKG9wdGlvbnMubmFtZSkgdGhpcy50ZW1wbGF0ZXMuZGVmaW5lKG9wdGlvbnMubmFtZSwgdGVtcGxhdGVGdW5jKTtcclxuICBcclxuICAgIHJldHVybiAoYmluZGVyKSA/IHRlbXBsYXRlRnVuYy5iaW5kKGJpbmRlcikgOiB0ZW1wbGF0ZUZ1bmNcclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFN0cmluZ2RleCB9IGZyb20gJ3NyYy90eXBlcy90eXBlcydcclxuaW1wb3J0IHsgaXNFeHRhbnQsIHZMb2csIHZXYXJuIH0gZnJvbSAnc3JjL3V0aWwnXHJcbmltcG9ydCBlbiBmcm9tICcuL2xvY2FsZS9lbi5qc29uJ1xyXG5pbXBvcnQgZW5fZ2IgZnJvbSAnLi9sb2NhbGUvZW5fZ2IuanNvbidcclxuXHJcbi8vIERvdWJ0IHRoaXMgd2lsbCBiZSB1c2VkIGJ1dCBJIHdhbnRlZCB0byBkbyBpdCBhbnl3YXlcclxuXHJcbnR5cGUgbG9jYWxlID0gUGFydGlhbDx0eXBlb2YgZW4+ICYgU3RyaW5nZGV4PHN0cmluZz5cclxuXHJcbnR5cGUgbCA9IHtcclxuICAnXyc6IChrZXk6IGtleW9mIHR5cGVvZiBlbiwgLi4uYXJnczogc3RyaW5nW10pID0+IHN0cmluZ1xyXG59ICYgdHlwZW9mIGVuIFxyXG4vKiBOT1RFOiB0aGlzIGlzIGp1c3QgY2F1c2UgVlNDIHNvbWV0aW1lcyByZWZ1c2VzIHRvIHVwZGF0ZSB0aGUganNvbiBkZWZpbml0aW9ucyB3aXRob3V0IGhhdmluZyB0byByZXN0YXJ0IGFuZCBvcGVuIGFsbCBteSB0ZXJtaW5hbHMgYWdhaW4gKi9cclxuJiBTdHJpbmdkZXg8c3RyaW5nPlxyXG5cclxuY29uc3QgbG9jYWxlczogU3RyaW5nZGV4PGxvY2FsZT4gJiB7ZW46IFN0cmluZ2RleDxzdHJpbmc+ICYgdHlwZW9mIGVufSA9IHtcclxuICBlbjogZW4sXHJcbiAgJ2VuLWdiJzogZW5fZ2JcclxufVxyXG5cclxuZnVuY3Rpb24gbWFrZSgpOiBsIHtcclxuICBsZXQgb3V0ID0ge1xyXG4gICAgJ18nOiB0XHJcbiAgfVxyXG4gIFxyXG4gIGZvciAobGV0IGtleSBvZiBPYmplY3Qua2V5cyhlbikpIHtcclxuICAgIGlmIChTdHJpbmcuaXNTdHJpbmcoKGVuIGFzIFN0cmluZ2RleClba2V5XSkpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG91dCwga2V5LCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiBsb2NhbGUoKT8uW2tleV0gPz8gKGVuIGFzIGxvY2FsZSlba2V5XVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHZMb2coJ0xvY2FsZSBkZWZpbml0aW9ucyBjb25zdHJ1Y3RlZCcpXHJcbiAgcmV0dXJuIG91dCBhcyBsXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxvY2FsZSgpOiBsb2NhbGUge3JldHVybiBsb2NhbGVzPy5bd2luZG93Lm1vbWVudC5sb2NhbGUoKV19XHJcblxyXG4vKiBQdWxsIGxvY2FsaXplZCBzdHJpbmdzIGZyb20gdGhpcy4gKi9cclxuZXhwb3J0IGNvbnN0IGw6IGwgPSBtYWtlKClcclxuXHJcbi8qKlxyXG4gKiBZb3UgY2FuIHB1bGwgc3RyaW5ncyBmcm9tIHRoaXMuXHJcbiAqIFBybzogc2FmZWx5IGhhbmRsZXMgdW5kZWZpbmVkIGtleXNcclxuICogQ29udHJhOiB5b3Ugd29uJ3QgZ2V0IHRoZSBwcm9wZXJ0eSBkZWZpbml0aW9uIHRvb2x0aXBzIGluIFZTQywgd2hpY2ggd2FzIHRoZSB3aG9sZSBwb2ludCBvZiB0aGlzIGRlc2lnblxyXG4gKiBAcGFyYW0ga2V5IExhbmcgZmlsZSBzdHJpbmcga2V5IHRvIHJldHVybiBsb2NhbCB2ZXJzaW9uIG9mXHJcbiAqIEBwYXJhbSBhcmdzIFN0cmluZ3MgdG8gaW5zZXJ0IGludG8gaW5zZXJ0aW9uIHRhZ3MgKGVnICclMCcpXHJcbiAqIEByZXR1cm5zIExvY2FsaXplZCBzdHJpbmcgKi9cclxuZnVuY3Rpb24gdChrZXk6IGtleW9mIHR5cGVvZiBlbiwgLi4uYXJnczogc3RyaW5nW10pOiBzdHJpbmcge1xyXG4gIGlmICghaXNFeHRhbnQoKGVuIGFzIGFueSlba2V5XSkpIHZXYXJuKGBCYWJlbCByZWNlaXZlZCB1bmRlZmluZWQga2V5OiAke2tleX1gKTtcclxuICBsZXQgc3RyOiBzdHJpbmcgPSBsW2tleV0gPz8gKGVuIGFzIGxvY2FsZSlba2V5XSA/PyBgJCR7a2V5fWAgXHJcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKCgvJShcXGQrKS9nKSwgKHQsIG4pID0+ICh2b2lkIDAgIT09IGFyZ3Nbbl0gPyBhcmdzW25dIDogdCkpXHJcbn1cclxuXHJcbiIsImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgeyBsIH0gZnJvbSBcInNyYy9sYW5nL2JhYmVsXCI7XHJcbmltcG9ydCB7IGtscyB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5cclxuaW50ZXJmYWNlIGNvbmZpcm1hdGlvbk1vZGFsVmFsdWVzIHtcclxuICB0aXRsZTogc3RyaW5nXHJcbiAgbGFiZWxQb3M6IHN0cmluZ1xyXG4gIGxhYmVsTmVnOiBzdHJpbmdcclxuICBkZXNjPzogc3RyaW5nXHJcbiAgY2xhc3M/OiBzdHJpbmdcclxuICBlbGVtZW50cz86IEVsZW1lbnRbXVxyXG59IFxyXG5cclxuZXhwb3J0IGNsYXNzIGNvbmZpcm1hdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgcmVzb2x2ZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgcHJpdmF0ZSByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQ7XHJcblxyXG4gIHByaXZhdGUgZmllbGRzOiBjb25maXJtYXRpb25Nb2RhbFZhbHVlcyA9IHtcclxuICAgIHRpdGxlOiBsW1wibW9kYWwuY29uZmlybS50aXRsZVwiXSxcclxuICAgIGxhYmVsUG9zOiBsW1wibW9kYWwuY29uZmlybS5jb25maXJtXCJdLFxyXG4gICAgbGFiZWxOZWc6IGxbXCJtb2RhbC5jb25maXJtLmNhbmNlbFwiXSxcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWVsZHNJbj86IFBhcnRpYWw8Y29uZmlybWF0aW9uTW9kYWxWYWx1ZXM+KSB7XHJcbiAgICBzdXBlcihhcHApXHJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMuZmllbGRzLCBmaWVsZHNJbiB8fCB7fSlcclxuICB9XHJcblxyXG4gIG9uT3Blbigpe1xyXG4gICAgdGhpcy50aXRsZUVsLnNldFRleHQodGhpcy5maWVsZHMudGl0bGUpXHJcbiAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXp6KGtscygnY29uZmlybWF0aW9uLW1vZGFsJyksIHRoaXMuZmllbGRzLmNsYXNzKVxyXG4gICAgaWYgKHRoaXMuZmllbGRzLmRlc2MpIHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7Y2xzOiBrbHMoJ2NvbmZpcm1hdGlvbi1tb2RhbC1kZXNjcmlwdGlvbicpLCB0ZXh0OiB0aGlzLmZpZWxkcy5kZXNjfSlcclxuICAgIHRoaXMuY29udGVudEVsLmFwcGVuZCguLi50aGlzLmZpZWxkcy5lbGVtZW50cylcclxuXHJcbiAgICBsZXQgYyA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7Y2xzOiBrbHMoJ2NvbmZpcm0tbW9kYWwtYnV0dG9ucycpfSlcclxuICAgIGMuY3JlYXRlRWwoXCJidXR0b25cIiwge3RleHQ6IHRoaXMuZmllbGRzLmxhYmVsUG9zLCBjbHM6IGtscygnbW9kYWwtYnV0dG9uLWNvbmZpcm0nKX0sIChiKSA9PiB7ICBcclxuICAgICAgYi5vbkNsaWNrRXZlbnQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZShcInRydWVcIilcclxuICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgfSkgXHJcbiAgICB9KVxyXG5cclxuICAgIGMuY3JlYXRlRWwoXCJidXR0b25cIiwge3RleHQ6IHRoaXMuZmllbGRzLmxhYmVsTmVnLCBjbHM6IGtscygnbW9kYWwtYnV0dG9uLWNhbmNlbCcpfSwgKGIpID0+IHsgXHJcbiAgICAgIGIub25DbGlja0V2ZW50KCgpID0+IHtcclxuICAgICAgICB0aGlzLnJlc29sdmUoXCJmYWxzZVwiKVxyXG4gICAgICAgIHRoaXMuY2xvc2UoKSBcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBhc3luYyBvcGVuQW5kR2V0VmFsdWUocmVzb2x2ZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQsIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xyXG4gICAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcclxuICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWFrZUV4dGVybmFsTGluayhsaW5rSW46IEhUTUxBbmNob3JFbGVtZW50IHwgc3RyaW5nKTogSFRNTEFuY2hvckVsZW1lbnQge1xyXG5cdGNvbnN0IGxpbmsgPSBTdHJpbmcuaXNTdHJpbmcobGlua0luKSA/IGNyZWF0ZUVsKCdhJywge2F0dHI6IHtocmVmOiBsaW5rSW59fSkgOiBsaW5rSW5cclxuXHJcbiAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldikgPT4ge1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKVxyXG5cclxuICAgIGxldCBwID0gbmV3IGNvbmZpcm1hdGlvbk1vZGFsKHdpbmRvdy5hcHAsIHtcclxuICAgICAgdGl0bGU6IGxbXCJtb2RhbC5leHRlcm5hbC50aXRsZVwiXSxcclxuICAgICAgZGVzYzogbFtcIm1vZGFsLmV4dGVybmFsLmRlc2NcIl0sXHJcbiAgICAgIGxhYmVsUG9zOiBsW1wibW9kYWwuZXh0ZXJuYWwubGFiZWxcIl0sXHJcbiAgICAgIGVsZW1lbnRzOiBbY3JlYXRlRGl2KHtjbHM6IGtscygnY29uZmlybWF0aW9uLW1vZGFsLWxpbmsnKSwgdGV4dDogbGluay5nZXRBdHRyKCdocmVmJyl9KV1cclxuICAgIH0pO1xyXG5cclxuICAgIG5ldyBQcm9taXNlKChyZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCwgcmVqZWN0OiAocmVhc29uPzogYW55KSA9PiB2b2lkKSA9PiBwLm9wZW5BbmRHZXRWYWx1ZShyZXNvbHZlLCByZWplY3QpKVxyXG4gICAgLnRoZW4ocmVzID0+ICB7XHJcbiAgICAgIGlmIChyZXMgPT09IFwidHJ1ZVwiKSB7XHJcbiAgICAgICAgd2luZG93Lm9wZW4obGluay5nZXRBdHRyKCdocmVmJykpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSlcclxuXHJcblx0cmV0dXJuIGxpbmtcclxufSIsImltcG9ydCB7IFBsdWdpblNldHRpbmdUYWIsIEFwcCwgU2V0dGluZywgVGV4dEFyZWFDb21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCwgZGVib3VuY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgbCB9IGZyb20gXCIuL2xhbmcvYmFiZWxcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBtYWtlRXh0ZXJuYWxMaW5rIH0gZnJvbSBcIi4vbW9kYWwvY29uZmlybWF0aW9uTW9kYWxcIjtcclxuaW1wb3J0IHsgaXNFeHRhbnQsIGlzRnVuYywgbGlua0RvY3MgfSBmcm9tIFwiLi91dGlsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2tyaWJvc1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IFNrcmlib3NQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFNrcmlib3NQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGxldCB7Y29udGFpbmVyRWx9ID0gdGhpcztcclxuIFxyXG5cdFx0Y29udGFpbmVyRWwuYWRkQ2xhc3MoXCJza3JpYmktc2V0dGluZ3NcIik7XHJcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6IGxbXCJzZXR0aW5nLnRpdGxlXCJdfSk7XHJcblx0XHRcclxuICAgIGxldCBkZXNjID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHtjbHM6ICdza3JpYmktbW9kYWwtZGVzYycsIGF0dHI6IHtzdHlsZTogXCJtYXJnaW4tYm90dG9tOiAxZW07XCJ9fSlcclxuICAgIG1ha2VFeHRlcm5hbExpbmsoZGVzYy5jcmVhdGVFbCgnYScsIHt0ZXh0OiBsWydkb2N1bWVudGF0aW9uJ10sIGF0dHI6IHsnaHJlZic6IGxpbmtEb2NzKCdzZXR0aW5ncycpfX0pKVxyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShsW1wic2V0dGluZy50ZW1wbGF0ZURpcmVjdG9yeS5uYW1lXCJdKVxyXG5cdFx0XHQuc2V0RGVzYyhsW1wic2V0dGluZy50ZW1wbGF0ZURpcmVjdG9yeS5kZXNjXCJdKVxyXG5cdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQ6IFRleHRBcmVhQ29tcG9uZW50KSA9PiB7dGV4dFxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlcilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSk7IHRleHQuaW5wdXRFbC5jb2xzID0gMzA7IHJldHVybiB0ZXh0fSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKGxbXCJzZXR0aW5nLnNjcmlwdERpcmVjdG9yeS5uYW1lXCJdKVxyXG5cdFx0XHQuc2V0RGVzYyhsW1wic2V0dGluZy5zY3JpcHREaXJlY3RvcnkuZGVzY1wiXSlcclxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0OiBUZXh0QXJlYUNvbXBvbmVudCkgPT4ge3RleHRcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2NyaXB0Rm9sZGVyKVxyXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdHRoaXMuc2F2ZVNldHRpbmcoJ3NjcmlwdEZvbGRlcicsIHZhbHVlLCAoKSA9PiB0aGlzLnBsdWdpbi5ldGEuYnVzLnNjcmlwdExvYWRlci5kaXJlY3RvcnlDaGFuZ2VkKCkpXHJcblx0XHRcdFx0fSk7IHRleHQuaW5wdXRFbC5jb2xzID0gMzA7IHJldHVybiB0ZXh0fSk7XHJcblxyXG5cdFx0dGhpcy5tYWtlVG9nZ2xlKGNvbnRhaW5lckVsLCBcImF1dG9SZWxvYWRcIiwgbFtcInNldHRpbmcuYXV0b1JlbG9hZC5uYW1lXCJdLCBsW1wic2V0dGluZy5hdXRvUmVsb2FkLmRlc2NcIl0pXHJcblx0XHR0aGlzLm1ha2VUb2dnbGUoY29udGFpbmVyRWwsIFwiZXJyb3JMb2dnaW5nXCIsIGxbXCJzZXR0aW5nLmVycm9yTG9nLm5hbWVcIl0sIGxbXCJzZXR0aW5nLmVycm9yTG9nLmRlc2NcIl0pXHJcblx0XHR0aGlzLm1ha2VUb2dnbGUoY29udGFpbmVyRWwsIFwidmVyYm9zZUxvZ2dpbmdcIiwgbFtcInNldHRpbmcudmVyYm9zZS5uYW1lXCJdLCBsW1wic2V0dGluZy52ZXJib3NlLmRlc2NcIl0pXHJcblx0XHRcclxuXHRcdC8vIHRoaXMubWFrZVRvZ2dsZShjb250YWluZXJFbCwgXCJzaGFkb3dNb2RlXCIsIFwiU2hhZG93IE1vZGVcIiwgXCJFbWJlZCBza3JpYmlzIGluIGEgc2hhZG93IHJvb3RcIiwgKCkgPT4gaW52b2tlTWV0aG9kT2Y8U2tyaWJpQ2hpbGQ+KFwicmVyZW5kZXJcIiwgLi4udGhpcy5wbHVnaW4uY2hpbGRyZW4pKSAvLyBoaWRkZW4gZm9yIG5vdyAodGhpcyBraWxscyB0aGUgc2tyaWJpY2hpbGQpXHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG1ha2VUb2dnbGUoZWw6IEhUTUxFbGVtZW50LCBzZXR0aW5nOiBrZXlvZiBTa3JpYm9zU2V0dGluZ3MsIG5hbWU6IHN0cmluZywgZGVzYzogc3RyaW5nLCBjYj86ICh2YWx1ZTogYW55KSA9PiB2b2lkKSB7XHJcblx0XHRyZXR1cm4gbmV3IFNldHRpbmcoZWwpXHJcblx0XHQuc2V0TmFtZShuYW1lKVxyXG5cdFx0LnNldERlc2MoZGVzYylcclxuXHRcdC5hZGRUb2dnbGUoKHRvZ2dsZTogVG9nZ2xlQ29tcG9uZW50KSA9PiB7IHRvZ2dsZVxyXG5cdFx0XHQuc2V0VmFsdWUoISF0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nXSlcclxuXHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmddID0gdmFsdWU7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0aWYgKGNiKSBjYih2YWx1ZSk7XHJcblx0XHRcdH0pXHJcblx0XHR9KVxyXG5cdH1cclxuXHJcblx0c2F2ZVNldHRpbmcgPSBkZWJvdW5jZShhc3luYyAoc2V0dGluZzogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiwgY2I/OiBGdW5jdGlvbiwgLi4uYXJnczogYW55W10pID0+IHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKFwic2F2aW5nOiBcIiArIHNldHRpbmcgKyBcIiA9IFwiICsgdmFsdWUpXHJcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nXSA9IHZhbHVlO1xyXG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCkudGhlbigoKSA9PiB7aWYgKGlzRXh0YW50KGNiKSAmJiBpc0Z1bmMoY2IpKSBjYiguLi5hcmdzIHx8IG51bGwpfSlcclxuXHR9LCAyMDAwLCB0cnVlKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrcmlib3NTZXR0aW5ncyB7XHJcblx0W2tleTogc3RyaW5nXSA6IGJvb2xlYW4gfCBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bWJlcjtcclxuXHJcblx0dGVtcGxhdGVGb2xkZXI6IHN0cmluZztcclxuXHRzY3JpcHRGb2xkZXI6IHN0cmluZztcclxuXHR2ZXJib3NlTG9nZ2luZzogYm9vbGVhbjtcclxuXHRkZXZMb2dnaW5nOiBib29sZWFuO1xyXG5cdGVycm9yTG9nZ2luZzogYm9vbGVhbjtcclxuXHRhdXRvUmVsb2FkOiBib29sZWFuO1xyXG5cclxuXHQvKiB1bmxpc3RlZCAqL1xyXG5cdHJlZmxlY3RTdHlsZVRhZ1RleHQ6IGJvb2xlYW47XHJcblx0c2hhZG93TW9kZTogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFNrcmlib3NTZXR0aW5ncyA9IHtcclxuXHR0ZW1wbGF0ZUZvbGRlcjogXCJcIixcclxuXHRzY3JpcHRGb2xkZXI6IFwiXCIsXHJcblx0dmVyYm9zZUxvZ2dpbmc6IGZhbHNlLFxyXG5cdGRldkxvZ2dpbmc6IGZhbHNlLFxyXG5cdGVycm9yTG9nZ2luZzogZmFsc2UsXHJcblx0YXV0b1JlbG9hZDogdHJ1ZSxcclxuXHRcclxuXHRyZWZsZWN0U3R5bGVUYWdUZXh0OiB0cnVlLFxyXG5cdHNoYWRvd01vZGU6IGZhbHNlLFxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBSZWdlbnREYXRhIHtcclxuXHRbaW5kZXg6IHN0cmluZ106IGFueSxcclxuXHRjbGFzcz86IHN0cmluZyxcclxuXHRsYWJlbD86IHN0cmluZyxcclxuXHRjbGVhcj86IGJvb2xlYW4sXHJcblx0aG92ZXI/OiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJFcnJvcihlbDogSFRNTEVsZW1lbnQsIGU6IFJlZ2VudERhdGEpIHtcclxuXHRpZiAoZT8uZmxhZyAmJiBlLmZsYWcgPT0gXCJhYm9ydFwiKSB7XHJcblx0XHRyZXR1cm4gcmVuZGVyUmVnZW50KGVsLCBPYmplY3QuYXNzaWduKHt9LCB7XHJcblx0XHRcdGNsYXNzOiAnYWJvcnQnLFxyXG5cdFx0XHRsYWJlbDogJ3NrJyxcclxuXHRcdFx0aG92ZXI6ICdSZW5kZXIgQWJvcnRlZCdcclxuXHRcdH0sIGUpKVxyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gcmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdlcnJvcicsIGxhYmVsOiAnc2snLCBob3ZlcjogZT8ubXNnIHx8IFwiVW5rbm93biBFcnJvclwiLCBjbGVhcjogdHJ1ZX0pXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyV2FpdChlbDogSFRNTEVsZW1lbnQpIHtcclxuXHRjb25zdCBwcmUgPSBjcmVhdGVFbChcImNvZGVcIiwge2NsczogXCJza3JpYmktcmVnZW50IHdhaXRcIiwgdGV4dDogXCJza1wifSlcclxuXHRlbC5yZXBsYWNlV2l0aChwcmUpXHJcblx0cmV0dXJuIHByZVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyU3RhdGUoZWw6IEhUTUxFbGVtZW50LCBkYXRhSW46IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwic3RhdGVcIixcclxuXHRcdGxhYmVsOiBcInNrXCIsXHJcblx0XHRjbGVhcjogZmFsc2UsXHJcblx0XHRob3ZlcjogXCJcIlxyXG5cdH0sIGRhdGFJbiB8fCB7fSlcclxuXHJcblx0ZWwuY2xhc3NOYW1lID0gYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWBcclxuXHRlbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVnZW50KGRhdGFJbj86IFJlZ2VudERhdGEpOiBbSFRNTEVsZW1lbnQsIFJlZ2VudERhdGFdIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwiZ2VuZXJpY1wiLFxyXG5cdFx0bGFiZWw6IFwic2tcIixcclxuXHRcdGNsZWFyOiBmYWxzZSxcclxuXHRcdGhvdmVyOiBcIlwiXHJcblx0fSwgZGF0YUluIHx8IHt9KVxyXG5cclxuXHRjb25zdCBwcmUgPSBjcmVhdGVFbChcImNvZGVcIiwge2NsczogYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWAsIHRleHQ6IGRhdGEubGFiZWx9KVxyXG5cdHByZS5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG5cclxuXHRyZXR1cm4gW3ByZSwgZGF0YV1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclJlZ2VudChlbDogSFRNTEVsZW1lbnQsIGRhdGFJbj86IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgW3ByZSwgZGF0YV0gPSBjcmVhdGVSZWdlbnQoZGF0YUluKVxyXG5cdGlmIChkYXRhLmNsZWFyKSBlbC5jbGFzc05hbWUgPSBcIlwiO1xyXG5cdGVsLnJlcGxhY2VXaXRoKHByZSlcclxuXHJcblx0cmV0dXJuIHByZVxyXG59IiwiaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgbm9ybWFsaXplUGF0aCwgcGFyc2VGcm9udE1hdHRlclN0cmluZ0FycmF5LCBNYXJrZG93blJlbmRlcmVyLCBzZXRJY29uLCBNYXJrZG93blByZXZpZXdWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgY3JlYXRlUmVnZW50IH0gZnJvbSBcIi4vcmVnZW50XCJcclxuaW1wb3J0IHsgZExvZywgaXNFeHRhbnQgfSBmcm9tIFwiLi4vdXRpbFwiXHJcblxyXG5jb25zdCBleHRJbWcgPSBbXCJibXBcIiwgXCJwbmdcIiwgXCJqcGdcIiwgXCJqcGVnXCIsIFwiZ2lmXCIsIFwic3ZnXCJdXHJcbmNvbnN0IGV4dEF1ZCA9IFtcIm1wM1wiLCBcIndhdlwiLCBcIm00YVwiLCBcIjNncFwiLCBcImZsYWNcIiwgXCJvZ2dcIiwgXCJvZ2FcIl1cclxuY29uc3QgZXh0VmlkID0gW1wibXA0XCIsIFwid2VibVwiLCBcIm9ndlwiXVxyXG5jb25zdCBleHRUeHQgPSBbXCJtZFwiXVxyXG5jb25zdCBleHRQZGYgPSBbXCJwZGZcIl1cclxuXHJcbi8qIFJlcGFpcnMgbWVkaWEgZW1iZWRzIHRoYXQgaGF2ZSBiZWVuIHJlbmRlcmVkIHRvIG1hcmtkb3duICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbWJlZE1lZGlhIChcclxuICBlbDogSFRNTEVsZW1lbnQsIFxyXG4gIHNyY1BhdGg6IHN0cmluZyxcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW4sXHJcbiAgZGVwdGg/OiBudW1iZXIsXHJcbiAgc2VsZj86IGJvb2xlYW5cclxuKSB7XHJcbiAgZExvZyhcImVtYmVkIHNlbGY6XCIsIHNlbGYpXHJcbiAgZExvZyhcImVtYmVkOlwiLCBlbClcclxuICB2YXIgcHJvbXM6IFByb21pc2U8dm9pZD5bXSA9IFtdXHJcblxyXG4gIGNvbnN0IGNhdGNoZXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwic3Bhbi5pbnRlcm5hbC1lbWJlZFwiKSBcclxuXHJcbiAgbGV0IGVsRGVwdGggPSBlbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKTtcclxuICBsZXQgZCA9IChpc0V4dGFudChlbERlcHRoKSA/IHBhcnNlSW50KGVsRGVwdGgpIDogaXNFeHRhbnQoZGVwdGgpID8gZGVwdGggOiAwKVxyXG5cclxuICBkTG9nKFwiZW1iZWRkZXIgZGVwdGg6XCIsIGQpXHJcblxyXG5cclxuICBmb3IgKGxldCBmaXNoIG9mIEFycmF5LmZyb20oY2F0Y2hlcykpIHtcclxuICAgIGlmIChmaXNoLmhhc0NsYXNzKFwiaXMtbG9hZGVkXCIpKSBjb250aW51ZTtcclxuXHJcbiAgICBsZXQgc3JjID0gbm9ybWFsaXplUGF0aChmaXNoLmdldEF0dHJpYnV0ZShcInNyY1wiKSlcclxuXHJcbiAgICBsZXQgZGVzdCA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChzcmMsIHNyY1BhdGgpXHJcbiAgICBcclxuICAgIGlmIChkZXN0KSB7XHJcbiAgICAgIGxldCBwYXRoID0gcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChkZXN0LnBhdGgpXHJcblxyXG4gICAgICBsZXQgZXh0ID0gZGVzdC5leHRlbnNpb247XHJcblxyXG4gICAgICBpZiAoZXh0SW1nLmNvbnRhaW5zKGV4dCkpIHsvLyBFbWJlZCBJbWFnZVxyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJpbWFnZS1lbWJlZFwiKTtcclxuICAgICAgICBcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiaW1nXCIpO1xyXG4gICAgICAgIG5lbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgcGF0aClcclxuICAgICAgICBcclxuICAgICAgfSBlbHNlIGlmIChleHRBdWQuY29udGFpbnMoZXh0KSkgeyAvLyBFbWJlZCBBdWRpb1xyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJtZWRpYS1lbWJlZFwiKTtcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiYXVkaW9cIiwge1wiYXR0clwiOiB7XCJjb250cm9sc1wiIDogdHJ1ZX19KTtcclxuICAgICAgICBuZWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFZpZC5jb250YWlucyhleHQpKSB7IC8vIEVtYmVkIFZpZGVvXHJcbiAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuXHJcbiAgICAgICAgbGV0IHZpZGl2ID0gZmlzaC5jcmVhdGVFbChcInZpZGVvXCIsIHtcImF0dHJcIiA6IHtcImNvbnRyb2xzXCIgOiB0cnVlfX0pXHJcbiAgICAgICAgdmlkaXYuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFR4dC5jb250YWlucyhleHQpKSB7IFxyXG4gICAgICAgIC8qIEVtYmVkIFRyYW5zY2x1c2lvbiAqL1xyXG5cclxuICAgICAgICBjb25zdCBjcmVhdGVFbWJlZFByb21pc2U6ICgpPT5Qcm9taXNlPHZvaWQ+ID0gKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRMb2coXCJuZXcgZW1iZWQgcHJvbVwiKVxyXG5cclxuICAgICAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuICBcclxuICAgICAgICAgICAgICBsZXQgY2FjaGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZGVzdC5wYXRoKVxyXG4gICAgICAgICAgICAgIGxldCByZWFkID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGRlc3QpXHJcbiAgICAgICAgICAgICAgbGV0IGNsYXNzZXMgPSBwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkoY2FjaGU/LmZyb250bWF0dGVyLCBcImNzc2NsYXNzXCIpXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgZGl2ID0gZmlzaC5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZFwifSlcclxuICAgICAgICAgICAgICBsZXQgZGl2dGl0bGUgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtdGl0bGVcIiwgdGV4dDogZGVzdC5iYXNlbmFtZX0pXHJcbiAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtY29udGVudFwifSlcclxuICAgICAgICAgICAgICBsZXQgbGluayA9IGRpdi5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZC1saW5rXCJ9KVxyXG4gICAgICAgICAgICAgIHNldEljb24obGluaywgXCJsaW5rXCIpXHJcbiAgICAgICAgICAgICAgbGluay5vbkNsaWNrRXZlbnQoKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChzcmMsIHNyY1BhdGgpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgcHYgPSBjb250ZW50LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctdmlld1wifSk7IHB2LmFkZENsYXp6KGNsYXNzZXMpO1xyXG4gICAgICAgICAgICAgIGxldCBwcyA9IHB2LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctc2l6ZXIgbWFya2Rvd24tcHJldmlldy1zZWN0aW9uXCJ9KVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgbGV0IG1raCA9IGNyZWF0ZURpdih7YXR0cjoge1wiZGVwdGhcIjogZGVwdGgudG9TdHJpbmcoKX19KVxyXG4gICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24ocmVhZCwgbWtoLCBzcmNQYXRoLCBudWxsKVxyXG4gICAgICAgICAgICAgIGNvbnN0IG1rZTogQ2hpbGROb2RlW10gPSAoQXJyYXkuZnJvbShta2g/LmNoaWxkTm9kZXMgfHwgW10pLm1hcCgobikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKG4uY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7IGxldCBkID0gY3JlYXRlRGl2KCk7IGQuYXBwZW5kKG4uY2xvbmVOb2RlKHRydWUpKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyBsZXQgZCA9IGNyZWF0ZURpdigpOyBkLmFwcGVuZChuKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuXHJcbiAgICAgICAgICAgICAgcHMuYXBwZW5kKC4uLm1rZSk7IC8vcHMuc2V0QXR0cmlidXRlKFwiZGVwdGhcIiwgZC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVtYmVkTWVkaWEocHMsIHNyY1BhdGgsIHBsdWdpbiwgZC0xLCB0cnVlKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkIDw9IDApICB7XHJcbiAgICAgICAgICBsZXQgW2xdID0gY3JlYXRlUmVnZW50KHtjbGFzczogXCJkZXB0aC1saW1pdFwiLCBob3ZlcjogXCJJdCBnb2VzIG9uIGZvcmV2ZXIuLi5cIn0pXHJcbiAgICAgICAgICBmaXNoLnJlcGxhY2VXaXRoKGwpXHJcblxyXG4gICAgICAgICAgZExvZyhcImVtYmVkZGVyIGhpdCBsaW1pdFwiKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm9tcy5wdXNoKGNyZWF0ZUVtYmVkUHJvbWlzZSgpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChwcm9tcykudGhlbih2YWx1ZXMgPT4ge1xyXG4gICAgZExvZyhcImVtYmVkZGVyIGRvbmVcIiwgcHJvbXMpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb21zLmxlbmd0aClcclxuICB9KVxyXG59IiwiaW1wb3J0IHsgaXNFeHRhbnQgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuXHJcbi8qIENoZWNrIGlmIGNvZGUgYmxvY2sgaXMgdGhhdCBnb29kIGdvb2QgYW5kIGlmIHNvIHdoYXQgdHlwZSBvZiBnb29kIGdvb2QgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXBhcnNlU2tyaWJpKGVsOiBIVE1MRWxlbWVudCwgc3RyPzogc3RyaW5nLCBmbGc/OiBhbnkpIHtcclxuXHRsZXQgdGV4dCA9IGlzRXh0YW50KHN0cikgPyBzdHIgOiBlbC50ZXh0Q29udGVudFxyXG5cdGlmICh0ZXh0Lmxlbmd0aCA8IDMpIHJldHVybjtcclxuXHJcblx0bGV0IGUgPSB0ZXh0LnN1YnN0cih0ZXh0Lmxlbmd0aC0yKVxyXG5cdGxldCBzID0gdGV4dC5zdWJzdHIoMCwgMilcclxuXHRcclxuXHRpZiAocy5zdGFydHNXaXRoKFwie1wiKSAmJiBlLmVuZHNXaXRoKFwifVwiKSkge1xyXG5cdFx0bGV0IGYgPSBzWzFdO1xyXG5cdFx0bGV0IGZsYWcgPSAoZiA9PSBcIjpcIikgPyAxIDogKGYgPT0gXCI9XCIpID8gMiA6IChmID09IFwiflwiKSA/IDMgOiAoZiA9PSBcIntcIikgPyA0IDogKGYgPT0gXCIuXCIpID8gNSA6IC0xO1xyXG5cdFx0aWYgKChmbGFnID4gMCkgJiYgKGZsYWcgIT0gNCB8fCAoZSA9PSBcIn19XCIpKSkge1xyXG5cdFx0XHRyZXR1cm4ge2ZsYWc6IGZsYWcsIHRleHQ6IHRleHQuc3Vic3RyaW5nKDIsIHRleHQubGVuZ3RoIC0gKGZsYWcgPT0gNCA/IDIgOiAxICkpfVxyXG5cdFx0fSBlbHNlIHJldHVyblxyXG5cdH0gZWxzZSByZXR1cm5cclxufVxyXG5cclxuLyogUGFyc2UgdmFyaWFibGVzIGluIHRlbXBsYXRlIGludm9jYXRpb25zICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVNrcmliaShzcmM6IHN0cmluZyk6IFByb21pc2U8e1xyXG5cdGlkOiBzdHJpbmcsXHJcblx0YXJnczogYW55XHJcbn0+IHtcclxuXHRsZXQgc2EgPSBzcmMuc3BsaXQoLyg/PCFbXFxcXF0pXFx8LylcclxuXHRsZXQgaWQgPSBzYS5zcGxpY2UoMCwgMSlbMF0udHJpbSgpXHJcblxyXG5cdGxldCBhcmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XHJcblx0Zm9yIChsZXQgc2VnIG9mIHNhKSB7XHJcblx0XHRsZXQgc2kgPSBzZWcuaW5kZXhPZihcIjpcIilcclxuXHRcdGlmIChzaSA9PSAtMSkgY29udGludWU7XHJcblx0XHRhcmdzW3NlZy5zbGljZSgwLCBzaSkudHJpbSgpXSA9IHNlZy5zbGljZShzaSsxKS50cmltKCk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge2lkOiBpZCwgYXJnczoge3Y6IGFyZ3N9fTtcclxufSIsIi8qXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90XHJcbiAqIHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mXHJcbiAqIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVRcclxuICogV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlXHJcbiAqIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyXHJcbiAqIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcbi8qIFxyXG4gKiBNb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW10aG9yL3Njb3BlZCAocG9seWZpbGwgZm9yIGRlcHJlY2F0ZWQgSFRNTCBmZWF0dXJlIHNjb3BlZCBzdHlsZXMpXHJcbiAqL1xyXG5cclxuLyoqIFByZWZpeGVzIGFsbCBDU1Mgc2VsZWN0b3JzIGluIGEgc2VsZWN0b3IgdGV4dCBzdHJpbmcgd2l0aCBwcmVmaXggcHJlZml4ICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVmaXhTZWxlY3RvcnMoc2VsZWN0b3JUZXh0OiBzdHJpbmcsIHByZWZpeDogc3RyaW5nKSB7XHJcblx0Y29uc3QgZm91bmQgPSBbXTtcclxuXHJcblx0d2hpbGUgKHNlbGVjdG9yVGV4dCkge1xyXG5cdFx0Y29uc3QgY29uc3VtZWQgPSBjb25zdW1lU2VsZWN0b3Ioc2VsZWN0b3JUZXh0LCBwcmVmaXgpO1xyXG5cdFx0aWYgKGNvbnN1bWVkID09PSBudWxsKSB7XHJcblx0XHRcdHJldHVybiAnOm5vdCgqKSc7XHJcblx0XHR9XHJcblx0XHRmb3VuZC5wdXNoKGNvbnN1bWVkLnNlbGVjdG9yKTtcclxuXHRcdHNlbGVjdG9yVGV4dCA9IGNvbnN1bWVkLnJlc3Q7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZm91bmQuam9pbignLCAnKTtcclxufVxyXG5cclxuLy8gVGhpcyBtb25zdHJvc2l0eSBtYXRjaGVzIGFueSB2YWxpZCBgW2Zvbz1cImJhclwiXWAgYmxvY2ssIHdpdGggZWl0aGVyIHF1b3RlIHN0eWxlLiBQYXJlbnRoZXNpc1xyXG4vLyBoYXZlIG5vIHNwZWNpYWwgbWVhbmluZyB3aXRoaW4gYW4gYXR0cmlidXRlIHNlbGVjdG9yLCBhbmQgdGhlIGNvbXBsZXggcmVnZXhwIGJlbG93IG1vc3RseVxyXG4vLyBleGlzdHMgdG8gYWxsb3cgXFxcIiBvciBcXCcgaW4gc3RyaW5nIHBhcnRzIChlLmcuIGBbZm9vPVwiYlxcXCJhclwiXWApLlxyXG5jb25zdCBhdHRyUmUgPSAvXlxcWy4qPyg/OihbXCInXSkoPzoufFxcXFxcXDEpKlxcMS4qKSpcXF0vO1xyXG5jb25zdCB3YWxrU2VsZWN0b3JSZSA9IC8oWyhbLF18OnNjb3BlXFxiKS87ICAvLyBcImludGVyZXN0aW5nXCIgc2V0dXBzXHJcbmNvbnN0IHNjb3BlUmUgPSAvXjpzY29wZVxcYi87XHJcblxyXG4vKipcclxuICogQ29uc3VtZXMgYSBzaW5nbGUgc2VsZWN0b3IgZnJvbSBjYW5kaWRhdGUgc2VsZWN0b3IgdGV4dCwgd2hpY2ggbWF5IGNvbnRhaW4gbWFueS4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbnN1bWVTZWxlY3RvcihyYXc6IHN0cmluZywgcHJlZml4OiBzdHJpbmcpOiB7c2VsZWN0b3I6IHN0cmluZywgcmVzdDogc3RyaW5nfSB8IG51bGwgIHtcclxuICAgIGxldCBpID0gcmF3LnNlYXJjaCh3YWxrU2VsZWN0b3JSZSk7XHJcbiAgICBpZiAoaSA9PT0gLTEpIHtcclxuICAgICAgcmV0dXJuIHsgc2VsZWN0b3I6IGAke3ByZWZpeH0gJHtyYXd9YCwgcmVzdDogJyd9XHJcbiAgICB9IGVsc2UgaWYgKHJhd1tpXSA9PT0gJywnKSB7XHJcbiAgICAgIHJldHVybiB7IHNlbGVjdG9yOiBgJHtwcmVmaXh9ICR7cmF3LnN1YnN0cigwLCBpKX1gLCByZXN0OiByYXcuc3Vic3RyKGkgKyAxKSB9XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGxlZnRtb3N0ID0gdHJ1ZTsgICAvLyB3aGV0aGVyIHdlJ3JlIHBhc3QgYSBkZXNjZW5kYW50IG9yIHNpbWlsYXIgc2VsZWN0b3JcclxuICAgIGxldCBzY29wZSA9IGZhbHNlOyAgICAgLy8gd2hldGhlciA6c2NvcGUgaGFzIGJlZW4gZm91bmQgKyByZXBsYWNlZFxyXG4gICAgaSA9IHJhdy5zZWFyY2goL1xcUy8pOyAgLy8gcGxhY2UgaSBhZnRlciBpbml0aWFsIHdoaXRlc3BhY2Ugb25seVxyXG5cclxuICAgIGxldCBkZXB0aCA9IDA7XHJcblx0XHRcclxuICBcdG91dGVyOlxyXG4gICAgZm9yICg7IGkgPCByYXcubGVuZ3RoOyArK2kpIHtcclxuICAgICAgY29uc3QgY2hhciA9IHJhd1tpXTtcclxuICAgICAgc3dpdGNoIChjaGFyKSB7XHJcbiAgICAgICAgY2FzZSAnWyc6XHJcbiAgICAgICAgICBjb25zdCBtYXRjaCA9IGF0dHJSZS5leGVjKHJhdy5zdWJzdHIoaSkpO1xyXG4gICAgICAgICAgaSArPSAobWF0Y2ggPyBtYXRjaFswXS5sZW5ndGggOiAxKSAtIDE7ICAvLyB3ZSBhZGQgMSBldmVyeSBsb29wXHJcbiAgICAgICAgICBjb250aW51ZTtcclxuXHJcbiAgICAgICAgY2FzZSAnKCc6XHJcbiAgICAgICAgICArK2RlcHRoO1xyXG4gICAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICAgIGNhc2UgJzonOlxyXG4gICAgICAgICAgaWYgKCFsZWZ0bW9zdCkge1xyXG4gICAgICAgICAgICBjb250aW51ZTsgIC8vIGRvZXNuJ3QgbWF0dGVyIGlmIDpzY29wZSBpcyBoZXJlLCBpdCdsbCBhbHdheXMgYmUgaWdub3JlZFxyXG4gICAgICAgICAgfSBlbHNlIGlmICghc2NvcGVSZS50ZXN0KHJhdy5zdWJzdHIoaSkpKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlOyAgLy8gbm90ICc6c2NvcGUnLCBpZ25vcmVcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZGVwdGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gUmVwbGFjZSAnOnNjb3BlJyB3aXRoIG91ciBwcmVmaXguIFRoaXMgY2FuIGhhcHBlbiBtYW55IHRpbWVzOyAnOnNjb3BlOnNjb3BlJyBpcyB2YWxpZC5cclxuICAgICAgICAgIC8vIEl0IHdpbGwgbmV2ZXIgYXBwbHkgdG8gYSBkZXNjZW5kYW50IHNlbGVjdG9yIChlLmcuLCBcIi5mb28gOnNjb3BlXCIpIGFzIHRoaXMgaXMgaWdub3JlZFxyXG4gICAgICAgICAgLy8gYnkgYnJvd3NlcnMgYW55d2F5IChpbnZhbGlkKS5cclxuICAgICAgICAgIHJhdyA9IHJhdy5zdWJzdHJpbmcoMCwgaSkgKyBwcmVmaXggKyByYXcuc3Vic3RyKGkgKyA2KTtcclxuICAgICAgICAgIGkgKz0gcHJlZml4Lmxlbmd0aDtcclxuICAgICAgICAgIHNjb3BlID0gdHJ1ZTtcclxuICAgICAgICAgIC0taTsgIC8vIHdlJ2Qgc2tpcCBvdmVyIG5leHQgY2hhcmFjdGVyIG90aGVyd2lzZVxyXG4gICAgICAgICAgY29udGludWU7ICAvLyBydW4gbG9vcCBhZ2FpblxyXG5cclxuICAgICAgY2FzZSAnKSc6XHJcbiAgICAgICAgaWYgKGRlcHRoKSB7LS1kZXB0aH1cclxuICAgICAgICBjb250aW51ZTtcclxuICAgIH1cclxuICAgIGlmIChkZXB0aCkgeyBjb250aW51ZSB9XHJcblxyXG4gICAgc3dpdGNoIChjaGFyKSB7XHJcbiAgICAgIGNhc2UgJywnOlxyXG4gICAgICAgIGJyZWFrIG91dGVyO1xyXG5cclxuICAgICAgY2FzZSAnICc6XHJcbiAgICAgIGNhc2UgJz4nOlxyXG4gICAgICBjYXNlICd+JzpcclxuICAgICAgY2FzZSAnKyc6XHJcbiAgICAgICAgaWYgKCFsZWZ0bW9zdCkge2NvbnRpbnVlfVxyXG4gICAgICAgIGxlZnRtb3N0ID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBzZWxlY3RvciA9IChzY29wZSA/ICcnIDogYCR7cHJlZml4fSBgKSArIHJhdy5zdWJzdHIoMCwgaSk7XHJcbiAgcmV0dXJuIHtzZWxlY3RvciwgcmVzdDogcmF3LnN1YnN0cihpICsgMSl9O1xyXG59IiwiaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEV0YUhhbmRsZXIgfSBmcm9tIFwic3JjL2V0YS9ldGFcIjtcclxuaW1wb3J0IHsgbCB9IGZyb20gXCJzcmMvbGFuZy9iYWJlbFwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcclxuaW1wb3J0IHsgTW9kZXMsIEZsYWdzLCBFQkFSIH0gZnJvbSBcInNyYy90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgeyBQcm9jZXNzb3JNb2RlLCBTa0NvbnRleHQsIFN0cmluZ2RleCwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgaXNFeHRhbnQsIGRMb2csIHZMb2csIHJvdW5kVG8sIGhhc2ggfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuaW1wb3J0IHsgU2tyaWJpQ2hpbGQgfSBmcm9tIFwiLi9jaGlsZFwiO1xyXG5pbXBvcnQgeyBlbWJlZE1lZGlhIH0gZnJvbSBcIi4vZW1iZWRcIjtcclxuaW1wb3J0IHsgcGFyc2VTa3JpYmksIHByZXBhcnNlU2tyaWJpIH0gZnJvbSBcIi4vcGFyc2VcIjtcclxuaW1wb3J0IHsgcmVuZGVyUmVnZW50LCByZW5kZXJFcnJvciwgcmVuZGVyU3RhdGUgfSBmcm9tIFwiLi9yZWdlbnRcIjtcclxuaW1wb3J0IHsgcHJlZml4U2VsZWN0b3JzIH0gZnJvbSBcIi4vc3R5bGVTY29wZVwiO1xyXG5cclxudHlwZSBTa3JpYmlSZXN1bHQgPSBTa3JpYmlSZXN1bHRSZW5kZXJlZCB8IFNrcmliaVJlc3VsdFF1ZXVlZFxyXG5cclxudHlwZSBTa3JpYmlSZXN1bHRSZW5kZXJlZCA9IFtQcm9taXNlPEhUTUxEaXZFbGVtZW50PiwgU2tyaWJpQ2hpbGRdXHJcbnR5cGUgU2tyaWJpUmVzdWx0UXVldWVkID0ge21zZzogc3RyaW5nLCBxaTogbnVtYmVyfVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2tyaWJpUHJvY2Vzc29yIHtcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuICBldGE6IEV0YUhhbmRsZXJcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gICAgdGhpcy5ldGEgPSBwbHVnaW4uZXRhXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBvdXIgbWFya2Rvd24gcHJvY2Vzc29ycy4gKi9cclxuICByZWdpc3RlclByb2Nlc3NvcnMoKSB7XHJcbiAgICBjb25zdCBwcm9jZXNzQ29kZVNwYW46IE1hcmtkb3duUG9zdFByb2Nlc3NvciA9IGFzeW5jKGVsLCBjdHgpID0+IHt0aGlzLnByb2Nlc3NFbnRyeSh7c3JjVHlwZTogTW9kZXMuZ2VuZXJhbH0sIGVsLCBjdHgpfVxyXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHByb2Nlc3NDb2RlU3BhbihlbCwgY3R4KSlcclxuXHJcbiAgICBjb25zdCBwcm9jZXNzQ29kZUJsb2NrID0gYXN5bmMgKG1vZGU6IFByb2Nlc3Nvck1vZGUsIHN0cjogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCkgPT4geyB0aGlzLnByb2Nlc3NFbnRyeShtb2RlLCBlbCwgY3R4LCBudWxsLCBudWxsLCBzdHIudHJpbUVuZCgpKSB9XHJcbiAgICAoW1tcIm5vcm1hbFwiLCBcIlwiLCBGbGFncy5ub25lXSwgW1wicmF3XCIsIFwiLXJhd1wiLCBGbGFncy5yYXddLCBbXCJsaXRlcmFsXCIsIFwiLWxpdFwiLCBGbGFncy5saXRlcmFsXSwgW1wiaW50ZXJwb2xhdGVcIiwgXCItaW50XCIsIEZsYWdzLmludGVycF0sIFtcImV2YWx1YXRlXCIsIFwiLWV2YWxcIiwgRmxhZ3MuZXZhbF1dKVxyXG5cdFx0LmZvckVhY2goKHYpID0+IHtcclxuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJNYXJrZG93bkNvZGVCbG9ja1Byb2Nlc3Nvcihgc2tyaWJpJHt2WzFdfWAsIHByb2Nlc3NDb2RlQmxvY2suYmluZCh0aGlzLCB7c3JjVHlwZTogTW9kZXMuYmxvY2ssIGZsYWc6IHZbMl19KSlcclxuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJNYXJrZG93bkNvZGVCbG9ja1Byb2Nlc3Nvcihgc2ske3ZbMV19YCwgcHJvY2Vzc0NvZGVCbG9jay5iaW5kKHRoaXMsIHtzcmNUeXBlOiBNb2Rlcy5ibG9jaywgZmxhZzogdlsyXX0pKVxyXG5cdFx0fSlcclxuICB9XHJcblxyXG4gIC8qKiBFbnRyeSB0byB0aGUgU2tyaWJpIHByb2Nlc3MgY2hhaW4uIENhbGxlZDpcclxuICAgKiAtIEJ5IE1hcmtkb3duVmlldyBvbiBlYWNoIGJsb2NrIG9mIGEgbWFya2Rvd24gcHJldmlld1xyXG4gICAqIC0gQnkgTWFya2Rvd25WaWV3IG9uIGNvZGUgYmxvY2tzIG9mIG91ciByZWdpc3RlciBsYW5ndWFnZSB0eXBlc1xyXG4gICAqIC0gQnkgcmVuZGVyU2tyaWJpIHRvIHJlY3Vyc2UgbmVzdGVkIHNrcmliaXMgKi9cclxuICAgYXN5bmMgcHJvY2Vzc0VudHJ5IChcclxuXHRcdG1vZGU6IFByb2Nlc3Nvck1vZGUsIC8vIDA6IGNvZGVzcGFuOyAxOiBjb2RlYmxvY2s7XHJcblx0XHRkb2M6IEhUTUxFbGVtZW50LFxyXG5cdFx0Y3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LFxyXG5cdFx0ZGVwdGg/OiBudW1iZXIsXHJcblx0XHRzZWxmPzogYm9vbGVhbixcclxuXHRcdHNyY0luPzogc3RyaW5nXHJcblx0KTogUHJvbWlzZTxQcm9taXNlPFNrcmliaVJlc3VsdD5bXSB8IG51bGw+IHtcclxuXHRcdGxldCBuZXN0RXh0YW50ID0gaXNFeHRhbnQoY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdGxldCBuZXN0TGV2ZWwgPSBuZXN0RXh0YW50ID8gY3R4LnJlbWFpbmluZ05lc3RMZXZlbCA6IG51bGw7XHJcblx0XHQvKiBuZXN0RXh0YW50IG1lYW5zIHRoYXQgd2UgYXJlIGluc2lkZSBvZiBhIG5hdHVyYWwgdHJhbnNjbHVzaW9uICovXHJcblxyXG5cdFx0c2VsZiA9IGlzRXh0YW50KHNlbGYpXHJcblx0XHRkZXB0aCA9IHNlbGYgPyBkZXB0aCA6IG51bGxcclxuXHRcdC8qIHNlbGYgbWVhbnMgdGhhdCB3ZSBoYXZlIGJlZW4gY2FsbGVkIGJ5IHJlbmRlclNrcmliaSwgdG8gbG9vayBmb3IgY29kZWJsb2NrcyAqL1xyXG5cclxuXHRcdGxldCBlbEhhc0RlcHRoID0gaXNFeHRhbnQoZG9jLmdldEF0dHJpYnV0ZShcImRlcHRoXCIpKVxyXG5cdFx0bGV0IGVsRWxIYXNEZXB0aCA9IGlzRXh0YW50KGN0eC5lbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSlcclxuXHRcdGxldCBlbERlcHRoID0gZWxIYXNEZXB0aCA/IHBhcnNlSW50KGRvYy5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSkgOiBlbEVsSGFzRGVwdGggPyBwYXJzZUludChjdHguZWwuZ2V0QXR0cmlidXRlKFwiZGVwdGhcIikpIDogbnVsbDtcclxuXHRcdC8qIFVzZWQgZm9yIHBhc3NpbmcgZGVwdGggdG8gdmlydHVhbCBlbGVtZW50cyAod2UgbWF5IGJlIGluIG9uZSBldmVuIGFzIHdlIHNwZWFrLi4uKSovXHJcblxyXG5cdFx0LyogZGV0ZXJtaW5lIG91ciBkZXB0aCBjb25kaXRpb24gdHlwZSAqL1xyXG5cdFx0bGV0IGQgPSBzZWxmID8gZGVwdGggOiAoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpID8gZWxEZXB0aCA6IG5lc3RFeHRhbnQgPyBuZXN0TGV2ZWwgOiAwXHJcblxyXG5cdFx0aWYgKCFuZXN0RXh0YW50ICYmICEoZWxIYXNEZXB0aCB8fCBlbEVsSGFzRGVwdGgpKSBkTG9nKFwicHJvY2Vzc29yIHNlZXMgbm8gZGVwdGhcIilcclxuXHJcblx0XHRpZiAoZWxIYXNEZXB0aCkgeyBcclxuXHRcdFx0ZExvZyhcImVsRGVwdGhcIiwgZWxEZXB0aCwgXCJkb2NcIiwgZG9jLCBcImVsXCIsIGN0eC5lbCwgXCJjb25FbFwiLCBjdHguY29udGFpbmVyRWwpIFxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZExvZyhcInByb2Nlc3NvcjogXCIsIFwiZG9jXCIsIGRvYywgXCJlbFwiLCBjdHguZWwsIFwiY29uRWxcIiwgY3R4LmNvbnRhaW5lckVsLCBcIm5lc3RcIiwgY3R4LnJlbWFpbmluZ05lc3RMZXZlbClcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0LyogRGlzcGF0Y2ggcmVuZGVyIHByb21pc2VzICovXHJcblx0XHR2YXIgcHJvbXM6IFByb21pc2U8U2tyaWJpUmVzdWx0PltdID0gW11cclxuXHRcdHZhciB0ZW1wcyA9IDA7XHJcblx0XHRjb25zdCBlbENvZGVzID0gKG1vZGUuc3JjVHlwZSA9PSBNb2Rlcy5ibG9jaykgPyBbZG9jXSA6IGRvYy5xdWVyeVNlbGVjdG9yQWxsKFwiY29kZVwiKVxyXG5cdFx0aWYgKCEoZCA8PSAwKSkge1xyXG5cdFx0XHRsZXQgdG0gPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdGNvbnN0IGVsUHJvbXMgPSBBcnJheS5mcm9tKGVsQ29kZXMpLm1hcChhc3luYyAoZWwpID0+IHtcclxuXHRcdFx0XHRsZXQgdCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKTtcclxuXHRcdFx0XHRkTG9nKFwic3RhcnQ6XCIsIHQpXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bGV0IHNyYyA9IChpc0V4dGFudChtb2RlLmZsYWcpICYmIG1vZGUuZmxhZyAhPSBGbGFncy5ub25lKSA/XHJcblx0XHRcdFx0XHR7dGV4dDogc3JjSW4gfHwgZG9jLnRleHRDb250ZW50LCBmbGFnOiBtb2RlLmZsYWd9IDogYXdhaXQgcHJlcGFyc2VTa3JpYmkoZWwpO1xyXG5cclxuXHRcdFx0XHRsZXQgb3JpZ2luYWxUZXh0ID0gKG1vZGUuc3JjVHlwZSA9PSBNb2Rlcy5ibG9jaykgPyBzcmNJbiA6IGVsLnRleHRDb250ZW50XHJcblxyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRpZiAoc3JjICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0bGV0IHNrQ3R4OiBTa0NvbnRleHQgPSB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBkZXB0aDogZCwgZmxhZzogc3JjLmZsYWcsIHNvdXJjZTogb3JpZ2luYWxUZXh0fVxyXG5cdFx0XHRcdFx0XHRsZXQgbmVsID0gcmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdzay1sb2FkaW5nJywgaG92ZXI6IGxbJ3JlZ2VudC5sb2FkaW5nLmhvdmVyJ119KVxyXG5cdFx0XHRcdFx0XHRpZiAoc3JjLmZsYWcgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdHByb21zLnB1c2godGhpcy5hd2FpdFRlbXBsYXRlc0xvYWRlZCh7ZWw6IG5lbCwgc3JjOiBzcmMudGV4dCwgbWRDdHg6IGN0eCwgc2tDdHg6IHNrQ3R4fSkpO1xyXG5cdFx0XHRcdFx0XHRcdHRlbXBzKys7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0cHJvbXMucHVzaCh0aGlzLnByb2Nlc3NTa3JpYmkobmVsLCBzcmMudGV4dCwgY3R4LCBza0N0eCkpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gXHJcblx0XHRcdFx0fSBjYXRjaChlKSB7XHJcblx0XHRcdFx0XHRpZiAoIWUuZmxhZ3Mubm9SZW5kZXIpIHtcclxuXHRcdFx0XHRcdFx0cmVuZGVyRXJyb3IoZWwsIGUpXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuXHRcdFx0fSlcclxuXHRcdFxyXG5cdFx0XHRpZiAoLyohc2VsZiAmJiAqLyFkb2MuaGFzQ2xhc3MoXCJza3JpYmktcmVuZGVyLXZpcnR1YWxcIikpIHtcclxuXHRcdFx0XHRsZXQgYXBzID0gUHJvbWlzZS5hbGwoZWxQcm9tcylcclxuXHRcdFx0XHRhcHMudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0XHRQcm9taXNlLmFsbFNldHRsZWQocHJvbXMpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAocHJvbXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5pbml0TG9hZGVkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2TG9nKGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGh9IHNrcmliaXMgKCR7cm91bmRUbygod2luZG93LnBlcmZvcm1hbmNlLm5vdygpLXRtKSwgNCl9IG1zKSBpbiBFbGVtZW50YCwgZG9jKVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgc3RyID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0ZW1wcyA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHByb21zLmxlbmd0aCAtIHRlbXBzID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN0ciA9IGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGgtdGVtcHN9IGFuZCBxdWV1ZWQgJHt0ZW1wc30gc2tyaWJpc2A7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBzdHIgPSBgUXVldWVkICR7dGVtcHN9IHNrcmliaXNgO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHN0ciA9IGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGgtdGVtcHN9IHNrcmliaXNgO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdHZMb2coc3RyICsgYCAoJHtyb3VuZFRvKCh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktdG0pLCA0KX0gbXMpIGluIEVsZW1lbnRgLCBkb2MpXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChlbFByb21zKVxyXG5cdFx0XHRyZXR1cm4gcHJvbXNcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8qIERlcHRoIHRvbyBoaWdoISAqL1xyXG5cclxuXHRcdFx0ZWxDb2Rlcy5mb3JFYWNoKGFzeW5jIChlbCkgPT4ge1xyXG5cdFx0XHRcdHByZXBhcnNlU2tyaWJpKGVsKS50aGVuKGFzeW5jIChzcmMpID0+IHtcclxuXHRcdFx0XHRcdGlmIChzcmMgIT0gbnVsbCkgcmVuZGVyU3RhdGUoZWwsIHtob3ZlcjogbFsncmVnZW50LnN0YXNpcy5ob3ZlciddLCBjbGFzczogJ3N0YXNpcyd9KVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH0pXHJcblx0XHRcdGRMb2coXCJwcm9jZXNzb3IgaGl0IGxpbWl0XCIpOyBcclxuXHRcdFx0XHJcblx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7IC8vIFBvc3Rwcm9jZXNzb3IgY2FsbHMgYXJlIG5vdCBjYXVnaHQgc28gd2UgY2FuJ3QgcmVqZWN0IG5lYXRseVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcbiAgcHJpdmF0ZSBxdWV1ZWRUZW1wbGF0ZXM6IEFycmF5PEZ1bmN0aW9uPiA9IFtdIC8vIFRPRE86IG1heWJlIGNvbnN0cnVjdCBwcm9taXNlcyB0byByZXNvbHZlIG9uIGV2ZW50IHNvIHRoZSBwcm9taXNlIGNoYWluIGlzbid0IGJyb2tlbj9cclxuXHJcbiAgLyogRW5zdXJlcyB0aGF0IHRoZSBpbml0aWFsIHRlbXBsYXRlIGxvYWQgaXMgY29tcGxldGUgYmVmb3JlIGNvbnRpbnVpbmcgdG8gcmVuZGVyLiAqL1xyXG5cdGFzeW5jIGF3YWl0VGVtcGxhdGVzTG9hZGVkKGFyZ3M6IHtlbDogSFRNTEVsZW1lbnQsIHNyYzogYW55LCBtZEN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgc2tDdHg6IFNrQ29udGV4dH0pOiBQcm9taXNlPFNrcmliaVJlc3VsdD4ge1xyXG5cdFx0bGV0IGVsID0gcmVuZGVyUmVnZW50KGFyZ3MuZWwsIHtjbGFzczogJ3dhaXQnLCBsYWJlbDogJ3NrJywgaG92ZXI6ICdBd2FpdGluZyBUZW1wbGF0ZSBDYWNoZScsIGNsZWFyOiB0cnVlfSlcclxuXHJcblx0XHRpZiAoIXRoaXMucGx1Z2luLmluaXRMb2FkZWQpIHtcclxuXHRcdFx0ZExvZyhcIm5vdCB5ZXQgbG9hZGVkXCIpXHJcbiAgICAgIGxldCBmdW5jID0gYXN5bmMgKCkgPT4ge3JldHVybiBhd2FpdCB0aGlzLnByb2Nlc3NTa3JpYmlUZW1wbGF0ZShlbCwgYXJncy5zcmMsIGFyZ3MubWRDdHgsIE9iamVjdC5hc3NpZ24oYXJncy5za0N0eCwge3RpbWU6IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKX0pKX1cclxuICAgICAgbGV0IHEgPSB0aGlzLnF1ZXVlZFRlbXBsYXRlcy5wdXNoKGZ1bmMpXHJcblxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHttc2c6IFwiUXVldWVkXCIsIHFpOiBxfSlcclxuXHRcdH0gZWxzZSByZXR1cm4gYXdhaXQgdGhpcy5wcm9jZXNzU2tyaWJpVGVtcGxhdGUoZWwsIGFyZ3Muc3JjLCBhcmdzLm1kQ3R4LCBhcmdzLnNrQ3R4KVxyXG5cdH1cclxuXHJcbiAgLyogQ2FsbGVkIGJ5IHRlbXBsYXRlIGxvYWQgZXZlbnQuICovXHJcbiAgdGVtcGxhdGVzUmVhZHkoKSB7XHJcbiAgICBsZXQgcHJvbXMgPSB0aGlzLnF1ZXVlZFRlbXBsYXRlcy5tYXAoKGZ1bmMpID0+IGZ1bmMoKSlcclxuICAgIFByb21pc2UuYWxsU2V0dGxlZChwcm9tcykudGhlbigoKSA9PiB7dGhpcy5xdWV1ZWRUZW1wbGF0ZXMgPSBbXX0pXHJcbiAgfVxyXG5cclxuXHRhc3luYyBwcm9jZXNzU2tyaWJpVGVtcGxhdGUoXHJcblx0XHRlbDogSFRNTEVsZW1lbnQsIFxyXG5cdFx0c3JjOiBzdHJpbmcsIFxyXG5cdFx0bWRDdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIFxyXG5cdFx0c2tDdHg6IFNrQ29udGV4dFxyXG5cdCk6IFByb21pc2U8U2tyaWJpUmVzdWx0PiB7XHJcblx0XHRsZXQgcGFyc2VkOiB7aWQ6IHN0cmluZywgYXJnczogYW55fSA9IG51bGw7XHJcblx0XHR0cnkgeyBwYXJzZWQgPSBhd2FpdCBwYXJzZVNrcmliaShzcmMpIH1cclxuXHRcdGNhdGNoIChlKSB7IHJlbmRlckVycm9yKGVsLCBlKTsgcmV0dXJuIFByb21pc2UucmVqZWN0KCdQYXJzaW5nIEVycm9yJykgfVxyXG5cdFx0XHJcblx0XHQvLyBBYm9ydCBpZiBiZWluZyByZW5kZXJlZCBpbiBpdHMgb3duIGRlZmluaXRpb25cclxuXHRcdGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChcIlwiLCBtZEN0eC5zb3VyY2VQYXRoKS5iYXNlbmFtZSA9PSBwYXJzZWQuaWQpIHtcclxuXHRcdFx0cmVuZGVyUmVnZW50KGVsLCB7Y2xhc3M6ICdzZWxmJywgaG92ZXI6IGxbJ3JlZ2VudC5zdGFzaXMuaG92ZXInXX0pOyByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ1dpdGhpbiBTZWxmIERlZmluaXRpb24nKTsgfVxyXG5cclxuXHRcdGxldCB0ZW1wbGF0ZSA9IHRoaXMuZXRhLmdldFBhcnRpYWwocGFyc2VkLmlkKVxyXG5cdFx0aWYgKCFpc0V4dGFudCh0ZW1wbGF0ZSkpIHtcclxuXHRcdFx0aWYgKHRoaXMuZXRhLmZhaWxlZFRlbXBsYXRlcy5oYXMocGFyc2VkLmlkKSkgeyByZW5kZXJFcnJvcihlbCwge21zZzogYFRlbXBsYXRlICR7cGFyc2VkLmlkfSBmYWlsZWQgdG8gY29tcGlsZSwgZXJyb3I6IFxcbmAgKyB0aGlzLmV0YS5mYWlsZWRUZW1wbGF0ZXMuZ2V0KHBhcnNlZC5pZCl9KSB9XHJcblx0XHRcdGVsc2Uge3JlbmRlckVycm9yKGVsLCB7bXNnOiBgTm8gc3VjaCB0ZW1wbGF0ZSBcIiR7cGFyc2VkLmlkfVwiYH0pfVxyXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoJ01pc3NpbmcgVGVtcGxhdGUgRGVmaW5pdGlvbicpXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyU2tyaWJpKGVsLCB0ZW1wbGF0ZSwgcGFyc2VkLmlkLCBtZEN0eCwgT2JqZWN0LmFzc2lnbih7fSwgc2tDdHgsIHtjdHg6IHBhcnNlZC5hcmdzfSkpO1xyXG5cdH1cclxuXHJcbiAgLyoqIFdyYXAgbm9uLXRlbXBsYXRlIHNrcmliaXMgaW4gdGFncyBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyIHR5cGUgZmxhZyAqL1xyXG5cdGFzeW5jIHByb2Nlc3NTa3JpYmkoXHJcblx0XHRlbDogSFRNTEVsZW1lbnQsIFxyXG5cdFx0c3JjOiBzdHJpbmcsIFxyXG5cdFx0bWRDdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIFxyXG5cdFx0c2tDdHg6IFNrQ29udGV4dFxyXG5cdCk6IFByb21pc2U8U2tyaWJpUmVzdWx0PiB7XHJcblx0XHRjb25zdCBwcmVwID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nLCBmbGFnOiBudW1iZXIpIHtcclxuXHRcdFx0c3dpdGNoIChmbGFnKSB7IFxyXG5cdFx0XHRcdGNhc2UgMjogcmV0dXJuIGA8JT0ke3NyY30lPmA7IFxyXG5cdFx0XHRcdGNhc2UgMzogcmV0dXJuIGA8JX4ke3NyY30lPmA7IFxyXG5cdFx0XHRcdGNhc2UgNDogcmV0dXJuIHN0cjtcclxuXHRcdFx0XHRjYXNlIDU6IHJldHVybiBgPCUke3NyY30lPmA7XHJcblx0XHRcdH0gXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyU2tyaWJpKGVsLCBwcmVwKHNyYywgc2tDdHguZmxhZyksIFwibGl0ZXJhbFwiLCBtZEN0eCwgc2tDdHgpXHJcblx0fVxyXG5cclxuICAvKiogTWFpbiBza3JpYmkgcmVuZGVyaW5nIGZ1bmN0aW9uICovXHJcblx0YXN5bmMgcmVuZGVyU2tyaWJpKFxyXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcclxuXHRcdGNvbjogc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCwgXHJcblx0XHRpZDogc3RyaW5nLCBcclxuXHRcdG1kQ3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBcclxuXHRcdHNrQ3R4OiBTa0NvbnRleHRcclxuXHQpOiBQcm9taXNlPFNrcmliaVJlc3VsdD4ge1xyXG5cdFx0bGV0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChcIlwiLCBtZEN0eC5zb3VyY2VQYXRoKVxyXG5cclxuXHRcdGxldCBuZXdFbGVtZW50ID0gY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCJ9KTtcclxuXHRcdGxldCBjaGlsZCA9IG5ldyBTa3JpYmlDaGlsZCh0aGlzLnBsdWdpbiwgbmV3RWxlbWVudClcclxuXHRcdE9iamVjdC5hc3NpZ24oY2hpbGQsIHsgXHJcblx0XHRcdHJlcmVuZGVyOiAoKHRlbXBsYXRlVG9SZXRyaWV2ZT86IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdGxldCBuc2tDdHggPSBPYmplY3QuYXNzaWduKHt9LCBza0N0eCwge3RpbWU6IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKX0pXHJcblx0XHRcdFx0aWYgKHNrQ3R4LmZsYWcgPT0gMSAmJiBpc0V4dGFudCh0ZW1wbGF0ZVRvUmV0cmlldmUpKSB7XHJcblx0XHRcdFx0XHRsZXQgdGVtcGxhdGUgPSB0aGlzLmV0YS5nZXRQYXJ0aWFsKHRlbXBsYXRlVG9SZXRyaWV2ZSlcclxuXHRcdFx0XHRcdGNoaWxkLnVubG9hZCgpO1xyXG5cdFx0XHRcdFx0dGhpcy5yZW5kZXJTa3JpYmkobmV3RWxlbWVudCwgdGVtcGxhdGUsIHRlbXBsYXRlVG9SZXRyaWV2ZSwgbWRDdHgsIG5za0N0eClcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y2hpbGQudW5sb2FkKCk7IFxyXG5cdFx0XHRcdFx0dGhpcy5yZW5kZXJTa3JpYmkobmV3RWxlbWVudCwgY29uLCBpZCwgbWRDdHgsIG5za0N0eClcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pLmJpbmQodGhpcyksXHJcblx0XHRcdHRlbXBsYXRlS2V5OiAoc2tDdHguZmxhZyA9PSAxKSA/IGlkIDogbnVsbCxcclxuXHRcdFx0c291cmNlOiBza0N0eC5zb3VyY2VcclxuXHRcdH0pIFxyXG5cdFx0XHRcclxuXHRcdGxldCBjdHggPSBPYmplY3QuYXNzaWduKHt9LCBza0N0eD8uY3R4IHx8IHt9LCB7Y2hpbGQ6IGNoaWxkLnByb3ZpZGVDb250ZXh0KCl9KVxyXG5cclxuXHRcdGxldCBbcmVuZGVyZWQsIHBhY2tldF06IFtzdHJpbmcsIFN0cmluZ2RleF0gPSBhd2FpdCB0aGlzLmV0YS5yZW5kZXJBc3luYyhjb24sIGN0eCwgZmlsZSlcclxuXHRcdC5jYXRjaCgoZXJyKSA9PiB7XHJcblx0XHRcdC8qIElmIHRoZSB0ZW1wbGF0ZSBmdW5jdGlvbiB0aHJvd3MgYW4gZXJyb3IsIGl0IHNob3VsZCBidWJibGUgdXAgdG8gaGVyZS4gKi9cclxuXHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVycm9yTG9nZ2luZykgY29uc29sZS53YXJuKGBTa3JpYmkgcmVuZGVyIHRocmV3IGVycm9yISBEaXNwbGF5aW5nIGNvbnRlbnQgYW5kIGVycm9yLi4uYCwgRUJBUiwgY29uLCBFQkFSLCBlcnIpO1xyXG5cdFx0XHRyZW5kZXJFcnJvcihlbCwgKGVycj8uaGFzRGF0YSkgPyBlcnIgOiB7bXNnOiBlcnI/Lm1zZyB8fCBlcnIgfHwgXCJSZW5kZXIgRXJyb3JcIn0pLnRoZW4oZXJyRWwgPT4ge1xyXG5cdFx0XHRcdC8qIEFsdGVyIHRoZSBjaGlsZCBzbyB0aGF0IGl0IG1heSB5ZXQgbGl2ZSAoYW5kIGxpc3RlbiBmb3Igc291cmNlIHVwZGF0ZXMpICovXHJcblx0XHRcdFx0T2JqZWN0LmFzc2lnbihjaGlsZCwge1xyXG5cdFx0XHRcdFx0Y29udGFpbmVyRWw6IGVyckVsLFxyXG5cdFx0XHRcdFx0c3RhdGU6IFwiZXJyb3JcIixcclxuXHRcdFx0XHRcdHJlcmVuZGVyOiAoKHRlbXBsYXRlVG9SZXRyaWV2ZT86IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRsZXQgbnNrQ3R4ID0gT2JqZWN0LmFzc2lnbih7fSwgc2tDdHgsIHt0aW1lOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCl9KVxyXG5cdFx0XHRcdFx0XHRpZiAoc2tDdHguZmxhZyA9PSAxICYmIGlzRXh0YW50KHRlbXBsYXRlVG9SZXRyaWV2ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRsZXQgdGVtcGxhdGUgPSB0aGlzLmV0YS5nZXRQYXJ0aWFsKHRlbXBsYXRlVG9SZXRyaWV2ZSlcclxuXHRcdFx0XHRcdFx0XHRjaGlsZC51bmxvYWQoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlbmRlclNrcmliaShlcnJFbCwgdGVtcGxhdGUsIHRlbXBsYXRlVG9SZXRyaWV2ZSwgbWRDdHgsIG5za0N0eClcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRjaGlsZC51bmxvYWQoKTsgXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5yZW5kZXJTa3JpYmkoZXJyRWwsIGNvbiwgaWQsIG1kQ3R4LCBuc2tDdHgpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pLmJpbmQodGhpcyksXHJcblx0XHRcdFx0fSkgXHJcblx0XHRcdFx0bWRDdHguYWRkQ2hpbGQoY2hpbGQpXHJcblx0XHRcdFx0dGhpcy5wbHVnaW4uY2hpbGRyZW4ucHVzaChjaGlsZClcclxuXHRcdFx0fSlcclxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShbbnVsbCwgbnVsbF0pXHJcblx0XHR9KVxyXG5cdFx0XHJcblx0XHRkTG9nKFwicmVuZGVyU2tyaWJpOlwiLCBlbCwgbWRDdHgsIHNrQ3R4LCBpZClcclxuXHRcdGlmIChpc0V4dGFudChyZW5kZXJlZCkpIHtcclxuXHRcdFx0bGV0IGQgPSBpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpID8gbWRDdHgucmVtYWluaW5nTmVzdExldmVsIDogKHNrQ3R4LmRlcHRoKVxyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0bGV0IHN0eWxlID0gc3RyaXBTdHlsZUZyb21TdHJpbmcocmVuZGVyZWQpIC8vIHJlbmRlck1hcmtkb3duIGlnbm9yZXMgc3R5bGUgbm9kZXMgc28gd2UnbGwganVzdCB5b2luayBlbSBcclxuXHRcdFx0aWYgKHN0eWxlWzFdKSB7cmVuZGVyZWQgPSBzdHlsZVswXX1cclxuXHJcblx0XHRcdGxldCByZW5kZXIgPSAocGFja2V0Py5bJ25vTWFya2Rvd24nXSBcclxuXHRcdFx0XHQ/IHRoaXMuc2ltcGxlUmVuZGVyKHJlbmRlcmVkLCBuZXdFbGVtZW50KSBcclxuXHRcdFx0XHQ6IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24ocmVuZGVyZWQsIG5ld0VsZW1lbnQsIG1kQ3R4LnNvdXJjZVBhdGgsIG51bGwpKVxyXG5cdFx0XHQudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0aWYgKGVsPy5wYXJlbnRFbGVtZW50Py5ub2RlTmFtZSA9PSBcIlBcIikgeyAvLyB0cnVlIHdoZW4gKG1vZGUgPT0gTW9kZS5ibG9jaylcclxuXHRcdFx0XHRcdGVsLnBhcmVudEVsZW1lbnQucmVwbGFjZVdpdGgoZWwpIC8vIHN0cmlwIHRoZSBzdXBlcmZsdW91cyBQIGVsZW1lbnRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJza3JpYmlcIiwgKHNrQ3R4LmZsYWcgPT0gMSkgPyAndGVtcGxhdGUnIDogaWQpXHJcblx0XHRcdFx0aWYgKHNrQ3R4LmZsYWcgPT0gMSkge25ld0VsZW1lbnQuc2V0QXR0cmlidXRlKFwic2tyaWJpLXRlbXBsYXRlXCIsIGlkKX1cclxuXHRcdFx0XHRuZXdFbGVtZW50LnJlbW92ZUNsYXNzKFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCIpXHJcblx0XHRcdFx0aWYgKCFuZXdFbGVtZW50LmdldEF0dHIoXCJjbGFzc1wiKSkge25ld0VsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiY2xhc3NcIil9XHJcblxyXG5cdFx0XHRcdGxldCBzaGFkZTtcclxuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hhZG93TW9kZSkge1xyXG5cdFx0XHRcdFx0LyogaXQgc2VlbXMgdGhhdCBub24tY29kZWJsb2NrIHNrcmliaXMgZG8gbm90IHN1cnZpdmUgdGhpcyBwcm9jZXNzICovXHJcblx0XHRcdFx0XHRsZXQgbmVsID0gY3JlYXRlRGl2KClcclxuXHRcdFx0XHRcdGVsPy5wYXJlbnRFbGVtZW50LnByZXBlbmQobmVsKVxyXG5cdFx0XHRcdFx0bmVsLnNldEF0dHIoJ3NrcmliaS1ob3N0JywgJycpXHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhlbCkgXHJcblx0XHRcdFx0XHRzaGFkZSA9IG5lbC5hdHRhY2hTaGFkb3coe21vZGU6ICdvcGVuJ30pXHJcblx0XHRcdFx0XHRzaGFkZS5hcHBlbmQobmV3RWxlbWVudClcclxuXHRcdFx0XHRcdGVsLnJlbW92ZSgpXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGVsLnJlcGxhY2VXaXRoKG5ld0VsZW1lbnQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0ZExvZyhcImZpbmlzaDogXCIsIHNrQ3R4LnRpbWUsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSk7XHJcblxyXG5cdFx0XHRcdGlmIChzdHlsZVsxXSkge1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNoYWRvd01vZGUpIHtcclxuXHRcdFx0XHRcdFx0KHNoYWRlIGFzIFNoYWRvd1Jvb3QpLmFwcGVuZChzdHlsZVsxXSlcclxuXHRcdFx0XHRcdFx0Ly8gbmV3RWxlbWVudC5wcmVwZW5kKHN0eWxlWzFdKVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0bmV3RWxlbWVudC5wcmVwZW5kKHN0eWxlWzFdKTsgXHJcblx0XHRcdFx0XHRcdHNjb3BlU3R5bGUoY2hpbGQsIG5ld0VsZW1lbnQsIHN0eWxlWzFdKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChza0N0eC5mbGFnID09IDEpIHtcclxuXHRcdFx0XHRcdHZMb2coYFJlbmRlcmVkIHRlbXBsYXRlIFwiJHtpZH1cIiAoJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS1za0N0eC50aW1lLCA0KX0gbXMpYCwgbmV3RWxlbWVudClcclxuXHRcdFx0XHR9IGVsc2UgdkxvZyhgUmVuZGVyZWQgbGl0ZXJhbCAoZjogJHtza0N0eC5mbGFnfSkgKCR7cm91bmRUbyh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktc2tDdHgudGltZSwgNCl9IG1zKWAsIG5ld0VsZW1lbnQpXHJcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXdFbGVtZW50KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRjaGlsZC5zZXRQYWNrZXQocGFja2V0KVxyXG5cdFx0XHRtZEN0eC5hZGRDaGlsZChjaGlsZClcclxuXHRcdFx0dGhpcy5wbHVnaW4uY2hpbGRyZW4ucHVzaChjaGlsZClcclxuXHRcdFx0XHJcblx0XHRcdHJlbmRlci50aGVuKChlKTogUHJvbWlzZTxhbnk+ID0+IHtcclxuXHRcdFx0XHRjaGlsZC5vblBvc3QoKVxyXG5cclxuXHRcdFx0XHQvLyBUT0RPOiBvbmx5IHJlc3RyaWN0IGRlcHRoIGZvciB0cmFuc2NsdXNpb25zXHJcblx0XHRcdFx0aWYgKGlzRXh0YW50KG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCkgJiYgKG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCA+IDApIHx8ICFpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZW1iZWRNZWRpYShlLCBtZEN0eC5zb3VyY2VQYXRoLCB0aGlzLnBsdWdpbiwgc2tDdHguZGVwdGgpIFxyXG5cdFx0XHRcdH0gZWxzZSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuXHRcdFx0fSlcclxuXHRcdFx0LnRoZW4oKHgpID0+IHtcclxuXHRcdFx0XHRkTG9nKFwicmVuZGVyZXIgZmluYWw6IFwiLCBkKVxyXG5cdFx0XHRcdHRoaXMucHJvY2Vzc0VudHJ5KHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgbmV3RWxlbWVudCwgbWRDdHgsIHNrQ3R4LmRlcHRoLTEsIHRydWUpIC8qIFJlY3Vyc2UgdGhlIHByb2Nlc3NvciB0byBwYXJzZSBza3JlZWJsaW5ncyAqL1xyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0cmV0dXJuIFtyZW5kZXIsIGNoaWxkXTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNoaWxkLmNsZWFyKCk7XHJcblx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChcIlJlbmRlciBFcnJvclwiKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIEVuZCBvZiBwcm9jZXNzb3IgY2hhaW4gKi9cclxuXHJcblx0YXN5bmMgc2ltcGxlUmVuZGVyKGNvbnRlbnQ6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XHJcblx0XHRlbC5pbm5lckhUTUwgPSBjb250ZW50XHJcblx0XHRjb25zb2xlLmxvZyhlbClcclxuXHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG5cdH1cclxufVxyXG5cclxuLyogU1RZTEUgRlVOQ1RJT05TICovXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3RyaXBTdHlsZUZyb21TdHJpbmcoc3RyOiBzdHJpbmcpOiBbc3RyaW5nLCBIVE1MU3R5bGVFbGVtZW50IHwgbnVsbF0ge1xyXG5cdGxldCB4ID0gY3JlYXRlRGl2KClcclxuXHR4LmlubmVySFRNTCA9IHN0clxyXG5cdC8vIGNvbnNvbGUubG9nKCdwcmVzdHJpcCcsIHgpXHJcblx0bGV0IHN0eWxlID0geC5xdWVyeVNlbGVjdG9yKCdzdHlsZScpXHJcblx0aWYgKHN0eWxlKSB4LnJlbW92ZUNoaWxkKHN0eWxlKVxyXG5cclxuXHRyZXR1cm4gW3guaW5uZXJIVE1MLCBzdHlsZSA/PyBudWxsXVxyXG59XHJcblxyXG4vKiBzIG11c3QgYmUgYXR0YWNoZWQgdG8gZG9jdW1lbnQgb3Igcy5zaGVldCB3aWxsIGJlIG51bGwgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNjb3BlU3R5bGUoY2hpbGQ6IFNrcmliaUNoaWxkLCBlbDogSFRNTEVsZW1lbnQsIHM6IEhUTUxTdHlsZUVsZW1lbnQpOiBIVE1MU3R5bGVFbGVtZW50IHtcclxuXHRjaGlsZC5oYXNoID0gY2hpbGQuaGFzaCA/PyBoYXNoKGNoaWxkLnNvdXJjZSlcclxuXHRjaGlsZC5jb250YWluZXJFbC5zZXRBdHRyKCdzay1oYXNoJywgY2hpbGQuaGFzaClcclxuXHRpZiAoIXMuc2hlZXQpIHtjb25zb2xlLndhcm4oXCJDb3VsZCBub3Qgc2NvcGUgc3R5bGUgYmVjYXVzZSBpdCB3YXMgbm90IGF0dGFjaGVkIHRvIHRoZSBkb2N1bWVudCFcXG5cIiwgZWwsIHMpOyByZXR1cm59XHJcblx0Y29uc3QgbCA9IHMuc2hlZXQuY3NzUnVsZXMubGVuZ3RoXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsOyArK2kpIHtcclxuXHRcdGNvbnN0IHJ1bGUgPSBzLnNoZWV0LmNzc1J1bGVzW2ldXHJcblxyXG5cdFx0aWYgKCEocnVsZSBpbnN0YW5jZW9mIENTU0ltcG9ydFJ1bGUpKSB7XHJcblx0XHRcdHNjb3BlUnVsZShydWxlLCBbJ3NrLWhhc2gnLCBjaGlsZC5oYXNoXSlcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIENoYW5naW5nIHRoZSBydWxlIHByb3BlcnRpZXMgZG9lc24ndCBjaGFuZ2UgdGhlIHRleHQgb2YgdGhlIHN0eWxlIGVsZW1lbnQsIHNvIHdlIGRvIGl0IG1hbnVhbGx5IHNvIG1ha2UgdGhlIHJlc29sdmVkIGJlaGF2aW9yIHZpc2libGUgZm9yIHVzZXJzIGluIGVsZW1lbnQgcGFuZWwgKi9cclxuXHRpZiAoKHdpbmRvdy5hcHAucGx1Z2lucy5wbHVnaW5zWydvYnNpZGlhbi1za3JpYmknXSBhcyBTa3JpYm9zUGx1Z2luKS5zZXR0aW5ncy5yZWZsZWN0U3R5bGVUYWdUZXh0KSB7XHJcblx0XHRsZXQgcnVsZXMgPSBbXVxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzLnNoZWV0LmNzc1J1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHJ1bGVzLnB1c2gocy5zaGVldC5jc3NSdWxlcy5pdGVtKGkpKVxyXG5cdFx0fVxyXG5cdFx0bGV0IHN0ciA9IHJ1bGVzLnJlZHVjZTxzdHJpbmc+KChhOiBzdHJpbmcsIGI6IENTU1J1bGUpID0+IHtyZXR1cm4gYSArIGAke2IuY3NzVGV4dH1gICsgJ1xcbid9LCBcIlwiKVxyXG5cdFx0cy50ZXh0Q29udGVudCA9IHN0clxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHNcclxufVxyXG5cclxuLyoqIE11dGF0ZXMgYSBDU1NSdWxlJ3Mgc2VsZWN0b3JzIHRvIHNlbGVjdCBlbGVtZW50cyB3aXRoIGF0dHJpYnV0ZSAnc2staGFzaCcgZXF1YWwgdG8gaGFzaCBcclxuLyogQHBhcmFtIHJ1bGUgQ1NTUnVsZSB0byBzY29wZSBcclxuLyogQHBhcmFtIGhhc2ggW2F0dHJLZXksIGF0dHJWYWxdIHRvIHRhcmdldCAqL1xyXG5mdW5jdGlvbiBzY29wZVJ1bGUocnVsZTogQ1NTUnVsZSwgdGFyZ2V0OiBbc3RyaW5nLCBudW1iZXJdKTogdm9pZCB7XHJcblx0aWYgKCEocnVsZSBpbnN0YW5jZW9mIENTU1N0eWxlUnVsZSkpIHJldHVybjsgLy8gbWVkaWEgYW5kIGltcG9ydCBydWxlcyBpZ25vcmVkXHJcblxyXG5cdGxldCBiID0gcHJlZml4U2VsZWN0b3JzKHJ1bGUuc2VsZWN0b3JUZXh0LCBgWyR7dGFyZ2V0WzBdfT0nJHt0YXJnZXRbMV19J11gKVxyXG5cdHJ1bGUuc2VsZWN0b3JUZXh0ID0gYlxyXG59IiwiaW1wb3J0IHsgRXZlbnRSZWYsIE1hcmtkb3duUmVuZGVyQ2hpbGQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcbmltcG9ydCB7IFN0cmluZ2RleCB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgZExvZywgdkxvZyB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBzY29wZVN0eWxlIH0gZnJvbSBcIi4vcHJvY2Vzc29yXCI7XHJcblxyXG5pbnRlcmZhY2UgU2tDaGlsZCB7XHJcblx0c2NyaXB0c1VwZGF0ZWQ6ICgpID0+IGFueVxyXG59XHJcblxyXG50eXBlIHNrQ2hpbGRTdGF0ZSA9IFwicHJlXCIgfCBcInBvc3RcIiB8IFwiZXJyb3JcIlxyXG5cclxuZXhwb3J0IGNsYXNzIFNrcmliaUNoaWxkIGV4dGVuZHMgTWFya2Rvd25SZW5kZXJDaGlsZCBpbXBsZW1lbnRzIFNrQ2hpbGQge1xyXG5cdHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luXHJcblxyXG5cdHBhY2tldDogU3RyaW5nZGV4XHJcblx0cHJpdmF0ZSBpbnRlcnZhbHM6IG51bWJlcltdID0gW107XHJcblx0cHJpdmF0ZSBjYk9uVW5sb2FkOiBbRnVuY3Rpb24sIGFueV1bXSA9IFtdXHJcblx0cHJpdmF0ZSBjYk9uUG9zdDogW0Z1bmN0aW9uLCBhbnldW10gPSBbXVxyXG5cclxuXHRpc1Bvc3Q6IGJvb2xlYW4gPSBmYWxzZSAvLyBUcnVlIHdoZW4gY29udGFpbmVyIGhhcyBhdHRhY2hlZCB0byBkb2N1bWVudCBcclxuXHRzdGF0ZTogc2tDaGlsZFN0YXRlID0gXCJwcmVcIlxyXG5cclxuXHR0ZW1wbGF0ZUtleT86IHN0cmluZyAvLyBUaGUgc291cmNlIHRlbXBsYXRlXHJcblx0c291cmNlOiBzdHJpbmcgLy8gVGhlIHVuY29tcGlsZWQgc291cmNlIHN0cmluZyBvZiB0aGUgc2tyaWJpIGludm9jYXRpb25cclxuXHRoYXNoOiBudW1iZXIgLy8gQXNzaWduZWQgd2hlbiBuZWVkZWRcclxuXHRzb3VyY2VzOiB7dGVtcGxhdGVzOiBzdHJpbmdbXSwgc3R5bGVzOiBzdHJpbmdbXX0gPSB7XHJcblx0XHR0ZW1wbGF0ZXM6IFtdLFxyXG5cdFx0c3R5bGVzOiBbXVxyXG5cdH1cclxuXHJcblx0Y29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luLCBlbDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdHN1cGVyKGVsKVxyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHR9XHJcblxyXG4gIHB1YmxpYyBwcm92aWRlQ29udGV4dCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGVsOiB0aGlzLmNvbnRhaW5lckVsLFxyXG4gICAgICByZWdpc3RlckludGVydmFsOiB0aGlzLnNrUmVnaXN0ZXJJbnRlcnZhbC5iaW5kKHRoaXMpLFxyXG4gICAgICByZWdpc3RlclVubG9hZDogdGhpcy5za1JlZ2lzdGVyVW5sb2FkLmJpbmQodGhpcyksXHJcbiAgICAgIHJlZ2lzdGVyRXZlbnQ6IHRoaXMuc2tSZWdpc3RlckV2ZW50LmJpbmQodGhpcyksXHJcblx0XHRcdHJlZ2lzdGVyUG9zdDogdGhpcy5za1JlZ2lzdGVyUG9zdC5iaW5kKHRoaXMpLFxyXG5cdFx0XHRhZGRTdHlsZTogdGhpcy5za0FkZFN0eWxlLmJpbmQodGhpcyksXHJcbiAgICAgIHJlbG9hZDogdGhpcy5yZXJlbmRlciwgLy8gQm91bmQgb24gYXNzaWdubWVudFxyXG4gICAgICBfYzogdGhpc1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblx0cHVibGljIHNjcmlwdHNVcGRhdGVkKCkge1xyXG5cdFx0dGhpcy5yZXJlbmRlcigpXHJcblx0fVxyXG5cclxuXHRwdWJsaWMgdGVtcGxhdGVzVXBkYXRlZChpZDogc3RyaW5nLCBuZXdJZD86IHN0cmluZykge1x0XHJcblx0XHRpZiAoKHRoaXM/LnRlbXBsYXRlS2V5ID09IGlkKSB8fCB0aGlzLnNvdXJjZXMudGVtcGxhdGVzLmNvbnRhaW5zKGlkKSkge1xyXG5cdFx0XHRkTG9nKFwiQ2hpbGQgcmVjZWl2ZWQgdGVtcGxhdGUgdXBkYXRlIG5vdGlmaWNhdGlvbiB0aGF0IG1hdGNoZWQgb25lIG9mIGl0cyBzb3VyY2VzXCIsIGlkLCB0aGlzKVxyXG5cdFx0XHR0aGlzLnJlcmVuZGVyKChpZCA9PSB0aGlzPy50ZW1wbGF0ZUtleSkgPyBpZCA6IG51bGwpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3R5bGVzVXBkYXRlZChpZDogc3RyaW5nKSB7XHJcblx0XHRpZiAoKHRoaXMuc291cmNlcy5zdHlsZXMpLmNvbnRhaW5zKGlkKSkge1xyXG5cdFx0XHRkTG9nKFwiQ2hpbGQgcmVjZWl2ZWQgc3R5bGUgdXBkYXRlIG5vdGlmaWNhdGlvbiB0aGF0IG1hdGNoZWQgb25lIG9mIGl0cyBzb3VyY2VzXCIsIGlkLCB0aGlzKVxyXG5cdFx0XHR0aGlzLnJlcmVuZGVyKClcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGxpc3RlbkZvcih0eXBlOiBcInN0eWxlXCIgfCBcInRlbXBsYXRlXCIsIGlkOiBzdHJpbmcpIHtcclxuXHRcdGxldCBsID0gKHR5cGUgPT0gXCJzdHlsZVwiID8gdGhpcy5zb3VyY2VzLnN0eWxlcyA6IHR5cGUgPT0gXCJ0ZW1wbGF0ZVwiID8gdGhpcy5zb3VyY2VzLnRlbXBsYXRlcyA6IG51bGwpXHJcblx0XHRpZiAobCkgbC5wdXNoKGlkKSBcclxuXHR9XHJcblxyXG5cdHNldFBhY2tldChwYWNrZXQ6IFN0cmluZ2RleCkge1xyXG5cdFx0aWYgKHRoaXMucGFja2V0ID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5wYWNrZXQgPSBwYWNrZXQ7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRvbmxvYWQoKSB7fVxyXG5cclxuXHQvKiBOT1QgY2FsbGVkIGJ5IGNoaWxkLnVubG9hZCgpIChleGNlcHQgc29tZXRpbWVzIGl0IGlzKSAqL1xyXG5cdG9udW5sb2FkKCkge1xyXG5cdFx0ZExvZyhcInNrcmVlYiB1bmxvYWRcIiwgdGhpcy5jb250YWluZXJFbCk7XHJcblx0XHR0aGlzLmNsZWFyKClcclxuXHR9XHJcblxyXG5cdC8qIENhbGxlZCBieSByZXJlbmRlci4gKi9cclxuXHRjbGVhcigpIHtcclxuXHRcdHZMb2coXCJjbGVhclwiLCB0aGlzLmNvbnRhaW5lckVsKVxyXG5cdFx0Zm9yIChsZXQgaSBvZiB0aGlzLmludGVydmFscykgd2luZG93LmNsZWFySW50ZXJ2YWwoaSk7IC8vIHRoZXJlIG1pZ2h0IGJlIGNhc2VzIHdoZXJlIHRoaXMgZG9lc24ndCBnZXQgY2FsbGVkIHByb3Blcmx5ICg/KVxyXG5cdFx0Zm9yIChsZXQgY2Igb2YgdGhpcy5jYk9uVW5sb2FkKSBjYlswXShjYlsxXSk7XHJcblxyXG5cdFx0Ly8gdGhpcy5jb250YWluZXJFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuY29udGFpbmVyRWwpXHJcblx0XHR0aGlzLnBsdWdpbi5jaGlsZHJlbi5yZW1vdmUodGhpcylcclxuXHR9XHJcblxyXG5cdC8qIENhbGxlZCBhZnRlciByZW5kZXIgZnVsZmlsbG1lbnQgKi9cclxuXHRvblBvc3QoKSB7XHJcblx0XHR0aGlzLmlzUG9zdCA9IHRydWVcclxuXHRcdHRoaXMuc3RhdGUgPSBcInBvc3RcIlxyXG5cdFx0Zm9yIChsZXQgY2Igb2YgdGhpcy5jYk9uUG9zdCkgY2JbMF0oY2JbMV0pO1xyXG5cdH1cclxuXHJcbiAgLyotLSBQcm92aWRlciBGdW5jdGlvbnMgLS0qL1xyXG5cclxuXHQvLyBBc3luY2hyb25vdXNseSBhZGRzIGEgc2NvcGVkIHN0eWxlIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lciwgZnJvbSBzdHJpbmcgc3RyXHJcblx0Ly8gV2lsbCBub3QgcmVzb2x2ZSB1bnRpbCBwb3N0ICh3aGVuIGVsZW1lbnQgaXMgYXR0YWNoZWQgdG8gZG9jdW1lbnQsIHdoaWNoIGlzIHJlcXVpcmVkIGZvciBzY29wZVN0eWxlKCkpXHJcblx0Ly8gUmV0dXJucyByZWZlcmVuY2UgdG8gdGhlIGNyZWF0ZWQgZWxlbWVudFxyXG5cdC8vIFRPRE86IGlmIGFib3J0ZWQgYmVmb3JlIHBvc3QsIHdpbGwgcHJvbWlzZSBwZXJzaXN0IGluIG1lbW9yeT9cclxuXHRza0FkZFN0eWxlKHN0cjogc3RyaW5nKTogUHJvbWlzZTxIVE1MU3R5bGVFbGVtZW50PiB7XHJcblx0XHRsZXQgcyA9IGNyZWF0ZUVsKCdzdHlsZScpXHJcblx0XHRzLmlubmVySFRNTCA9IHN0clxyXG5cdFx0dGhpcy5jb250YWluZXJFbC5wcmVwZW5kKHMpXHJcblxyXG5cdFx0bGV0IHAgPSAoKSA9PiB7XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdFx0dGhpcy5za1JlZ2lzdGVyUG9zdCgoKSA9PiB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHNjb3BlU3R5bGUodGhpcywgdGhpcy5jb250YWluZXJFbCwgcykpfSlcclxuXHRcdFx0fSlcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcCgpIGFzIFByb21pc2U8SFRNTFN0eWxlRWxlbWVudD5cclxuXHR9XHJcblxyXG5cdHNrUmVnaXN0ZXJJbnRlcnZhbChjYjogRnVuY3Rpb24sIHRpbWU6IG51bWJlciwgLi4uYXJnczogYW55W10pIHtcclxuXHRcdC8vQHRzLWlnbm9yZVxyXG5cdFx0bGV0IHggPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKC4uLmE6IGFueSkgPT4geyBpZiAodGhpcy5fbG9hZGVkID09IGZhbHNlKSB7d2luZG93LmNsZWFySW50ZXJ2YWwoeCl9XHJcblx0XHRcdGNiKC4uLmEpfSwgdGltZSAqIDEwMDAsIC4uLmFyZ3MpXHJcblx0XHR0aGlzLmludGVydmFscy5wdXNoKHgpXHJcblx0XHRyZXR1cm4geDtcclxuXHR9XHJcblxyXG4gIHNrUmVnaXN0ZXJFdmVudChldmVudDogRXZlbnRSZWYpIHtcclxuICAgIGRMb2coJ1NrQ2hpbGQgcmVnaXN0ZXJlZCBldmVudDonLCBldmVudClcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChldmVudClcclxuICB9XHJcblxyXG5cdHNrUmVnaXN0ZXJVbmxvYWQoY2I6IEZ1bmN0aW9uLCAuLi5hcmdzOiBhbnlbXSkge1xyXG5cdFx0dGhpcy5jYk9uVW5sb2FkLnB1c2goWyguLi54OiBhbnkpID0+IGNiKC4uLngpLCBhcmdzXSlcclxuXHR9XHJcblxyXG5cdHNrUmVnaXN0ZXJQb3N0KGNiOiBGdW5jdGlvbiwgLi4uYXJnczogYW55W10pIHtcclxuXHRcdGlmICghdGhpcy5pc1Bvc3QpIHtcclxuXHRcdFx0dGhpcy5jYk9uUG9zdC5wdXNoKFsoLi4ueDogYW55KSA9PiBjYiguLi54KSwgYXJnc10pXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQoKC4uLng6IGFueSkgPT4gY2IoLi4ueCkpKGFyZ3MpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuICAvLyBBc3NpZ25lZCBpbiByZW5kZXJTa3JpYmkoKVxyXG4gIHJlcmVuZGVyKC4uLmFyZ3M6IGFueVtdKSB7fVxyXG59IiwiaW1wb3J0IHsgRnV6enlTdWdnZXN0TW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU3VnZ2VzdGlvbk1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XHJcbiAgcHJpdmF0ZSByZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZDtcclxuXHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFNrcmlib3NQbHVnaW4pIHtcclxuICAgIHN1cGVyKHBsdWdpbi5hcHApXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uZXRhLmdldENhY2hlS2V5cygpXHJcbiAgfVxyXG5cclxuICBnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge3JldHVybiBpdGVtfVxyXG5cclxuICBvbkNob29zZUl0ZW0oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLnJlc29sdmUoaXRlbSlcclxuICB9XHJcblxyXG4gIGFzeW5jIG9wZW5BbmRHZXRWYWx1ZShyZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCwgcmVqZWN0OiAoKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlXHJcbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdFxyXG4gICAgdGhpcy5vcGVuKClcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBFdGFDb25maWcgfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29uZmlnXCI7XHJcbmltcG9ydCB7IENhbGxiYWNrRm4gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvZmlsZS1oYW5kbGVyc1wiO1xyXG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gXCJzcmMvcmVuZGVyL2NoaWxkXCI7XHJcbmltcG9ydCB7IE1vZGVzLCBGbGFncyB9IGZyb20gXCIuL2NvbnN0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrQ29udGV4dCB7XHJcblx0dGltZTogbnVtYmVyLCAvLyBUaW1lIG9mIGluaXRpYWwgcmVuZGVyIHByb21pc2UgZGlzcGF0Y2hcclxuXHRmbGFnOiBudW1iZXIsXHJcblx0ZGVwdGg6IG51bWJlciwgXHJcblx0c291cmNlOiBzdHJpbmcsIC8vIE9yaWdpbmFsIHRleHQgY29udGVudFxyXG5cdGN0eD86IGFueVx0Ly8gU3RvcmVzIHBhc3NlZCB0ZW1wbGF0ZSB2YWx1ZXMsIG51bGwgb24gbm9uLXRlbXBsYXRlc1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFByb2Nlc3Nvck1vZGUge1xyXG5cdHNyY1R5cGU6IE1vZGVzXHJcblx0ZmxhZz86IEZsYWdzXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGVtcGxhdGUge1xyXG5cdGZpbGU6IFRGaWxlXHJcbn1cclxuXHJcbmV4cG9ydCBkZWNsYXJlIHR5cGUgU3RyaW5nZGV4PFQgPSBhbnk+ID0ge1tpbmRleDogc3RyaW5nXTogVH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXJnU2V0IHtbaW5kZXg6IHN0cmluZ106IHN0cmluZyB8IHN0cmluZ1tdfTtcclxuXHJcbmV4cG9ydCBlbnVtIHByb21wdFR5cGVzIHtcclxuICBzdHJpbmcgPSBcInN0cmluZ1wiXHJcbn1cclxuXHJcbi8qIEFuIG9iamVjdCBjcmVhdGVkIGZyb20gdGVtcGxhdGUgbWV0YWRhdGEsIHVzZWQgYnkgaW5zZXJ0aW9uTW9kYWwuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgZmllbGRQcm9tcHQge1xyXG5cdFtpbmRleDogc3RyaW5nXTogYW55XHJcblx0aWQ6IHN0cmluZ1xyXG5cdHR5cGU6IHByb21wdFR5cGVzXHJcblx0bmFtZTogc3RyaW5nXHJcblx0cGxhY2Vob2xkZXI6IHN0cmluZ1xyXG5cdGRlZmF1bHQ6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHNjb3BlZFZhcnMgZXh0ZW5kcyBTdHJpbmdkZXgge1xyXG4gIHNrOiBvYmplY3QsIFxyXG4gIEU6IEV0YUNvbmZpZywgXHJcbiAgY2I/OiBDYWxsYmFja0ZuLCBcclxuICBzY29wZT86IFN0cmluZ2RleFxyXG59XHJcblxyXG5leHBvcnQgZGVjbGFyZSB0eXBlIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgPSAoc2NvcGU6IHNjb3BlZFZhcnMpID0+IFByb21pc2U8c3RyaW5nPjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRHluYW1pY1N0YXRlIHtcclxuICBlbDogSFRNTEVsZW1lbnQsXHJcbiAgZmlsZTogVEZpbGUsXHJcbiAgY2hpbGQ6IFNrcmliaUNoaWxkXHJcbn1cclxuXHJcbi8qIEZvciBvYmplY3RzIHRoYXQgbXVzdCByZWFjdCB0byBmaWxlIGNoYW5nZSBldmVudHMgKi9cclxuZXhwb3J0IGludGVyZmFjZSBGaWxlTWluZGVyIHtcclxuXHRmaWxlUmVuYW1lZChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvbGROYW1lOiBzdHJpbmcpOiB2b2lkXHJcblx0ZmlsZUFkZGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkXHJcblx0ZmlsZURlbGV0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSk6IHZvaWRcclxuXHRmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZFxyXG5cdGRpcmVjdG9yeUNoYW5nZWQoKTogdm9pZFxyXG5cdGlzSW5Eb21haW4oZmlsZTogVEFic3RyYWN0RmlsZSk6IGJvb2xlYW5cclxuXHRkaXJlY3Rvcnk6IHN0cmluZ1xyXG59IiwiaW1wb3J0IHsgQWJzdHJhY3RUZXh0Q29tcG9uZW50LCBFZGl0b3IsIEVkaXRvclJhbmdlT3JDYXJldCxLZXltYXBFdmVudEhhbmRsZXIsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGwgfSBmcm9tIFwic3JjL2xhbmcvYmFiZWxcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgZmllbGRQcm9tcHQsIHByb21wdFR5cGVzIH0gZnJvbSBcIi4uL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCB0b0R1cGVSZWNvcmQgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEluc2VydGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG4gIHByaXZhdGUgZWRpdG9yOiBFZGl0b3I7XHJcbiAgcHJpdmF0ZSBrZXlwcmVzc1JlZjogS2V5bWFwRXZlbnRIYW5kbGVyO1xyXG5cclxuICBjdXJyZW50SUQ6IHN0cmluZztcclxuICB0ZXh0SW5wdXQ6IEFic3RyYWN0VGV4dENvbXBvbmVudDxhbnk+XHJcblxyXG4gIHZhbEZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbiwgZWRpdG9yOiBFZGl0b3IsIGlkOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKHBsdWdpbi5hcHApXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yO1xyXG5cclxuICAgIHRoaXMuY3VycmVudElEID0gaWQudG9TdHJpbmcoKVxyXG5cclxuICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJza3JpYmktaW5zZXJ0aW9uLW1vZGFsXCIpXHJcbiAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChsW1wibW9kYWwuaW5zZXJ0LnRpdGxlXCJdKVxyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgdGhpcy5jcmVhdGUoKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlKCkge1xyXG4gICAgbGV0IHMgPSBuZXcgU2V0dGluZyh0aGlzLmNvbnRlbnRFbClcclxuICAgIHMuYWRkRHJvcGRvd24oKGRyb3ApID0+IHsgZHJvcFxyXG4gICAgICAuYWRkT3B0aW9ucyh0b0R1cGVSZWNvcmQodGhpcy5wbHVnaW4uZXRhLmdldENhY2hlS2V5cygpKSlcclxuICAgICAgLnNldFZhbHVlKHRoaXMuY3VycmVudElEKVxyXG4gICAgICAub25DaGFuZ2UoKHYpID0+IHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRJRCA9IHZcclxuICAgICAgICBsZXQgZiA9IHRoaXMuZ2VuZXJhdGVGaWVsZHMoZmllbGRzRGl2LCB0aGlzLmN1cnJlbnRJRCk7XHJcbiAgICAgICAgKChmLmxlbmd0aCA+IDApID8gZlswXSA6IHRoaXMudGV4dElucHV0KS5pbnB1dEVsLmZvY3VzKCk7XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIGxldCBmaWVsZHNEaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2NsczogXCJza3JpYmktbW9kYWwtZmllbGRzXCJ9KVxyXG5cclxuICAgIGxldCB0ID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICB0LmFkZFRleHQoKHRlKSA9PiB7dGhpcy50ZXh0SW5wdXQgPSB0ZTsgcmV0dXJuIHRlO30pXHJcbiAgICB0LnNldE5hbWUobFtcIm1vZGFsLmluc2VydC5hcHBlbmRcIl0pXHJcbiAgICB0LnNldHRpbmdFbC5hZGRDbGFzcyhcInNrcmliaS1tb2RhbC1maWVsZC1hcHBlbmRcIilcclxuXHJcbiAgICBsZXQgZiA9IHRoaXMuZ2VuZXJhdGVGaWVsZHMoZmllbGRzRGl2LCB0aGlzLmN1cnJlbnRJRCk7XHJcbiAgICAoKGYubGVuZ3RoID4gMCkgPyBmWzBdIDogdGhpcy50ZXh0SW5wdXQpLmlucHV0RWwuZm9jdXMoKTtcclxuXHJcbiAgICBsZXQgY29uZmlybSA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgbGV0IGNiID0gY29uZmlybS5hZGRCdXR0b24oKGJ1dHRvbikgPT4gYnV0dG9uXHJcbiAgICAgIC5zZXRCdXR0b25UZXh0KGxbXCJtb2RhbC5pbnNlcnQuaW5zZXJ0XCJdKVxyXG4gICAgICAub25DbGljaygoKSA9PiB0aGlzLmRvSW5zZXJ0KCkpKVxyXG5cclxuICAgIHRoaXMua2V5cHJlc3NSZWYgPSB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVudGVyXCIsIHRoaXMuZG9JbnNlcnQuYmluZCh0aGlzKSlcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICB0aGlzLnNjb3BlLnVucmVnaXN0ZXIodGhpcy5rZXlwcmVzc1JlZilcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlRmllbGRzKGVsOiBIVE1MRWxlbWVudCwgaWQ6IHN0cmluZykge1xyXG4gICAgZWwuZW1wdHkoKTtcclxuXHJcbiAgICB2YXIgYXJyOiBBYnN0cmFjdFRleHRDb21wb25lbnQ8YW55PltdID0gW107XHJcblxyXG4gICAgaWYgKHRoaXMucGx1Z2luLmV0YS50ZW1wbGF0ZUZyb250bWF0dGVycy5oYXMoaWQpKSB7XHJcbiAgICAgIGxldCBmbSA9IHRoaXMucGx1Z2luLmV0YS50ZW1wbGF0ZUZyb250bWF0dGVycy5nZXQoaWQpXHJcbiAgICAgIGxldCBwdiA9IFtdXHJcbiAgICAgIGZvciAobGV0IHYgb2YgT2JqZWN0LmtleXMoZm0pKSB7XHJcbiAgICAgICAgaWYgKHYuY2hhckF0KDApPT1cIl9cIikge1xyXG4gICAgICAgICAgbGV0IHZuID0gdi5zdWJzdHJpbmcoMSlcclxuICAgICAgICAgIGxldCBmbWEgPSB0aGlzLnBhcnNlUHJvbXB0VmFsKHZuLCBmbVt2XSlcclxuXHJcbiAgICAgICAgICBsZXQgcyA9IG5ldyBTZXR0aW5nKGVsKVxyXG4gICAgICAgICAgcy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJza3JpYmktbW9kYWwtdGVtcGxhdGUtZmllbGRcIilcclxuICAgICAgICAgIGlmIChmbWEudHlwZSA9PSBwcm9tcHRUeXBlcy5zdHJpbmcpIHtcclxuICAgICAgICAgICAgYXJyLnB1c2godGhpcy5jcmVhdGVUZXh0RmllbGQocywgZm1hKSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHMuc2V0TmFtZShmbWEubmFtZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlVGV4dEZpZWxkKHNldDogU2V0dGluZywgZm1hOiBmaWVsZFByb21wdCkge1xyXG4gICAgbGV0IHQ7XHJcbiAgICBzZXQuYWRkVGV4dCgodGV4dCkgPT4geyBcclxuICAgICAgdGV4dFxyXG4gICAgICAuc2V0VmFsdWUoZm1hLmRlZmF1bHQpXHJcbiAgICAgIC5zZXRQbGFjZWhvbGRlcihmbWEucGxhY2Vob2xkZXIpXHJcbiAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICB0aGlzLnZhbEZpZWxkc1tmbWEuaWRdID0gdmFsdWVcclxuICAgICAgfSlcclxuICAgICAgdGV4dC5pbnB1dEVsLmFkZENsYXNzKFwic2tyaWJpLXRleHQtaW5wdXRcIilcclxuICAgICAgdCA9IHRleHRcclxuICAgIH0pXHJcblxyXG4gICAgaWYgKGZtYS5kZWZhdWx0Lmxlbmd0aCA+IDApIHRoaXMudmFsRmllbGRzW2ZtYS5pZF0gPSBmbWEuZGVmYXVsdFxyXG5cclxuICAgIHJldHVybiB0XHJcbiAgfVxyXG5cclxuICBwYXJzZVByb21wdFZhbChrOiBhbnksIHZhbDogYW55KTogZmllbGRQcm9tcHQge1xyXG4gICAgbGV0IHY6IGZpZWxkUHJvbXB0ID0ge1xyXG4gICAgICBpZDogayxcclxuICAgICAgdHlwZTogcHJvbXB0VHlwZXMuc3RyaW5nLFxyXG4gICAgICBuYW1lOiBpc0V4dGFudCh2YWw/Lm5hbWUpID8gdmFsLm5hbWUgOiBrLFxyXG4gICAgICBwbGFjZWhvbGRlcjogaXNFeHRhbnQodmFsPy5wbGFjZWhvbGRlcikgPyB2YWwucGxhY2Vob2xkZXIgOiBcIlwiLFxyXG4gICAgICBkZWZhdWx0OiBpc0V4dGFudCh2YWw/LmRlZmF1bHQpID8gdmFsLmRlZmF1bHQgOiBpc0V4dGFudCh2YWw/LmRlZikgPyB2YWwuZGVmIDogXCJcIixcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdlxyXG4gIH1cclxuXHJcbiAgZG9JbnNlcnQoKSB7XHJcbiAgICBsZXQgaWQgPSB0aGlzLmN1cnJlbnRJRFxyXG5cclxuICAgIGxldCBvc2VsID0gdGhpcy5lZGl0b3IubGlzdFNlbGVjdGlvbnMoKVxyXG4gICAgXHJcbiAgICBsZXQgdG9JbnNlcnQgPSBgXFxgezoke2lkfWBcclxuXHJcbiAgICBmb3IgKGxldCBlIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMudmFsRmllbGRzKSkge1xyXG4gICAgICB0b0luc2VydCArPSBgIHwgJHtlWzBdfTogJHtlWzFdfWBcclxuICAgIH1cclxuXHJcbiAgICB0b0luc2VydCArPSAodGhpcz8udGV4dElucHV0LmdldFZhbHVlKCkubGVuZ3RoID4gMCkgPyBcIiB8IFwiICsgdGhpcy50ZXh0SW5wdXQuZ2V0VmFsdWUoKSA6IFwiXCJcclxuICAgIHRvSW5zZXJ0ICs9IGB9XFxgYFxyXG5cclxuICAgIHRoaXMuZWRpdG9yLmdldERvYygpLnJlcGxhY2VTZWxlY3Rpb24odG9JbnNlcnQpXHJcblxyXG4gICAgbGV0IG5zZWw6IEVkaXRvclJhbmdlT3JDYXJldFtdID0gW10gXHJcbiAgICBmb3IgKGxldCBwIG9mIG9zZWwpIHtuc2VsLnB1c2goe2Zyb206IHtsaW5lOiBwLmFuY2hvci5saW5lLCBjaDogcC5hbmNob3IuY2ggKyAodG9JbnNlcnQubGVuZ3RoKX19KX1cclxuICAgIHRoaXMuZWRpdG9yLnRyYW5zYWN0aW9uKHtzZWxlY3Rpb25zOiBuc2VsfSlcclxuXHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEFic3RyYWN0VGV4dENvbXBvbmVudCwgS2V5bWFwRXZlbnRIYW5kbGVyLCBNYXJrZG93blNlY3Rpb25JbmZvcm1hdGlvbiwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgbCB9IGZyb20gXCJzcmMvbGFuZy9iYWJlbFwiO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gXCJzcmMvcmVuZGVyL2NoaWxkXCI7XHJcbmltcG9ydCB7IE1vZGVzIH0gZnJvbSBcInNyYy90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xyXG5pbXBvcnQgeyBhdmVyYWdlLCAgaW52b2tlTWV0aG9kT2YsICBsaW5rRG9jcywgcm91bmRUbywgdkxvZyB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IG1ha2VFeHRlcm5hbExpbmsgfSBmcm9tIFwiLi9jb25maXJtYXRpb25Nb2RhbFwiO1xyXG5cclxuY29uc3QgbWF4aW11bUl0ZXJhdGlvbnMgPSAxMDAwMFxyXG5cclxuZXhwb3J0IGNsYXNzIFRlc3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHBsdWdpbjogU2tyaWJvc1BsdWdpbjtcclxuICBwcml2YXRlIGtleXByZXNzUmVmOiBLZXltYXBFdmVudEhhbmRsZXI7XHJcblxyXG4gIHRleHRGaWVsZFRvRXZhbDogQWJzdHJhY3RUZXh0Q29tcG9uZW50PGFueT5cclxuICBpdGVyYXRpb25zOiBudW1iZXIgPSAxMDtcclxuICBtdWx0aUJsb2NrOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIHJlc3VsdHNGaWVsZDogSFRNTEVsZW1lbnRcclxuXHJcbiAgdmFsRmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cclxuXHJcbiAgdGV4dEluOiBzdHJpbmdcclxuICBhdXRvZmlsbDoge1xyXG4gICAgdHlwZTogc3RyaW5nXHJcbiAgICB2YWx1ZTogc3RyaW5nXHJcbiAgfSA9IG51bGxcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luLCBhdXRvZmlsbD86IHt0eXBlOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9KSB7XHJcbiAgICBzdXBlcihwbHVnaW4uYXBwKVxyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmF1dG9maWxsID0gYXV0b2ZpbGxcclxuICAgIFxyXG4gICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcInNrcmliaS10ZXN0LW1vZGFsXCIpXHJcbiAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChsWydtb2RhbC5wZXJmLnRpdGxlJ10pXHJcblxyXG4gICAgbGV0IGRlc2MgPSBjcmVhdGVEaXYoe2NsczogJ3NrcmliaS1tb2RhbC1kZXNjJ30pXHJcbiAgICBtYWtlRXh0ZXJuYWxMaW5rKGRlc2MuY3JlYXRlRWwoJ2EnLCB7dGV4dDogbFsnZG9jdW1lbnRhdGlvbiddLCBhdHRyOiB7J2hyZWYnOiBsaW5rRG9jcygnY29tbWFuZHMvcGVyZm9ybWFuY2UnKX19KSlcclxuXHJcbiAgICBkZXNjLmluc2VydEFmdGVyKHRoaXMudGl0bGVFbClcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIHRoaXMuY3JlYXRlKClcclxuICB9XHJcblxyXG4gIGNyZWF0ZSgpIHtcclxuICAgIGxldCBmaWVsZFRleHRUb0V2YWwgPSBuZXcgU2V0dGluZyh0aGlzLmNvbnRlbnRFbClcclxuICAgIGZpZWxkVGV4dFRvRXZhbC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge3RoaXMudGV4dEZpZWxkVG9FdmFsID0gdGV4dDsgcmV0dXJuIHRleHR9KVxyXG4gICAgZmllbGRUZXh0VG9FdmFsLnNldE5hbWUobFtcIm1vZGFsLnBlcmYudGV4dFRvRXZhbHVhdGUubmFtZVwiXSlcclxuICAgIGZpZWxkVGV4dFRvRXZhbC5zZXREZXNjKGxbXCJtb2RhbC5wZXJmLnRleHRUb0V2YWx1YXRlLmRlc2NcIl0pXHJcbiAgICB0aGlzLnRleHRGaWVsZFRvRXZhbC5zZXRQbGFjZWhvbGRlcihsW1wibW9kYWwucGVyZi50ZXh0VG9FdmFsdWF0ZS5wbGFjZWhvbGRlclwiXSlcclxuICAgIGlmICh0aGlzLmF1dG9maWxsKSB7XHJcbiAgICAgIGZpZWxkVGV4dFRvRXZhbC5pbmZvRWwuYXBwZW5kKGNyZWF0ZURpdih7dGV4dDogYEF1dG9maWxsZWQgZnJvbSAke3RoaXMuYXV0b2ZpbGwudHlwZX1gLCBjbHM6ICdzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gc2tyaWJpLWF1dG9maWxsLW5vdGlmaWNhdGlvbid9KSlcclxuICAgICAgdGhpcy50ZXh0RmllbGRUb0V2YWwuc2V0VmFsdWUodGhpcy5hdXRvZmlsbC52YWx1ZSlcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZmllbGRJdGVyYXRpb25zID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBsZXQgaXRlcnM6IEhUTUxJbnB1dEVsZW1lbnQgPSBmaWVsZEl0ZXJhdGlvbnMuY29udHJvbEVsLmNyZWF0ZUVsKCdpbnB1dCcsIHthdHRyOiB7dHlwZTogJ251bWJlcid9fSlcclxuICAgIGl0ZXJzLmRlZmF1bHRWYWx1ZSA9IHRoaXMuaXRlcmF0aW9ucy50b1N0cmluZygpXHJcbiAgICBpdGVycy5vbmNoYW5nZSA9IChldikgPT4ge3RoaXMuaXRlcmF0aW9ucyA9IGl0ZXJzLnZhbHVlQXNOdW1iZXJ9XHJcbiAgICBmaWVsZEl0ZXJhdGlvbnMuc2V0TmFtZShsW1wibW9kYWwucGVyZi5ldmFsSXRlcmF0aW9ucy5uYW1lXCJdKVxyXG4gICAgZmllbGRJdGVyYXRpb25zLnNldERlc2MobFtcIm1vZGFsLnBlcmYudGV4dFRvRXZhbHVhdGUuZGVzY1wiXSlcclxuXHJcbiAgICBsZXQgYmxvY2tTZXR0aW5nID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBibG9ja1NldHRpbmcuYWRkVG9nZ2xlKCh0b2cpID0+IHtcclxuICAgICAgdG9nLnNldFZhbHVlKHRoaXMubXVsdGlCbG9jaylcclxuICAgICAgdG9nLm9uQ2hhbmdlKCh2KSA9PiB0aGlzLm11bHRpQmxvY2sgPSB2KVxyXG4gICAgICByZXR1cm4gdG9nXHJcbiAgICB9KVxyXG4gICAgYmxvY2tTZXR0aW5nLnNldE5hbWUobFtcIm1vZGFsLnBlcmYuZXZhbEJsb2Nrc1wiXSlcclxuXHJcbiAgICBsZXQgY29uZmlybSA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKS5zZXRDbGFzcygnc2tyaWJpLWJ1dHRvbi1ldmFsJylcclxuICAgIGNvbmZpcm0uYWRkQnV0dG9uKChidXR0b24pID0+IGJ1dHRvblxyXG4gICAgICAuc2V0QnV0dG9uVGV4dChsW1wibW9kYWwucGVyZi5ldmFsdWF0ZVwiXSlcclxuICAgICAgLm9uQ2xpY2soKCkgPT4gdGhpcy5kb0V2YWwoKSkpXHJcbiAgICB0aGlzLmtleXByZXNzUmVmID0gdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCB0aGlzLmRvRXZhbC5iaW5kKHRoaXMpKVxyXG5cclxuICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKCdocicpXHJcblxyXG4gICAgdGhpcy5yZXN1bHRzRmllbGQgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2NsczogXCJza3JpYmktdGVzdC1yZXN1bHRzLWZpZWxkXCJ9KVxyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHRoaXMuc2NvcGUudW5yZWdpc3Rlcih0aGlzLmtleXByZXNzUmVmKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZG9FdmFsKCkge1xyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5pbml0TG9hZGVkKSB7XHJcbiAgICAgIHRoaXMucmVzdWx0c0ZpZWxkLnNldFRleHQoXCJUZW1wbGF0ZSBjYWNoZSBub3QgcmVhZHkhXCIpXHJcbiAgICAgIHJldHVybjsgXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNvbnRhaW5lciA9IGNyZWF0ZURpdigpXHJcbiAgICBsZXQgZWwgPSBjcmVhdGVEaXYoKVxyXG5cclxuICAgIGxldCBibG9ja3NUb1Byb2Nlc3M6IEhUTUxFbGVtZW50W10gPSBbXVxyXG4gICAgbGV0IHRvSXRlciA9IE1hdGgubWluKHRoaXMuaXRlcmF0aW9ucywgbWF4aW11bUl0ZXJhdGlvbnMpXHJcbiAgICBpZiAodGhpcy5tdWx0aUJsb2NrKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9JdGVyOyBpKyspIHtcclxuICAgICAgICBsZXQgZCA9IGNyZWF0ZURpdigpXHJcbiAgICAgICAgZC5jcmVhdGVFbCgnY29kZScsIHt0ZXh0OiB0aGlzLnRleHRGaWVsZFRvRXZhbC5nZXRWYWx1ZSgpfSlcclxuICAgICAgICBibG9ja3NUb1Byb2Nlc3MucHVzaChkKVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgc2luZ2xlRGl2ID0gY3JlYXRlRGl2KClcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b0l0ZXI7IGkrKykge1xyXG4gICAgICAgIHNpbmdsZURpdi5jcmVhdGVFbCgnY29kZScsIHt0ZXh0OiB0aGlzLnRleHRGaWVsZFRvRXZhbC5nZXRWYWx1ZSgpfSlcclxuICAgICAgfVxyXG4gICAgICBibG9ja3NUb1Byb2Nlc3MucHVzaChzaW5nbGVEaXYpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHRpbWVTdGFydCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxyXG5cclxuICAgIGNvbnN0IHByb21zOiBQcm9taXNlPFtbXSwgbnVtYmVyLCBudW1iZXJdPltdID0gYmxvY2tzVG9Qcm9jZXNzLm1hcChhc3luYyAoZGl2KSA9PiB7XHJcbiAgICAgIGxldCBwcm9taXNlU3RhcnRUaW1lID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXHJcblxyXG4gICAgICBsZXQgcHJvbWlzZSA9IGF3YWl0IHRoaXMucGx1Z2luLnByb2Nlc3Nvci5wcm9jZXNzRW50cnkoe3NyY1R5cGU6IE1vZGVzLmdlbmVyYWx9LCBkaXYsIHtcclxuICAgICAgICByZW1haW5pbmdOZXN0TGV2ZWw6IDQsXHJcbiAgICAgICAgZG9jSWQ6ICc1NTU1NTU1NScsXHJcbiAgICAgICAgZnJvbnRtYXR0ZXI6IG51bGwsXHJcbiAgICAgICAgc291cmNlUGF0aDogdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhdGggfHwgXCJcIixcclxuICAgICAgICBhZGRDaGlsZDogKGNoaWxkOiBhbnkpID0+IHt9LFxyXG4gICAgICAgIGdldFNlY3Rpb25JbmZvOiAoKSA9PiB7cmV0dXJuIG51bGwgYXMgTWFya2Rvd25TZWN0aW9uSW5mb3JtYXRpb259LFxyXG4gICAgICAgIGNvbnRhaW5lckVsOiBjb250YWluZXIsXHJcbiAgICAgICAgZWw6IGVsXHJcbiAgICAgIH0sIDQsIGZhbHNlLCBudWxsKS5jYXRjaCgoKSA9PiB7fSlcclxuXHJcbiAgICAgIHJldHVybiBbcHJvbWlzZSwgd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBwcm9taXNlU3RhcnRUaW1lXSBhcyBhbnlcclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5yZXN1bHRzRmllbGQuc2V0VGV4dChsW1wibW9kYWwucGVyZi5ldmFsdWF0aW5nXCJdKVxyXG5cclxuICAgIGxldCBzZXR0bGVkVmFsdWVzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHByb21zKVxyXG5cclxuICAgIFxyXG4gICAgdkxvZyhgUGVyZm9ybWFuY2UgdGVzdCBzZXR0bGVkIGluOiAke3JvdW5kVG8od2luZG93LnBlcmZvcm1hbmNlLm5vdygpLXRpbWVTdGFydCwgMyl9bXNgKVxyXG5cclxuICAgIGxldCBmdWxsZmlsbGVkOiBbYW55W10sIG51bWJlciwgbnVtYmVyXVtdID0gc2V0dGxlZFZhbHVlcy5tYXAoKHYpID0+IHtpZiAodi5zdGF0dXMgPT0gJ2Z1bGZpbGxlZCcpIHJldHVybiB2LnZhbHVlfSlcclxuICAgIGxldCB0aW1lcyA9IGZ1bGxmaWxsZWQubWFwKChyZXN1bHQpID0+IChyZXN1bHRbMV0gYXMgbnVtYmVyIC0gKHJlc3VsdFsyXSBhcyBudW1iZXIpKSlcclxuICAgIGxldCBhdmcgPSBhdmVyYWdlKC4uLnRpbWVzKVxyXG4gICAgXHJcbiAgICBsZXQgcDogYW55W10gPSBbXVxyXG4gICAgZnVsbGZpbGxlZC5tYXAocmVzID0+IHJlc1swXS5tYXAoKGEpID0+IHAucHVzaChhKSkpXHJcbiAgICBsZXQgY2hpbGRyZW4gPSAoYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHApKS5tYXAoKHJleikgPT4ge2lmIChyZXouc3RhdHVzID09IFwiZnVsZmlsbGVkXCIpIHJldHVybiByZXoudmFsdWVbMV19KVxyXG4gICAgXHJcbiAgICB0aGlzLnJlc3VsdHNGaWVsZC5zZXRUZXh0KGAke2xbXCJtb2RhbC5wZXJmLnJlc3VsdHNcIl19ICgke2NoaWxkcmVuLmxlbmd0aH0gY2hpbGRyZW4gaW4gJHsgbC5fKCh0aW1lcy5sZW5ndGggPiAxID8gXCJtb2RhbC5wZXJmLnJlc3VsdHNCbG9ja0NvdW50LnBsdXJhbFwiIDogXCJtb2RhbC5wZXJmLnJlc3VsdHNCbG9ja0NvdW50LnNpbmdsZVwiKSwgdGltZXMubGVuZ3RoLnRvU3RyaW5nKCkpfSk6ICR7cm91bmRUbyhhdmcsIDMpfW1zYClcclxuICBcclxuICAgIC8vIGludm9rZU1ldGhvZE9mPFNrcmliaUNoaWxkPihcImNsZWFyXCIsIC4uLmNoaWxkcmVuKSAvLyBVbmxvYWQgZG9lc24ndCBzZWVtIHRvIGJlIGludm9rZWQgY29uc2lzdGVudGx5IHNvIGxldCdzIGp1c3QgbWFrZSBzdXJlIGV2ZXJ5dGhpbmcgaXMgY2xlYXJlZFxyXG4gICAgQXJyYXkuZnJvbShjaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQ6IFNrcmliaUNoaWxkKSA9PiBjaGlsZC5jbGVhcigpKVxyXG4gICAgYmxvY2tzVG9Qcm9jZXNzLm1hcChibG9jayA9PiBibG9jay5yZW1vdmUoKSkgLy8gQ2hpbGRyZW4gYXJlIGVhc2llciB0byBjb2xsZWN0IHdoZW4gdGhleSBsYWNrIHNoZWx0ZXJcclxuICAgIGNvbnRhaW5lci5yZW1vdmUoKTsgZWwucmVtb3ZlKCk7IC8vIE9uZSBkYXksIHRoZSBsYXN0IHBlcnNvbiB3aG8gcmVtZW1iZXJzIHlvdSB3aWxsIGRpZSwgYW5kIHlvdSB3aWxsIGJlIGZvcmdvdHRlbiBmb3JldmVyXHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBNYXJrZG93blZpZXcsIFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgRXRhSGFuZGxlciB9IGZyb20gJy4vZXRhL2V0YSc7XHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIFNrcmlib3NTZXR0aW5ncywgU2tyaWJvc1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcclxuaW1wb3J0IHsgU2tyaWJpQ2hpbGQgfSBmcm9tICcuL3JlbmRlci9jaGlsZCc7XHJcbmltcG9ydCB7IFN1Z2dlc3Rpb25Nb2RhbCB9IGZyb20gJy4vbW9kYWwvc3VnZ2VzdGlvbk1vZGFsJztcclxuaW1wb3J0IHsgSW5zZXJ0aW9uTW9kYWwgfSBmcm9tICcuL21vZGFsL2luc2VydGlvbk1vZGFsJztcclxuaW1wb3J0IHsgVGVzdE1vZGFsIH0gZnJvbSAnLi9tb2RhbC90ZXN0TW9kYWwnO1xyXG5pbXBvcnQgeyBsIH0gZnJvbSAnLi9sYW5nL2JhYmVsJztcclxuaW1wb3J0IFNrcmliaVByb2Nlc3NvciBmcm9tICcuL3JlbmRlci9wcm9jZXNzb3InO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2tyaWJvc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblx0c2V0dGluZ3M6IFNrcmlib3NTZXR0aW5ncztcclxuXHRldGE6IEV0YUhhbmRsZXI7XHJcblx0cHJvY2Vzc29yOiBTa3JpYmlQcm9jZXNzb3JcclxuXHJcblx0dmFyTmFtZTogc3RyaW5nID0gXCJza1wiO1xyXG5cdGluaXRMb2FkZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0bCA9IGxcclxuXHJcblx0Y2hpbGRyZW46IFNrcmliaUNoaWxkW10gPSBbXVxyXG5cdGNoaWxkUHJvdG86IGFueSA9IFNrcmliaUNoaWxkIC8vIGZvciBkZXYgbWVtb3J5IHF1ZXJ5aW5nIFxyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRjb25zb2xlLmxvZygnU2tyaWJpOiBMb2FkaW5nLi4uJyk7XHJcblxyXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2tyaWJvc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLmV0YSA9IG5ldyBFdGFIYW5kbGVyKHRoaXMpXHJcblx0XHR0aGlzLnByb2Nlc3NvciA9IG5ldyBTa3JpYmlQcm9jZXNzb3IodGhpcylcclxuXHJcblx0XHR0aGlzLnByb2Nlc3Nvci5yZWdpc3RlclByb2Nlc3NvcnMoKVxyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignc2tyaWJpOnRlbXBsYXRlLWluaXQtY29tcGxldGUnLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuaW5pdExvYWRlZCA9IHRydWVcclxuXHRcdFx0dGhpcy5wcm9jZXNzb3IudGVtcGxhdGVzUmVhZHkoKVxyXG5cdFx0fSkpXHJcblxyXG5cdFx0dGhpcy5kZWZpbmVDb21tYW5kcygpXHJcblx0XHR0aGlzLnJlZ2lzdGVyRXh0ZW5zaW9ucyhbJ2V0YSddLCAnbWFya2Rvd24nKVxyXG5cdFx0Ly8gcmVnaXN0ZXJNaXJyb3IodGhpcyk7XHJcblxyXG5cdFx0LyogUmVyZW5kZXIgcHJldmlldyB2aWV3cyAqL1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIikuZm9yRWFjaCgobGVhZikgPT4ge1xyXG5cdFx0XHRcdGlmICgobGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykuY3VycmVudE1vZGUudHlwZSA9PSBcInByZXZpZXdcIikge1xyXG5cdFx0XHRcdFx0KGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLnByZXZpZXdNb2RlLnJlcmVuZGVyKHRydWUpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0fSlcclxuXHR9XHJcblxyXG5cdC8qKiBSZWdpc3RlciBvdXIgY29tbWFuZHMuICovXHJcblx0ZGVmaW5lQ29tbWFuZHMoKSB7XHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe2lkOiBcImluc2VydC1za3JpYmlcIiwgbmFtZTogbFsnY29tbWFuZC5pbnNlcnQnXSwgXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yLCB2aWV3KSA9PiB7XHJcblx0XHRcdFx0aWYgKCF0aGlzLmluaXRMb2FkZWQpIHJldHVybjtcclxuXHRcdFx0XHRsZXQgeCA9IG5ldyBTdWdnZXN0aW9uTW9kYWwodGhpcyk7XHJcblx0XHRcdFx0bmV3IFByb21pc2UoKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpID0+IHgub3BlbkFuZEdldFZhbHVlKHJlc29sdmUsIHJlamVjdCkpXHJcblx0XHRcdFx0LnRoZW4ocmVzdWx0ID0+IHtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmV0YS5oYXNQYXJ0aWFsKHJlc3VsdCkpIHtcclxuXHRcdFx0XHRcdFx0bGV0IGkgPSBuZXcgSW5zZXJ0aW9uTW9kYWwodGhpcywgZWRpdG9yLCByZXN1bHQpXHJcblx0XHRcdFx0XHRcdGkub3BlbigpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sIChyKSA9PiB7fSk7XHJcblx0XHRcdH19KVxyXG5cclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7aWQ6IFwicmVsb2FkLXNjcmlwdHNcIiwgbmFtZTogbFsnY29tbWFuZC5yZWxvYWRTY3JpcHRzJ10sIGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdHRoaXMuZXRhLmJ1cy5zY3JpcHRMb2FkZXIucmVsb2FkKCkudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIlNrcmliaTogUmVsb2FkZWQgU2NyaXB0c1wiKSk7XHJcblx0XHR9fSlcclxuXHRcdFxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJyZWxvYWQtc2tyaWJpc1wiLCBuYW1lOiBcIlJlbG9hZCBTa3JpYmlzXCIsIGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikuZm9yRWFjaChjaGlsZCA9PiBjaGlsZC5yZXJlbmRlcihjaGlsZD8udGVtcGxhdGVLZXkpKVxyXG5cdFx0fX0pXHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJ0ZXN0LXBlcmZvcm1hbmNlXCIsIG5hbWU6IGxbJ2NvbW1hbmQucGVyZlRlc3QnXSwgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0bGV0IHNlbCA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcj8uZ2V0U2VsZWN0aW9uKClcclxuXHRcdFx0bGV0IGNsaXAgPSBhd2FpdCB3aW5kb3cubmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpO1xyXG5cdFx0XHRsZXQgZmlsbCA9IChzZWwgfHwgY2xpcCkgPyB7XHJcblx0XHRcdFx0dHlwZTogbFtzZWwgPyAnbW9kYWwucGVyZi5hdXRvZmlsbC5zZWxlY3Rpb24nIDogJ21vZGFsLnBlcmYuYXV0b2ZpbGwuY2xpcGJvYXJkJ10sXHJcblx0XHRcdFx0dmFsdWU6IHNlbCA/IHNlbCA6IGNsaXBcclxuXHRcdFx0fSA6IG51bGxcclxuXHRcdFx0XHJcblx0XHRcdG5ldyBUZXN0TW9kYWwodGhpcywgZmlsbCkub3BlbigpXHJcblx0XHR9fSlcclxuXHR9XHJcblx0XHJcblx0b251bmxvYWQoKSB7XHJcblx0XHR0aGlzLmV0YS51bmxvYWQoKVxyXG5cdFx0Y29uc29sZS5sb2coJ1NrcmliaTogVW5sb2FkaW5nLi4uJywgdGhpcy5jaGlsZHJlbik7ICBcclxuXHRcdEFycmF5LmZyb20odGhpcy5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuXHRcdFx0bGV0IHByZSA9IGNyZWF0ZUVsKCdjb2RlJywge3RleHQ6IGNoaWxkLnNvdXJjZX0pXHJcblx0XHRcdGNoaWxkLmNvbnRhaW5lckVsLnJlcGxhY2VXaXRoKHByZSlcclxuXHRcdFx0Y2hpbGQudW5sb2FkKClcclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG59Il0sIm5hbWVzIjpbInByb21pc2VJbXBsIiwiaGFzT3duUHJvcCIsImNvcHlQcm9wcyIsIkNhY2hlciIsInJlc29sdmUiLCJkaXJuYW1lIiwiZXh0bmFtZSIsImV4aXN0c1N5bmMiLCJyZWFkRmlsZVN5bmMiLCJub3JtYWxpemVQYXRoIiwiVEZvbGRlciIsIlZhdWx0IiwiVEZpbGUiLCJFdGEuZ2V0Q29uZmlnIiwiTWFya2Rvd25SZW5kZXJlciIsIkZpbGVTeXN0ZW1BZGFwdGVyIiwicGFyc2VZYW1sIiwiRXRhLmNvbXBpbGVUb1N0cmluZyIsIkV0YS5yZW5kZXJBc3luYyIsIkV0YS5yZW5kZXIiLCJNb2RhbCIsIlBsdWdpblNldHRpbmdUYWIiLCJkZWJvdW5jZSIsIlNldHRpbmciLCJwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkiLCJzZXRJY29uIiwiTWFya2Rvd25SZW5kZXJDaGlsZCIsIkZ1enp5U3VnZ2VzdE1vZGFsIiwiUGx1Z2luIiwiTWFya2Rvd25WaWV3Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDaEgsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxVQUFVLE9BQU8sRUFBRSxNQUFNLEVBQUU7QUFDL0QsUUFBUSxTQUFTLFNBQVMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ25HLFFBQVEsU0FBUyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0FBQ3RHLFFBQVEsU0FBUyxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsTUFBTSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FB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
