/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');
var fs = require('fs');
var path = require('path');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function setPrototypeOf(obj, proto) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    if (Object.setPrototypeOf) {
        Object.setPrototypeOf(obj, proto);
    }
    else {
        obj.__proto__ = proto;
    }
}
// This is pretty much the only way to get nice, extended Errors
// without using ES6
/**
 * This returns a new Error with a custom prototype. Note that it's _not_ a constructor
 *
 * @param message Error message
 *
 * **Example**
 *
 * ```js
 * throw EtaErr("template not found")
 * ```
 */
function EtaErr(message) {
    var err = new Error(message);
    setPrototypeOf(err, EtaErr.prototype);
    return err;
}
EtaErr.prototype = Object.create(Error.prototype, {
    name: { value: 'Eta Error', enumerable: false }
});
/**
 * Throws an EtaErr with a nicely formatted error and message showing where in the template the error occurred.
 */
function ParseErr(message, str, indx) {
    var whitespace = str.slice(0, indx).split(/\n/);
    var lineNo = whitespace.length;
    var colNo = whitespace[lineNo - 1].length + 1;
    message +=
        ' at line ' +
            lineNo +
            ' col ' +
            colNo +
            ':\n\n' +
            '  ' +
            str.split(/\n/)[lineNo - 1] +
            '\n' +
            '  ' +
            Array(colNo).join(' ') +
            '^';
    throw EtaErr(message);
}

/**
 * @returns The global Promise function
 */
var promiseImpl$1 = new Function('return this')().Promise;
/**
 * @returns A new AsyncFunction constuctor
 */
function getAsyncFunctionConstructor() {
    try {
        return new Function('return (async function(){}).constructor')();
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr("This environment doesn't support async/await");
        }
        else {
            throw e;
        }
    }
}
/**
 * str.trimLeft polyfill
 *
 * @param str - Input string
 * @returns The string with left whitespace removed
 *
 */
function trimLeft(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimLeft) {
        return str.trimLeft();
    }
    else {
        return str.replace(/^\s+/, '');
    }
}
/**
 * str.trimRight polyfill
 *
 * @param str - Input string
 * @returns The string with right whitespace removed
 *
 */
function trimRight(str) {
    // eslint-disable-next-line no-extra-boolean-cast
    if (!!String.prototype.trimRight) {
        return str.trimRight();
    }
    else {
        return str.replace(/\s+$/, ''); // TODO: do we really need to replace BOM's?
    }
}

// TODO: allow '-' to trim up until newline. Use [^\S\n\r] instead of \s
/* END TYPES */
function hasOwnProp$1(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}
function copyProps$1(toObj, fromObj) {
    for (var key in fromObj) {
        if (hasOwnProp$1(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
/**
 * Takes a string within a template and trims it, based on the preceding tag's whitespace control and `config.autoTrim`
 */
function trimWS(str, config, wsLeft, wsRight) {
    var leftTrim;
    var rightTrim;
    if (Array.isArray(config.autoTrim)) {
        // kinda confusing
        // but _}} will trim the left side of the following string
        leftTrim = config.autoTrim[1];
        rightTrim = config.autoTrim[0];
    }
    else {
        leftTrim = rightTrim = config.autoTrim;
    }
    if (wsLeft || wsLeft === false) {
        leftTrim = wsLeft;
    }
    if (wsRight || wsRight === false) {
        rightTrim = wsRight;
    }
    if (!rightTrim && !leftTrim) {
        return str;
    }
    if (leftTrim === 'slurp' && rightTrim === 'slurp') {
        return str.trim();
    }
    if (leftTrim === '_' || leftTrim === 'slurp') {
        // console.log('trimming left' + leftTrim)
        // full slurp
        str = trimLeft(str);
    }
    else if (leftTrim === '-' || leftTrim === 'nl') {
        // nl trim
        str = str.replace(/^(?:\r\n|\n|\r)/, '');
    }
    if (rightTrim === '_' || rightTrim === 'slurp') {
        // full slurp
        str = trimRight(str);
    }
    else if (rightTrim === '-' || rightTrim === 'nl') {
        // nl trim
        str = str.replace(/(?:\r\n|\n|\r)$/, ''); // TODO: make sure this gets \r\n
    }
    return str;
}
/**
 * A map of special HTML characters to their XML-escaped equivalents
 */
var escMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
};
function replaceChar(s) {
    return escMap[s];
}
/**
 * XML-escapes an input value after converting it to a string
 *
 * @param str - Input value (usually a string)
 * @returns XML-escaped string
 */
function XMLEscape(str) {
    // eslint-disable-line @typescript-eslint/no-explicit-any
    // To deal with XSS. Based on Escape implementations of Mustache.JS and Marko, then customized.
    var newStr = String(str);
    if (/[&<>"']/.test(newStr)) {
        return newStr.replace(/[&<>"']/g, replaceChar);
    }
    else {
        return newStr;
    }
}

/* END TYPES */
var templateLitReg = /`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g;
var singleQuoteReg = /'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g;
var doubleQuoteReg = /"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;
/** Escape special regular expression characters inside a string */
function escapeRegExp(string) {
    // From MDN
    return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
}
function parse(str, config) {
    var buffer = [];
    var trimLeftOfNextStr = false;
    var lastIndex = 0;
    var parseOptions = config.parse;
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processTemplate) {
                str = plugin.processTemplate(str, config);
            }
        }
    }
    /* Adding for EJS compatibility */
    if (config.rmWhitespace) {
        // Code taken directly from EJS
        // Have to use two separate replaces here as `^` and `$` operators don't
        // work well with `\r` and empty lines don't work well with the `m` flag.
        // Essentially, this replaces the whitespace at the beginning and end of
        // each line and removes multiple newlines.
        str = str.replace(/[\r\n]+/g, '\n').replace(/^\s+|\s+$/gm, '');
    }
    /* End rmWhitespace option */
    templateLitReg.lastIndex = 0;
    singleQuoteReg.lastIndex = 0;
    doubleQuoteReg.lastIndex = 0;
    function pushString(strng, shouldTrimRightOfString) {
        if (strng) {
            // if string is truthy it must be of type 'string'
            strng = trimWS(strng, config, trimLeftOfNextStr, // this will only be false on the first str, the next ones will be null or undefined
            shouldTrimRightOfString);
            if (strng) {
                // replace \ with \\, ' with \'
                // we're going to convert all CRLF to LF so it doesn't take more than one replace
                strng = strng.replace(/\\|'/g, '\\$&').replace(/\r\n|\n|\r/g, '\\n');
                buffer.push(strng);
            }
        }
    }
    var prefixes = [parseOptions.exec, parseOptions.interpolate, parseOptions.raw].reduce(function (accumulator, prefix) {
        if (accumulator && prefix) {
            return accumulator + '|' + escapeRegExp(prefix);
        }
        else if (prefix) {
            // accumulator is falsy
            return escapeRegExp(prefix);
        }
        else {
            // prefix and accumulator are both falsy
            return accumulator;
        }
    }, '');
    var parseOpenReg = new RegExp('([^]*?)' + escapeRegExp(config.tags[0]) + '(-|_)?\\s*(' + prefixes + ')?\\s*', 'g');
    var parseCloseReg = new RegExp('\'|"|`|\\/\\*|(\\s*(-|_)?' + escapeRegExp(config.tags[1]) + ')', 'g');
    // TODO: benchmark having the \s* on either side vs using str.trim()
    var m;
    while ((m = parseOpenReg.exec(str))) {
        lastIndex = m[0].length + m.index;
        var precedingString = m[1];
        var wsLeft = m[2];
        var prefix = m[3] || ''; // by default either ~, =, or empty
        pushString(precedingString, wsLeft);
        parseCloseReg.lastIndex = lastIndex;
        var closeTag = void 0;
        var currentObj = false;
        while ((closeTag = parseCloseReg.exec(str))) {
            if (closeTag[1]) {
                var content = str.slice(lastIndex, closeTag.index);
                parseOpenReg.lastIndex = lastIndex = parseCloseReg.lastIndex;
                trimLeftOfNextStr = closeTag[2];
                var currentType = prefix === parseOptions.exec
                    ? 'e'
                    : prefix === parseOptions.raw
                        ? 'r'
                        : prefix === parseOptions.interpolate
                            ? 'i'
                            : '';
                currentObj = { t: currentType, val: content };
                break;
            }
            else {
                var char = closeTag[0];
                if (char === '/*') {
                    var commentCloseInd = str.indexOf('*/', parseCloseReg.lastIndex);
                    if (commentCloseInd === -1) {
                        ParseErr('unclosed comment', str, closeTag.index);
                    }
                    parseCloseReg.lastIndex = commentCloseInd;
                }
                else if (char === "'") {
                    singleQuoteReg.lastIndex = closeTag.index;
                    var singleQuoteMatch = singleQuoteReg.exec(str);
                    if (singleQuoteMatch) {
                        parseCloseReg.lastIndex = singleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '"') {
                    doubleQuoteReg.lastIndex = closeTag.index;
                    var doubleQuoteMatch = doubleQuoteReg.exec(str);
                    if (doubleQuoteMatch) {
                        parseCloseReg.lastIndex = doubleQuoteReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
                else if (char === '`') {
                    templateLitReg.lastIndex = closeTag.index;
                    var templateLitMatch = templateLitReg.exec(str);
                    if (templateLitMatch) {
                        parseCloseReg.lastIndex = templateLitReg.lastIndex;
                    }
                    else {
                        ParseErr('unclosed string', str, closeTag.index);
                    }
                }
            }
        }
        if (currentObj) {
            buffer.push(currentObj);
        }
        else {
            ParseErr('unclosed tag', str, m.index + precedingString.length);
        }
    }
    pushString(str.slice(lastIndex, str.length), false);
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processAST) {
                buffer = plugin.processAST(buffer, config);
            }
        }
    }
    return buffer;
}

/* END TYPES */
/**
 * Compiles a template string to a function string. Most often users just use `compile()`, which calls `compileToString` and creates a new function using the result
 *
 * **Example**
 *
 * ```js
 * compileToString("Hi <%= it.user %>", eta.config)
 * // "var tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR"
 * ```
 */
function compileToString(str, config) {
    var buffer = parse(str, config);
    var res = "var tR='',__l,__lP" +
        (config.include ? ',include=E.include.bind(E)' : '') +
        (config.includeFile ? ',includeFile=E.includeFile.bind(E)' : '') +
        '\nfunction layout(p,d){__l=p;__lP=d}\n' +
        (config.useWith ? 'with(' + config.varName + '||{}){' : '') +
        compileScope(buffer, config) +
        (config.includeFile
            ? 'if(__l)tR=' +
                (config.async ? 'await ' : '') +
                ("includeFile(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
            : config.include
                ? 'if(__l)tR=' +
                    (config.async ? 'await ' : '') +
                    ("include(__l,Object.assign(" + config.varName + ",{body:tR},__lP))\n")
                : '') +
        'if(cb){cb(null,tR)} return tR' +
        (config.useWith ? '}' : '');
    if (config.plugins) {
        for (var i = 0; i < config.plugins.length; i++) {
            var plugin = config.plugins[i];
            if (plugin.processFnString) {
                res = plugin.processFnString(res, config);
            }
        }
    }
    return res;
}
/**
 * Loops through the AST generated by `parse` and transform each item into JS calls
 *
 * **Example**
 *
 * ```js
 * // AST version of 'Hi <%= it.user %>'
 * let templateAST = ['Hi ', { val: 'it.user', t: 'i' }]
 * compileScope(templateAST, eta.config)
 * // "tR+='Hi ';tR+=E.e(it.user);"
 * ```
 */
function compileScope(buff, config) {
    var i = 0;
    var buffLength = buff.length;
    var returnStr = '';
    for (i; i < buffLength; i++) {
        var currentBlock = buff[i];
        if (typeof currentBlock === 'string') {
            var str = currentBlock;
            // we know string exists
            returnStr += "tR+='" + str + "'\n";
        }
        else {
            var type = currentBlock.t; // ~, s, !, ?, r
            var content = currentBlock.val || '';
            if (type === 'r') {
                // raw
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
            }
            else if (type === 'i') {
                // interpolate
                if (config.filter) {
                    content = 'E.filter(' + content + ')';
                }
                if (config.autoEscape) {
                    content = 'E.e(' + content + ')';
                }
                returnStr += 'tR+=' + content + '\n';
                // reference
            }
            else if (type === 'e') {
                // execute
                returnStr += content + '\n'; // you need a \n in case you have <% } %>
            }
        }
    }
    return returnStr;
}

/**
 * Handles storage and accessing of values
 *
 * In this case, we use it to store compiled template functions
 * Indexed by their `name` or `filename`
 */
var Cacher$1 = /** @class */ (function () {
    function Cacher(cache) {
        this.cache = cache;
    }
    Cacher.prototype.define = function (key, val) {
        this.cache[key] = val;
    };
    Cacher.prototype.get = function (key) {
        // string | array.
        // TODO: allow array of keys to look down
        // TODO: create plugin to allow referencing helpers, filters with dot notation
        return this.cache[key];
    };
    Cacher.prototype.remove = function (key) {
        delete this.cache[key];
    };
    Cacher.prototype.reset = function () {
        this.cache = {};
    };
    Cacher.prototype.load = function (cacheObj) {
        copyProps$1(this.cache, cacheObj);
    };
    return Cacher;
}());

/* END TYPES */
/**
 * Eta's template storage
 *
 * Stores partials and cached templates
 */
var templates = new Cacher$1({});

/* END TYPES */
/**
 * Include a template based on its name (or filepath, if it's already been cached).
 *
 * Called like `include(templateNameOrPath, data)`
 */
function includeHelper(templateNameOrPath, data) {
    var template = this.templates.get(templateNameOrPath);
    if (!template) {
        throw EtaErr('Could not fetch template "' + templateNameOrPath + '"');
    }
    return template(data, this);
}
/** Eta's base (global) configuration */
var config = {
    async: false,
    autoEscape: true,
    autoTrim: [false, 'nl'],
    cache: false,
    e: XMLEscape,
    include: includeHelper,
    parse: {
        exec: '',
        interpolate: '=',
        raw: '~'
    },
    plugins: [],
    rmWhitespace: false,
    tags: ['<%', '%>'],
    templates: templates,
    useWith: false,
    varName: 'it'
};
/**
 * Takes one or two partial (not necessarily complete) configuration objects, merges them 1 layer deep into eta.config, and returns the result
 *
 * @param override Partial configuration object
 * @param baseConfig Partial configuration object to merge before `override`
 *
 * **Example**
 *
 * ```js
 * let customConfig = getConfig({tags: ['!#', '#!']})
 * ```
 */
function getConfig(override, baseConfig) {
    // TODO: run more tests on this
    var res = {}; // Linked
    copyProps$1(res, config); // Creates deep clone of eta.config, 1 layer deep
    if (baseConfig) {
        copyProps$1(res, baseConfig);
    }
    if (override) {
        copyProps$1(res, override);
    }
    return res;
}

/* END TYPES */
/**
 * Takes a template string and returns a template function that can be called with (data, config, [cb])
 *
 * @param str - The template string
 * @param config - A custom configuration object (optional)
 *
 * **Example**
 *
 * ```js
 * let compiledFn = eta.compile("Hi <%= it.user %>")
 * // function anonymous()
 * let compiledFnStr = compiledFn.toString()
 * // "function anonymous(it,E,cb\n) {\nvar tR='',include=E.include.bind(E),includeFile=E.includeFile.bind(E);tR+='Hi ';tR+=E.e(it.user);if(cb){cb(null,tR)} return tR\n}"
 * ```
 */
function compile(str, config) {
    var options = getConfig(config || {});
    /* ASYNC HANDLING */
    // The below code is modified from mde/ejs. All credit should go to them.
    var ctor = options.async ? getAsyncFunctionConstructor() : Function;
    /* END ASYNC HANDLING */
    try {
        return new ctor(options.varName, 'E', // EtaConfig
        'cb', // optional callback
        compileToString(str, options)); // eslint-disable-line no-new-func
    }
    catch (e) {
        if (e instanceof SyntaxError) {
            throw EtaErr('Bad template syntax\n\n' +
                e.message +
                '\n' +
                Array(e.message.length + 1).join('=') +
                '\n' +
                compileToString(str, options) +
                '\n' // This will put an extra newline before the callstack for extra readability
            );
        }
        else {
            throw e;
        }
    }
}

var _BOM = /^\uFEFF/;
/* END TYPES */
/**
 * Get the path to the included file from the parent file path and the
 * specified path.
 *
 * If `name` does not have an extension, it will default to `.eta`
 *
 * @param name specified path
 * @param parentfile parent file path
 * @param isDirectory whether parentfile is a directory
 * @return absolute path to template
 */
function getWholeFilePath(name, parentfile, isDirectory) {
    var includePath = path.resolve(isDirectory ? parentfile : path.dirname(parentfile), // returns directory the parent file is in
    name // file
    ) + (path.extname(name) ? '' : '.eta');
    return includePath;
}
/**
 * Get the absolute path to an included template
 *
 * If this is called with an absolute path (for example, starting with '/' or 'C:\')
 * then Eta will attempt to resolve the absolute path within options.views. If it cannot,
 * Eta will fallback to options.root or '/'
 *
 * If this is called with a relative path, Eta will:
 * - Look relative to the current template (if the current template has the `filename` property)
 * - Look inside each directory in options.views
 *
 * Note: if Eta is unable to find a template using path and options, it will throw an error.
 *
 * @param path    specified path
 * @param options compilation options
 * @return absolute path to template
 */
function getPath(path, options) {
    var includePath = false;
    var views = options.views;
    var searchedPaths = [];
    // If these four values are the same,
    // getPath() will return the same result every time.
    // We can cache the result to avoid expensive
    // file operations.
    var pathOptions = JSON.stringify({
        filename: options.filename,
        path: path,
        root: options.root,
        views: options.views
    });
    if (options.cache && options.filepathCache && options.filepathCache[pathOptions]) {
        // Use the cached filepath
        return options.filepathCache[pathOptions];
    }
    /** Add a filepath to the list of paths we've checked for a template */
    function addPathToSearched(pathSearched) {
        if (!searchedPaths.includes(pathSearched)) {
            searchedPaths.push(pathSearched);
        }
    }
    /**
     * Take a filepath (like 'partials/mypartial.eta'). Attempt to find the template file inside `views`;
     * return the resulting template file path, or `false` to indicate that the template was not found.
     *
     * @param views the filepath that holds templates, or an array of filepaths that hold templates
     * @param path the path to the template
     */
    function searchViews(views, path) {
        var filePath;
        // If views is an array, then loop through each directory
        // And attempt to find the template
        if (Array.isArray(views) &&
            views.some(function (v) {
                filePath = getWholeFilePath(path, v, true);
                addPathToSearched(filePath);
                return fs.existsSync(filePath);
            })) {
            // If the above returned true, we know that the filePath was just set to a path
            // That exists (Array.some() returns as soon as it finds a valid element)
            return filePath;
        }
        else if (typeof views === 'string') {
            // Search for the file if views is a single directory
            filePath = getWholeFilePath(path, views, true);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                return filePath;
            }
        }
        // Unable to find a file
        return false;
    }
    // Path starts with '/', 'C:\', etc.
    var match = /^[A-Za-z]+:\\|^\//.exec(path);
    // Absolute path, like /partials/partial.eta
    if (match && match.length) {
        // We have to trim the beginning '/' off the path, or else
        // path.resolve(dir, path) will always resolve to just path
        var formattedPath = path.replace(/^\/*/, '');
        // First, try to resolve the path within options.views
        includePath = searchViews(views, formattedPath);
        if (!includePath) {
            // If that fails, searchViews will return false. Try to find the path
            // inside options.root (by default '/', the base of the filesystem)
            var pathFromRoot = getWholeFilePath(formattedPath, options.root || '/', true);
            addPathToSearched(pathFromRoot);
            includePath = pathFromRoot;
        }
    }
    else {
        // Relative paths
        // Look relative to a passed filename first
        if (options.filename) {
            var filePath = getWholeFilePath(path, options.filename);
            addPathToSearched(filePath);
            if (fs.existsSync(filePath)) {
                includePath = filePath;
            }
        }
        // Then look for the template in options.views
        if (!includePath) {
            includePath = searchViews(views, path);
        }
        if (!includePath) {
            throw EtaErr('Could not find the template "' + path + '". Paths tried: ' + searchedPaths);
        }
    }
    // If caching and filepathCache are enabled,
    // cache the input & output of this function.
    if (options.cache && options.filepathCache) {
        options.filepathCache[pathOptions] = includePath;
    }
    return includePath;
}
/**
 * Reads a file synchronously
 */
function readFile(filePath) {
    try {
        return fs.readFileSync(filePath).toString().replace(_BOM, ''); // TODO: is replacing BOM's necessary?
    }
    catch (_a) {
        throw EtaErr("Failed to read template at '" + filePath + "'");
    }
}

// express is set like: app.engine('html', require('eta').renderFile)
/* END TYPES */
/**
 * Reads a template, compiles it into a function, caches it if caching isn't disabled, returns the function
 *
 * @param filePath Absolute path to template file
 * @param options Eta configuration overrides
 * @param noCache Optionally, make Eta not cache the template
 */
function loadFile(filePath, options, noCache) {
    var config = getConfig(options);
    var template = readFile(filePath);
    try {
        var compiledTemplate = compile(template, config);
        if (!noCache) {
            config.templates.define(config.filename, compiledTemplate);
        }
        return compiledTemplate;
    }
    catch (e) {
        throw EtaErr('Loading file: ' + filePath + ' failed:\n\n' + e.message);
    }
}
/**
 * Get the template from a string or a file, either compiled on-the-fly or
 * read from cache (if enabled), and cache the template if needed.
 *
 * If `options.cache` is true, this function reads the file from
 * `options.filename` so it must be set prior to calling this function.
 *
 * @param options   compilation options
 * @return Eta template function
 */
function handleCache(options) {
    var filename = options.filename;
    if (options.cache) {
        var func = options.templates.get(filename);
        if (func) {
            return func;
        }
        return loadFile(filename, options);
    }
    // Caching is disabled, so pass noCache = true
    return loadFile(filename, options, true);
}
/**
 * Get the template function.
 *
 * If `options.cache` is `true`, then the template is cached.
 *
 * This returns a template function and the config object with which that template function should be called.
 *
 * @remarks
 *
 * It's important that this returns a config object with `filename` set.
 * Otherwise, the included file would not be able to use relative paths
 *
 * @param path path for the specified file (if relative, specify `views` on `options`)
 * @param options compilation options
 * @return [Eta template function, new config object]
 */
function includeFile(path, options) {
    // the below creates a new options object, using the parent filepath of the old options object and the path
    var newFileOptions = getConfig({ filename: getPath(path, options) }, options);
    // TODO: make sure properties are currectly copied over
    return [handleCache(newFileOptions), newFileOptions];
}

/* END TYPES */
/**
 * Called with `includeFile(path, data)`
 */
function includeFileHelper(path, data) {
    var templateAndConfig = includeFile(path, this);
    return templateAndConfig[0](data, templateAndConfig[1]);
}

/* END TYPES */
function handleCache$1(template, options) {
    if (options.cache && options.name && options.templates.get(options.name)) {
        return options.templates.get(options.name);
    }
    var templateFunc = typeof template === 'function' ? template : compile(template, options);
    // Note that we don't have to check if it already exists in the cache;
    // it would have returned earlier if it had
    if (options.cache && options.name) {
        options.templates.define(options.name, templateFunc);
    }
    return templateFunc;
}
/**
 * Render a template
 *
 * If `template` is a string, Eta will compile it to a function and then call it with the provided data.
 * If `template` is a template function, Eta will call it with the provided data.
 *
 * If `config.async` is `false`, Eta will return the rendered template.
 *
 * If `config.async` is `true` and there's a callback function, Eta will call the callback with `(err, renderedTemplate)`.
 * If `config.async` is `true` and there's not a callback function, Eta will return a Promise that resolves to the rendered template.
 *
 * If `config.cache` is `true` and `config` has a `name` or `filename` property, Eta will cache the template on the first render and use the cached template for all subsequent renders.
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function render(template, data, config, cb) {
    var options = getConfig(config || {});
    if (options.async) {
        if (cb) {
            // If user passes callback
            try {
                // Note: if there is an error while rendering the template,
                // It will bubble up and be caught here
                var templateFn = handleCache$1(template, options);
                templateFn(data, options, cb);
            }
            catch (err) {
                return cb(err);
            }
        }
        else {
            // No callback, try returning a promise
            if (typeof promiseImpl$1 === 'function') {
                return new promiseImpl$1(function (resolve, reject) {
                    try {
                        resolve(handleCache$1(template, options)(data, options));
                    }
                    catch (err) {
                        reject(err);
                    }
                });
            }
            else {
                throw EtaErr("Please provide a callback function, this env doesn't support Promises");
            }
        }
    }
    else {
        return handleCache$1(template, options)(data, options);
    }
}
/**
 * Render a template asynchronously
 *
 * If `template` is a string, Eta will compile it to a function and call it with the provided data.
 * If `template` is a function, Eta will call it with the provided data.
 *
 * If there is a callback function, Eta will call it with `(err, renderedTemplate)`.
 * If there is not a callback function, Eta will return a Promise that resolves to the rendered template
 *
 * @param template Template string or template function
 * @param data Data to render the template with
 * @param config Optional config options
 * @param cb Callback function
 */
function renderAsync(template, data, config, cb) {
    // Using Object.assign to lower bundle size, using spread operator makes it larger because of typescript injected polyfills
    return render(template, data, Object.assign({}, config, { async: true }), cb);
}

// @denoify-ignore
config.includeFile = includeFileHelper;
config.filepathCache = {};

const VAR_NAME = 'sk';
const EBAR = `\n---------------------------\n`;

class confirmationModal extends obsidian.Modal {
    constructor(app, fieldsIn) {
        super(app);
        this.fields = {
            title: "Please Confirm",
            labelPos: "Confirm",
            labelNeg: "Cancel",
        };
        Object.assign(this.fields, fieldsIn || {});
    }
    onOpen() {
        this.titleEl.setText(this.fields.title);
        this.containerEl.addClazz(kls('confirmation-modal'), this.fields.class);
        if (this.fields.desc)
            this.contentEl.createDiv({ cls: kls('confirmation-modal-description'), text: this.fields.desc });
        this.contentEl.append(...this.fields.elements);
        let c = this.contentEl.createDiv({ cls: kls('confirm-modal-buttons') });
        c.createEl("button", { text: this.fields.labelPos, cls: kls('modal-button-confirm') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("true");
                this.close();
            });
        });
        c.createEl("button", { text: this.fields.labelNeg, cls: kls('modal-button-cancel') }, (b) => {
            b.onClickEvent(() => {
                this.resolve("false");
                this.close();
            });
        });
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}

Element.prototype.addClazz = function (str) {
    if (Array.isArray(str)) {
        this.addClass(...str);
    }
    else
        this.addClass(str);
};
function getFiles(app, dir) {
    let dirPath = obsidian.normalizePath(dir);
    let fo = app.vault.getAbstractFileByPath(dirPath);
    // console.log(dirPath), console.log(fo);
    if (!fo || !(fo instanceof obsidian.TFolder))
        throw `Skribi: Could not find folder '${dirPath}'`;
    let files = [];
    obsidian.Vault.recurseChildren(fo, (fi) => {
        if (fi instanceof obsidian.TFile)
            files.push(fi);
    });
    return files;
}
function checkFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).every((f) => { return exts.contains(f.extension); });
}
function filterFileExt(files, exts) {
    exts = toArray(exts);
    return toArray(files).filter((f) => { if (checkFileExt(f, exts))
        return f; });
}
function toArray(args) {
    return (Array.isArray(args) ? args : [args]);
}
function isInFolder(e, dir) {
    let boo = (obsidian.normalizePath((/.+\//g).exec(e.path)[0]) == obsidian.normalizePath(dir));
    return boo;
}
function isExtant(obj) {
    return !((obj === null) || (obj === undefined));
}
function roundTo(x, to) {
    return parseFloat(parseFloat(x).toPrecision(to !== null && to !== void 0 ? to : 4));
}
function getVerbosity() {
    var _a;
    //@ts-ignore
    return ((_a = window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings.verboseLogging) || false;
}
function vLog(...args) {
    if (getVerbosity()) {
        console.log("Skribi:", ...args);
    }
}
function dLog(...args) {
    var _a, _b;
    //@ts-ignore
    if (((_b = (_a = window === null || window === void 0 ? void 0 : window.app.plugins.plugins["obsidian-skribi"]) === null || _a === void 0 ? void 0 : _a.settings) === null || _b === void 0 ? void 0 : _b.devLogging) || false) {
        console.log(...args);
    }
}
/* Takes an array of strings and returns a record of key/value pairs for each, where the key and value are the same */
function toDupeRecord(arr) {
    return arr.reduce((a, i) => (Object.assign(Object.assign({}, a), { [i]: i })), {});
}
/**
 * @param input An object to clone
 * @param keys The keys of properties to omit from the clone
 * @returns A clone of 'input' without the omitted properties */
function withoutKey(input, key) {
    const clone = Object.assign({}, input);
    if (Array.isArray(key)) {
        key.forEach((k) => {
            delete clone[k];
        });
    }
    else {
        delete clone[key];
    }
    return clone;
}
Object.getPrototypeOf(function () {
    return __awaiter(this, void 0, void 0, function* () { });
}).constructor;
const promiseImpl = new Function('return this')().Promise;
const getAsyncConstructor = () => new Function('return (async function(){}).constructor')();
const isFunc = (func) => (func instanceof Function);
const isFile = (item) => (item) instanceof obsidian.TFile;
function average(...numbers) {
    return numbers.reduce((val, cur) => val + cur) / numbers.length;
}
/* Get link to documentation page. */
function linkToDocumentation(page) {
    // return `https://azulaloi.net/obsidian-skribi/${page}`
    return `https://azulaloi.github.io/obsidian-skribi/${page}`;
}
/* Prefixes string with plugin name. Makes reusing code across plugins easier. */
function kls(cls) { return `skribi-${cls}`; }
function makeExternalLink(linkIn) {
    const link = String.isString(linkIn) ? createEl('a', { attr: { href: linkIn } }) : linkIn;
    link.addEventListener('click', (ev) => {
        ev.preventDefault();
        let p = new confirmationModal(window.app, {
            title: `Open External Link?`,
            desc: `Will open the following address with default program:`,
            labelPos: `Open Link`,
            elements: [createDiv({ cls: kls('confirmation-modal-link'), text: link.getAttr('href') })]
        });
        new Promise((resolve, reject) => p.openAndGetValue(resolve, reject))
            .then(res => {
            if (res === "true") {
                window.open(link.getAttr('href'));
            }
        });
    });
    return link;
}

/** Adds the entries of scope to a function string.
* @param functionString A string function compiled by Eta's compileToString()
* @param keys Array of keys that the returned function will expect to be present in its scope argument
* @param async If true, returned function will be asynchronous */
function compileWith(functionString, keys, async) {
    var a = "";
    for (let k of keys) {
        a += `${k},`;
    }
    let func = `var {${a.substr(0, a.length - 1)}} = scope;\n` + functionString;
    let constructor = (async) ? getAsyncConstructor() : Function;
    let compiled = new constructor('scope', func);
    return compiled;
}
/* Version of Eta's render function, modified to handle scoped templates */
function renderEta(handler, template, data, config, cb, scope, binder) {
    const options = getConfig(config || {});
    if (options.async) {
        // if (cb) {
        // try { 
        // const templateFn = handler.getCached(template, options, scope, binder)
        // templateFn(scope)
        // } catch(e) {
        // return cb(e)
        // }
        // } else {
        // return (async () => handler.getCached(template, options, scope, binder)(scope))()
        return new promiseImpl(function (resolve, reject) {
            try {
                resolve(handler.getCached(template, options, scope, binder)(scope));
            }
            catch (e) {
                reject(e);
            }
        });
        // }
    }
    else {
        let func = handler.getCached(template, options, scope, binder);
        dLog(`Rendering function`, func);
        return func(scope);
    }
}
/* Version of Eta's async render function, just sets async to true */
/* Note: perf impact of using async templatefunctions is negligible */
function renderEtaAsync(handler, template, data, config, cb, scope, binder) {
    return renderEta(handler, template, data, Object.assign({}, config, { async: true }), cb, scope, binder);
}

class Provider {
    constructor(bus, id) {
        this.functions = new Map();
        this.initLoaded = false;
        this.isDirty = false;
        this.bus = bus;
        this.id = id;
    }
    createObject() {
        return Object.assign({}, Object.fromEntries(this.functions));
    }
    init() {
        this.initLoaded = true;
        return Promise.resolve();
    }
    unload() { }
    reload() {
        return Promise.resolve();
    }
    /**
     * @param clean If true, provider.isDirty = false */
    setDirty(dirty) {
        this.isDirty = isExtant(dirty) ? dirty : true;
        this.bus.providerNotificationDirty(this, this.isDirty);
    }
}
class ProviderPredicated extends Provider {
    constructor() {
        super(...arguments);
        this.predicatePluginName = '';
    }
    getPredicate() {
        var _a;
        return ((_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a[this.predicatePluginName]) || null;
    }
    /**
     * @returns true only when the predicate condition is met */
    predicateCheck() {
        return this.bus.plugin.app.plugins.enabledPlugins.has(this.predicatePluginName);
    }
    /**
     * @returns An error string describing the unmet predicate condition */
    predicateError() {
        return `Integration Module '${this.id}' not available, could not find required plugin: '${this.predicatePluginName}'`;
    }
}

class ProviderSK extends Provider {
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return _super.init.call(this);
        });
    }
    createObject() {
        return {
            render: function (str) {
                let e = createDiv({ cls: "skribi-render-virtual" });
                console.log(this);
                obsidian.MarkdownRenderer.renderMarkdown(str, e, this.this.file.path, null);
                return e.innerHTML;
            },
            has: function (v) {
                var _a, _b;
                return !((((_a = this.v) === null || _a === void 0 ? void 0 : _a[v]) == null) || (((_b = this.v) === null || _b === void 0 ? void 0 : _b[v]) == undefined));
            },
            abort: function (s) {
                let abortPacket = String.isString(s)
                    ? { hasData: true, flag: 'abort', hover: s }
                    : Object.assign({ hasData: true, flag: 'abort' }, s);
                throw abortPacket;
            },
        };
    }
}

class ProviderDataview extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'dataview';
        // createDynamic(state: DynamicState) {
        // let api = new DataviewInlineApi(this.dvp.index, state.child, state.el, this.bus.plugin.app, this.dvp.settings, state.file.path)
        // return this?.dvp?.api || null
        // }
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            // this.dvp = this.bus.plugin.app.plugins.plugins.dataview as DataviewPlugin || null
            this.eventRef_API_READY = this.bus.plugin.app.metadataCache.on('dataview:api-ready', (api) => { this.apiReady(); });
            return _super.init.call(this);
        });
    }
    unload() {
        this.bus.plugin.app.metadataCache.offref(this.eventRef_API_READY);
    }
    createObject() {
        var _a, _b;
        return ((_b = (_a = this.bus.plugin.app.plugins.plugins) === null || _a === void 0 ? void 0 : _a.dataview) === null || _b === void 0 ? void 0 : _b.api) || null;
    }
    apiReady() {
    }
}

class ProviderWeather extends ProviderPredicated {
    constructor() {
        super(...arguments);
        this.predicatePluginName = 'obsidian-weather';
    }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.eventRefs = {
                ready: this.bus.plugin.app.workspace.on("az-weather:api-ready", () => { }),
                unload: this.bus.plugin.app.workspace.on("az-weather:api-unload", () => { }),
                tick: this.bus.plugin.app.workspace.on("az-weather:api-tick", () => { })
            };
            this.functions.set("check", this.provide_predicate());
            this.functions.set("cache", this.provide_dispenseCache());
            this.functions.set("tickEventRef", this.provide_tickEventRef());
            return _super.init.call(this);
        });
    }
    unload() {
        for (let r of Object.values(this.eventRefs)) {
            this.bus.plugin.app.workspace.offref(r);
        }
    }
    /* Provisions */
    provide_predicate() {
        return () => {
            return (!!this.weatherAPI);
        };
    }
    provide_dispenseCache() {
        return () => {
            var _a;
            let p = this.getPredicate();
            return (_a = p === null || p === void 0 ? void 0 : p.API) === null || _a === void 0 ? void 0 : _a.dispenseCache.bind(p.API)();
        };
    }
    provide_tickEventRef() {
        return (cb) => {
            return this.bus.plugin.app.workspace.on("az-weather:api-tick", (...a) => cb(...a));
        };
    }
}

class ProviderScriptloader extends Provider {
    constructor() {
        super(...arguments);
        this.loadedModules = new Map();
    }
    get directory() { return this.bus.plugin.settings.scriptFolder; }
    init() {
        const _super = Object.create(null, {
            init: { get: () => super.init }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad().then(() => _super.init.call(this));
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.loadAndSet(...getFiles(this.bus.plugin.app, this.bus.plugin.settings.scriptFolder));
        });
    }
    loadAndSet(...file) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.readFiles(...file)
                .then((ret) => { /*vLog('Loading JS modules...', ret);*/ this.stashModule(ret); return Promise.resolve(); });
        });
    }
    stashModule(modules) {
        dLog('Scriptloader: stashModule', modules);
        modules.map((r) => {
            var _a, _b;
            if (r) {
                this.loadedModules.delete(r[0]);
                this.loadedModules.set(r[0], {
                    name: (String.isString((_b = (_a = r[1]) === null || _a === void 0 ? void 0 : _a._name) !== null && _b !== void 0 ? _b : null) ? r[1]._name : null),
                    properties: withoutKey(r[1], '_name')
                });
            }
        });
    }
    createObject() {
        let exports = new Map();
        this.loadedModules.forEach((value, key) => {
            var _a;
            let single = (Object.keys(value.properties).length == 1);
            exports.set(((_a = value.name) !== null && _a !== void 0 ? _a : (single ? Object.keys(value.properties)[0] : key)), single ? Object.values(value.properties)[0] : value.properties);
        });
        return Object.assign({}, Object.fromEntries(exports));
    }
    readFiles(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            let filtered = filterFileExt(files, "js");
            const reads = filtered.map((f) => __awaiter(this, void 0, void 0, function* () {
                try {
                    if (!(this.bus.plugin.app.vault.adapter instanceof obsidian.FileSystemAdapter))
                        return Promise.reject();
                    let path = this.bus.plugin.app.vault.adapter.getBasePath() + "/" + f.path;
                    let resPath = window.require.resolve(path);
                    if (Object.keys(window.require.cache).contains(resPath))
                        delete window.require.cache[window.require.resolve(resPath)];
                    const mod = require(path);
                    return (isExtant(mod))
                        ? Promise.resolve([f.basename, mod])
                        : Promise.reject();
                }
                catch (e) {
                    console.warn(e);
                    return Promise.reject();
                }
            }));
            return yield Promise.allSettled(reads)
                .then((settled) => {
                return settled
                    .filter((r) => { return r.status == "fulfilled"; })
                    .map((v) => { return v.value; });
            });
        });
    }
    clearJS(...items) {
        let names = items.map((item) => {
            if (isFile(item))
                return filterFileExt(item, 'js')[0].basename;
            else if (String.isString(item))
                return item;
        });
        for (let name of names)
            this.loadedModules.delete(name);
    }
    reload() {
        const _super = Object.create(null, {
            reload: { get: () => super.reload }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.loadedModules.clear();
            yield this.initLoad();
            return _super.reload.call(this);
        });
    }
    // Event listeners for file events registered by EtaHander
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in script directory modified, updating...`);
        this.clearJS(file);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileDeleted(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' removed from script directory, unloading...`);
        this.clearJS(file);
        this.setDirty();
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to script directory, loading...`);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => this.clearJS(file));
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Script file '${oldName}' renamed to '${file.name}', updating...`);
        this.clearJS(oldName);
        this.loadAndSet(file)
            .then(() => { this.setDirty(); }, () => { });
    }
    directoryChanged() {
        vLog(`Script directory changed, reloading scripts...`);
        this.reload().then(() => this.setDirty(), (e) => { console.warn(e); });
    }
}

const obsidianModule = require("obsidian");
const MODULE_NAME_INTEGRATIONS = 'int';
/* Handles all script function providers */
class ProviderBus {
    constructor(handler) {
        this.providers = new Map();
        this.providersPredicated = new Map();
        this.scopeStatic = {};
        // Indicates that a provider has been added or removed, and the static scope should be regenerated.
        this.isStaticScopeDirty = false;
        /**
         * Integration point for other plugins to add a provider
         * @param provider Provider implementation to add */
        this.addProvider = (provider) => {
            this.providers.set(provider.id, provider);
            this.isStaticScopeDirty = true;
            this.handler.recompileTemplates();
        };
        /**
         * Integration point for other plugins to add a predicated provider
         * @param provider ProviderPredicated implementation to add */
        this.addProviderPredicated = (provider) => {
            this.providersPredicated.set(provider.id, provider);
        };
        this.handler = handler;
        this.plugin = handler.plugin;
        this.scriptLoader = new ProviderScriptloader(this, 'js'); // assigned here so that we can register file events in handler
    }
    /* Construct all providers but do not initialize them yet, so that we can compile and cache templates ASAP */
    preInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addTo(this.providers, this.scriptLoader);
            this.addTo(this.providersPredicated, new ProviderDataview(this, 'dv'));
            this.addTo(this.providersPredicated, new ProviderWeather(this, 'weather'));
            this.skBase = new ProviderSK(this, VAR_NAME);
            return Promise.resolve();
        });
    }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            const inits = Object.values(this.execOnProviders('init'));
            yield Promise.allSettled(inits);
            this.createStaticScope();
            return Promise.resolve();
        });
    }
    addTo(providers, provider) {
        providers.set(provider.id, provider);
    }
    unload() {
        this.execOnProviders('unload');
    }
    /* Invoked by providers to indicate their provision must be regenerated */
    providerNotificationDirty(provider, isDirty) {
        if (isDirty)
            this.refreshProvider(provider);
    }
    /* Clean dirty providers by regenerating their provision */
    refreshProvider(...providers) {
        let proxy = {};
        for (let provider of providers) {
            proxy[provider.id] = provider.createObject();
            provider.setDirty(false);
        }
        Object.assign(this.scopeStatic, proxy);
    }
    /* Reloads all providers */
    reloadProviders() {
        return __awaiter(this, void 0, void 0, function* () {
            let proms = this.execOnProviders('reload');
            return Promise.allSettled(Object.values(proms));
        });
    }
    getScopeKeys() {
        return [...this.providers.keys(), MODULE_NAME_INTEGRATIONS, 'moment', 'obsidian'];
    }
    /* Retrieves providers object */
    getScope(ctx, refresh) {
        let dirties = Object.values(this.providers).filter((p) => { return p.isDirty; });
        if (dirties)
            this.refreshProvider(...dirties);
        if (this.isStaticScopeDirty)
            this.createStaticScope();
        return Object.assign({}, this.scopeStatic, { [MODULE_NAME_INTEGRATIONS]: this.createPredicatedScope(ctx || null) });
    }
    /* Creates scope object. Should not be used to get the scope. */
    createStaticScope() {
        let spaces = {};
        for (let p of this.providers)
            spaces[p[0]] = p[1].createObject();
        spaces['moment'] = window.moment;
        spaces['obsidian'] = obsidianModule;
        this.scopeStatic = spaces;
        this.isStaticScopeDirty = false;
        return this.scopeStatic;
    }
    /* Predicated providers */
    createPredicatedScope(ctx) {
        let spaces = {};
        for (let p of this.providersPredicated) {
            Object.defineProperty(spaces, p[0], { get: function () {
                    if (p[1].predicateCheck())
                        return p[1].createObject();
                    else
                        throw new Error(p[1].predicateError());
                }
            });
        }
        return spaces;
    }
    /* Get the base provider scope */
    getScopeSK() {
        return this.skBase.createObject();
    }
    /* Invoke function on all providers and return array of results */
    execOnProviders(func) {
        let rets = {};
        const invoke = (providers) => {
            for (let p of providers)
                if ((p != null) && (isFunc(p[1][func]))) {
                    rets[p[0]] = p[1][func]();
                }
        };
        invoke(this.providers);
        invoke(this.providersPredicated);
        return rets;
    }
}

class Cacher {
    constructor(cache) {
        this.cache = cache;
    }
    define(key, val) { this.cache[key] = val; }
    get(key) { return this.cache[key]; }
    remove(key) { delete this.cache[key]; }
    reset() { this.cache = {}; }
    load(cacheObj) { copyProps(this.cache, cacheObj); }
}
function copyProps(toObj, fromObj) {
    for (const key in fromObj) {
        if (hasOwnProp(fromObj, key)) {
            toObj[key] = fromObj[key];
        }
    }
    return toObj;
}
function hasOwnProp(obj, prop) {
    return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* Responsible for the caching and management of templates. */
class TemplateLoader {
    constructor(handler) {
        this.templateCache = new Cacher({});
        this.templateFailures = new Map();
        this.templateFrontmatters = new Map();
        this.handler = handler;
        this.plugin = handler.plugin;
    }
    get directory() { return this.plugin.settings.templateFolder; }
    init() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.initLoad();
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.definePartials(...getFiles(this.plugin.app, this.directory));
            this.plugin.loadEvents.trigger('init-load-complete'); //TODO: use native events?
            return Promise.resolve();
        });
    }
    /* Load and compile files into the template cache */
    definePartials(...files) {
        return __awaiter(this, void 0, void 0, function* () {
            const startTime = window.performance.now();
            var failureCount = 0;
            var successCount = 0;
            const scopeKeys = this.handler.bus.getScopeKeys();
            const readPromises = files.map((file) => __awaiter(this, void 0, void 0, function* () {
                var _a, _b, _c;
                if (!checkFileExt(file, ["md", "eta", "txt"]))
                    return Promise.reject();
                let read = yield this.plugin.app.vault.cachedRead(file);
                let fileFrontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) === null || _a === void 0 ? void 0 : _a.frontmatter;
                if (fileFrontmatter) {
                    let fmSearch = (/(?<frontmatter>^---.*?(?=\n---)\n---)/s).exec(read);
                    let fmText = (_c = (_b = fmSearch === null || fmSearch === void 0 ? void 0 : fmSearch.groups) === null || _b === void 0 ? void 0 : _b.frontmatter) !== null && _c !== void 0 ? _c : null;
                    if (isExtant(fmText)) {
                        read = read.substr(fmText.length);
                    }
                }
                try {
                    let compiledString = compileToString(read, getConfig({ varName: VAR_NAME, name: file.basename }));
                    var compiled = compileWith(compiledString, [VAR_NAME, 'E', 'cb', ...scopeKeys]);
                }
                catch (err) {
                    this.templateFailures.set(file.basename, err || `Template failed to compile: Unknown Error`);
                    console.warn(`Skribi: template '${file.basename}' failed to compile`, EBAR, err, EBAR, read);
                    this.templateCache.remove(file.basename);
                    this.templateFrontmatters.delete(file.basename);
                    failureCount++;
                    return Promise.reject();
                }
                this.templateFailures.delete(file.basename);
                this.templateCache.define(file.basename, compiled);
                if (fileFrontmatter)
                    this.templateFrontmatters.set(file.basename, withoutKey(fileFrontmatter, 'position'));
                successCount++;
                return Promise.resolve();
            }));
            yield Promise.allSettled(readPromises);
            if ((!this.plugin.initLoaded) && files.length) {
                let str = `${successCount} template${(successCount == 1) ? '' : 's'}`;
                if (failureCount)
                    str += `\n Of ${files.length} total templates, ${failureCount} failed to compile.`;
                console.log(`Skribi: Loaded ` + str);
            }
            else if (this.plugin.initLoaded) {
                vLog(`Updated template '${files[0].basename}' in ${roundTo(window.performance.now() - startTime, 4)}ms`);
            }
            return Promise.resolve();
        });
    }
    /* Deletes cache entries by string name or file of origin */
    deletePartial(...items) {
        for (let item of items) {
            let name = isFile(item) ? item.basename : item;
            this.templateCache.remove(name);
        }
    }
    reload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.templateCache.reset();
            return this.definePartials(...getFiles(this.plugin.app, this.directory));
        });
    }
    /* These functions are registered to the appropriate events by handler */
    fileUpdated(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' in template directory modified, updating...`);
        this.definePartials(file);
    }
    fileDeleted(file) {
        let isf = isFile(file);
        if ((!isf && !(String.isString(file) && this.templateCache.get(file))))
            return;
        vLog(`File '${isf ? file.name : file}' removed from template directory, unloading...`);
        this.deletePartial(file);
    }
    fileAdded(file) {
        if (!isFile(file))
            return;
        vLog(`File '${file.name}' added to template directory, loading...`);
        this.definePartials(file);
    }
    fileRenamed(file, oldName) {
        if (!isFile(file))
            return;
        vLog(`Template file '${oldName}' renamed to '${file.name}', updating...`);
        this.deletePartial(oldName);
        this.definePartials(file);
    }
    directoryChanged() {
        vLog(`Template directory changed, reloading templates...`);
        this.reload();
    }
}

class EtaHandler {
    constructor(plugin) {
        this.templatesDirty = false;
        this.baseContext = {};
        this.isInTemplates = (e) => isInFolder(e, this.plugin.settings.templateFolder);
        this.isInScripts = (e) => isInFolder(e, this.plugin.settings.scriptFolder);
        this.plugin = plugin;
        this.bus = new ProviderBus(this);
        this.loader = new TemplateLoader(this);
        if (!this.plugin.app.workspace.layoutReady)
            this.plugin.app.workspace.onLayoutReady(() => this.init.bind(this)());
        else
            this.init();
    }
    get templates() { return this.loader.templateCache; }
    get failedTemplates() { return this.loader.templateFailures; }
    get templateFrontmatters() { return this.loader.templateFrontmatters; }
    init() {
        this.initLoad().then(() => {
            this.plugin.registerEvent(this.plugin.app.vault.on('modify', e => {
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileUpdated(e);
                if (this.isInTemplates(e))
                    this.loader.fileUpdated(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('delete', e => {
                // console.log(e)
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileDeleted(e);
                if (this.isInTemplates(e))
                    this.loader.fileDeleted(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('create', e => {
                if (this.isInScripts(e))
                    this.bus.scriptLoader.fileAdded(e);
                if (this.isInTemplates(e))
                    this.loader.fileAdded(e);
            }));
            this.plugin.registerEvent(this.plugin.app.vault.on('rename', (file, oldPath) => {
                for (let obj of [this.bus.scriptLoader, this.loader]) {
                    let ourDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath(obj.directory));
                    let oldDir = this.plugin.app.vault.getAbstractFileByPath(obsidian.normalizePath((/.+\//g).exec(oldPath)[0]));
                    // console.log(oldDir, ourDir)
                    if (file.parent == ourDir) {
                        // New location of file is in our directory
                        if (file.parent == oldDir) {
                            // File did not move but was renamed
                            obj.fileRenamed(file, (/([a-zA-Z0-9-_.]+\..*)/g).exec(oldPath)[0]);
                        }
                        else {
                            // File was moved from elsewhere into the template directory
                            obj.fileAdded(file);
                        }
                    }
                    else if (oldDir == ourDir) {
                        // File used to be in templates directory and is no longer
                        obj.fileDeleted(file);
                    }
                }
            }));
        }).catch((err) => {
            console.error(`Skribi: EtaHandler failed to initialize!`, EBAR, err);
        });
    }
    initLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            let { a: a, b: b } = yield this.bus.preInit().then(() => {
                return { a: this.bus.init(), b: this.loader.init() };
            });
            return Promise.all([a, b]);
        });
    }
    unload() {
        this.bus.unload();
    }
    recompileTemplates() {
        // If the bus scope changes, the templates must be recompiled. 
        // The bus scope should not change post-init unless an external source modifies the provider list.
        this.loader.reload();
    }
    getPartial(id) {
        return this.loader.templateCache.get(id);
    }
    hasPartial(id) {
        return isExtant(this.loader.templateCache.get(id));
    }
    getCacheKeys() {
        //@ts-ignore
        return Object.keys(this.templates.cache);
    }
    /**
    * Primary skribi render function. Renders asynchronously (TemplateFunction may or may not be async)
    * @param content String or scoped template function to render
    * @param ctxIn Context object to be added to `sk` object
    * @param file File in which the skribi is being rendered
    * @returns [rendered string, returned packet (currently unused)] */
    renderAsync(content, ctxIn, file) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!isFile(file))
                return Promise.reject(`Could not identify current file: ${file}`);
            let z = {};
            function p() {
                return function (x, y) {
                    z[x] = y;
                };
            }
            let cfg = getConfig({ varName: VAR_NAME });
            /* the 'this' object of the sk context*/
            let binder = {
                file: file,
                plugin: this.plugin,
                app: this.plugin.app
            };
            /* The 'sk' object */
            let sk = Object.assign({}, this.baseContext, ctxIn || {}, { up: p(), this: binder }, this.bus.getScopeSK());
            /* scope of the tfunc env */
            let scope = Object.assign({ 'sk': sk, 'E': cfg, 'cb': null }, this.bus.getScope());
            let ren = (content.toString().contains('await')) // This will catch strings containing await as well, maybe a flag should be used instead
                ? renderEtaAsync(this, content, {}, cfg, null, scope, binder)
                : renderEta(this, content, {}, cfg, null, scope, binder);
            // console.log("psuedo post:", sk)
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve([r, z]); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve([ren, z]);
            }
            else
                return Promise.reject("EtaHandler.renderAsync: Unknown Error");
        });
    }
    /* this is somehow 1.3x slower than renderAsync */
    renderAsyncNaive(content, ctxIn, varName) {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribos: renderAsyncNaive invoked', content, ctxIn);
            let context = Object.assign({}, this.baseContext, ctxIn || {});
            let ren = renderAsync(content, context, { varName: varName !== null && varName !== void 0 ? varName : VAR_NAME });
            if (ren instanceof Promise) {
                return yield ren.then((r) => { return Promise.resolve(r); }, (r) => { return Promise.reject(r); });
            }
            else if (String.isString(ren)) {
                return Promise.resolve(ren);
            }
            else
                return Promise.reject("Unknown error");
        });
    }
    render(content, ctxIn) {
        let context = ctxIn || {};
        content = render(content, context, {
            varName: VAR_NAME
        });
        return content;
    }
    /** TemplateFunction handler, will return cached or compiled function, appropriately bound and scoped
     * @param template String or scoped template function
     * @param options EtaConfig
     * @param scope Object containing objects that should be available in the returned function's scope
     * @param binder Object to which the returned function will be bound */
    getCached(template, options, scope, binder) {
        if (options.name && this.templates.get(options.name)) {
            return (binder) ? this.templates.get(options.name).bind(binder) : this.templates.get(options.name);
        }
        const templateFunc = typeof template === 'function' ? template : compileWith(compileToString(template, options), Object.keys(scope), options.async);
        if (options.name)
            this.templates.define(options.name, templateFunc);
        return (binder) ? templateFunc.bind(binder) : templateFunc;
    }
}

class SkribosSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.saveSetting = obsidian.debounce((setting, value, cb, ...args) => __awaiter(this, void 0, void 0, function* () {
            // console.log("saving: " + setting + " = " + value)
            this.plugin.settings[setting] = value;
            this.plugin.saveSettings().then(() => { if (isExtant(cb) && isFunc(cb))
                cb(...args || null); });
        }), 2000, true);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.addClass("skribi-settings");
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Skribi Settings' });
        new obsidian.Setting(containerEl)
            .setName('Template Directory')
            .setDesc('Skribi will look for templates in this folder.')
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.templateFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.templateFolder = value;
                yield this.plugin.saveSettings();
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName('Skript Directory')
            .setDesc('Skribi will look for JS files in this folder.')
            .addTextArea((text) => {
            text
                .setValue(this.plugin.settings.scriptFolder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.saveSetting('scriptFolder', value, () => this.plugin.eta.bus.scriptLoader.directoryChanged());
            }));
            text.inputEl.cols = 30;
            return text;
        });
        new obsidian.Setting(containerEl)
            .setName('Error Logging')
            .setDesc('Enable to dump any errored renders to the console.'
            + 'If false, will still add the error as tooltip on the errored element. \n'
            + 'Will spam your console if typing into a skribi with a preview window open.')
            .addToggle((toggle) => {
            toggle
                .setValue(this.plugin.settings.errorLogging)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.errorLogging = value;
                yield this.plugin.saveSettings();
            }));
        });
        new obsidian.Setting(containerEl)
            .setName('Verbose Logging')
            .setDesc('Enable to get more detailed logs in the console.')
            .addToggle((toggle) => {
            toggle
                .setValue(this.plugin.settings.verboseLogging)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.plugin.settings.verboseLogging = value;
                yield this.plugin.saveSettings();
            }));
        });
    }
}
const DEFAULT_SETTINGS = {
    templateFolder: "",
    scriptFolder: "",
    verboseLogging: false,
    devLogging: false,
    errorLogging: false,
};

function renderError(el, e) {
    return __awaiter(this, void 0, void 0, function* () {
        if ((e === null || e === void 0 ? void 0 : e.flag) && e.flag == "abort") {
            renderRegent(el, Object.assign({}, {
                class: 'abort',
                label: 'sk',
                hover: 'Render Aborted'
            }, e));
        }
        else {
            renderRegent(el, { class: 'error', label: 'sk', hover: (e === null || e === void 0 ? void 0 : e.msg) || "Unknown Error", clear: true });
        }
    });
}
function renderWait(el) {
    const pre = createEl("code", { cls: "skribi-wait", text: "sk" });
    el.replaceWith(pre);
    return pre;
}
function renderState(el, dataIn) {
    return __awaiter(this, void 0, void 0, function* () {
        let data = Object.assign({
            class: "state",
            label: "sk",
            clear: false,
            hover: ""
        }, dataIn || {});
        el.className = `skribi-regent ${data.class}`;
        el.setAttribute("title", data.hover);
    });
}
function createRegent(dataIn) {
    let data = Object.assign({
        class: "generic",
        label: "sk",
        clear: false,
        hover: ""
    }, dataIn || {});
    const pre = createEl("code", { cls: `skribi-regent ${data.class}`, text: data.label });
    pre.setAttribute("title", data.hover);
    return [pre, data];
}
function renderRegent(el, dataIn) {
    let [pre, data] = createRegent(dataIn);
    if (data.clear)
        el.className = "";
    el.replaceWith(pre);
    return pre;
}

const extImg = ["bmp", "png", "jpg", "jpeg", "gif", "svg"];
const extAud = ["mp3", "wav", "m4a", "3gp", "flac", "ogg", "oga"];
const extVid = ["mp4", "webm", "ogv"];
const extTxt = ["md"];
/* Repairs media embeds that have been rendered to markdown */
function embedMedia(el, srcPath, plugin, depth, self) {
    return __awaiter(this, void 0, void 0, function* () {
        dLog("embed self:", self);
        dLog("embed:", el);
        var proms = [];
        const catches = el.querySelectorAll("span.internal-embed");
        let elDepth = el.getAttribute("depth");
        let d = (isExtant(elDepth) ? parseInt(elDepth) : isExtant(depth) ? depth : 0);
        dLog("embedder depth:", d);
        for (let fish of Array.from(catches)) {
            if (fish.hasClass("is-loaded"))
                continue;
            let src = obsidian.normalizePath(fish.getAttribute("src"));
            let dest = plugin.app.metadataCache.getFirstLinkpathDest(src, srcPath);
            if (dest) {
                let path = plugin.app.vault.adapter.getResourcePath(dest.path);
                let ext = dest.extension;
                if (extImg.contains(ext)) { // Embed Image
                    fish.addClass("image-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("img");
                    nel.setAttribute("src", path);
                }
                else if (extAud.contains(ext)) { // Embed Audio
                    fish.addClass("media-embed");
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let nel = fish.createEl("audio", { "attr": { "controls": true } });
                    nel.setAttribute("src", path);
                }
                else if (extVid.contains(ext)) { // Embed Video
                    fish.childNodes.forEach((n) => { fish.removeChild(n); });
                    let vidiv = fish.createEl("video", { "attr": { "controls": true } });
                    vidiv.setAttribute("src", path);
                }
                else if (extTxt.contains(ext)) {
                    /* Embed Transclusion */
                    const createEmbedPromise = () => {
                        return new Promise(() => __awaiter(this, void 0, void 0, function* () {
                            dLog("new embed prom");
                            fish.childNodes.forEach((n) => { fish.removeChild(n); });
                            let cache = plugin.app.metadataCache.getCache(dest.path);
                            let read = yield plugin.app.vault.cachedRead(dest);
                            let classes = obsidian.parseFrontMatterStringArray(cache === null || cache === void 0 ? void 0 : cache.frontmatter, "cssclass");
                            let div = fish.createDiv({ cls: "markdown-embed" });
                            div.createDiv({ cls: "markdown-embed-title", text: dest.basename });
                            let content = div.createDiv({ cls: "markdown-embed-content" });
                            let link = div.createDiv({ cls: "markdown-embed-link" });
                            obsidian.setIcon(link, "link");
                            link.onClickEvent((e) => {
                                e.preventDefault();
                                plugin.app.workspace.openLinkText(src, srcPath);
                            });
                            let pv = content.createDiv({ cls: "markdown-preview-view" });
                            pv.addClazz(classes);
                            let ps = pv.createDiv({ cls: "markdown-preview-sizer markdown-preview-section" });
                            let mkh = createDiv({ attr: { "depth": depth.toString() } });
                            yield obsidian.MarkdownRenderer.renderMarkdown(read, mkh, srcPath, null);
                            const mke = (Array.from((mkh === null || mkh === void 0 ? void 0 : mkh.childNodes) || []).map((n) => {
                                // if (n.childNodes.length > 0) { let d = createDiv(); d.append(n.cloneNode(true)); return d;} else return n;}));
                                if (n.childNodes.length > 0) {
                                    let d = createDiv();
                                    d.append(n);
                                    return d;
                                }
                                else
                                    return n;
                            }));
                            ps.append(...mke); //ps.setAttribute("depth", d.toString())
                            return embedMedia(ps, srcPath, plugin, d - 1, true);
                        }));
                    };
                    if (d <= 0) {
                        let [l] = createRegent({ class: "depth-limit", hover: "It goes on forever..." });
                        fish.replaceWith(l);
                        dLog("embedder hit limit");
                    }
                    else {
                        proms.push(createEmbedPromise());
                    }
                }
            }
        }
        return Promise.allSettled(proms).then(values => {
            dLog("embedder done", proms);
            return Promise.resolve(proms.length);
        });
    });
}

class SkribiChild extends obsidian.MarkdownRenderChild {
    constructor(el) {
        super(el);
        this.intervals = [];
        this.cbOnUnload = [];
    }
    provideContext() {
        return {
            el: this.containerEl,
            registerInterval: this.skRegisterInterval.bind(this),
            registerUnload: this.skRegisterUnload.bind(this),
            registerEvent: this.skRegisterEvent.bind(this),
            reload: this.rerender,
            c: this
        };
    }
    setPacket(packet) {
        if (this.packet == null) {
            this.packet = packet;
        }
    }
    onload() { }
    clear() {
        dLog("skreeb clear");
        for (let i of this.intervals)
            window.clearInterval(i); // there might be cases where this doesn't get called properly
        for (let cb of this.cbOnUnload)
            cb[0](cb[1]);
    }
    onunload() {
        dLog("skreeb unload");
        this.clear();
    }
    /* Provider Functions */
    skRegisterInterval(cb, time, ...args) {
        //@ts-ignore
        let x = window.setInterval((...a) => {
            if (this._loaded == false) {
                window.clearInterval(x);
            }
            cb(...a);
        }, time * 1000, ...args);
        this.intervals.push(x);
        return x;
    }
    skRegisterEvent(event) {
        dLog('SkChild registered event:', event);
        this.registerEvent(event);
    }
    skRegisterUnload(cb, ...args) {
        this.cbOnUnload.push([(...x) => cb(...x), args]);
    }
    // Assigned in renderSkribi()
    rerender() { }
}

/* Check if code block is that good good and if so what type of good good */
function preparseSkribi(el, str, flg) {
    return __awaiter(this, void 0, void 0, function* () {
        let text = isExtant(str) ? str : el.textContent;
        if (text.length < 3)
            return;
        let e = text.substr(text.length - 2);
        let s = text.substr(0, 2);
        if (s.startsWith("{") && e.endsWith("}")) {
            let f = s[1];
            let flag = (f == ":") ? 1 : (f == "=") ? 2 : (f == "~") ? 3 : (f == "{") ? 4 : (f == ".") ? 5 : -1;
            if ((flag > 0) && (flag != 4 || (e == "}}"))) {
                return { flag: flag, text: text.substring(2, text.length - (flag == 4 ? 2 : 1)) };
            }
            else
                return;
        }
        else
            return;
    });
}
/* Parse variables in template invocations */
function parseSkribi(src) {
    return __awaiter(this, void 0, void 0, function* () {
        let sa = src.split(/(?<![\\])\|/);
        let id = sa.splice(0, 1)[0].trim();
        let args = {};
        for (let seg of sa) {
            let si = seg.indexOf(":");
            if (si == -1)
                continue;
            args[seg.slice(0, si).trim()] = seg.slice(si + 1).trim();
        }
        return { id: id, args: { v: args } };
    });
}

class SuggestionModal extends obsidian.FuzzySuggestModal {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
    }
    getItems() {
        return this.plugin.eta.getCacheKeys();
    }
    getItemText(item) { return item; }
    onChooseItem(item, evt) {
        this.resolve(item);
    }
    openAndGetValue(resolve, reject) {
        return __awaiter(this, void 0, void 0, function* () {
            this.resolve = resolve;
            this.reject = reject;
            this.open();
        });
    }
}

var promptTypes;
(function (promptTypes) {
    promptTypes["string"] = "string";
})(promptTypes || (promptTypes = {}));

class InsertionModal extends obsidian.Modal {
    constructor(plugin, editor, id) {
        super(plugin.app);
        this.valFields = {};
        this.plugin = plugin;
        this.editor = editor;
        this.currentID = id.toString();
        this.containerEl.addClass("skribi-insertion-modal");
        this.titleEl.setText("Insert Skribi Template");
    }
    onOpen() {
        this.create();
    }
    create() {
        let s = new obsidian.Setting(this.contentEl);
        s.addDropdown((drop) => {
            drop
                .addOptions(toDupeRecord(this.plugin.eta.getCacheKeys()))
                .setValue(this.currentID)
                .onChange((v) => {
                this.currentID = v;
                let f = this.generateFields(fieldsDiv, this.currentID);
                ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
            });
        });
        let fieldsDiv = this.contentEl.createDiv({ cls: "skribi-modal-fields" });
        let t = new obsidian.Setting(this.contentEl);
        t.addText((te) => { this.textInput = te; return te; });
        t.setName("Append");
        t.settingEl.addClass("skribi-modal-field-append");
        let f = this.generateFields(fieldsDiv, this.currentID);
        ((f.length > 0) ? f[0] : this.textInput).inputEl.focus();
        let confirm = new obsidian.Setting(this.contentEl);
        confirm.addButton((button) => button
            .setButtonText("Insert")
            .onClick(() => this.doInsert()));
        this.keypressRef = this.scope.register([], "Enter", this.doInsert.bind(this));
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    generateFields(el, id) {
        el.empty();
        var arr = [];
        if (this.plugin.eta.templateFrontmatters.has(id)) {
            let fm = this.plugin.eta.templateFrontmatters.get(id);
            for (let v of Object.keys(fm)) {
                if (v.charAt(0) == "_") {
                    let vn = v.substring(1);
                    let fma = this.parsePromptVal(vn, fm[v]);
                    let s = new obsidian.Setting(el);
                    s.settingEl.addClass("skribi-modal-template-field");
                    if (fma.type == promptTypes.string) {
                        arr.push(this.createTextField(s, fma));
                    }
                    s.setName(fma.name);
                }
            }
        }
        return arr;
    }
    createTextField(set, fma) {
        let t;
        set.addText((text) => {
            text
                .setValue(fma.default)
                .setPlaceholder(fma.placeholder)
                .onChange((value) => __awaiter(this, void 0, void 0, function* () {
                this.valFields[fma.id] = value;
            }));
            text.inputEl.addClass("skribi-text-input");
            t = text;
        });
        if (fma.default.length > 0)
            this.valFields[fma.id] = fma.default;
        return t;
    }
    parsePromptVal(k, val) {
        let v = {
            id: k,
            type: promptTypes.string,
            name: isExtant(val === null || val === void 0 ? void 0 : val.name) ? val.name : k,
            placeholder: isExtant(val === null || val === void 0 ? void 0 : val.placeholder) ? val.placeholder : "",
            default: isExtant(val === null || val === void 0 ? void 0 : val.default) ? val.default : isExtant(val === null || val === void 0 ? void 0 : val.def) ? val.def : "",
        };
        return v;
    }
    doInsert() {
        let id = this.currentID;
        let osel = this.editor.listSelections();
        let toInsert = `\`{:${id}`;
        for (let e of Object.entries(this.valFields)) {
            toInsert += ` | ${e[0]}: ${e[1]}`;
        }
        toInsert += ((this === null || this === void 0 ? void 0 : this.textInput.getValue().length) > 0) ? " | " + this.textInput.getValue() : "";
        toInsert += `}\``;
        this.editor.getDoc().replaceSelection(toInsert);
        let nsel = [];
        for (let p of osel) {
            nsel.push({ from: { line: p.anchor.line, ch: p.anchor.ch + (toInsert.length) } });
        }
        this.editor.transaction({ selections: nsel });
        this.close();
    }
}

class TestModal extends obsidian.Modal {
    constructor(plugin, autofill) {
        super(plugin.app);
        this.iterations = 10;
        this.multiBlock = false;
        this.valFields = {};
        this.autofill = null;
        this.plugin = plugin;
        this.autofill = autofill;
        this.containerEl.addClass("skribi-test-modal");
        this.titleEl.setText("Skribi Performance Test");
        let desc = createDiv({ cls: 'skribi-modal-desc' });
        makeExternalLink(desc.createEl('a', { text: 'Documentation', attr: { 'href': linkToDocumentation('commands/performance') } }));
        desc.insertAfter(this.titleEl);
    }
    onOpen() {
        this.create();
    }
    create() {
        let fieldTextToEval = new obsidian.Setting(this.contentEl);
        fieldTextToEval.addTextArea((text) => { this.textFieldToEval = text; return text; });
        fieldTextToEval.setName('Text To Evaluate');
        fieldTextToEval.setDesc('Text is evaluated as the contents of a code span.');
        this.textFieldToEval.setPlaceholder(`{~ console.log('Hello World'); }`);
        if (this.autofill) {
            fieldTextToEval.infoEl.append(createDiv({ text: `Autofilled from ${this.autofill.type}`, cls: 'setting-item-description skribi-autofill-notification' }));
            this.textFieldToEval.setValue(this.autofill.value);
        }
        let fieldIterations = new obsidian.Setting(this.contentEl);
        let iters = fieldIterations.controlEl.createEl('input', { attr: { type: 'number' } });
        iters.defaultValue = this.iterations.toString();
        iters.onchange = (ev) => { this.iterations = iters.valueAsNumber; };
        fieldIterations.setName('Evaluation Iterations');
        fieldIterations.setDesc('How many times should the text be evaluated?');
        let blockSetting = new obsidian.Setting(this.contentEl);
        blockSetting.addToggle((tog) => {
            tog.setValue(this.multiBlock);
            tog.onChange((v) => this.multiBlock = v);
            return tog;
        });
        blockSetting.setName('Eval As Individual Blocks?');
        let confirm = new obsidian.Setting(this.contentEl).setClass('skribi-button-eval');
        confirm.addButton((button) => button
            .setButtonText("Evaluate")
            .onClick(() => this.doEval()));
        this.keypressRef = this.scope.register([], "Enter", this.doEval.bind(this));
        this.contentEl.createEl('hr');
        this.resultsField = this.contentEl.createDiv({ cls: "skribi-test-results-field" });
    }
    onClose() {
        this.scope.unregister(this.keypressRef);
    }
    doEval() {
        return __awaiter(this, void 0, void 0, function* () {
            let container = createDiv();
            let el = createDiv();
            let blocksToProcess = [];
            Math.min(this.iterations);
            if (this.multiBlock) {
                for (let i = 0; i < this.iterations; i++) {
                    let d = createDiv();
                    d.createEl('code', { text: this.textFieldToEval.getValue() });
                    blocksToProcess.push(d);
                }
            }
            else {
                let singleDiv = createDiv();
                for (let i = 0; i < this.iterations; i++) {
                    singleDiv.createEl('code', { text: this.textFieldToEval.getValue() });
                }
                blocksToProcess.push(singleDiv);
            }
            let timeStart = window.performance.now();
            const proms = blocksToProcess.map((div) => __awaiter(this, void 0, void 0, function* () {
                let promiseStartTime = window.performance.now();
                let promise = yield this.plugin.processor({ srcType: "GENERAL" /* general */ }, div, {
                    remainingNestLevel: 4,
                    docId: '55555555',
                    frontmatter: null,
                    sourcePath: this.plugin.app.workspace.getActiveFile().path,
                    addChild: (child) => { },
                    getSectionInfo: () => { return null; },
                    containerEl: container,
                    el: el
                }, 4, false, null).catch(() => { });
                return [promise, window.performance.now(), promiseStartTime];
            }));
            this.resultsField.setText('Evaluating...');
            let settledValues = yield Promise.allSettled(proms);
            vLog(`Performance test settled in: ${roundTo(window.performance.now() - timeStart, 3)}ms`);
            let fullfilled = settledValues.map((v) => { if (v.status == 'fulfilled')
                return v.value; });
            let times = fullfilled.map((result) => (result[1] - result[2]));
            let avg = average(...times);
            this.resultsField.setText(`Average fulfillment time (${times.length} block${times.length > 1 ? 's' : ''}): ${roundTo(avg, 3)}ms`);
            el.detach();
        });
    }
}

class SkribosPlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        this.varName = "sk";
        this.loadEvents = new obsidian.Events();
        this.initLoaded = false;
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Skribi: Loading...');
            yield this.loadSettings();
            this.addSettingTab(new SkribosSettingTab(this.app, this));
            this.eta = new EtaHandler(this);
            let process = (el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processor({ srcType: "GENERAL" /* general */ }, el, ctx); });
            // process.sortOrder = -50
            this.registerMarkdownPostProcessor((el, ctx) => process(el, ctx));
            let processBlock = (mode, str, el, ctx) => __awaiter(this, void 0, void 0, function* () { this.processor(mode, el, ctx, null, null, str.trimEnd()); });
            ([["normal", "", 0 /* none */], ["raw", "-raw", 3 /* raw */], ["literal", "-lit", 4 /* literal */], ["interpolate", "-int", 2 /* interp */], ["evaluate", "-eval", 5 /* eval */]])
                .forEach((v) => {
                this.registerMarkdownCodeBlockProcessor(`skribi${v[1]}`, processBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
                this.registerMarkdownCodeBlockProcessor(`sk${v[1]}`, processBlock.bind(this, { srcType: "BLOCK" /* block */, flag: v[2] }));
            });
            this.registerEvent(this.app.metadataCache.on('changed', e => {
                // if (e?.parent.path.contains(this.settings.templateFolder)) { bUpdate(e); }
            }));
            this.initLoadRef = this.loadEvents.on('init-load-complete', () => { this.initLoaded = true; dLog("init-load-complete"); });
            this.addCommand({ id: "insert-skribi", name: "Insert Skribi",
                editorCallback: (editor, view) => {
                    if (!this.initLoaded)
                        return;
                    let x = new SuggestionModal(this);
                    new Promise((resolve, reject) => x.openAndGetValue(resolve, reject))
                        .then(result => {
                        if (this.eta.hasPartial(result)) {
                            let i = new InsertionModal(this, editor, result);
                            i.open();
                        }
                    }, (r) => { });
                } });
            this.addCommand({ id: "reload-scripts", name: "Reload Scripts",
                callback: () => {
                    this.eta.bus.scriptLoader.reload().then(() => console.log("Skribi: Reloaded Scripts"));
                } });
            this.addCommand({ id: "test-performance", name: 'Test Performance', callback: () => __awaiter(this, void 0, void 0, function* () {
                    var _a, _b;
                    let sel = (_b = (_a = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView)) === null || _a === void 0 ? void 0 : _a.editor) === null || _b === void 0 ? void 0 : _b.getSelection();
                    let clip = yield window.navigator.clipboard.readText();
                    let fill = (sel || clip) ? {
                        type: sel ? 'Selection' : 'Clipboard',
                        value: sel ? sel : clip
                    } : null;
                    new TestModal(this, fill).open();
                }) });
            // registerMirror(this);
        });
    }
    onunload() {
        this.eta.unload();
        this.loadEvents.offref(this.initLoadRef);
        console.log('Skribi: Unloading...');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
    processor(mode, // 0: codespan; 1: codeblock;
    doc, ctx, depth, self, srcIn) {
        return __awaiter(this, void 0, void 0, function* () {
            let nestExtant = isExtant(ctx.remainingNestLevel);
            let nestLevel = nestExtant ? ctx.remainingNestLevel : null;
            /* nestExtant means that we are inside of a natural transclusion */
            self = isExtant(self);
            depth = self ? depth : null;
            /* self means that we have been called by renderSkribi, to look for codeblocks */
            let elHasDepth = isExtant(doc.getAttribute("depth"));
            let elElHasDepth = isExtant(ctx.el.getAttribute("depth"));
            let elDepth = elHasDepth ? parseInt(doc.getAttribute("depth")) : elElHasDepth ? parseInt(ctx.el.getAttribute("depth")) : null;
            /* Used for passing depth to virtual elements (we may be in one even as we speak...)*/
            /* determine our depth condition type */
            let d = self ? depth : (elHasDepth || elElHasDepth) ? elDepth : nestExtant ? nestLevel : 0;
            if (!nestExtant && !(elHasDepth || elElHasDepth))
                dLog("processor sees no depth");
            if (elHasDepth) {
                dLog("elDepth", elDepth, "doc", doc, "el", ctx.el, "conEl", ctx.containerEl);
            }
            else {
                dLog("processor: ", "doc", doc, "el", ctx.el, "conEl", ctx.containerEl, "nest", ctx.remainingNestLevel);
            }
            /* Dispatch render promises */
            var proms = [];
            var temps = 0;
            const elCodes = (mode.srcType == "BLOCK" /* block */) ? [doc] : doc.querySelectorAll("code");
            if (!(d <= 0)) {
                let tm = window.performance.now();
                const elProms = Array.from(elCodes).map((el) => __awaiter(this, void 0, void 0, function* () {
                    let t = window.performance.now();
                    dLog("start:", t);
                    let src = (isExtant(mode.flag) && mode.flag != 0 /* none */) ?
                        { text: srcIn || doc.textContent, flag: mode.flag } : yield preparseSkribi(el);
                    try {
                        if (src != null) {
                            let nel = renderRegent(el, { class: 'sk-loading', hover: 'Evaluating...' });
                            if (src.flag == 1) {
                                proms.push(this.predicate({ el: nel, src: src.text, mdCtx: ctx, skCtx: { time: window.performance.now(), depth: d, flag: src.flag } }));
                                temps++;
                            }
                            else {
                                proms.push(this.processSkribi(nel, src.text, ctx, { time: window.performance.now(), depth: d, flag: src.flag }));
                            }
                        }
                    }
                    catch (e) {
                        if (!e.flags.noRender) {
                            renderError(el, e);
                        }
                    }
                    return Promise.resolve();
                }));
                if ( /*!self && */!doc.hasClass("skribi-render-virtual")) {
                    let aps = Promise.all(elProms);
                    aps.then(() => {
                        Promise.allSettled(proms).then(() => {
                            if (proms.length > 0) {
                                if (this.initLoaded) {
                                    vLog(`Processed ${proms.length} skribis (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                                else {
                                    let str = "";
                                    if (temps > 0) {
                                        if (proms.length - temps > 0) {
                                            str = `Processed ${proms.length - temps} and queued ${temps} skribis`;
                                        }
                                        else
                                            str = `Queued ${temps} skribis`;
                                    }
                                    else
                                        str = `Processed ${proms.length - temps} skribis`;
                                    vLog(str + ` (${roundTo((window.performance.now() - tm), 4)} ms) in Element`, doc);
                                }
                            }
                        });
                    });
                }
                yield Promise.allSettled(elProms);
                return proms;
            }
            else {
                /* Depth too high! */
                elCodes.forEach((el) => __awaiter(this, void 0, void 0, function* () {
                    preparseSkribi(el).then((src) => __awaiter(this, void 0, void 0, function* () {
                        if (src != null)
                            renderState(el, { hover: "Recursion limit reached!", class: 'stasis' });
                    }));
                }));
                dLog("processor hit limit");
                return Promise.resolve('Depth Limit');
            }
        });
    }
    /* Await initial loading of templates */
    predicate(args) {
        return __awaiter(this, void 0, void 0, function* () {
            let el = renderWait(args.el);
            if (!this.initLoaded) {
                dLog("not yet loaded");
                this.initLoadRef = this.loadEvents.on('init-load-complete', () => __awaiter(this, void 0, void 0, function* () {
                    this.initLoaded = true;
                    return yield this.processSkribiTemplate(el, args.src, args.mdCtx, Object.assign(args.skCtx, { time: window.performance.now() }));
                }));
            }
            else
                return yield this.processSkribiTemplate(el, args.src, args.mdCtx, args.skCtx);
        });
    }
    processSkribiTemplate(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let parsed = null;
            try {
                parsed = yield parseSkribi(src);
            }
            catch (e) {
                renderError(el, e);
                return null;
            }
            if (this.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath).basename == parsed.id) {
                renderRegent(el, { class: 'self', hover: 'Self Render Prohibited' });
                return null;
            }
            let template = this.eta.getPartial(parsed.id);
            if (!isExtant(template)) {
                if (this.eta.failedTemplates.has(parsed.id)) {
                    renderError(el, { msg: `Template ${parsed.id} failed to compile, error: \n` + this.eta.failedTemplates.get(parsed.id) });
                }
                else {
                    renderError(el, { msg: `No such template "${parsed.id}"` });
                }
                return null;
            }
            return this.renderSkribi(el, template, parsed.id, mdCtx, Object.assign({}, skCtx, { ctx: parsed.args }));
        });
    }
    processSkribi(el, src, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            const prep = function (str, flag) {
                switch (flag) {
                    case 2: return `<%=${src}%>`;
                    case 3: return `<%~${src}%>`;
                    case 4: return str;
                    case 5: return `<%${src}%>`;
                }
            };
            return this.renderSkribi(el, prep(src, skCtx.flag), "literal", mdCtx, skCtx);
        });
    }
    renderSkribi(el, con, id, mdCtx, skCtx) {
        return __awaiter(this, void 0, void 0, function* () {
            let file = this.app.metadataCache.getFirstLinkpathDest("", mdCtx.sourcePath);
            let e = createDiv({ cls: "skribi-render-virtual" });
            let c = new SkribiChild(e);
            Object.assign(c, { rerender: (() => {
                    console.log("e");
                    c.clear();
                    this.renderSkribi(e, con, id, mdCtx, skCtx);
                }).bind(this)
            });
            let ctx = Object.assign({}, (skCtx === null || skCtx === void 0 ? void 0 : skCtx.ctx) || {}, { child: c.provideContext() });
            let [rendered, packet] = yield this.eta.renderAsync(con, ctx, file).catch((err) => {
                if (this.settings.errorLogging)
                    console.warn(`Skribi render threw error! Displaying content and error...`, EBAR, con, EBAR, err);
                renderError(el, (err === null || err === void 0 ? void 0 : err.hasData) ? err : { msg: (err === null || err === void 0 ? void 0 : err.msg) || err || "Render Error" });
                c.unload();
                return Promise.resolve(null);
            });
            dLog("renderSkrib:", el, mdCtx, skCtx, id);
            if (isExtant(rendered)) {
                let d = isExtant(mdCtx.remainingNestLevel) ? mdCtx.remainingNestLevel : (skCtx.depth);
                let r = obsidian.MarkdownRenderer.renderMarkdown(rendered, e, mdCtx.sourcePath, null).then(() => {
                    e.setAttribute("skribi", id); //e.setAttribute("depth", d.toString());
                    e.removeClass("skribi-render-virtual");
                    el.replaceWith(e);
                    dLog("finish: ", skCtx.time, window.performance.now());
                    if (skCtx.flag == 1) {
                        vLog(`Rendered template "${id}" (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, e);
                    }
                    else
                        vLog(`Rendered literal (f: ${skCtx.flag}) (${roundTo(window.performance.now() - skCtx.time, 4)} ms)`, e);
                    return Promise.resolve(e);
                });
                c.setPacket(packet);
                mdCtx.addChild(c);
                r.then((e) => {
                    // TODO: only restrict depth for transclusions
                    if (isExtant(mdCtx.remainingNestLevel) && (mdCtx.remainingNestLevel > 0) || !isExtant(mdCtx.remainingNestLevel)) {
                        return embedMedia(e, mdCtx.sourcePath, this, skCtx.depth);
                    }
                    else
                        return Promise.resolve();
                    //e.setAttribute("depth", d.toString())
                })
                    .then((x) => {
                    dLog("renderer final: ", d);
                    // e.setAttribute("depth", d.toString())
                    this.processor({ srcType: "GENERAL" /* general */ }, e, mdCtx, skCtx.depth - 1, true); /* Recurse the processor to parse skreeblings */
                });
                return r;
            }
            else {
                c.clear();
                return Promise.reject("Render Error");
            }
        });
    }
}

module.exports = SkribosPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5vZGVfbW9kdWxlcy9ldGEvZGlzdC9ldGEuZXMuanMiLCJzcmMvdHlwZXMvY29uc3QudHMiLCJzcmMvbW9kYWwvY29uZmlybWF0aW9uTW9kYWwudHMiLCJzcmMvdXRpbC50cyIsInNyYy9ldGEvY29tcC50cyIsInNyYy9ldGEvcHJvdmlkZXJfYWJzLnRzIiwic3JjL2V0YS9wcm92aWRlcnMvYmFzZS50cyIsInNyYy9ldGEvcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2LnRzIiwic3JjL2V0YS9wcm92aWRlcnMvaW50ZWdyYXRpb24vd2VhdGhlci50cyIsInNyYy9ldGEvcHJvdmlkZXJzL3NjcmlwdGxvYWRlci50cyIsInNyYy9ldGEvcHJvdmlkZXJfYnVzLnRzIiwic3JjL2V0YS9jYWNoZXIudHMiLCJzcmMvZXRhL3RlbXBsYXRlcy50cyIsInNyYy9ldGEvZXRhLnRzIiwic3JjL3NldHRpbmdzLnRzIiwic3JjL3JlbmRlci9yZWdlbnQudHMiLCJzcmMvcmVuZGVyL2VtYmVkLnRzIiwic3JjL3JlbmRlci9jaGlsZC50cyIsInNyYy9yZW5kZXIvcGFyc2UudHMiLCJzcmMvbW9kYWwvc3VnZ2VzdGlvbk1vZGFsLnRzIiwic3JjL3R5cGVzL3R5cGVzLnRzIiwic3JjL21vZGFsL2luc2VydGlvbk1vZGFsLnRzIiwic3JjL21vZGFsL3Rlc3RNb2RhbC50cyIsInNyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XHJcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcclxuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XHJcbn0pIDogZnVuY3Rpb24obywgdikge1xyXG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgZ2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJtXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIG1ldGhvZCBpcyBub3Qgd3JpdGFibGVcIik7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIChraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlciwgdmFsdWUpIDogZiA/IGYudmFsdWUgPSB2YWx1ZSA6IHN0YXRlLnNldChyZWNlaXZlciwgdmFsdWUpKSwgdmFsdWU7XHJcbn1cclxuIiwiaW1wb3J0IHsgZXhpc3RzU3luYywgcmVhZEZpbGVTeW5jIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHsgcmVzb2x2ZSwgZGlybmFtZSwgZXh0bmFtZSB9IGZyb20gJ3BhdGgnO1xuXG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG5cclxudmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcblxuZnVuY3Rpb24gc2V0UHJvdG90eXBlT2Yob2JqLCBwcm90bykge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICBpZiAoT2JqZWN0LnNldFByb3RvdHlwZU9mKSB7XHJcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKG9iaiwgcHJvdG8pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgb2JqLl9fcHJvdG9fXyA9IHByb3RvO1xyXG4gICAgfVxyXG59XHJcbi8vIFRoaXMgaXMgcHJldHR5IG11Y2ggdGhlIG9ubHkgd2F5IHRvIGdldCBuaWNlLCBleHRlbmRlZCBFcnJvcnNcclxuLy8gd2l0aG91dCB1c2luZyBFUzZcclxuLyoqXHJcbiAqIFRoaXMgcmV0dXJucyBhIG5ldyBFcnJvciB3aXRoIGEgY3VzdG9tIHByb3RvdHlwZS4gTm90ZSB0aGF0IGl0J3MgX25vdF8gYSBjb25zdHJ1Y3RvclxyXG4gKlxyXG4gKiBAcGFyYW0gbWVzc2FnZSBFcnJvciBtZXNzYWdlXHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIHRocm93IEV0YUVycihcInRlbXBsYXRlIG5vdCBmb3VuZFwiKVxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIEV0YUVycihtZXNzYWdlKSB7XHJcbiAgICB2YXIgZXJyID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG4gICAgc2V0UHJvdG90eXBlT2YoZXJyLCBFdGFFcnIucHJvdG90eXBlKTtcclxuICAgIHJldHVybiBlcnI7XHJcbn1cclxuRXRhRXJyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlLCB7XHJcbiAgICBuYW1lOiB7IHZhbHVlOiAnRXRhIEVycm9yJywgZW51bWVyYWJsZTogZmFsc2UgfVxyXG59KTtcclxuLyoqXHJcbiAqIFRocm93cyBhbiBFdGFFcnIgd2l0aCBhIG5pY2VseSBmb3JtYXR0ZWQgZXJyb3IgYW5kIG1lc3NhZ2Ugc2hvd2luZyB3aGVyZSBpbiB0aGUgdGVtcGxhdGUgdGhlIGVycm9yIG9jY3VycmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gUGFyc2VFcnIobWVzc2FnZSwgc3RyLCBpbmR4KSB7XHJcbiAgICB2YXIgd2hpdGVzcGFjZSA9IHN0ci5zbGljZSgwLCBpbmR4KS5zcGxpdCgvXFxuLyk7XHJcbiAgICB2YXIgbGluZU5vID0gd2hpdGVzcGFjZS5sZW5ndGg7XHJcbiAgICB2YXIgY29sTm8gPSB3aGl0ZXNwYWNlW2xpbmVObyAtIDFdLmxlbmd0aCArIDE7XHJcbiAgICBtZXNzYWdlICs9XHJcbiAgICAgICAgJyBhdCBsaW5lICcgK1xyXG4gICAgICAgICAgICBsaW5lTm8gK1xyXG4gICAgICAgICAgICAnIGNvbCAnICtcclxuICAgICAgICAgICAgY29sTm8gK1xyXG4gICAgICAgICAgICAnOlxcblxcbicgK1xyXG4gICAgICAgICAgICAnICAnICtcclxuICAgICAgICAgICAgc3RyLnNwbGl0KC9cXG4vKVtsaW5lTm8gLSAxXSArXHJcbiAgICAgICAgICAgICdcXG4nICtcclxuICAgICAgICAgICAgJyAgJyArXHJcbiAgICAgICAgICAgIEFycmF5KGNvbE5vKS5qb2luKCcgJykgK1xyXG4gICAgICAgICAgICAnXic7XHJcbiAgICB0aHJvdyBFdGFFcnIobWVzc2FnZSk7XHJcbn1cblxuLyoqXHJcbiAqIEByZXR1cm5zIFRoZSBnbG9iYWwgUHJvbWlzZSBmdW5jdGlvblxyXG4gKi9cclxudmFyIHByb21pc2VJbXBsID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCkuUHJvbWlzZTtcclxuLyoqXHJcbiAqIEByZXR1cm5zIEEgbmV3IEFzeW5jRnVuY3Rpb24gY29uc3R1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXN5bmNGdW5jdGlvbkNvbnN0cnVjdG9yKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gKGFzeW5jIGZ1bmN0aW9uKCl7fSkuY29uc3RydWN0b3InKSgpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFN5bnRheEVycm9yKSB7XHJcbiAgICAgICAgICAgIHRocm93IEV0YUVycihcIlRoaXMgZW52aXJvbm1lbnQgZG9lc24ndCBzdXBwb3J0IGFzeW5jL2F3YWl0XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIHN0ci50cmltTGVmdCBwb2x5ZmlsbFxyXG4gKlxyXG4gKiBAcGFyYW0gc3RyIC0gSW5wdXQgc3RyaW5nXHJcbiAqIEByZXR1cm5zIFRoZSBzdHJpbmcgd2l0aCBsZWZ0IHdoaXRlc3BhY2UgcmVtb3ZlZFxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gdHJpbUxlZnQoc3RyKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXh0cmEtYm9vbGVhbi1jYXN0XHJcbiAgICBpZiAoISFTdHJpbmcucHJvdG90eXBlLnRyaW1MZWZ0KSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci50cmltTGVmdCgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKy8sICcnKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogc3RyLnRyaW1SaWdodCBwb2x5ZmlsbFxyXG4gKlxyXG4gKiBAcGFyYW0gc3RyIC0gSW5wdXQgc3RyaW5nXHJcbiAqIEByZXR1cm5zIFRoZSBzdHJpbmcgd2l0aCByaWdodCB3aGl0ZXNwYWNlIHJlbW92ZWRcclxuICpcclxuICovXHJcbmZ1bmN0aW9uIHRyaW1SaWdodChzdHIpIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1leHRyYS1ib29sZWFuLWNhc3RcclxuICAgIGlmICghIVN0cmluZy5wcm90b3R5cGUudHJpbVJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci50cmltUmlnaHQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvXFxzKyQvLCAnJyk7IC8vIFRPRE86IGRvIHdlIHJlYWxseSBuZWVkIHRvIHJlcGxhY2UgQk9NJ3M/XHJcbiAgICB9XHJcbn1cblxuLy8gVE9ETzogYWxsb3cgJy0nIHRvIHRyaW0gdXAgdW50aWwgbmV3bGluZS4gVXNlIFteXFxTXFxuXFxyXSBpbnN0ZWFkIG9mIFxcc1xyXG4vKiBFTkQgVFlQRVMgKi9cclxuZnVuY3Rpb24gaGFzT3duUHJvcChvYmosIHByb3ApIHtcclxuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcclxufVxyXG5mdW5jdGlvbiBjb3B5UHJvcHModG9PYmosIGZyb21PYmopIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBmcm9tT2JqKSB7XHJcbiAgICAgICAgaWYgKGhhc093blByb3AoZnJvbU9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICB0b09ialtrZXldID0gZnJvbU9ialtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0b09iajtcclxufVxyXG4vKipcclxuICogVGFrZXMgYSBzdHJpbmcgd2l0aGluIGEgdGVtcGxhdGUgYW5kIHRyaW1zIGl0LCBiYXNlZCBvbiB0aGUgcHJlY2VkaW5nIHRhZydzIHdoaXRlc3BhY2UgY29udHJvbCBhbmQgYGNvbmZpZy5hdXRvVHJpbWBcclxuICovXHJcbmZ1bmN0aW9uIHRyaW1XUyhzdHIsIGNvbmZpZywgd3NMZWZ0LCB3c1JpZ2h0KSB7XHJcbiAgICB2YXIgbGVmdFRyaW07XHJcbiAgICB2YXIgcmlnaHRUcmltO1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY29uZmlnLmF1dG9UcmltKSkge1xyXG4gICAgICAgIC8vIGtpbmRhIGNvbmZ1c2luZ1xyXG4gICAgICAgIC8vIGJ1dCBffX0gd2lsbCB0cmltIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIGZvbGxvd2luZyBzdHJpbmdcclxuICAgICAgICBsZWZ0VHJpbSA9IGNvbmZpZy5hdXRvVHJpbVsxXTtcclxuICAgICAgICByaWdodFRyaW0gPSBjb25maWcuYXV0b1RyaW1bMF07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBsZWZ0VHJpbSA9IHJpZ2h0VHJpbSA9IGNvbmZpZy5hdXRvVHJpbTtcclxuICAgIH1cclxuICAgIGlmICh3c0xlZnQgfHwgd3NMZWZ0ID09PSBmYWxzZSkge1xyXG4gICAgICAgIGxlZnRUcmltID0gd3NMZWZ0O1xyXG4gICAgfVxyXG4gICAgaWYgKHdzUmlnaHQgfHwgd3NSaWdodCA9PT0gZmFsc2UpIHtcclxuICAgICAgICByaWdodFRyaW0gPSB3c1JpZ2h0O1xyXG4gICAgfVxyXG4gICAgaWYgKCFyaWdodFRyaW0gJiYgIWxlZnRUcmltKSB7XHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH1cclxuICAgIGlmIChsZWZ0VHJpbSA9PT0gJ3NsdXJwJyAmJiByaWdodFRyaW0gPT09ICdzbHVycCcpIHtcclxuICAgICAgICByZXR1cm4gc3RyLnRyaW0oKTtcclxuICAgIH1cclxuICAgIGlmIChsZWZ0VHJpbSA9PT0gJ18nIHx8IGxlZnRUcmltID09PSAnc2x1cnAnKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3RyaW1taW5nIGxlZnQnICsgbGVmdFRyaW0pXHJcbiAgICAgICAgLy8gZnVsbCBzbHVycFxyXG4gICAgICAgIHN0ciA9IHRyaW1MZWZ0KHN0cik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChsZWZ0VHJpbSA9PT0gJy0nIHx8IGxlZnRUcmltID09PSAnbmwnKSB7XHJcbiAgICAgICAgLy8gbmwgdHJpbVxyXG4gICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9eKD86XFxyXFxufFxcbnxcXHIpLywgJycpO1xyXG4gICAgfVxyXG4gICAgaWYgKHJpZ2h0VHJpbSA9PT0gJ18nIHx8IHJpZ2h0VHJpbSA9PT0gJ3NsdXJwJykge1xyXG4gICAgICAgIC8vIGZ1bGwgc2x1cnBcclxuICAgICAgICBzdHIgPSB0cmltUmlnaHQoc3RyKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHJpZ2h0VHJpbSA9PT0gJy0nIHx8IHJpZ2h0VHJpbSA9PT0gJ25sJykge1xyXG4gICAgICAgIC8vIG5sIHRyaW1cclxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvKD86XFxyXFxufFxcbnxcXHIpJC8sICcnKTsgLy8gVE9ETzogbWFrZSBzdXJlIHRoaXMgZ2V0cyBcXHJcXG5cclxuICAgIH1cclxuICAgIHJldHVybiBzdHI7XHJcbn1cclxuLyoqXHJcbiAqIEEgbWFwIG9mIHNwZWNpYWwgSFRNTCBjaGFyYWN0ZXJzIHRvIHRoZWlyIFhNTC1lc2NhcGVkIGVxdWl2YWxlbnRzXHJcbiAqL1xyXG52YXIgZXNjTWFwID0ge1xyXG4gICAgJyYnOiAnJmFtcDsnLFxyXG4gICAgJzwnOiAnJmx0OycsXHJcbiAgICAnPic6ICcmZ3Q7JyxcclxuICAgICdcIic6ICcmcXVvdDsnLFxyXG4gICAgXCInXCI6ICcmIzM5OydcclxufTtcclxuZnVuY3Rpb24gcmVwbGFjZUNoYXIocykge1xyXG4gICAgcmV0dXJuIGVzY01hcFtzXTtcclxufVxyXG4vKipcclxuICogWE1MLWVzY2FwZXMgYW4gaW5wdXQgdmFsdWUgYWZ0ZXIgY29udmVydGluZyBpdCB0byBhIHN0cmluZ1xyXG4gKlxyXG4gKiBAcGFyYW0gc3RyIC0gSW5wdXQgdmFsdWUgKHVzdWFsbHkgYSBzdHJpbmcpXHJcbiAqIEByZXR1cm5zIFhNTC1lc2NhcGVkIHN0cmluZ1xyXG4gKi9cclxuZnVuY3Rpb24gWE1MRXNjYXBlKHN0cikge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAvLyBUbyBkZWFsIHdpdGggWFNTLiBCYXNlZCBvbiBFc2NhcGUgaW1wbGVtZW50YXRpb25zIG9mIE11c3RhY2hlLkpTIGFuZCBNYXJrbywgdGhlbiBjdXN0b21pemVkLlxyXG4gICAgdmFyIG5ld1N0ciA9IFN0cmluZyhzdHIpO1xyXG4gICAgaWYgKC9bJjw+XCInXS8udGVzdChuZXdTdHIpKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N0ci5yZXBsYWNlKC9bJjw+XCInXS9nLCByZXBsYWNlQ2hhcik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbmV3U3RyO1xyXG4gICAgfVxyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG52YXIgdGVtcGxhdGVMaXRSZWcgPSAvYCg/OlxcXFxbXFxzXFxTXXxcXCR7KD86W157fV18eyg/Oltee31dfHtbXn1dKn0pKn0pKn18KD8hXFwkeylbXlxcXFxgXSkqYC9nO1xyXG52YXIgc2luZ2xlUXVvdGVSZWcgPSAvJyg/OlxcXFxbXFxzXFx3XCInXFxcXGBdfFteXFxuXFxyJ1xcXFxdKSo/Jy9nO1xyXG52YXIgZG91YmxlUXVvdGVSZWcgPSAvXCIoPzpcXFxcW1xcc1xcd1wiJ1xcXFxgXXxbXlxcblxcclwiXFxcXF0pKj9cIi9nO1xyXG4vKiogRXNjYXBlIHNwZWNpYWwgcmVndWxhciBleHByZXNzaW9uIGNoYXJhY3RlcnMgaW5zaWRlIGEgc3RyaW5nICovXHJcbmZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHJpbmcpIHtcclxuICAgIC8vIEZyb20gTUROXHJcbiAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoL1suKitcXC0/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7IC8vICQmIG1lYW5zIHRoZSB3aG9sZSBtYXRjaGVkIHN0cmluZ1xyXG59XHJcbmZ1bmN0aW9uIHBhcnNlKHN0ciwgY29uZmlnKSB7XHJcbiAgICB2YXIgYnVmZmVyID0gW107XHJcbiAgICB2YXIgdHJpbUxlZnRPZk5leHRTdHIgPSBmYWxzZTtcclxuICAgIHZhciBsYXN0SW5kZXggPSAwO1xyXG4gICAgdmFyIHBhcnNlT3B0aW9ucyA9IGNvbmZpZy5wYXJzZTtcclxuICAgIGlmIChjb25maWcucGx1Z2lucykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnLnBsdWdpbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBsdWdpbiA9IGNvbmZpZy5wbHVnaW5zW2ldO1xyXG4gICAgICAgICAgICBpZiAocGx1Z2luLnByb2Nlc3NUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gcGx1Z2luLnByb2Nlc3NUZW1wbGF0ZShzdHIsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKiBBZGRpbmcgZm9yIEVKUyBjb21wYXRpYmlsaXR5ICovXHJcbiAgICBpZiAoY29uZmlnLnJtV2hpdGVzcGFjZSkge1xyXG4gICAgICAgIC8vIENvZGUgdGFrZW4gZGlyZWN0bHkgZnJvbSBFSlNcclxuICAgICAgICAvLyBIYXZlIHRvIHVzZSB0d28gc2VwYXJhdGUgcmVwbGFjZXMgaGVyZSBhcyBgXmAgYW5kIGAkYCBvcGVyYXRvcnMgZG9uJ3RcclxuICAgICAgICAvLyB3b3JrIHdlbGwgd2l0aCBgXFxyYCBhbmQgZW1wdHkgbGluZXMgZG9uJ3Qgd29yayB3ZWxsIHdpdGggdGhlIGBtYCBmbGFnLlxyXG4gICAgICAgIC8vIEVzc2VudGlhbGx5LCB0aGlzIHJlcGxhY2VzIHRoZSB3aGl0ZXNwYWNlIGF0IHRoZSBiZWdpbm5pbmcgYW5kIGVuZCBvZlxyXG4gICAgICAgIC8vIGVhY2ggbGluZSBhbmQgcmVtb3ZlcyBtdWx0aXBsZSBuZXdsaW5lcy5cclxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvW1xcclxcbl0rL2csICdcXG4nKS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nbSwgJycpO1xyXG4gICAgfVxyXG4gICAgLyogRW5kIHJtV2hpdGVzcGFjZSBvcHRpb24gKi9cclxuICAgIHRlbXBsYXRlTGl0UmVnLmxhc3RJbmRleCA9IDA7XHJcbiAgICBzaW5nbGVRdW90ZVJlZy5sYXN0SW5kZXggPSAwO1xyXG4gICAgZG91YmxlUXVvdGVSZWcubGFzdEluZGV4ID0gMDtcclxuICAgIGZ1bmN0aW9uIHB1c2hTdHJpbmcoc3RybmcsIHNob3VsZFRyaW1SaWdodE9mU3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHN0cm5nKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHN0cmluZyBpcyB0cnV0aHkgaXQgbXVzdCBiZSBvZiB0eXBlICdzdHJpbmcnXHJcbiAgICAgICAgICAgIHN0cm5nID0gdHJpbVdTKHN0cm5nLCBjb25maWcsIHRyaW1MZWZ0T2ZOZXh0U3RyLCAvLyB0aGlzIHdpbGwgb25seSBiZSBmYWxzZSBvbiB0aGUgZmlyc3Qgc3RyLCB0aGUgbmV4dCBvbmVzIHdpbGwgYmUgbnVsbCBvciB1bmRlZmluZWRcclxuICAgICAgICAgICAgc2hvdWxkVHJpbVJpZ2h0T2ZTdHJpbmcpO1xyXG4gICAgICAgICAgICBpZiAoc3RybmcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgXFwgd2l0aCBcXFxcLCAnIHdpdGggXFwnXHJcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBnb2luZyB0byBjb252ZXJ0IGFsbCBDUkxGIHRvIExGIHNvIGl0IGRvZXNuJ3QgdGFrZSBtb3JlIHRoYW4gb25lIHJlcGxhY2VcclxuICAgICAgICAgICAgICAgIHN0cm5nID0gc3RybmcucmVwbGFjZSgvXFxcXHwnL2csICdcXFxcJCYnKS5yZXBsYWNlKC9cXHJcXG58XFxufFxcci9nLCAnXFxcXG4nKTtcclxuICAgICAgICAgICAgICAgIGJ1ZmZlci5wdXNoKHN0cm5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHZhciBwcmVmaXhlcyA9IFtwYXJzZU9wdGlvbnMuZXhlYywgcGFyc2VPcHRpb25zLmludGVycG9sYXRlLCBwYXJzZU9wdGlvbnMucmF3XS5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtdWxhdG9yLCBwcmVmaXgpIHtcclxuICAgICAgICBpZiAoYWNjdW11bGF0b3IgJiYgcHJlZml4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2N1bXVsYXRvciArICd8JyArIGVzY2FwZVJlZ0V4cChwcmVmaXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcmVmaXgpIHtcclxuICAgICAgICAgICAgLy8gYWNjdW11bGF0b3IgaXMgZmFsc3lcclxuICAgICAgICAgICAgcmV0dXJuIGVzY2FwZVJlZ0V4cChwcmVmaXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gcHJlZml4IGFuZCBhY2N1bXVsYXRvciBhcmUgYm90aCBmYWxzeVxyXG4gICAgICAgICAgICByZXR1cm4gYWNjdW11bGF0b3I7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgJycpO1xyXG4gICAgdmFyIHBhcnNlT3BlblJlZyA9IG5ldyBSZWdFeHAoJyhbXl0qPyknICsgZXNjYXBlUmVnRXhwKGNvbmZpZy50YWdzWzBdKSArICcoLXxfKT9cXFxccyooJyArIHByZWZpeGVzICsgJyk/XFxcXHMqJywgJ2cnKTtcclxuICAgIHZhciBwYXJzZUNsb3NlUmVnID0gbmV3IFJlZ0V4cCgnXFwnfFwifGB8XFxcXC9cXFxcKnwoXFxcXHMqKC18Xyk/JyArIGVzY2FwZVJlZ0V4cChjb25maWcudGFnc1sxXSkgKyAnKScsICdnJyk7XHJcbiAgICAvLyBUT0RPOiBiZW5jaG1hcmsgaGF2aW5nIHRoZSBcXHMqIG9uIGVpdGhlciBzaWRlIHZzIHVzaW5nIHN0ci50cmltKClcclxuICAgIHZhciBtO1xyXG4gICAgd2hpbGUgKChtID0gcGFyc2VPcGVuUmVnLmV4ZWMoc3RyKSkpIHtcclxuICAgICAgICBsYXN0SW5kZXggPSBtWzBdLmxlbmd0aCArIG0uaW5kZXg7XHJcbiAgICAgICAgdmFyIHByZWNlZGluZ1N0cmluZyA9IG1bMV07XHJcbiAgICAgICAgdmFyIHdzTGVmdCA9IG1bMl07XHJcbiAgICAgICAgdmFyIHByZWZpeCA9IG1bM10gfHwgJyc7IC8vIGJ5IGRlZmF1bHQgZWl0aGVyIH4sID0sIG9yIGVtcHR5XHJcbiAgICAgICAgcHVzaFN0cmluZyhwcmVjZWRpbmdTdHJpbmcsIHdzTGVmdCk7XHJcbiAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSBsYXN0SW5kZXg7XHJcbiAgICAgICAgdmFyIGNsb3NlVGFnID0gdm9pZCAwO1xyXG4gICAgICAgIHZhciBjdXJyZW50T2JqID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUgKChjbG9zZVRhZyA9IHBhcnNlQ2xvc2VSZWcuZXhlYyhzdHIpKSkge1xyXG4gICAgICAgICAgICBpZiAoY2xvc2VUYWdbMV0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gc3RyLnNsaWNlKGxhc3RJbmRleCwgY2xvc2VUYWcuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgcGFyc2VPcGVuUmVnLmxhc3RJbmRleCA9IGxhc3RJbmRleCA9IHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4O1xyXG4gICAgICAgICAgICAgICAgdHJpbUxlZnRPZk5leHRTdHIgPSBjbG9zZVRhZ1syXTtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VHlwZSA9IHByZWZpeCA9PT0gcGFyc2VPcHRpb25zLmV4ZWNcclxuICAgICAgICAgICAgICAgICAgICA/ICdlJ1xyXG4gICAgICAgICAgICAgICAgICAgIDogcHJlZml4ID09PSBwYXJzZU9wdGlvbnMucmF3XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gJ3InXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogcHJlZml4ID09PSBwYXJzZU9wdGlvbnMuaW50ZXJwb2xhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2knXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICcnO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudE9iaiA9IHsgdDogY3VycmVudFR5cGUsIHZhbDogY29udGVudCB9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhciA9IGNsb3NlVGFnWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICcvKicpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29tbWVudENsb3NlSW5kID0gc3RyLmluZGV4T2YoJyovJywgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tZW50Q2xvc2VJbmQgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCBjb21tZW50Jywgc3RyLCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlQ2xvc2VSZWcubGFzdEluZGV4ID0gY29tbWVudENsb3NlSW5kO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gXCInXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzaW5nbGVRdW90ZVJlZy5sYXN0SW5kZXggPSBjbG9zZVRhZy5pbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2luZ2xlUXVvdGVNYXRjaCA9IHNpbmdsZVF1b3RlUmVnLmV4ZWMoc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2luZ2xlUXVvdGVNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUNsb3NlUmVnLmxhc3RJbmRleCA9IHNpbmdsZVF1b3RlUmVnLmxhc3RJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcnNlRXJyKCd1bmNsb3NlZCBzdHJpbmcnLCBzdHIsIGNsb3NlVGFnLmluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGFyID09PSAnXCInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlUXVvdGVSZWcubGFzdEluZGV4ID0gY2xvc2VUYWcuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvdWJsZVF1b3RlTWF0Y2ggPSBkb3VibGVRdW90ZVJlZy5leGVjKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvdWJsZVF1b3RlTWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSBkb3VibGVRdW90ZVJlZy5sYXN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgc3RyaW5nJywgc3RyLCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gJ2AnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVMaXRSZWcubGFzdEluZGV4ID0gY2xvc2VUYWcuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlTGl0TWF0Y2ggPSB0ZW1wbGF0ZUxpdFJlZy5leGVjKHN0cik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBsYXRlTGl0TWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VDbG9zZVJlZy5sYXN0SW5kZXggPSB0ZW1wbGF0ZUxpdFJlZy5sYXN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJzZUVycigndW5jbG9zZWQgc3RyaW5nJywgc3RyLCBjbG9zZVRhZy5pbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjdXJyZW50T2JqKSB7XHJcbiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGN1cnJlbnRPYmopO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgUGFyc2VFcnIoJ3VuY2xvc2VkIHRhZycsIHN0ciwgbS5pbmRleCArIHByZWNlZGluZ1N0cmluZy5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1c2hTdHJpbmcoc3RyLnNsaWNlKGxhc3RJbmRleCwgc3RyLmxlbmd0aCksIGZhbHNlKTtcclxuICAgIGlmIChjb25maWcucGx1Z2lucykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnLnBsdWdpbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBsdWdpbiA9IGNvbmZpZy5wbHVnaW5zW2ldO1xyXG4gICAgICAgICAgICBpZiAocGx1Z2luLnByb2Nlc3NBU1QpIHtcclxuICAgICAgICAgICAgICAgIGJ1ZmZlciA9IHBsdWdpbi5wcm9jZXNzQVNUKGJ1ZmZlciwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBidWZmZXI7XHJcbn1cblxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBDb21waWxlcyBhIHRlbXBsYXRlIHN0cmluZyB0byBhIGZ1bmN0aW9uIHN0cmluZy4gTW9zdCBvZnRlbiB1c2VycyBqdXN0IHVzZSBgY29tcGlsZSgpYCwgd2hpY2ggY2FsbHMgYGNvbXBpbGVUb1N0cmluZ2AgYW5kIGNyZWF0ZXMgYSBuZXcgZnVuY3Rpb24gdXNpbmcgdGhlIHJlc3VsdFxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBjb21waWxlVG9TdHJpbmcoXCJIaSA8JT0gaXQudXNlciAlPlwiLCBldGEuY29uZmlnKVxyXG4gKiAvLyBcInZhciB0Uj0nJyxpbmNsdWRlPUUuaW5jbHVkZS5iaW5kKEUpLGluY2x1ZGVGaWxlPUUuaW5jbHVkZUZpbGUuYmluZChFKTt0Uis9J0hpICc7dFIrPUUuZShpdC51c2VyKTtpZihjYil7Y2IobnVsbCx0Uil9IHJldHVybiB0UlwiXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gY29tcGlsZVRvU3RyaW5nKHN0ciwgY29uZmlnKSB7XHJcbiAgICB2YXIgYnVmZmVyID0gcGFyc2Uoc3RyLCBjb25maWcpO1xyXG4gICAgdmFyIHJlcyA9IFwidmFyIHRSPScnLF9fbCxfX2xQXCIgK1xyXG4gICAgICAgIChjb25maWcuaW5jbHVkZSA/ICcsaW5jbHVkZT1FLmluY2x1ZGUuYmluZChFKScgOiAnJykgK1xyXG4gICAgICAgIChjb25maWcuaW5jbHVkZUZpbGUgPyAnLGluY2x1ZGVGaWxlPUUuaW5jbHVkZUZpbGUuYmluZChFKScgOiAnJykgK1xyXG4gICAgICAgICdcXG5mdW5jdGlvbiBsYXlvdXQocCxkKXtfX2w9cDtfX2xQPWR9XFxuJyArXHJcbiAgICAgICAgKGNvbmZpZy51c2VXaXRoID8gJ3dpdGgoJyArIGNvbmZpZy52YXJOYW1lICsgJ3x8e30peycgOiAnJykgK1xyXG4gICAgICAgIGNvbXBpbGVTY29wZShidWZmZXIsIGNvbmZpZykgK1xyXG4gICAgICAgIChjb25maWcuaW5jbHVkZUZpbGVcclxuICAgICAgICAgICAgPyAnaWYoX19sKXRSPScgK1xyXG4gICAgICAgICAgICAgICAgKGNvbmZpZy5hc3luYyA/ICdhd2FpdCAnIDogJycpICtcclxuICAgICAgICAgICAgICAgIChcImluY2x1ZGVGaWxlKF9fbCxPYmplY3QuYXNzaWduKFwiICsgY29uZmlnLnZhck5hbWUgKyBcIix7Ym9keTp0Un0sX19sUCkpXFxuXCIpXHJcbiAgICAgICAgICAgIDogY29uZmlnLmluY2x1ZGVcclxuICAgICAgICAgICAgICAgID8gJ2lmKF9fbCl0Uj0nICtcclxuICAgICAgICAgICAgICAgICAgICAoY29uZmlnLmFzeW5jID8gJ2F3YWl0ICcgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgICAgIChcImluY2x1ZGUoX19sLE9iamVjdC5hc3NpZ24oXCIgKyBjb25maWcudmFyTmFtZSArIFwiLHtib2R5OnRSfSxfX2xQKSlcXG5cIilcclxuICAgICAgICAgICAgICAgIDogJycpICtcclxuICAgICAgICAnaWYoY2Ipe2NiKG51bGwsdFIpfSByZXR1cm4gdFInICtcclxuICAgICAgICAoY29uZmlnLnVzZVdpdGggPyAnfScgOiAnJyk7XHJcbiAgICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwbHVnaW4gPSBjb25maWcucGx1Z2luc1tpXTtcclxuICAgICAgICAgICAgaWYgKHBsdWdpbi5wcm9jZXNzRm5TdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgIHJlcyA9IHBsdWdpbi5wcm9jZXNzRm5TdHJpbmcocmVzLCBjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG4vKipcclxuICogTG9vcHMgdGhyb3VnaCB0aGUgQVNUIGdlbmVyYXRlZCBieSBgcGFyc2VgIGFuZCB0cmFuc2Zvcm0gZWFjaCBpdGVtIGludG8gSlMgY2FsbHNcclxuICpcclxuICogKipFeGFtcGxlKipcclxuICpcclxuICogYGBganNcclxuICogLy8gQVNUIHZlcnNpb24gb2YgJ0hpIDwlPSBpdC51c2VyICU+J1xyXG4gKiBsZXQgdGVtcGxhdGVBU1QgPSBbJ0hpICcsIHsgdmFsOiAnaXQudXNlcicsIHQ6ICdpJyB9XVxyXG4gKiBjb21waWxlU2NvcGUodGVtcGxhdGVBU1QsIGV0YS5jb25maWcpXHJcbiAqIC8vIFwidFIrPSdIaSAnO3RSKz1FLmUoaXQudXNlcik7XCJcclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjb21waWxlU2NvcGUoYnVmZiwgY29uZmlnKSB7XHJcbiAgICB2YXIgaSA9IDA7XHJcbiAgICB2YXIgYnVmZkxlbmd0aCA9IGJ1ZmYubGVuZ3RoO1xyXG4gICAgdmFyIHJldHVyblN0ciA9ICcnO1xyXG4gICAgZm9yIChpOyBpIDwgYnVmZkxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRCbG9jayA9IGJ1ZmZbaV07XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50QmxvY2sgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBjdXJyZW50QmxvY2s7XHJcbiAgICAgICAgICAgIC8vIHdlIGtub3cgc3RyaW5nIGV4aXN0c1xyXG4gICAgICAgICAgICByZXR1cm5TdHIgKz0gXCJ0Uis9J1wiICsgc3RyICsgXCInXFxuXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IGN1cnJlbnRCbG9jay50OyAvLyB+LCBzLCAhLCA/LCByXHJcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gY3VycmVudEJsb2NrLnZhbCB8fCAnJztcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdyJykge1xyXG4gICAgICAgICAgICAgICAgLy8gcmF3XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAnRS5maWx0ZXIoJyArIGNvbnRlbnQgKyAnKSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm5TdHIgKz0gJ3RSKz0nICsgY29udGVudCArICdcXG4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT09ICdpJykge1xyXG4gICAgICAgICAgICAgICAgLy8gaW50ZXJwb2xhdGVcclxuICAgICAgICAgICAgICAgIGlmIChjb25maWcuZmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9ICdFLmZpbHRlcignICsgY29udGVudCArICcpJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjb25maWcuYXV0b0VzY2FwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAnRS5lKCcgKyBjb250ZW50ICsgJyknO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuU3RyICs9ICd0Uis9JyArIGNvbnRlbnQgKyAnXFxuJztcclxuICAgICAgICAgICAgICAgIC8vIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT09ICdlJykge1xyXG4gICAgICAgICAgICAgICAgLy8gZXhlY3V0ZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuU3RyICs9IGNvbnRlbnQgKyAnXFxuJzsgLy8geW91IG5lZWQgYSBcXG4gaW4gY2FzZSB5b3UgaGF2ZSA8JSB9ICU+XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0dXJuU3RyO1xyXG59XG5cbi8qKlxyXG4gKiBIYW5kbGVzIHN0b3JhZ2UgYW5kIGFjY2Vzc2luZyBvZiB2YWx1ZXNcclxuICpcclxuICogSW4gdGhpcyBjYXNlLCB3ZSB1c2UgaXQgdG8gc3RvcmUgY29tcGlsZWQgdGVtcGxhdGUgZnVuY3Rpb25zXHJcbiAqIEluZGV4ZWQgYnkgdGhlaXIgYG5hbWVgIG9yIGBmaWxlbmFtZWBcclxuICovXHJcbnZhciBDYWNoZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDYWNoZXIoY2FjaGUpIHtcclxuICAgICAgICB0aGlzLmNhY2hlID0gY2FjaGU7XHJcbiAgICB9XHJcbiAgICBDYWNoZXIucHJvdG90eXBlLmRlZmluZSA9IGZ1bmN0aW9uIChrZXksIHZhbCkge1xyXG4gICAgICAgIHRoaXMuY2FjaGVba2V5XSA9IHZhbDtcclxuICAgIH07XHJcbiAgICBDYWNoZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAvLyBzdHJpbmcgfCBhcnJheS5cclxuICAgICAgICAvLyBUT0RPOiBhbGxvdyBhcnJheSBvZiBrZXlzIHRvIGxvb2sgZG93blxyXG4gICAgICAgIC8vIFRPRE86IGNyZWF0ZSBwbHVnaW4gdG8gYWxsb3cgcmVmZXJlbmNpbmcgaGVscGVycywgZmlsdGVycyB3aXRoIGRvdCBub3RhdGlvblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNhY2hlW2tleV07XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuY2FjaGVba2V5XTtcclxuICAgIH07XHJcbiAgICBDYWNoZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSB7fTtcclxuICAgIH07XHJcbiAgICBDYWNoZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoY2FjaGVPYmopIHtcclxuICAgICAgICBjb3B5UHJvcHModGhpcy5jYWNoZSwgY2FjaGVPYmopO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDYWNoZXI7XHJcbn0oKSk7XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogRXRhJ3MgdGVtcGxhdGUgc3RvcmFnZVxyXG4gKlxyXG4gKiBTdG9yZXMgcGFydGlhbHMgYW5kIGNhY2hlZCB0ZW1wbGF0ZXNcclxuICovXHJcbnZhciB0ZW1wbGF0ZXMgPSBuZXcgQ2FjaGVyKHt9KTtcblxuLyogRU5EIFRZUEVTICovXHJcbi8qKlxyXG4gKiBJbmNsdWRlIGEgdGVtcGxhdGUgYmFzZWQgb24gaXRzIG5hbWUgKG9yIGZpbGVwYXRoLCBpZiBpdCdzIGFscmVhZHkgYmVlbiBjYWNoZWQpLlxyXG4gKlxyXG4gKiBDYWxsZWQgbGlrZSBgaW5jbHVkZSh0ZW1wbGF0ZU5hbWVPclBhdGgsIGRhdGEpYFxyXG4gKi9cclxuZnVuY3Rpb24gaW5jbHVkZUhlbHBlcih0ZW1wbGF0ZU5hbWVPclBhdGgsIGRhdGEpIHtcclxuICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVzLmdldCh0ZW1wbGF0ZU5hbWVPclBhdGgpO1xyXG4gICAgaWYgKCF0ZW1wbGF0ZSkge1xyXG4gICAgICAgIHRocm93IEV0YUVycignQ291bGQgbm90IGZldGNoIHRlbXBsYXRlIFwiJyArIHRlbXBsYXRlTmFtZU9yUGF0aCArICdcIicpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRlbXBsYXRlKGRhdGEsIHRoaXMpO1xyXG59XHJcbi8qKiBFdGEncyBiYXNlIChnbG9iYWwpIGNvbmZpZ3VyYXRpb24gKi9cclxudmFyIGNvbmZpZyA9IHtcclxuICAgIGFzeW5jOiBmYWxzZSxcclxuICAgIGF1dG9Fc2NhcGU6IHRydWUsXHJcbiAgICBhdXRvVHJpbTogW2ZhbHNlLCAnbmwnXSxcclxuICAgIGNhY2hlOiBmYWxzZSxcclxuICAgIGU6IFhNTEVzY2FwZSxcclxuICAgIGluY2x1ZGU6IGluY2x1ZGVIZWxwZXIsXHJcbiAgICBwYXJzZToge1xyXG4gICAgICAgIGV4ZWM6ICcnLFxyXG4gICAgICAgIGludGVycG9sYXRlOiAnPScsXHJcbiAgICAgICAgcmF3OiAnfidcclxuICAgIH0sXHJcbiAgICBwbHVnaW5zOiBbXSxcclxuICAgIHJtV2hpdGVzcGFjZTogZmFsc2UsXHJcbiAgICB0YWdzOiBbJzwlJywgJyU+J10sXHJcbiAgICB0ZW1wbGF0ZXM6IHRlbXBsYXRlcyxcclxuICAgIHVzZVdpdGg6IGZhbHNlLFxyXG4gICAgdmFyTmFtZTogJ2l0J1xyXG59O1xyXG4vKipcclxuICogVGFrZXMgb25lIG9yIHR3byBwYXJ0aWFsIChub3QgbmVjZXNzYXJpbHkgY29tcGxldGUpIGNvbmZpZ3VyYXRpb24gb2JqZWN0cywgbWVyZ2VzIHRoZW0gMSBsYXllciBkZWVwIGludG8gZXRhLmNvbmZpZywgYW5kIHJldHVybnMgdGhlIHJlc3VsdFxyXG4gKlxyXG4gKiBAcGFyYW0gb3ZlcnJpZGUgUGFydGlhbCBjb25maWd1cmF0aW9uIG9iamVjdFxyXG4gKiBAcGFyYW0gYmFzZUNvbmZpZyBQYXJ0aWFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0IHRvIG1lcmdlIGJlZm9yZSBgb3ZlcnJpZGVgXHJcbiAqXHJcbiAqICoqRXhhbXBsZSoqXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGxldCBjdXN0b21Db25maWcgPSBnZXRDb25maWcoe3RhZ3M6IFsnISMnLCAnIyEnXX0pXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0Q29uZmlnKG92ZXJyaWRlLCBiYXNlQ29uZmlnKSB7XHJcbiAgICAvLyBUT0RPOiBydW4gbW9yZSB0ZXN0cyBvbiB0aGlzXHJcbiAgICB2YXIgcmVzID0ge307IC8vIExpbmtlZFxyXG4gICAgY29weVByb3BzKHJlcywgY29uZmlnKTsgLy8gQ3JlYXRlcyBkZWVwIGNsb25lIG9mIGV0YS5jb25maWcsIDEgbGF5ZXIgZGVlcFxyXG4gICAgaWYgKGJhc2VDb25maWcpIHtcclxuICAgICAgICBjb3B5UHJvcHMocmVzLCBiYXNlQ29uZmlnKTtcclxuICAgIH1cclxuICAgIGlmIChvdmVycmlkZSkge1xyXG4gICAgICAgIGNvcHlQcm9wcyhyZXMsIG92ZXJyaWRlKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuLyoqIFVwZGF0ZSBFdGEncyBiYXNlIGNvbmZpZyAqL1xyXG5mdW5jdGlvbiBjb25maWd1cmUob3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGNvcHlQcm9wcyhjb25maWcsIG9wdGlvbnMpO1xyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogVGFrZXMgYSB0ZW1wbGF0ZSBzdHJpbmcgYW5kIHJldHVybnMgYSB0ZW1wbGF0ZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgd2l0aCAoZGF0YSwgY29uZmlnLCBbY2JdKVxyXG4gKlxyXG4gKiBAcGFyYW0gc3RyIC0gVGhlIHRlbXBsYXRlIHN0cmluZ1xyXG4gKiBAcGFyYW0gY29uZmlnIC0gQSBjdXN0b20gY29uZmlndXJhdGlvbiBvYmplY3QgKG9wdGlvbmFsKVxyXG4gKlxyXG4gKiAqKkV4YW1wbGUqKlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBsZXQgY29tcGlsZWRGbiA9IGV0YS5jb21waWxlKFwiSGkgPCU9IGl0LnVzZXIgJT5cIilcclxuICogLy8gZnVuY3Rpb24gYW5vbnltb3VzKClcclxuICogbGV0IGNvbXBpbGVkRm5TdHIgPSBjb21waWxlZEZuLnRvU3RyaW5nKClcclxuICogLy8gXCJmdW5jdGlvbiBhbm9ueW1vdXMoaXQsRSxjYlxcbikge1xcbnZhciB0Uj0nJyxpbmNsdWRlPUUuaW5jbHVkZS5iaW5kKEUpLGluY2x1ZGVGaWxlPUUuaW5jbHVkZUZpbGUuYmluZChFKTt0Uis9J0hpICc7dFIrPUUuZShpdC51c2VyKTtpZihjYil7Y2IobnVsbCx0Uil9IHJldHVybiB0Ulxcbn1cIlxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGUoc3RyLCBjb25maWcpIHtcclxuICAgIHZhciBvcHRpb25zID0gZ2V0Q29uZmlnKGNvbmZpZyB8fCB7fSk7XHJcbiAgICAvKiBBU1lOQyBIQU5ETElORyAqL1xyXG4gICAgLy8gVGhlIGJlbG93IGNvZGUgaXMgbW9kaWZpZWQgZnJvbSBtZGUvZWpzLiBBbGwgY3JlZGl0IHNob3VsZCBnbyB0byB0aGVtLlxyXG4gICAgdmFyIGN0b3IgPSBvcHRpb25zLmFzeW5jID8gZ2V0QXN5bmNGdW5jdGlvbkNvbnN0cnVjdG9yKCkgOiBGdW5jdGlvbjtcclxuICAgIC8qIEVORCBBU1lOQyBIQU5ETElORyAqL1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gbmV3IGN0b3Iob3B0aW9ucy52YXJOYW1lLCAnRScsIC8vIEV0YUNvbmZpZ1xyXG4gICAgICAgICdjYicsIC8vIG9wdGlvbmFsIGNhbGxiYWNrXHJcbiAgICAgICAgY29tcGlsZVRvU3RyaW5nKHN0ciwgb3B0aW9ucykpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldy1mdW5jXHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXRhRXJyKCdCYWQgdGVtcGxhdGUgc3ludGF4XFxuXFxuJyArXHJcbiAgICAgICAgICAgICAgICBlLm1lc3NhZ2UgK1xyXG4gICAgICAgICAgICAgICAgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgQXJyYXkoZS5tZXNzYWdlLmxlbmd0aCArIDEpLmpvaW4oJz0nKSArXHJcbiAgICAgICAgICAgICAgICAnXFxuJyArXHJcbiAgICAgICAgICAgICAgICBjb21waWxlVG9TdHJpbmcoc3RyLCBvcHRpb25zKSArXHJcbiAgICAgICAgICAgICAgICAnXFxuJyAvLyBUaGlzIHdpbGwgcHV0IGFuIGV4dHJhIG5ld2xpbmUgYmVmb3JlIHRoZSBjYWxsc3RhY2sgZm9yIGV4dHJhIHJlYWRhYmlsaXR5XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG52YXIgX0JPTSA9IC9eXFx1RkVGRi87XHJcbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogR2V0IHRoZSBwYXRoIHRvIHRoZSBpbmNsdWRlZCBmaWxlIGZyb20gdGhlIHBhcmVudCBmaWxlIHBhdGggYW5kIHRoZVxyXG4gKiBzcGVjaWZpZWQgcGF0aC5cclxuICpcclxuICogSWYgYG5hbWVgIGRvZXMgbm90IGhhdmUgYW4gZXh0ZW5zaW9uLCBpdCB3aWxsIGRlZmF1bHQgdG8gYC5ldGFgXHJcbiAqXHJcbiAqIEBwYXJhbSBuYW1lIHNwZWNpZmllZCBwYXRoXHJcbiAqIEBwYXJhbSBwYXJlbnRmaWxlIHBhcmVudCBmaWxlIHBhdGhcclxuICogQHBhcmFtIGlzRGlyZWN0b3J5IHdoZXRoZXIgcGFyZW50ZmlsZSBpcyBhIGRpcmVjdG9yeVxyXG4gKiBAcmV0dXJuIGFic29sdXRlIHBhdGggdG8gdGVtcGxhdGVcclxuICovXHJcbmZ1bmN0aW9uIGdldFdob2xlRmlsZVBhdGgobmFtZSwgcGFyZW50ZmlsZSwgaXNEaXJlY3RvcnkpIHtcclxuICAgIHZhciBpbmNsdWRlUGF0aCA9IHJlc29sdmUoaXNEaXJlY3RvcnkgPyBwYXJlbnRmaWxlIDogZGlybmFtZShwYXJlbnRmaWxlKSwgLy8gcmV0dXJucyBkaXJlY3RvcnkgdGhlIHBhcmVudCBmaWxlIGlzIGluXHJcbiAgICBuYW1lIC8vIGZpbGVcclxuICAgICkgKyAoZXh0bmFtZShuYW1lKSA/ICcnIDogJy5ldGEnKTtcclxuICAgIHJldHVybiBpbmNsdWRlUGF0aDtcclxufVxyXG4vKipcclxuICogR2V0IHRoZSBhYnNvbHV0ZSBwYXRoIHRvIGFuIGluY2x1ZGVkIHRlbXBsYXRlXHJcbiAqXHJcbiAqIElmIHRoaXMgaXMgY2FsbGVkIHdpdGggYW4gYWJzb2x1dGUgcGF0aCAoZm9yIGV4YW1wbGUsIHN0YXJ0aW5nIHdpdGggJy8nIG9yICdDOlxcJylcclxuICogdGhlbiBFdGEgd2lsbCBhdHRlbXB0IHRvIHJlc29sdmUgdGhlIGFic29sdXRlIHBhdGggd2l0aGluIG9wdGlvbnMudmlld3MuIElmIGl0IGNhbm5vdCxcclxuICogRXRhIHdpbGwgZmFsbGJhY2sgdG8gb3B0aW9ucy5yb290IG9yICcvJ1xyXG4gKlxyXG4gKiBJZiB0aGlzIGlzIGNhbGxlZCB3aXRoIGEgcmVsYXRpdmUgcGF0aCwgRXRhIHdpbGw6XHJcbiAqIC0gTG9vayByZWxhdGl2ZSB0byB0aGUgY3VycmVudCB0ZW1wbGF0ZSAoaWYgdGhlIGN1cnJlbnQgdGVtcGxhdGUgaGFzIHRoZSBgZmlsZW5hbWVgIHByb3BlcnR5KVxyXG4gKiAtIExvb2sgaW5zaWRlIGVhY2ggZGlyZWN0b3J5IGluIG9wdGlvbnMudmlld3NcclxuICpcclxuICogTm90ZTogaWYgRXRhIGlzIHVuYWJsZSB0byBmaW5kIGEgdGVtcGxhdGUgdXNpbmcgcGF0aCBhbmQgb3B0aW9ucywgaXQgd2lsbCB0aHJvdyBhbiBlcnJvci5cclxuICpcclxuICogQHBhcmFtIHBhdGggICAgc3BlY2lmaWVkIHBhdGhcclxuICogQHBhcmFtIG9wdGlvbnMgY29tcGlsYXRpb24gb3B0aW9uc1xyXG4gKiBAcmV0dXJuIGFic29sdXRlIHBhdGggdG8gdGVtcGxhdGVcclxuICovXHJcbmZ1bmN0aW9uIGdldFBhdGgocGF0aCwgb3B0aW9ucykge1xyXG4gICAgdmFyIGluY2x1ZGVQYXRoID0gZmFsc2U7XHJcbiAgICB2YXIgdmlld3MgPSBvcHRpb25zLnZpZXdzO1xyXG4gICAgdmFyIHNlYXJjaGVkUGF0aHMgPSBbXTtcclxuICAgIC8vIElmIHRoZXNlIGZvdXIgdmFsdWVzIGFyZSB0aGUgc2FtZSxcclxuICAgIC8vIGdldFBhdGgoKSB3aWxsIHJldHVybiB0aGUgc2FtZSByZXN1bHQgZXZlcnkgdGltZS5cclxuICAgIC8vIFdlIGNhbiBjYWNoZSB0aGUgcmVzdWx0IHRvIGF2b2lkIGV4cGVuc2l2ZVxyXG4gICAgLy8gZmlsZSBvcGVyYXRpb25zLlxyXG4gICAgdmFyIHBhdGhPcHRpb25zID0gSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGZpbGVuYW1lOiBvcHRpb25zLmZpbGVuYW1lLFxyXG4gICAgICAgIHBhdGg6IHBhdGgsXHJcbiAgICAgICAgcm9vdDogb3B0aW9ucy5yb290LFxyXG4gICAgICAgIHZpZXdzOiBvcHRpb25zLnZpZXdzXHJcbiAgICB9KTtcclxuICAgIGlmIChvcHRpb25zLmNhY2hlICYmIG9wdGlvbnMuZmlsZXBhdGhDYWNoZSAmJiBvcHRpb25zLmZpbGVwYXRoQ2FjaGVbcGF0aE9wdGlvbnNdKSB7XHJcbiAgICAgICAgLy8gVXNlIHRoZSBjYWNoZWQgZmlsZXBhdGhcclxuICAgICAgICByZXR1cm4gb3B0aW9ucy5maWxlcGF0aENhY2hlW3BhdGhPcHRpb25zXTtcclxuICAgIH1cclxuICAgIC8qKiBBZGQgYSBmaWxlcGF0aCB0byB0aGUgbGlzdCBvZiBwYXRocyB3ZSd2ZSBjaGVja2VkIGZvciBhIHRlbXBsYXRlICovXHJcbiAgICBmdW5jdGlvbiBhZGRQYXRoVG9TZWFyY2hlZChwYXRoU2VhcmNoZWQpIHtcclxuICAgICAgICBpZiAoIXNlYXJjaGVkUGF0aHMuaW5jbHVkZXMocGF0aFNlYXJjaGVkKSkge1xyXG4gICAgICAgICAgICBzZWFyY2hlZFBhdGhzLnB1c2gocGF0aFNlYXJjaGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRha2UgYSBmaWxlcGF0aCAobGlrZSAncGFydGlhbHMvbXlwYXJ0aWFsLmV0YScpLiBBdHRlbXB0IHRvIGZpbmQgdGhlIHRlbXBsYXRlIGZpbGUgaW5zaWRlIGB2aWV3c2A7XHJcbiAgICAgKiByZXR1cm4gdGhlIHJlc3VsdGluZyB0ZW1wbGF0ZSBmaWxlIHBhdGgsIG9yIGBmYWxzZWAgdG8gaW5kaWNhdGUgdGhhdCB0aGUgdGVtcGxhdGUgd2FzIG5vdCBmb3VuZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdmlld3MgdGhlIGZpbGVwYXRoIHRoYXQgaG9sZHMgdGVtcGxhdGVzLCBvciBhbiBhcnJheSBvZiBmaWxlcGF0aHMgdGhhdCBob2xkIHRlbXBsYXRlc1xyXG4gICAgICogQHBhcmFtIHBhdGggdGhlIHBhdGggdG8gdGhlIHRlbXBsYXRlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHNlYXJjaFZpZXdzKHZpZXdzLCBwYXRoKSB7XHJcbiAgICAgICAgdmFyIGZpbGVQYXRoO1xyXG4gICAgICAgIC8vIElmIHZpZXdzIGlzIGFuIGFycmF5LCB0aGVuIGxvb3AgdGhyb3VnaCBlYWNoIGRpcmVjdG9yeVxyXG4gICAgICAgIC8vIEFuZCBhdHRlbXB0IHRvIGZpbmQgdGhlIHRlbXBsYXRlXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmlld3MpICYmXHJcbiAgICAgICAgICAgIHZpZXdzLnNvbWUoZnVuY3Rpb24gKHYpIHtcclxuICAgICAgICAgICAgICAgIGZpbGVQYXRoID0gZ2V0V2hvbGVGaWxlUGF0aChwYXRoLCB2LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGFkZFBhdGhUb1NlYXJjaGVkKGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBleGlzdHNTeW5jKGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgfSkpIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIGFib3ZlIHJldHVybmVkIHRydWUsIHdlIGtub3cgdGhhdCB0aGUgZmlsZVBhdGggd2FzIGp1c3Qgc2V0IHRvIGEgcGF0aFxyXG4gICAgICAgICAgICAvLyBUaGF0IGV4aXN0cyAoQXJyYXkuc29tZSgpIHJldHVybnMgYXMgc29vbiBhcyBpdCBmaW5kcyBhIHZhbGlkIGVsZW1lbnQpXHJcbiAgICAgICAgICAgIHJldHVybiBmaWxlUGF0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZpZXdzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAvLyBTZWFyY2ggZm9yIHRoZSBmaWxlIGlmIHZpZXdzIGlzIGEgc2luZ2xlIGRpcmVjdG9yeVxyXG4gICAgICAgICAgICBmaWxlUGF0aCA9IGdldFdob2xlRmlsZVBhdGgocGF0aCwgdmlld3MsIHRydWUpO1xyXG4gICAgICAgICAgICBhZGRQYXRoVG9TZWFyY2hlZChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIGlmIChleGlzdHNTeW5jKGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFVuYWJsZSB0byBmaW5kIGEgZmlsZVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIFBhdGggc3RhcnRzIHdpdGggJy8nLCAnQzpcXCcsIGV0Yy5cclxuICAgIHZhciBtYXRjaCA9IC9eW0EtWmEtel0rOlxcXFx8XlxcLy8uZXhlYyhwYXRoKTtcclxuICAgIC8vIEFic29sdXRlIHBhdGgsIGxpa2UgL3BhcnRpYWxzL3BhcnRpYWwuZXRhXHJcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2gubGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gV2UgaGF2ZSB0byB0cmltIHRoZSBiZWdpbm5pbmcgJy8nIG9mZiB0aGUgcGF0aCwgb3IgZWxzZVxyXG4gICAgICAgIC8vIHBhdGgucmVzb2x2ZShkaXIsIHBhdGgpIHdpbGwgYWx3YXlzIHJlc29sdmUgdG8ganVzdCBwYXRoXHJcbiAgICAgICAgdmFyIGZvcm1hdHRlZFBhdGggPSBwYXRoLnJlcGxhY2UoL15cXC8qLywgJycpO1xyXG4gICAgICAgIC8vIEZpcnN0LCB0cnkgdG8gcmVzb2x2ZSB0aGUgcGF0aCB3aXRoaW4gb3B0aW9ucy52aWV3c1xyXG4gICAgICAgIGluY2x1ZGVQYXRoID0gc2VhcmNoVmlld3Modmlld3MsIGZvcm1hdHRlZFBhdGgpO1xyXG4gICAgICAgIGlmICghaW5jbHVkZVBhdGgpIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhhdCBmYWlscywgc2VhcmNoVmlld3Mgd2lsbCByZXR1cm4gZmFsc2UuIFRyeSB0byBmaW5kIHRoZSBwYXRoXHJcbiAgICAgICAgICAgIC8vIGluc2lkZSBvcHRpb25zLnJvb3QgKGJ5IGRlZmF1bHQgJy8nLCB0aGUgYmFzZSBvZiB0aGUgZmlsZXN5c3RlbSlcclxuICAgICAgICAgICAgdmFyIHBhdGhGcm9tUm9vdCA9IGdldFdob2xlRmlsZVBhdGgoZm9ybWF0dGVkUGF0aCwgb3B0aW9ucy5yb290IHx8ICcvJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGFkZFBhdGhUb1NlYXJjaGVkKHBhdGhGcm9tUm9vdCk7XHJcbiAgICAgICAgICAgIGluY2x1ZGVQYXRoID0gcGF0aEZyb21Sb290O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIFJlbGF0aXZlIHBhdGhzXHJcbiAgICAgICAgLy8gTG9vayByZWxhdGl2ZSB0byBhIHBhc3NlZCBmaWxlbmFtZSBmaXJzdFxyXG4gICAgICAgIGlmIChvcHRpb25zLmZpbGVuYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlUGF0aCA9IGdldFdob2xlRmlsZVBhdGgocGF0aCwgb3B0aW9ucy5maWxlbmFtZSk7XHJcbiAgICAgICAgICAgIGFkZFBhdGhUb1NlYXJjaGVkKGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgaWYgKGV4aXN0c1N5bmMoZmlsZVBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlUGF0aCA9IGZpbGVQYXRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoZW4gbG9vayBmb3IgdGhlIHRlbXBsYXRlIGluIG9wdGlvbnMudmlld3NcclxuICAgICAgICBpZiAoIWluY2x1ZGVQYXRoKSB7XHJcbiAgICAgICAgICAgIGluY2x1ZGVQYXRoID0gc2VhcmNoVmlld3Modmlld3MsIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWluY2x1ZGVQYXRoKSB7XHJcbiAgICAgICAgICAgIHRocm93IEV0YUVycignQ291bGQgbm90IGZpbmQgdGhlIHRlbXBsYXRlIFwiJyArIHBhdGggKyAnXCIuIFBhdGhzIHRyaWVkOiAnICsgc2VhcmNoZWRQYXRocyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gSWYgY2FjaGluZyBhbmQgZmlsZXBhdGhDYWNoZSBhcmUgZW5hYmxlZCxcclxuICAgIC8vIGNhY2hlIHRoZSBpbnB1dCAmIG91dHB1dCBvZiB0aGlzIGZ1bmN0aW9uLlxyXG4gICAgaWYgKG9wdGlvbnMuY2FjaGUgJiYgb3B0aW9ucy5maWxlcGF0aENhY2hlKSB7XHJcbiAgICAgICAgb3B0aW9ucy5maWxlcGF0aENhY2hlW3BhdGhPcHRpb25zXSA9IGluY2x1ZGVQYXRoO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGluY2x1ZGVQYXRoO1xyXG59XHJcbi8qKlxyXG4gKiBSZWFkcyBhIGZpbGUgc3luY2hyb25vdXNseVxyXG4gKi9cclxuZnVuY3Rpb24gcmVhZEZpbGUoZmlsZVBhdGgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIHJlYWRGaWxlU3luYyhmaWxlUGF0aCkudG9TdHJpbmcoKS5yZXBsYWNlKF9CT00sICcnKTsgLy8gVE9ETzogaXMgcmVwbGFjaW5nIEJPTSdzIG5lY2Vzc2FyeT9cclxuICAgIH1cclxuICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgIHRocm93IEV0YUVycihcIkZhaWxlZCB0byByZWFkIHRlbXBsYXRlIGF0ICdcIiArIGZpbGVQYXRoICsgXCInXCIpO1xyXG4gICAgfVxyXG59XG5cbi8vIGV4cHJlc3MgaXMgc2V0IGxpa2U6IGFwcC5lbmdpbmUoJ2h0bWwnLCByZXF1aXJlKCdldGEnKS5yZW5kZXJGaWxlKVxyXG4vKiBFTkQgVFlQRVMgKi9cclxuLyoqXHJcbiAqIFJlYWRzIGEgdGVtcGxhdGUsIGNvbXBpbGVzIGl0IGludG8gYSBmdW5jdGlvbiwgY2FjaGVzIGl0IGlmIGNhY2hpbmcgaXNuJ3QgZGlzYWJsZWQsIHJldHVybnMgdGhlIGZ1bmN0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSBmaWxlUGF0aCBBYnNvbHV0ZSBwYXRoIHRvIHRlbXBsYXRlIGZpbGVcclxuICogQHBhcmFtIG9wdGlvbnMgRXRhIGNvbmZpZ3VyYXRpb24gb3ZlcnJpZGVzXHJcbiAqIEBwYXJhbSBub0NhY2hlIE9wdGlvbmFsbHksIG1ha2UgRXRhIG5vdCBjYWNoZSB0aGUgdGVtcGxhdGVcclxuICovXHJcbmZ1bmN0aW9uIGxvYWRGaWxlKGZpbGVQYXRoLCBvcHRpb25zLCBub0NhY2hlKSB7XHJcbiAgICB2YXIgY29uZmlnID0gZ2V0Q29uZmlnKG9wdGlvbnMpO1xyXG4gICAgdmFyIHRlbXBsYXRlID0gcmVhZEZpbGUoZmlsZVBhdGgpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgY29tcGlsZWRUZW1wbGF0ZSA9IGNvbXBpbGUodGVtcGxhdGUsIGNvbmZpZyk7XHJcbiAgICAgICAgaWYgKCFub0NhY2hlKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy50ZW1wbGF0ZXMuZGVmaW5lKGNvbmZpZy5maWxlbmFtZSwgY29tcGlsZWRUZW1wbGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb21waWxlZFRlbXBsYXRlO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBFdGFFcnIoJ0xvYWRpbmcgZmlsZTogJyArIGZpbGVQYXRoICsgJyBmYWlsZWQ6XFxuXFxuJyArIGUubWVzc2FnZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEdldCB0aGUgdGVtcGxhdGUgZnJvbSBhIHN0cmluZyBvciBhIGZpbGUsIGVpdGhlciBjb21waWxlZCBvbi10aGUtZmx5IG9yXHJcbiAqIHJlYWQgZnJvbSBjYWNoZSAoaWYgZW5hYmxlZCksIGFuZCBjYWNoZSB0aGUgdGVtcGxhdGUgaWYgbmVlZGVkLlxyXG4gKlxyXG4gKiBJZiBgb3B0aW9ucy5jYWNoZWAgaXMgdHJ1ZSwgdGhpcyBmdW5jdGlvbiByZWFkcyB0aGUgZmlsZSBmcm9tXHJcbiAqIGBvcHRpb25zLmZpbGVuYW1lYCBzbyBpdCBtdXN0IGJlIHNldCBwcmlvciB0byBjYWxsaW5nIHRoaXMgZnVuY3Rpb24uXHJcbiAqXHJcbiAqIEBwYXJhbSBvcHRpb25zICAgY29tcGlsYXRpb24gb3B0aW9uc1xyXG4gKiBAcmV0dXJuIEV0YSB0ZW1wbGF0ZSBmdW5jdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlQ2FjaGUob3B0aW9ucykge1xyXG4gICAgdmFyIGZpbGVuYW1lID0gb3B0aW9ucy5maWxlbmFtZTtcclxuICAgIGlmIChvcHRpb25zLmNhY2hlKSB7XHJcbiAgICAgICAgdmFyIGZ1bmMgPSBvcHRpb25zLnRlbXBsYXRlcy5nZXQoZmlsZW5hbWUpO1xyXG4gICAgICAgIGlmIChmdW5jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbG9hZEZpbGUoZmlsZW5hbWUsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgLy8gQ2FjaGluZyBpcyBkaXNhYmxlZCwgc28gcGFzcyBub0NhY2hlID0gdHJ1ZVxyXG4gICAgcmV0dXJuIGxvYWRGaWxlKGZpbGVuYW1lLCBvcHRpb25zLCB0cnVlKTtcclxufVxyXG4vKipcclxuICogVHJ5IGNhbGxpbmcgaGFuZGxlQ2FjaGUgd2l0aCB0aGUgZ2l2ZW4gb3B0aW9ucyBhbmQgZGF0YSBhbmQgY2FsbCB0aGVcclxuICogY2FsbGJhY2sgd2l0aCB0aGUgcmVzdWx0LiBJZiBhbiBlcnJvciBvY2N1cnMsIGNhbGwgdGhlIGNhbGxiYWNrIHdpdGhcclxuICogdGhlIGVycm9yLiBVc2VkIGJ5IHJlbmRlckZpbGUoKS5cclxuICpcclxuICogQHBhcmFtIGRhdGEgdGVtcGxhdGUgZGF0YVxyXG4gKiBAcGFyYW0gb3B0aW9ucyBjb21waWxhdGlvbiBvcHRpb25zXHJcbiAqIEBwYXJhbSBjYiBjYWxsYmFja1xyXG4gKi9cclxuZnVuY3Rpb24gdHJ5SGFuZGxlQ2FjaGUoZGF0YSwgb3B0aW9ucywgY2IpIHtcclxuICAgIGlmIChjYikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIE5vdGU6IGlmIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIHJlbmRlcmluZyB0aGUgdGVtcGxhdGUsXHJcbiAgICAgICAgICAgIC8vIEl0IHdpbGwgYnViYmxlIHVwIGFuZCBiZSBjYXVnaHQgaGVyZVxyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVGbiA9IGhhbmRsZUNhY2hlKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZUZuKGRhdGEsIG9wdGlvbnMsIGNiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICByZXR1cm4gY2IoZXJyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBObyBjYWxsYmFjaywgdHJ5IHJldHVybmluZyBhIHByb21pc2VcclxuICAgICAgICBpZiAodHlwZW9mIHByb21pc2VJbXBsID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgcHJvbWlzZUltcGwoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVGbiA9IGhhbmRsZUNhY2hlKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB0ZW1wbGF0ZUZuKGRhdGEsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFdGFFcnIoXCJQbGVhc2UgcHJvdmlkZSBhIGNhbGxiYWNrIGZ1bmN0aW9uLCB0aGlzIGVudiBkb2Vzbid0IHN1cHBvcnQgUHJvbWlzZXNcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBHZXQgdGhlIHRlbXBsYXRlIGZ1bmN0aW9uLlxyXG4gKlxyXG4gKiBJZiBgb3B0aW9ucy5jYWNoZWAgaXMgYHRydWVgLCB0aGVuIHRoZSB0ZW1wbGF0ZSBpcyBjYWNoZWQuXHJcbiAqXHJcbiAqIFRoaXMgcmV0dXJucyBhIHRlbXBsYXRlIGZ1bmN0aW9uIGFuZCB0aGUgY29uZmlnIG9iamVjdCB3aXRoIHdoaWNoIHRoYXQgdGVtcGxhdGUgZnVuY3Rpb24gc2hvdWxkIGJlIGNhbGxlZC5cclxuICpcclxuICogQHJlbWFya3NcclxuICpcclxuICogSXQncyBpbXBvcnRhbnQgdGhhdCB0aGlzIHJldHVybnMgYSBjb25maWcgb2JqZWN0IHdpdGggYGZpbGVuYW1lYCBzZXQuXHJcbiAqIE90aGVyd2lzZSwgdGhlIGluY2x1ZGVkIGZpbGUgd291bGQgbm90IGJlIGFibGUgdG8gdXNlIHJlbGF0aXZlIHBhdGhzXHJcbiAqXHJcbiAqIEBwYXJhbSBwYXRoIHBhdGggZm9yIHRoZSBzcGVjaWZpZWQgZmlsZSAoaWYgcmVsYXRpdmUsIHNwZWNpZnkgYHZpZXdzYCBvbiBgb3B0aW9uc2ApXHJcbiAqIEBwYXJhbSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnNcclxuICogQHJldHVybiBbRXRhIHRlbXBsYXRlIGZ1bmN0aW9uLCBuZXcgY29uZmlnIG9iamVjdF1cclxuICovXHJcbmZ1bmN0aW9uIGluY2x1ZGVGaWxlKHBhdGgsIG9wdGlvbnMpIHtcclxuICAgIC8vIHRoZSBiZWxvdyBjcmVhdGVzIGEgbmV3IG9wdGlvbnMgb2JqZWN0LCB1c2luZyB0aGUgcGFyZW50IGZpbGVwYXRoIG9mIHRoZSBvbGQgb3B0aW9ucyBvYmplY3QgYW5kIHRoZSBwYXRoXHJcbiAgICB2YXIgbmV3RmlsZU9wdGlvbnMgPSBnZXRDb25maWcoeyBmaWxlbmFtZTogZ2V0UGF0aChwYXRoLCBvcHRpb25zKSB9LCBvcHRpb25zKTtcclxuICAgIC8vIFRPRE86IG1ha2Ugc3VyZSBwcm9wZXJ0aWVzIGFyZSBjdXJyZWN0bHkgY29waWVkIG92ZXJcclxuICAgIHJldHVybiBbaGFuZGxlQ2FjaGUobmV3RmlsZU9wdGlvbnMpLCBuZXdGaWxlT3B0aW9uc107XHJcbn1cclxuZnVuY3Rpb24gcmVuZGVyRmlsZShmaWxlbmFtZSwgZGF0YSwgY29uZmlnLCBjYikge1xyXG4gICAgLypcclxuICAgIEhlcmUgd2UgaGF2ZSBzb21lIGZ1bmN0aW9uIG92ZXJsb2FkaW5nLlxyXG4gICAgRXNzZW50aWFsbHksIHRoZSBmaXJzdCAyIGFyZ3VtZW50cyB0byByZW5kZXJGaWxlIHNob3VsZCBhbHdheXMgYmUgdGhlIGZpbGVuYW1lIGFuZCBkYXRhXHJcbiAgICBIb3dldmVyLCB3aXRoIEV4cHJlc3MsIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyB3aWxsIGJlIHBhc3NlZCBhbG9uZyB3aXRoIHRoZSBkYXRhLlxyXG4gICAgVGh1cywgRXhwcmVzcyB3aWxsIGNhbGwgcmVuZGVyRmlsZSB3aXRoIChmaWxlbmFtZSwgZGF0YUFuZE9wdGlvbnMsIGNiKVxyXG4gICAgQW5kIHdlIHdhbnQgdG8gYWxzbyBtYWtlIChmaWxlbmFtZSwgZGF0YSwgb3B0aW9ucywgY2IpIGF2YWlsYWJsZVxyXG4gICAgKi9cclxuICAgIHZhciByZW5kZXJDb25maWc7XHJcbiAgICB2YXIgY2FsbGJhY2s7XHJcbiAgICBkYXRhID0gZGF0YSB8fCB7fTsgLy8gSWYgZGF0YSBpcyB1bmRlZmluZWQsIHdlIGRvbid0IHdhbnQgYWNjZXNzaW5nIGRhdGEuc2V0dGluZ3MgdG8gZXJyb3JcclxuICAgIC8vIEZpcnN0LCBhc3NpZ24gb3VyIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGBjYWxsYmFja2BcclxuICAgIC8vIFdlIGNhbiBsZWF2ZSBpdCB1bmRlZmluZWQgaWYgbmVpdGhlciBwYXJhbWV0ZXIgaXMgYSBmdW5jdGlvbjtcclxuICAgIC8vIENhbGxiYWNrcyBhcmUgb3B0aW9uYWxcclxuICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAvLyBUaGUgNHRoIGFyZ3VtZW50IGlzIHRoZSBjYWxsYmFja1xyXG4gICAgICAgIGNhbGxiYWNrID0gY2I7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgY29uZmlnID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgLy8gVGhlIDNyZCBhcmcgaXMgdGhlIGNhbGxiYWNrXHJcbiAgICAgICAgY2FsbGJhY2sgPSBjb25maWc7XHJcbiAgICB9XHJcbiAgICAvLyBJZiB0aGVyZSBpcyBhIGNvbmZpZyBvYmplY3QgcGFzc2VkIGluIGV4cGxpY2l0bHksIHVzZSBpdFxyXG4gICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgcmVuZGVyQ29uZmlnID0gZ2V0Q29uZmlnKGNvbmZpZyB8fCB7fSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBPdGhlcndpc2UsIGdldCB0aGUgY29uZmlnIGZyb20gdGhlIGRhdGEgb2JqZWN0XHJcbiAgICAgICAgLy8gQW5kIHRoZW4gZ3JhYiBzb21lIGNvbmZpZyBvcHRpb25zIGZyb20gZGF0YS5zZXR0aW5nc1xyXG4gICAgICAgIC8vIFdoaWNoIGlzIHdoZXJlIEV4cHJlc3Mgc29tZXRpbWVzIHN0b3JlcyB0aGVtXHJcbiAgICAgICAgcmVuZGVyQ29uZmlnID0gZ2V0Q29uZmlnKGRhdGEpO1xyXG4gICAgICAgIGlmIChkYXRhLnNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIC8vIFB1bGwgYSBmZXcgdGhpbmdzIGZyb20ga25vd24gbG9jYXRpb25zXHJcbiAgICAgICAgICAgIGlmIChkYXRhLnNldHRpbmdzLnZpZXdzKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJDb25maWcudmlld3MgPSBkYXRhLnNldHRpbmdzLnZpZXdzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnNldHRpbmdzWyd2aWV3IGNhY2hlJ10pIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlckNvbmZpZy5jYWNoZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVW5kb2N1bWVudGVkIGFmdGVyIEV4cHJlc3MgMiwgYnV0IHN0aWxsIHVzYWJsZSwgZXNwLiBmb3JcclxuICAgICAgICAgICAgLy8gaXRlbXMgdGhhdCBhcmUgdW5zYWZlIHRvIGJlIHBhc3NlZCBhbG9uZyB3aXRoIGRhdGEsIGxpa2UgYHJvb3RgXHJcbiAgICAgICAgICAgIHZhciB2aWV3T3B0cyA9IGRhdGEuc2V0dGluZ3NbJ3ZpZXcgb3B0aW9ucyddO1xyXG4gICAgICAgICAgICBpZiAodmlld09wdHMpIHtcclxuICAgICAgICAgICAgICAgIGNvcHlQcm9wcyhyZW5kZXJDb25maWcsIHZpZXdPcHRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIFNldCB0aGUgZmlsZW5hbWUgb3B0aW9uIG9uIHRoZSB0ZW1wbGF0ZVxyXG4gICAgLy8gVGhpcyB3aWxsIGZpcnN0IHRyeSB0byByZXNvbHZlIHRoZSBmaWxlIHBhdGggKHNlZSBnZXRQYXRoIGZvciBkZXRhaWxzKVxyXG4gICAgcmVuZGVyQ29uZmlnLmZpbGVuYW1lID0gZ2V0UGF0aChmaWxlbmFtZSwgcmVuZGVyQ29uZmlnKTtcclxuICAgIHJldHVybiB0cnlIYW5kbGVDYWNoZShkYXRhLCByZW5kZXJDb25maWcsIGNhbGxiYWNrKTtcclxufVxyXG5mdW5jdGlvbiByZW5kZXJGaWxlQXN5bmMoZmlsZW5hbWUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIHJldHVybiByZW5kZXJGaWxlKGZpbGVuYW1lLCB0eXBlb2YgY29uZmlnID09PSAnZnVuY3Rpb24nID8gX19hc3NpZ24oX19hc3NpZ24oe30sIGRhdGEpLCB7IGFzeW5jOiB0cnVlIH0pIDogZGF0YSwgdHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcgPyBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgY29uZmlnKSwgeyBhc3luYzogdHJ1ZSB9KSA6IGNvbmZpZywgY2IpO1xyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG4vKipcclxuICogQ2FsbGVkIHdpdGggYGluY2x1ZGVGaWxlKHBhdGgsIGRhdGEpYFxyXG4gKi9cclxuZnVuY3Rpb24gaW5jbHVkZUZpbGVIZWxwZXIocGF0aCwgZGF0YSkge1xyXG4gICAgdmFyIHRlbXBsYXRlQW5kQ29uZmlnID0gaW5jbHVkZUZpbGUocGF0aCwgdGhpcyk7XHJcbiAgICByZXR1cm4gdGVtcGxhdGVBbmRDb25maWdbMF0oZGF0YSwgdGVtcGxhdGVBbmRDb25maWdbMV0pO1xyXG59XG5cbi8qIEVORCBUWVBFUyAqL1xyXG5mdW5jdGlvbiBoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0aW9ucy5jYWNoZSAmJiBvcHRpb25zLm5hbWUgJiYgb3B0aW9ucy50ZW1wbGF0ZXMuZ2V0KG9wdGlvbnMubmFtZSkpIHtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucy50ZW1wbGF0ZXMuZ2V0KG9wdGlvbnMubmFtZSk7XHJcbiAgICB9XHJcbiAgICB2YXIgdGVtcGxhdGVGdW5jID0gdHlwZW9mIHRlbXBsYXRlID09PSAnZnVuY3Rpb24nID8gdGVtcGxhdGUgOiBjb21waWxlKHRlbXBsYXRlLCBvcHRpb25zKTtcclxuICAgIC8vIE5vdGUgdGhhdCB3ZSBkb24ndCBoYXZlIHRvIGNoZWNrIGlmIGl0IGFscmVhZHkgZXhpc3RzIGluIHRoZSBjYWNoZTtcclxuICAgIC8vIGl0IHdvdWxkIGhhdmUgcmV0dXJuZWQgZWFybGllciBpZiBpdCBoYWRcclxuICAgIGlmIChvcHRpb25zLmNhY2hlICYmIG9wdGlvbnMubmFtZSkge1xyXG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGVzLmRlZmluZShvcHRpb25zLm5hbWUsIHRlbXBsYXRlRnVuYyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGVtcGxhdGVGdW5jO1xyXG59XHJcbi8qKlxyXG4gKiBSZW5kZXIgYSB0ZW1wbGF0ZVxyXG4gKlxyXG4gKiBJZiBgdGVtcGxhdGVgIGlzIGEgc3RyaW5nLCBFdGEgd2lsbCBjb21waWxlIGl0IHRvIGEgZnVuY3Rpb24gYW5kIHRoZW4gY2FsbCBpdCB3aXRoIHRoZSBwcm92aWRlZCBkYXRhLlxyXG4gKiBJZiBgdGVtcGxhdGVgIGlzIGEgdGVtcGxhdGUgZnVuY3Rpb24sIEV0YSB3aWxsIGNhbGwgaXQgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICpcclxuICogSWYgYGNvbmZpZy5hc3luY2AgaXMgYGZhbHNlYCwgRXRhIHdpbGwgcmV0dXJuIHRoZSByZW5kZXJlZCB0ZW1wbGF0ZS5cclxuICpcclxuICogSWYgYGNvbmZpZy5hc3luY2AgaXMgYHRydWVgIGFuZCB0aGVyZSdzIGEgY2FsbGJhY2sgZnVuY3Rpb24sIEV0YSB3aWxsIGNhbGwgdGhlIGNhbGxiYWNrIHdpdGggYChlcnIsIHJlbmRlcmVkVGVtcGxhdGUpYC5cclxuICogSWYgYGNvbmZpZy5hc3luY2AgaXMgYHRydWVgIGFuZCB0aGVyZSdzIG5vdCBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlbmRlcmVkIHRlbXBsYXRlLlxyXG4gKlxyXG4gKiBJZiBgY29uZmlnLmNhY2hlYCBpcyBgdHJ1ZWAgYW5kIGBjb25maWdgIGhhcyBhIGBuYW1lYCBvciBgZmlsZW5hbWVgIHByb3BlcnR5LCBFdGEgd2lsbCBjYWNoZSB0aGUgdGVtcGxhdGUgb24gdGhlIGZpcnN0IHJlbmRlciBhbmQgdXNlIHRoZSBjYWNoZWQgdGVtcGxhdGUgZm9yIGFsbCBzdWJzZXF1ZW50IHJlbmRlcnMuXHJcbiAqXHJcbiAqIEBwYXJhbSB0ZW1wbGF0ZSBUZW1wbGF0ZSBzdHJpbmcgb3IgdGVtcGxhdGUgZnVuY3Rpb25cclxuICogQHBhcmFtIGRhdGEgRGF0YSB0byByZW5kZXIgdGhlIHRlbXBsYXRlIHdpdGhcclxuICogQHBhcmFtIGNvbmZpZyBPcHRpb25hbCBjb25maWcgb3B0aW9uc1xyXG4gKiBAcGFyYW0gY2IgQ2FsbGJhY2sgZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIHJlbmRlcih0ZW1wbGF0ZSwgZGF0YSwgY29uZmlnLCBjYikge1xyXG4gICAgdmFyIG9wdGlvbnMgPSBnZXRDb25maWcoY29uZmlnIHx8IHt9KTtcclxuICAgIGlmIChvcHRpb25zLmFzeW5jKSB7XHJcbiAgICAgICAgaWYgKGNiKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHVzZXIgcGFzc2VzIGNhbGxiYWNrXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBpZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSByZW5kZXJpbmcgdGhlIHRlbXBsYXRlLFxyXG4gICAgICAgICAgICAgICAgLy8gSXQgd2lsbCBidWJibGUgdXAgYW5kIGJlIGNhdWdodCBoZXJlXHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVGbiA9IGhhbmRsZUNhY2hlJDEodGVtcGxhdGUsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVGbihkYXRhLCBvcHRpb25zLCBjYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIE5vIGNhbGxiYWNrLCB0cnkgcmV0dXJuaW5nIGEgcHJvbWlzZVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHByb21pc2VJbXBsID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHByb21pc2VJbXBsKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGhhbmRsZUNhY2hlJDEodGVtcGxhdGUsIG9wdGlvbnMpKGRhdGEsIG9wdGlvbnMpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEV0YUVycihcIlBsZWFzZSBwcm92aWRlIGEgY2FsbGJhY2sgZnVuY3Rpb24sIHRoaXMgZW52IGRvZXNuJ3Qgc3VwcG9ydCBQcm9taXNlc1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBoYW5kbGVDYWNoZSQxKHRlbXBsYXRlLCBvcHRpb25zKShkYXRhLCBvcHRpb25zKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVuZGVyIGEgdGVtcGxhdGUgYXN5bmNocm9ub3VzbHlcclxuICpcclxuICogSWYgYHRlbXBsYXRlYCBpcyBhIHN0cmluZywgRXRhIHdpbGwgY29tcGlsZSBpdCB0byBhIGZ1bmN0aW9uIGFuZCBjYWxsIGl0IHdpdGggdGhlIHByb3ZpZGVkIGRhdGEuXHJcbiAqIElmIGB0ZW1wbGF0ZWAgaXMgYSBmdW5jdGlvbiwgRXRhIHdpbGwgY2FsbCBpdCB3aXRoIHRoZSBwcm92aWRlZCBkYXRhLlxyXG4gKlxyXG4gKiBJZiB0aGVyZSBpcyBhIGNhbGxiYWNrIGZ1bmN0aW9uLCBFdGEgd2lsbCBjYWxsIGl0IHdpdGggYChlcnIsIHJlbmRlcmVkVGVtcGxhdGUpYC5cclxuICogSWYgdGhlcmUgaXMgbm90IGEgY2FsbGJhY2sgZnVuY3Rpb24sIEV0YSB3aWxsIHJldHVybiBhIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVuZGVyZWQgdGVtcGxhdGVcclxuICpcclxuICogQHBhcmFtIHRlbXBsYXRlIFRlbXBsYXRlIHN0cmluZyBvciB0ZW1wbGF0ZSBmdW5jdGlvblxyXG4gKiBAcGFyYW0gZGF0YSBEYXRhIHRvIHJlbmRlciB0aGUgdGVtcGxhdGUgd2l0aFxyXG4gKiBAcGFyYW0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZyBvcHRpb25zXHJcbiAqIEBwYXJhbSBjYiBDYWxsYmFjayBmdW5jdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gcmVuZGVyQXN5bmModGVtcGxhdGUsIGRhdGEsIGNvbmZpZywgY2IpIHtcclxuICAgIC8vIFVzaW5nIE9iamVjdC5hc3NpZ24gdG8gbG93ZXIgYnVuZGxlIHNpemUsIHVzaW5nIHNwcmVhZCBvcGVyYXRvciBtYWtlcyBpdCBsYXJnZXIgYmVjYXVzZSBvZiB0eXBlc2NyaXB0IGluamVjdGVkIHBvbHlmaWxsc1xyXG4gICAgcmV0dXJuIHJlbmRlcih0ZW1wbGF0ZSwgZGF0YSwgT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnLCB7IGFzeW5jOiB0cnVlIH0pLCBjYik7XHJcbn1cblxuLy8gQGRlbm9pZnktaWdub3JlXHJcbmNvbmZpZy5pbmNsdWRlRmlsZSA9IGluY2x1ZGVGaWxlSGVscGVyO1xyXG5jb25maWcuZmlsZXBhdGhDYWNoZSA9IHt9O1xuXG5leHBvcnQgeyByZW5kZXJGaWxlIGFzIF9fZXhwcmVzcywgY29tcGlsZSwgY29tcGlsZVRvU3RyaW5nLCBjb25maWcsIGNvbmZpZ3VyZSwgY29uZmlnIGFzIGRlZmF1bHRDb25maWcsIGdldENvbmZpZywgbG9hZEZpbGUsIHBhcnNlLCByZW5kZXIsIHJlbmRlckFzeW5jLCByZW5kZXJGaWxlLCByZW5kZXJGaWxlQXN5bmMsIHRlbXBsYXRlcyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXRhLmVzLmpzLm1hcFxuIiwiaW1wb3J0IHsgQXJnU2V0IH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBWQVJfTkFNRTogc3RyaW5nID0gJ3NrJ1xyXG5cclxuZXhwb3J0IGNvbnN0IERFTElNSVRFUlM6IEFyZ1NldCA9IHtcclxuXHRcIlBBU1NfVkFMVUVcIjogW1wiOlwiXVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgU0tfREVQVEhfTElNSVQgPSA1O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVudW0gTW9kZXMge1xyXG5cdGdlbmVyYWwgPSBcIkdFTkVSQUxcIixcclxuXHRibG9jayA9IFwiQkxPQ0tcIixcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGVudW0gRmxhZ3Mge1xyXG5cdG5vbmUgPSAwLFxyXG5cdHRlbXBsYXRlID0gMSxcclxuXHRpbnRlcnAgPSAyLFxyXG5cdHJhdyA9IDMsXHJcblx0bGl0ZXJhbCA9IDQsXHJcblx0ZXZhbCA9IDVcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEVCQVIgPSBgXFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuYCIsImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgeyBrbHMgfSBmcm9tIFwic3JjL3V0aWxcIjtcclxuXHJcbmludGVyZmFjZSBjb25maXJtYXRpb25Nb2RhbFZhbHVlcyB7XHJcbiAgdGl0bGU6IHN0cmluZ1xyXG4gIGxhYmVsUG9zOiBzdHJpbmdcclxuICBsYWJlbE5lZzogc3RyaW5nXHJcbiAgZGVzYz86IHN0cmluZ1xyXG4gIGNsYXNzPzogc3RyaW5nXHJcbiAgZWxlbWVudHM/OiBFbGVtZW50W11cclxufSBcclxuXHJcbmV4cG9ydCBjbGFzcyBjb25maXJtYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgcmVqZWN0OiAocmVhc29uPzogYW55KSA9PiB2b2lkO1xyXG5cclxuICBwcml2YXRlIGZpZWxkczogY29uZmlybWF0aW9uTW9kYWxWYWx1ZXMgPSB7XHJcbiAgICB0aXRsZTogXCJQbGVhc2UgQ29uZmlybVwiLFxyXG4gICAgbGFiZWxQb3M6IFwiQ29uZmlybVwiLFxyXG4gICAgbGFiZWxOZWc6IFwiQ2FuY2VsXCIsXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmllbGRzSW4/OiBQYXJ0aWFsPGNvbmZpcm1hdGlvbk1vZGFsVmFsdWVzPikge1xyXG4gICAgc3VwZXIoYXBwKVxyXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpZWxkcywgZmllbGRzSW4gfHwge30pXHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKXtcclxuICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KHRoaXMuZmllbGRzLnRpdGxlKVxyXG4gICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGF6eihrbHMoJ2NvbmZpcm1hdGlvbi1tb2RhbCcpLCB0aGlzLmZpZWxkcy5jbGFzcylcclxuICAgIGlmICh0aGlzLmZpZWxkcy5kZXNjKSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2Nsczoga2xzKCdjb25maXJtYXRpb24tbW9kYWwtZGVzY3JpcHRpb24nKSwgdGV4dDogdGhpcy5maWVsZHMuZGVzY30pXHJcbiAgICB0aGlzLmNvbnRlbnRFbC5hcHBlbmQoLi4udGhpcy5maWVsZHMuZWxlbWVudHMpXHJcblxyXG4gICAgbGV0IGMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe2Nsczoga2xzKCdjb25maXJtLW1vZGFsLWJ1dHRvbnMnKX0pXHJcbiAgICBjLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHt0ZXh0OiB0aGlzLmZpZWxkcy5sYWJlbFBvcywgY2xzOiBrbHMoJ21vZGFsLWJ1dHRvbi1jb25maXJtJyl9LCAoYikgPT4geyAgXHJcbiAgICAgIGIub25DbGlja0V2ZW50KCgpID0+IHtcclxuICAgICAgICB0aGlzLnJlc29sdmUoXCJ0cnVlXCIpXHJcbiAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgIH0pIFxyXG4gICAgfSlcclxuXHJcbiAgICBjLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHt0ZXh0OiB0aGlzLmZpZWxkcy5sYWJlbE5lZywgY2xzOiBrbHMoJ21vZGFsLWJ1dHRvbi1jYW5jZWwnKX0sIChiKSA9PiB7IFxyXG4gICAgICBiLm9uQ2xpY2tFdmVudCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlKFwiZmFsc2VcIilcclxuICAgICAgICB0aGlzLmNsb3NlKCkgXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgb3BlbkFuZEdldFZhbHVlKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XHJcbiAgICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufSIsImltcG9ydCB7IEFwcCwgTWFya2Rvd25WaWV3LCBub3JtYWxpemVQYXRoLCBUQWJzdHJhY3RGaWxlLCBURmlsZSwgVEZvbGRlciwgVmF1bHQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgY29uZmlybWF0aW9uTW9kYWwgfSBmcm9tIFwiLi9tb2RhbC9jb25maXJtYXRpb25Nb2RhbFwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXgsIFN0cmluZ2RleGVkIH0gZnJvbSBcIi4vdHlwZXMvdHlwZXNcIjtcclxuXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuXHRpbnRlcmZhY2UgRWxlbWVudCB7XHJcblx0XHRhZGRDbGF6eih0aGlzOiBFbGVtZW50LCBzdHI6IHN0cmluZyB8IHN0cmluZ1tdKTogdm9pZDtcclxuXHRcdGFkZENsYXp6KHRoaXM6IEVsZW1lbnQsIC4uLnN0cjogc3RyaW5nW10pOiB2b2lkO1xyXG5cdH1cclxufVxyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuYWRkQ2xhenogPSBmdW5jdGlvbiAoc3RyOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xyXG5cdGlmIChBcnJheS5pc0FycmF5KHN0cikpIHtcclxuXHRcdHRoaXMuYWRkQ2xhc3MoLi4uc3RyKVxyXG5cdH0gZWxzZSB0aGlzLmFkZENsYXNzKHN0cilcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlcyhhcHA6IEFwcCwgZGlyOiBzdHJpbmcpOiBURmlsZVtdIHtcclxuXHRsZXQgZGlyUGF0aCA9IG5vcm1hbGl6ZVBhdGgoZGlyKVxyXG5cdGxldCBmbyA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGlyUGF0aCk7XHJcblxyXG5cdC8vIGNvbnNvbGUubG9nKGRpclBhdGgpLCBjb25zb2xlLmxvZyhmbyk7XHJcblx0aWYgKCFmbyB8fCAhKGZvIGluc3RhbmNlb2YgVEZvbGRlcikpIHRocm93IGBTa3JpYmk6IENvdWxkIG5vdCBmaW5kIGZvbGRlciAnJHtkaXJQYXRofSdgO1xyXG5cclxuXHRsZXQgZmlsZXM6IFRGaWxlW10gPSBbXTtcclxuXHRWYXVsdC5yZWN1cnNlQ2hpbGRyZW4oZm8sIChmaSkgPT4ge1xyXG5cdFx0aWYgKGZpIGluc3RhbmNlb2YgVEZpbGUpIGZpbGVzLnB1c2goZmkpXHJcblx0fSlcclxuXHJcblx0cmV0dXJuIGZpbGVzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tGaWxlRXh0KGZpbGVzOiBURmlsZVtdIHwgVEZpbGUsIGV4dHM6IHN0cmluZ1tdIHwgc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0ZXh0cyA9IHRvQXJyYXkoZXh0cyk7IFxyXG5cdHJldHVybiB0b0FycmF5KGZpbGVzKS5ldmVyeSgoZikgPT4ge3JldHVybiBleHRzLmNvbnRhaW5zKGYuZXh0ZW5zaW9uKX0pXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJGaWxlRXh0KGZpbGVzOiBURmlsZVtdIHwgVEZpbGUsIGV4dHM6IHN0cmluZ1tdIHwgc3RyaW5nKTogVEZpbGVbXSB7XHJcblx0ZXh0cyA9IHRvQXJyYXkoZXh0cylcclxuXHRyZXR1cm4gdG9BcnJheShmaWxlcykuZmlsdGVyKChmKSA9PiB7aWYgKGNoZWNrRmlsZUV4dChmLCBleHRzKSkgcmV0dXJuIGZ9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheShhcmdzOiBhbnkgfCBhbnlbXSk6IGFueVtdIHtcclxuXHRyZXR1cm4gKEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNJbkZvbGRlcihlOiBUQWJzdHJhY3RGaWxlLCBkaXI6IHN0cmluZykge1xyXG5cdGxldCBib28gPSAobm9ybWFsaXplUGF0aCgoLy4rXFwvL2cpLmV4ZWMoZS5wYXRoKVswXSkgPT0gbm9ybWFsaXplUGF0aChkaXIpKVxyXG5cclxuXHRyZXR1cm4gYm9vXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGFudChvYmo6IGFueSkge1xyXG5cdHJldHVybiAhKChvYmogPT09IG51bGwgKSB8fCAob2JqID09PSB1bmRlZmluZWQpKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm91bmRUbyh4OiBhbnksIHRvPzogbnVtYmVyKTogbnVtYmVyIHtcclxuICByZXR1cm4gcGFyc2VGbG9hdChwYXJzZUZsb2F0KHgpLnRvUHJlY2lzaW9uKHRvID8/IDQpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VmVyYm9zaXR5KCkge1xyXG5cdC8vQHRzLWlnbm9yZVxyXG5cdHJldHVybiB3aW5kb3cuYXBwLnBsdWdpbnMucGx1Z2luc1tcIm9ic2lkaWFuLXNrcmliaVwiXT8uc2V0dGluZ3MudmVyYm9zZUxvZ2dpbmcgfHwgZmFsc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2TG9nKC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0aWYgKGdldFZlcmJvc2l0eSgpKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcIlNrcmliaTpcIiwgLi4uYXJncyApXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZExvZyguLi5hcmdzOiBhbnlbXSkge1xyXG5cdC8vQHRzLWlnbm9yZVxyXG5cdGlmICh3aW5kb3c/LmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJvYnNpZGlhbi1za3JpYmlcIl0/LnNldHRpbmdzPy5kZXZMb2dnaW5nIHx8IGZhbHNlKSB7XHJcblx0XHRjb25zb2xlLmxvZyguLi5hcmdzKVxyXG5cdH1cclxufVxyXG5cclxuLyogVGFrZXMgYW4gYXJyYXkgb2Ygc3RyaW5ncyBhbmQgcmV0dXJucyBhIHJlY29yZCBvZiBrZXkvdmFsdWUgcGFpcnMgZm9yIGVhY2gsIHdoZXJlIHRoZSBrZXkgYW5kIHZhbHVlIGFyZSB0aGUgc2FtZSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9EdXBlUmVjb3JkKGFycjogc3RyaW5nW10pOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcclxuICByZXR1cm4gYXJyLnJlZHVjZSgoYSwgaSkgPT4gKHsuLi5hLCBbaV06IGl9KSwge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPilcclxufVxyXG5cclxuLyoqIFxyXG4gKiBAcGFyYW0gaW5wdXQgQW4gb2JqZWN0IHRvIGNsb25lXHJcbiAqIEBwYXJhbSBrZXlzIFRoZSBrZXlzIG9mIHByb3BlcnRpZXMgdG8gb21pdCBmcm9tIHRoZSBjbG9uZVxyXG4gKiBAcmV0dXJucyBBIGNsb25lIG9mICdpbnB1dCcgd2l0aG91dCB0aGUgb21pdHRlZCBwcm9wZXJ0aWVzICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRob3V0S2V5PFQgZXh0ZW5kcyB7IFtLIGluIGtleW9mIFRdOiBzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2wgfT4oaW5wdXQ6IHtbaW5kZXg6IHN0cmluZ106IGFueX0sIGtleTogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICBjb25zdCBjbG9uZSA9IHsgLi4uaW5wdXQgfTtcclxuICBpZiAoQXJyYXkuaXNBcnJheShrZXkpKSB7XHJcbiAgICAgIChrZXkgYXMgc3RyaW5nW10pLmZvckVhY2goKGspID0+IHtcclxuICAgICAgICAgIGRlbGV0ZSBjbG9uZVtrXVxyXG4gICAgICB9KVxyXG4gIH0gZWxzZSB7IGRlbGV0ZSBjbG9uZVtrZXldIH1cclxuICByZXR1cm4gY2xvbmU7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhc3luY0Z1bmMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvclxyXG5leHBvcnQgY29uc3QgcHJvbWlzZUltcGw6IFByb21pc2VDb25zdHJ1Y3RvciA9IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLlByb21pc2VcclxuZXhwb3J0IGNvbnN0IGdldEFzeW5jQ29uc3RydWN0b3IgPSAoKTogRnVuY3Rpb25Db25zdHJ1Y3RvciA9PiBuZXcgRnVuY3Rpb24oJ3JldHVybiAoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvcicpKClcclxuXHJcblxyXG4vKipcclxuICogQHBhcmFtIEFwcFxyXG4gKiBAcGFyYW0gZmxpcCBJZiB0cnVlLCB0YXJnZXQgaXMgZWRpdG9yIG1vZGUuIE90aGVyd2lzZSwgdGFyZ2V0IGlzIHByZXZpZXcgbW9kZS5cclxuICogQHJldHVybnMgRmlyc3QgbWFya2Rvd24gdmlldyBvZiB0YXJnZXQgbW9kZSB3aXRoIHNhbWUgZmlsZSBhcyBhY3RpdmUgdmlldywgb3IgYWN0aXZlIHZpZXcgaWYgbm9uZSB3YXMgZm91bmQuIE51bGwgaWYgbm8gYWN0aXZlIHZpZXcgZXhpc3RzLiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJldmlld1ZpZXcoYXBwOiBBcHAsIGZsaXA/OiBib29sZWFuKTogTWFya2Rvd25WaWV3IHwgbnVsbCB7XHJcblx0bGV0IHQxID0gZmxpcCA/IFwicHJldmlld1wiIDogXCJzb3VyY2VcIlxyXG5cdGxldCB0MiA9IGZsaXAgPyBcInNvdXJjZVwiIDogXCJwcmV2aWV3XCJcclxuXHJcblx0dHJ5IHtcclxuXHR2YXIgdmlldyA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG5cdGlmICh2aWV3LmdldE1vZGUoKSA9PSB0MSkge1xyXG5cdFx0YXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKS5mb3JFYWNoKChsZWFmKSA9PiB7XHJcblx0XHRcdGlmICgobGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykuZ2V0TW9kZSgpID09IHQyKSB7XHJcblx0XHRcdFx0bGV0IHogPSAobGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykucHJldmlld01vZGVcclxuXHRcdFx0XHRpZiAoei5nZXRGaWxlKCkgPT0gdmlldy5maWxlKSB7XHJcblx0XHRcdFx0XHR2aWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlld1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHR9XHJcblx0fSBjYXRjaCAoZSkge1xyXG5cclxuXHR9XHJcblxyXG5cdHJldHVybiB2aWV3IHx8IG51bGw7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgaXNGdW5jID0gKGZ1bmM6IGFueSk6IGZ1bmMgaXMgRnVuY3Rpb24gPT4gKGZ1bmMgaW5zdGFuY2VvZiBGdW5jdGlvbilcclxuZXhwb3J0IGNvbnN0IGlzRmlsZSA9IChpdGVtOiBhbnkpOiBpdGVtIGlzIFRGaWxlID0+IChpdGVtKSBpbnN0YW5jZW9mIFRGaWxlOyBcclxuXHJcbmZ1bmN0aW9uIGludm9rZU1ldGhvZE9mQW5kUmV0dXJuPFQ+KGZ1bmM6IGtleW9mIFQsIG9iamVjdHM6IFN0cmluZ2RleGVkPFQ+KSB7XHJcbiAgbGV0IHJldHM6IFN0cmluZ2RleCA9IHt9O1xyXG4gIGZvciAobGV0IG8gb2YgT2JqZWN0LmVudHJpZXMob2JqZWN0cykpIHtcclxuICAgIGlmICgobyAhPSBudWxsKSAmJiAoaXNGdW5jKG9bZnVuY10pKSkge1xyXG4gICAgICByZXRzW29bMF1dID0gKG9bMV1bZnVuY10gYXMgRnVuY3Rpb24pKClcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHJldHNcclxufVxyXG5cclxuZnVuY3Rpb24gaW52b2tlTWV0aG9kT2Y8VD4oZnVuYzoga2V5b2YgVCwgLi4ub2JqZWN0czogVFtdKSB7XHJcbiAgZm9yIChsZXQgbyBvZiBvYmplY3RzKSB7XHJcbiAgICBpZiAoKG8gIT0gbnVsbCkgJiYgKGlzRnVuYyhvW2Z1bmNdKSkpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAob1tmdW5jXSBhcyB1bmtub3duIGFzIEZ1bmN0aW9uKSgpXHJcbiAgICAgIH0gY2F0Y2goZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBpbnZva2VNZXRob2RPZjogY2F1Z2h0IGVycm9yISBcXG5gLCBgS2V5IGNhbGxlZCBhcyBtZXRob2Q6YCwgZnVuYywgIGBDYWxsZWQgb246YCwgbywgYEVycm9yOmAsIGVycilcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGF2ZXJhZ2UoLi4ubnVtYmVyczogbnVtYmVyW10pIHtcclxuICByZXR1cm4gbnVtYmVycy5yZWR1Y2UoKHZhbCwgY3VyKSA9PiB2YWwrY3VyKS9udW1iZXJzLmxlbmd0aFxyXG59XHJcblxyXG4vKiBHZXQgbGluayB0byBkb2N1bWVudGF0aW9uIHBhZ2UuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsaW5rVG9Eb2N1bWVudGF0aW9uKHBhZ2U6IHN0cmluZykge1xyXG5cdC8vIHJldHVybiBgaHR0cHM6Ly9henVsYWxvaS5uZXQvb2JzaWRpYW4tc2tyaWJpLyR7cGFnZX1gXHJcblx0cmV0dXJuIGBodHRwczovL2F6dWxhbG9pLmdpdGh1Yi5pby9vYnNpZGlhbi1za3JpYmkvJHtwYWdlfWBcclxufVxyXG5cclxuLyogUHJlZml4ZXMgc3RyaW5nIHdpdGggcGx1Z2luIG5hbWUuIE1ha2VzIHJldXNpbmcgY29kZSBhY3Jvc3MgcGx1Z2lucyBlYXNpZXIuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBrbHMoY2xzOiBzdHJpbmcpIHtyZXR1cm4gYHNrcmliaS0ke2Nsc31gfVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VFeHRlcm5hbExpbmsobGlua0luOiBIVE1MQW5jaG9yRWxlbWVudCB8IHN0cmluZyk6IEhUTUxBbmNob3JFbGVtZW50IHtcclxuXHRjb25zdCBsaW5rID0gU3RyaW5nLmlzU3RyaW5nKGxpbmtJbikgPyBjcmVhdGVFbCgnYScsIHthdHRyOiB7aHJlZjogbGlua0lufX0pIDogbGlua0luXHJcblxyXG4gIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpID0+IHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICBsZXQgcCA9IG5ldyBjb25maXJtYXRpb25Nb2RhbCh3aW5kb3cuYXBwLCB7XHJcbiAgICAgIHRpdGxlOiBgT3BlbiBFeHRlcm5hbCBMaW5rP2AsXHJcbiAgICAgIGRlc2M6IGBXaWxsIG9wZW4gdGhlIGZvbGxvd2luZyBhZGRyZXNzIHdpdGggZGVmYXVsdCBwcm9ncmFtOmAsXHJcbiAgICAgIGxhYmVsUG9zOiBgT3BlbiBMaW5rYCxcclxuICAgICAgZWxlbWVudHM6IFtjcmVhdGVEaXYoe2Nsczoga2xzKCdjb25maXJtYXRpb24tbW9kYWwtbGluaycpLCB0ZXh0OiBsaW5rLmdldEF0dHIoJ2hyZWYnKX0pXVxyXG4gICAgfSk7XHJcblxyXG4gICAgbmV3IFByb21pc2UoKHJlc29sdmU6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpID0+IHAub3BlbkFuZEdldFZhbHVlKHJlc29sdmUsIHJlamVjdCkpXHJcbiAgICAudGhlbihyZXMgPT4gIHtcclxuICAgICAgaWYgKHJlcyA9PT0gXCJ0cnVlXCIpIHtcclxuICAgICAgICB3aW5kb3cub3BlbihsaW5rLmdldEF0dHIoJ2hyZWYnKSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuXHRyZXR1cm4gbGlua1xyXG59XHJcbiIsImltcG9ydCAqIGFzIEV0YSBmcm9tIFwiZXRhXCI7XHJcbmltcG9ydCB7IFBhcnRpYWxDb25maWcgfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29uZmlnXCJcclxuaW1wb3J0IHsgQ2FsbGJhY2tGbiB9IGZyb20gXCJldGEvZGlzdC90eXBlcy9maWxlLWhhbmRsZXJzXCJcclxuaW1wb3J0IHsgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCwgc2NvcGVkVmFycyB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXNcIlxyXG5pbXBvcnQgeyBkTG9nLCBnZXRBc3luY0NvbnN0cnVjdG9yLCBwcm9taXNlSW1wbCB9IGZyb20gXCJzcmMvdXRpbFwiXHJcbmltcG9ydCB7IEV0YUhhbmRsZXIgfSBmcm9tIFwiLi9ldGFcIlxyXG5cclxuLyoqIEFkZHMgdGhlIGVudHJpZXMgb2Ygc2NvcGUgdG8gYSBmdW5jdGlvbiBzdHJpbmcuIFxyXG4qIEBwYXJhbSBmdW5jdGlvblN0cmluZyBBIHN0cmluZyBmdW5jdGlvbiBjb21waWxlZCBieSBFdGEncyBjb21waWxlVG9TdHJpbmcoKSBcclxuKiBAcGFyYW0ga2V5cyBBcnJheSBvZiBrZXlzIHRoYXQgdGhlIHJldHVybmVkIGZ1bmN0aW9uIHdpbGwgZXhwZWN0IHRvIGJlIHByZXNlbnQgaW4gaXRzIHNjb3BlIGFyZ3VtZW50XHJcbiogQHBhcmFtIGFzeW5jIElmIHRydWUsIHJldHVybmVkIGZ1bmN0aW9uIHdpbGwgYmUgYXN5bmNocm9ub3VzICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlV2l0aChmdW5jdGlvblN0cmluZzogc3RyaW5nLCBrZXlzOiBzdHJpbmdbXSwgYXN5bmM/OiBib29sZWFuKTogVGVtcGxhdGVGdW5jdGlvblNjb3BlZCB7XHJcbiAgdmFyIGEgPSBcIlwiOyB2YXIgYiA9IFwiXCI7XHJcbiAgZm9yIChsZXQgayBvZiBrZXlzKSB7XHJcbiAgICBhICs9IGAke2t9LGBcclxuICAgIGIgKz0gYCcke2t9JyxgXHJcbiAgfVxyXG4gIGxldCBmdW5jID0gYHZhciB7JHthLnN1YnN0cigwLCBhLmxlbmd0aC0xKX19ID0gc2NvcGU7XFxuYCArIGZ1bmN0aW9uU3RyaW5nXHJcbiAgbGV0IGNvbnN0cnVjdG9yID0gKGFzeW5jKSA/IGdldEFzeW5jQ29uc3RydWN0b3IoKSA6IEZ1bmN0aW9uIFxyXG4gIGxldCBjb21waWxlZCA9IG5ldyBjb25zdHJ1Y3Rvcignc2NvcGUnLCBmdW5jKVxyXG4gIHJldHVybiBjb21waWxlZCBhcyBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkXHJcbn1cclxuXHJcbi8qIFZlcnNpb24gb2YgRXRhJ3MgcmVuZGVyIGZ1bmN0aW9uLCBtb2RpZmllZCB0byBoYW5kbGUgc2NvcGVkIHRlbXBsYXRlcyAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyRXRhKFxyXG4gIGhhbmRsZXI6IEV0YUhhbmRsZXIsXHJcbiAgdGVtcGxhdGU6IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsXHJcbiAgZGF0YTogb2JqZWN0LFxyXG4gIGNvbmZpZz86IFBhcnRpYWxDb25maWcsXHJcbiAgY2I/OiBDYWxsYmFja0ZuLFxyXG4gIHNjb3BlPzogc2NvcGVkVmFycyxcclxuICBiaW5kZXI/OiBhbnlcclxuICApOiBzdHJpbmcgfCBQcm9taXNlPHN0cmluZz4gfCB2b2lkIHtcclxuICBjb25zdCBvcHRpb25zID0gRXRhLmdldENvbmZpZyhjb25maWcgfHwge30pXHJcblxyXG4gIGlmIChvcHRpb25zLmFzeW5jKSB7XHJcbiAgICAvLyBpZiAoY2IpIHtcclxuICAgICAgLy8gdHJ5IHsgXHJcbiAgICAgICAgLy8gY29uc3QgdGVtcGxhdGVGbiA9IGhhbmRsZXIuZ2V0Q2FjaGVkKHRlbXBsYXRlLCBvcHRpb25zLCBzY29wZSwgYmluZGVyKVxyXG4gICAgICAgIC8vIHRlbXBsYXRlRm4oc2NvcGUpXHJcbiAgICAgIC8vIH0gY2F0Y2goZSkge1xyXG4gICAgICAgIC8vIHJldHVybiBjYihlKVxyXG4gICAgICAvLyB9XHJcbiAgICAvLyB9IGVsc2Uge1xyXG5cclxuICAgICAgLy8gcmV0dXJuIChhc3luYyAoKSA9PiBoYW5kbGVyLmdldENhY2hlZCh0ZW1wbGF0ZSwgb3B0aW9ucywgc2NvcGUsIGJpbmRlcikoc2NvcGUpKSgpXHJcbiAgICAgIHJldHVybiBuZXcgcHJvbWlzZUltcGwoZnVuY3Rpb24gKHJlc29sdmU6IEZ1bmN0aW9uLCByZWplY3Q6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHJlc29sdmUoaGFuZGxlci5nZXRDYWNoZWQodGVtcGxhdGUsIG9wdGlvbnMsIHNjb3BlLCBiaW5kZXIpKHNjb3BlKSlcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICByZWplY3QoZSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAvLyB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGxldCBmdW5jID0gaGFuZGxlci5nZXRDYWNoZWQodGVtcGxhdGUsIG9wdGlvbnMsIHNjb3BlLCBiaW5kZXIpXHJcbiAgICBkTG9nKGBSZW5kZXJpbmcgZnVuY3Rpb25gLCBmdW5jKVxyXG4gICAgcmV0dXJuIGZ1bmMoc2NvcGUpXHJcbiAgfVxyXG59XHJcblxyXG4vKiBWZXJzaW9uIG9mIEV0YSdzIGFzeW5jIHJlbmRlciBmdW5jdGlvbiwganVzdCBzZXRzIGFzeW5jIHRvIHRydWUgKi9cclxuLyogTm90ZTogcGVyZiBpbXBhY3Qgb2YgdXNpbmcgYXN5bmMgdGVtcGxhdGVmdW5jdGlvbnMgaXMgbmVnbGlnaWJsZSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyRXRhQXN5bmMoXHJcbiAgaGFuZGxlcjogRXRhSGFuZGxlcixcclxuICB0ZW1wbGF0ZTogc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCxcclxuICBkYXRhOiBvYmplY3QsXHJcbiAgY29uZmlnPzogUGFydGlhbENvbmZpZyxcclxuICBjYj86IENhbGxiYWNrRm4sXHJcbiAgc2NvcGU/OiBzY29wZWRWYXJzLFxyXG4gIGJpbmRlcj86IGFueVxyXG4gICk6IHN0cmluZyB8IFByb21pc2U8c3RyaW5nPiB8IHZvaWQge1xyXG4gICAgcmV0dXJuIHJlbmRlckV0YShoYW5kbGVyLCB0ZW1wbGF0ZSwgZGF0YSwgT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnLCB7YXN5bmM6IHRydWV9KSwgY2IsIHNjb3BlLCBiaW5kZXIpXHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBTdHJpbmdkZXggfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50IH0gZnJvbSBcInNyYy91dGlsXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyQnVzIH0gZnJvbSBcIi4vcHJvdmlkZXJfYnVzXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElQcm92aWRlciB7XHJcbiAgaWQ6IHN0cmluZ1xyXG4gIGJ1czogUHJvdmlkZXJCdXNcclxuICBmdW5jdGlvbnM6IE1hcDxzdHJpbmcsIGFueT47XHJcbiAgY3JlYXRlT2JqZWN0KCk6IFN0cmluZ2RleDtcclxuICBpbml0KCk6IFByb21pc2U8dm9pZD47ICAgICAgICAgICAgICAgICAgIC8vIENhbGxlZCBvbmNlLCBvbiBidXMgbG9hZFxyXG4gIHVubG9hZCgpOiB2b2lkOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxsZWQgb25jZSwgb24gYnVzIHVubG9hZFxyXG4gIHJlbG9hZCgpOiBQcm9taXNlPGFueT47ICAgICAgICAgICAgICAgICAvLyBNYXkgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzXHJcblxyXG4gIHNldERpcnR5KCk6IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQcm92aWRlciBpbXBsZW1lbnRzIElQcm92aWRlciB7XHJcbiAgaWQ6IHN0cmluZ1xyXG4gIGJ1czogUHJvdmlkZXJCdXM7XHJcbiAgZnVuY3Rpb25zOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpXHJcbiAgaW5pdExvYWRlZCA9IGZhbHNlO1xyXG4gIGlzRGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoYnVzOiBQcm92aWRlckJ1cywgaWQ6IHN0cmluZykge1xyXG4gICAgdGhpcy5idXMgPSBidXNcclxuICAgIHRoaXMuaWQgPSBpZFxyXG4gIH1cclxuXHJcbiAgW2luZGV4OiBzdHJpbmddOiBhbnk7XHJcblxyXG4gIGNyZWF0ZU9iamVjdCgpOiBTdHJpbmdkZXgge1xyXG4gICAgcmV0dXJuIHsuLi5PYmplY3QuZnJvbUVudHJpZXModGhpcy5mdW5jdGlvbnMpfVxyXG4gIH1cclxuXHJcbiAgaW5pdCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMuaW5pdExvYWRlZCA9IHRydWVcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgdW5sb2FkKCk6IHZvaWQge31cclxuICByZWxvYWQoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGNsZWFuIElmIHRydWUsIHByb3ZpZGVyLmlzRGlydHkgPSBmYWxzZSAqL1xyXG4gIHNldERpcnR5KGRpcnR5PzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5pc0RpcnR5ID0gaXNFeHRhbnQoZGlydHkpID8gZGlydHkgOiB0cnVlXHJcbiAgICB0aGlzLmJ1cy5wcm92aWRlck5vdGlmaWNhdGlvbkRpcnR5KHRoaXMsIHRoaXMuaXNEaXJ0eSlcclxuICB9XHJcbn1cclxuXHJcbi8qKiBcclxuICogUHJlZGljYXRlZCBwcm92aWRlcnMgYXJlIHJlc3BvbnNpYmxlIGZvciBtb2R1bGVzIHRoYXQgcmVxdWlyZSBjZXJ0YWluIGNvbmRpdGlvbnMgdG8gZnVuY3Rpb24gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJUHJvdmlkZXJQcmVkaWNhdGVkIGV4dGVuZHMgSVByb3ZpZGVyIHtcclxuICBwcmVkaWNhdGVDaGVjaygpOiBib29sZWFuXHJcbiAgcHJlZGljYXRlRXJyb3IoKTogc3RyaW5nXHJcbiAgZ2V0UHJlZGljYXRlKCk6IFBsdWdpblxyXG59XHJcbiBcclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFByb3ZpZGVyUHJlZGljYXRlZCBleHRlbmRzIFByb3ZpZGVyIGltcGxlbWVudHMgSVByb3ZpZGVyUHJlZGljYXRlZCB7XHJcbiAgcHJlZGljYXRlUGx1Z2luTmFtZTogc3RyaW5nID0gJydcclxuICBcclxuICBnZXRQcmVkaWNhdGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5idXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnM/Llt0aGlzLnByZWRpY2F0ZVBsdWdpbk5hbWVdIHx8IG51bGxcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm5zIHRydWUgb25seSB3aGVuIHRoZSBwcmVkaWNhdGUgY29uZGl0aW9uIGlzIG1ldCAqL1xyXG4gIHByZWRpY2F0ZUNoZWNrKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYnVzLnBsdWdpbi5hcHAucGx1Z2lucy5lbmFibGVkUGx1Z2lucy5oYXModGhpcy5wcmVkaWNhdGVQbHVnaW5OYW1lKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybnMgQW4gZXJyb3Igc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHVubWV0IHByZWRpY2F0ZSBjb25kaXRpb24gKi9cclxuICBwcmVkaWNhdGVFcnJvcigpIHtcclxuICAgIHJldHVybiBgSW50ZWdyYXRpb24gTW9kdWxlICcke3RoaXMuaWR9JyBub3QgYXZhaWxhYmxlLCBjb3VsZCBub3QgZmluZCByZXF1aXJlZCBwbHVnaW46ICcke3RoaXMucHJlZGljYXRlUGx1Z2luTmFtZX0nYFxyXG4gIH1cclxufSIsImltcG9ydCB7IE1hcmtkb3duUmVuZGVyZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tIFwic3JjL2V0YS9wcm92aWRlcl9hYnNcIjtcclxuaW1wb3J0IHsgUHJvdmlkZXJCdXMgfSBmcm9tIFwic3JjL2V0YS9wcm92aWRlcl9idXNcIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyU0sgZXh0ZW5kcyBQcm92aWRlciB7XHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIHJldHVybiBzdXBlci5pbml0KClcclxuICB9XHJcblxyXG4gIGNyZWF0ZU9iamVjdCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlbmRlcjogZnVuY3Rpb24oc3RyOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgZSA9IGNyZWF0ZURpdih7Y2xzOiBcInNrcmliaS1yZW5kZXItdmlydHVhbFwifSk7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcylcclxuICAgICAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHN0ciwgZSwgdGhpcy50aGlzLmZpbGUucGF0aCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIGUuaW5uZXJIVE1MXHJcbiAgICAgIH0sXHJcbiAgICAgIGhhczogZnVuY3Rpb24odjogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuICEoKHRoaXMudj8uW3ZdID09IG51bGwpIHx8ICh0aGlzLnY/Llt2XSA9PSB1bmRlZmluZWQpKVxyXG4gICAgICB9LFxyXG4gICAgICBhYm9ydDogZnVuY3Rpb24oczogc3RyaW5nIHwgU3RyaW5nZGV4KSB7XHJcbiAgICAgICAgbGV0IGFib3J0UGFja2V0ID0gU3RyaW5nLmlzU3RyaW5nKHMpIFxyXG4gICAgICAgID8ge2hhc0RhdGE6IHRydWUsIGZsYWc6ICdhYm9ydCcsIGhvdmVyOiBzfSBcclxuICAgICAgICA6IE9iamVjdC5hc3NpZ24oe2hhc0RhdGE6IHRydWUsIGZsYWc6ICdhYm9ydCd9LCBzKVxyXG4gICAgICAgIHRocm93IGFib3J0UGFja2V0XHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgRXZlbnRSZWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuLy8gaW1wb3J0IHsgRGF0YXZpZXdJbmxpbmVBcGkgfSBmcm9tIFwib2JzaWRpYW4tZGF0YXZpZXcvbGliL2FwaS9pbmxpbmUtYXBpXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyUHJlZGljYXRlZCB9IGZyb20gXCJzcmMvZXRhL3Byb3ZpZGVyX2Fic1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyRGF0YXZpZXcgZXh0ZW5kcyBQcm92aWRlclByZWRpY2F0ZWQge1xyXG4gIHByZWRpY2F0ZVBsdWdpbk5hbWUgPSAnZGF0YXZpZXcnXHJcbiAgLy8gZHZwOiBEYXRhdmlld1BsdWdpbiA9IG51bGxcclxuXHJcbiAgZXZlbnRSZWZfQVBJX1JFQURZOiBFdmVudFJlZlxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgLy8gdGhpcy5kdnAgPSB0aGlzLmJ1cy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldyBhcyBEYXRhdmlld1BsdWdpbiB8fCBudWxsXHJcblxyXG4gICAgdGhpcy5ldmVudFJlZl9BUElfUkVBRFkgPSB0aGlzLmJ1cy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RhdGF2aWV3OmFwaS1yZWFkeScsIChhcGkpID0+IHt0aGlzLmFwaVJlYWR5KCl9KVxyXG5cclxuICAgIHJldHVybiBzdXBlci5pbml0KClcclxuICB9XHJcblxyXG4gIHVubG9hZCgpIHtcclxuICAgIHRoaXMuYnVzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vZmZyZWYodGhpcy5ldmVudFJlZl9BUElfUkVBRFkpXHJcbiAgfVxyXG5cclxuICBjcmVhdGVPYmplY3QoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5idXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnM/LmRhdGF2aWV3Py5hcGkgfHwgbnVsbFxyXG4gIH1cclxuXHJcbiAgYXBpUmVhZHkoKSB7XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gY3JlYXRlRHluYW1pYyhzdGF0ZTogRHluYW1pY1N0YXRlKSB7XHJcbiAgICAvLyBsZXQgYXBpID0gbmV3IERhdGF2aWV3SW5saW5lQXBpKHRoaXMuZHZwLmluZGV4LCBzdGF0ZS5jaGlsZCwgc3RhdGUuZWwsIHRoaXMuYnVzLnBsdWdpbi5hcHAsIHRoaXMuZHZwLnNldHRpbmdzLCBzdGF0ZS5maWxlLnBhdGgpXHJcblxyXG4gICAgLy8gcmV0dXJuIHRoaXM/LmR2cD8uYXBpIHx8IG51bGxcclxuICAvLyB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvdmlkZXJQcmVkaWNhdGVkIH0gZnJvbSBcIi4uLy4uL3Byb3ZpZGVyX2Fic1wiO1xyXG5pbXBvcnQgdHlwZSBXZWF0aGVyQVBJIGZyb20gXCIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi13ZWF0aGVyL3NyYy9hcGlcIjtcclxuaW1wb3J0IHsgRXZlbnRSZWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm92aWRlcldlYXRoZXIgZXh0ZW5kcyBQcm92aWRlclByZWRpY2F0ZWQge1xyXG4gIHByZWRpY2F0ZVBsdWdpbk5hbWU6IHN0cmluZyA9ICdvYnNpZGlhbi13ZWF0aGVyJ1xyXG5cclxuICBwcml2YXRlIGV2ZW50UmVmczoge1xyXG4gICAgcmVhZHk6IEV2ZW50UmVmIFxyXG4gICAgdW5sb2FkOiBFdmVudFJlZlxyXG4gICAgdGljazogRXZlbnRSZWZcclxuICB9XHJcblxyXG4gIGFzeW5jIGluaXQoKSB7XHJcbiAgICB0aGlzLmV2ZW50UmVmcyA9IHtcclxuICAgICAgcmVhZHk6IHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwiYXotd2VhdGhlcjphcGktcmVhZHlcIiwgKCkgPT4ge30pLFxyXG4gICAgICB1bmxvYWQ6IHRoaXMuYnVzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwiYXotd2VhdGhlcjphcGktdW5sb2FkXCIsICgpID0+IHt9KSxcclxuICAgICAgdGljazogdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJhei13ZWF0aGVyOmFwaS10aWNrXCIsICgpID0+IHt9KVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZnVuY3Rpb25zLnNldChcImNoZWNrXCIsIHRoaXMucHJvdmlkZV9wcmVkaWNhdGUoKSlcclxuICAgIHRoaXMuZnVuY3Rpb25zLnNldChcImNhY2hlXCIsIHRoaXMucHJvdmlkZV9kaXNwZW5zZUNhY2hlKCkpXHJcbiAgICB0aGlzLmZ1bmN0aW9ucy5zZXQoXCJ0aWNrRXZlbnRSZWZcIiwgdGhpcy5wcm92aWRlX3RpY2tFdmVudFJlZigpKVxyXG5cclxuICAgIHJldHVybiBzdXBlci5pbml0KClcclxuICB9XHJcblxyXG4gIHVubG9hZCgpIHtcclxuICAgIGZvciAobGV0IHIgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmV2ZW50UmVmcykpIHtcclxuICAgICAgdGhpcy5idXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub2ZmcmVmKHIpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKiBQcm92aXNpb25zICovXHJcblxyXG4gIHByb3ZpZGVfcHJlZGljYXRlKCk6IEZ1bmN0aW9uIHtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIHJldHVybiAoISF0aGlzLndlYXRoZXJBUEkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcm92aWRlX2Rpc3BlbnNlQ2FjaGUoKTogRnVuY3Rpb24ge1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgbGV0IHA6IGFueSA9IHRoaXMuZ2V0UHJlZGljYXRlKCk7XHJcbiAgICAgIHJldHVybiBwPy5BUEk/LmRpc3BlbnNlQ2FjaGUuYmluZChwLkFQSSkoKVxyXG4gICAgfSBcclxuICB9XHJcblxyXG4gIHByb3ZpZGVfdGlja0V2ZW50UmVmKCk6IEZ1bmN0aW9uIHtcclxuICAgIHJldHVybiAoY2I6IEZ1bmN0aW9uKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImF6LXdlYXRoZXI6YXBpLXRpY2tcIiwgKC4uLmE6IGFueSkgPT4gY2IoLi4uYSkpXHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgRmlsZVN5c3RlbUFkYXB0ZXIsIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFN0cmluZ2RleCwgU3RyaW5nZGV4ZWQgfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGRMb2csIGZpbHRlckZpbGVFeHQsIGdldEZpbGVzLCBpc0V4dGFudCwgaXNGaWxlLCB2TG9nLCB3aXRob3V0S2V5IH0gZnJvbSBcInNyYy91dGlsXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcIi4uL3Byb3ZpZGVyX2Fic1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyU2NyaXB0bG9hZGVyIGV4dGVuZHMgUHJvdmlkZXIge1xyXG4gIGxvYWRlZE1vZHVsZXM6IE1hcDxzdHJpbmcsIHtuYW1lPzogc3RyaW5nLCBwcm9wZXJ0aWVzOiBTdHJpbmdkZXh9PiA9IG5ldyBNYXAoKVxyXG5cclxuICBnZXQgZGlyZWN0b3J5KCk6IHN0cmluZyB7IHJldHVybiB0aGlzLmJ1cy5wbHVnaW4uc2V0dGluZ3Muc2NyaXB0Rm9sZGVyIH1cclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIHJldHVybiB0aGlzLmluaXRMb2FkKCkudGhlbigoKSA9PiBzdXBlci5pbml0KCkpXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0TG9hZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmxvYWRBbmRTZXQoLi4uZ2V0RmlsZXModGhpcy5idXMucGx1Z2luLmFwcCwgdGhpcy5idXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlcikpXHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkQW5kU2V0KC4uLmZpbGU6IFRGaWxlW10pIHtcclxuICAgIHJldHVybiB0aGlzLnJlYWRGaWxlcyguLi5maWxlKVxyXG4gICAgLnRoZW4oKHJldCkgPT4gey8qdkxvZygnTG9hZGluZyBKUyBtb2R1bGVzLi4uJywgcmV0KTsqLyB0aGlzLnN0YXNoTW9kdWxlKHJldCk7IHJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pO1xyXG4gIH1cclxuXHJcbiAgc3Rhc2hNb2R1bGUobW9kdWxlczogW3N0cmluZywgU3RyaW5nZGV4XVtdKSB7XHJcbiAgICBkTG9nKCdTY3JpcHRsb2FkZXI6IHN0YXNoTW9kdWxlJywgbW9kdWxlcylcclxuXHJcbiAgICBtb2R1bGVzLm1hcCgocikgPT4ge1xyXG4gICAgICBpZiAocikge1xyXG4gICAgICAgIHRoaXMubG9hZGVkTW9kdWxlcy5kZWxldGUoclswXSlcclxuICAgICAgICB0aGlzLmxvYWRlZE1vZHVsZXMuc2V0KHJbMF0sIHtcclxuICAgICAgICAgIG5hbWU6IChTdHJpbmcuaXNTdHJpbmcoclsxXT8uX25hbWUgPz8gbnVsbCkgPyByWzFdLl9uYW1lIDogbnVsbCksIFxyXG4gICAgICAgICAgcHJvcGVydGllczogd2l0aG91dEtleShyWzFdLCAnX25hbWUnKVxyXG4gICAgICAgICAgfSAgICAgICAgICBcclxuICAgICAgICApXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBjcmVhdGVPYmplY3QoKTogU3RyaW5nZGV4IHtcclxuICAgIGxldCBleHBvcnRzOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpXHJcbiAgICB0aGlzLmxvYWRlZE1vZHVsZXMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xyXG4gICAgICBsZXQgc2luZ2xlID0gKE9iamVjdC5rZXlzKHZhbHVlLnByb3BlcnRpZXMpLmxlbmd0aCA9PSAxKSBcclxuXHJcbiAgICAgIGV4cG9ydHMuc2V0KCh2YWx1ZS5uYW1lID8/IChzaW5nbGUgPyBPYmplY3Qua2V5cyh2YWx1ZS5wcm9wZXJ0aWVzKVswXSA6IGtleSkpLFxyXG4gICAgICAgIHNpbmdsZSA/IE9iamVjdC52YWx1ZXModmFsdWUucHJvcGVydGllcylbMF0gOiB2YWx1ZS5wcm9wZXJ0aWVzXHJcbiAgICAgIClcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIHsuLi5PYmplY3QuZnJvbUVudHJpZXMoZXhwb3J0cyl9XHJcbiAgfVxyXG5cclxuICBhc3luYyByZWFkRmlsZXMoLi4uZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPFtzdHJpbmcsIFN0cmluZ2RleF1bXT4ge1xyXG4gICAgbGV0IGZpbHRlcmVkID0gZmlsdGVyRmlsZUV4dChmaWxlcywgXCJqc1wiKVxyXG4gICAgY29uc3QgcmVhZHMgPSBmaWx0ZXJlZC5tYXAoYXN5bmMgKGYpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoISh0aGlzLmJ1cy5wbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIgaW5zdGFuY2VvZiBGaWxlU3lzdGVtQWRhcHRlcikpIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xyXG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5idXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmdldEJhc2VQYXRoKCkgKyBcIi9cIiArIGYucGF0aFxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCByZXNQYXRoID0gd2luZG93LnJlcXVpcmUucmVzb2x2ZShwYXRoKVxyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh3aW5kb3cucmVxdWlyZS5jYWNoZSkuY29udGFpbnMocmVzUGF0aCkpIGRlbGV0ZSB3aW5kb3cucmVxdWlyZS5jYWNoZVt3aW5kb3cucmVxdWlyZS5yZXNvbHZlKHJlc1BhdGgpXVxyXG5cclxuICAgICAgICBjb25zdCBtb2QgPSByZXF1aXJlKHBhdGgpXHJcblxyXG4gICAgICAgIHJldHVybiAoaXNFeHRhbnQobW9kKSkgXHJcbiAgICAgICAgICA/IFByb21pc2UucmVzb2x2ZShbZi5iYXNlbmFtZSwgbW9kXSlcclxuICAgICAgICAgIDogUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oZSlcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKVxyXG4gICAgICB9ICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocmVhZHMpXHJcbiAgICAudGhlbigoc2V0dGxlZCkgPT4geyByZXR1cm4gc2V0dGxlZFxyXG4gICAgICAuZmlsdGVyKChyKSA9PiB7cmV0dXJuIHIuc3RhdHVzID09IFwiZnVsZmlsbGVkXCJ9KVxyXG4gICAgICAubWFwKCh2KSA9PiB7cmV0dXJuICh2IGFzIFByb21pc2VGdWxmaWxsZWRSZXN1bHQ8W3N0cmluZywgU3RyaW5nZGV4XT4pLnZhbHVlfSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBjbGVhckpTKC4uLml0ZW1zOiBBcnJheTxURmlsZSB8IHN0cmluZz4pOiB2b2lkIHtcclxuICAgIGxldCBuYW1lcyA9IGl0ZW1zLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICBpZiAoaXNGaWxlKGl0ZW0pKSByZXR1cm4gZmlsdGVyRmlsZUV4dChpdGVtLCAnanMnKVswXS5iYXNlbmFtZVxyXG4gICAgICBlbHNlIGlmIChTdHJpbmcuaXNTdHJpbmcoaXRlbSkpIHJldHVybiBpdGVtIFxyXG4gICAgfSlcclxuXHJcbiAgICBmb3IgKGxldCBuYW1lIG9mIG5hbWVzKSB0aGlzLmxvYWRlZE1vZHVsZXMuZGVsZXRlKG5hbWUpXHJcbiAgfVxyXG5cclxuICBhc3luYyByZWxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLmxvYWRlZE1vZHVsZXMuY2xlYXIoKVxyXG4gICAgYXdhaXQgdGhpcy5pbml0TG9hZCgpXHJcbiAgICByZXR1cm4gc3VwZXIucmVsb2FkKClcclxuICB9XHJcblxyXG4gIC8vIEV2ZW50IGxpc3RlbmVycyBmb3IgZmlsZSBldmVudHMgcmVnaXN0ZXJlZCBieSBFdGFIYW5kZXJcclxuICBmaWxlVXBkYXRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBpbiBzY3JpcHQgZGlyZWN0b3J5IG1vZGlmaWVkLCB1cGRhdGluZy4uLmApXHJcbiAgICB0aGlzLmNsZWFySlMoZmlsZSlcclxuICAgIHRoaXMubG9hZEFuZFNldChmaWxlKVxyXG4gICAgLnRoZW4oKCkgPT4ge3RoaXMuc2V0RGlydHkoKX0sICgpID0+IHRoaXMuY2xlYXJKUyhmaWxlKSlcclxuICB9XHJcblxyXG4gIGZpbGVEZWxldGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIHJlbW92ZWQgZnJvbSBzY3JpcHQgZGlyZWN0b3J5LCB1bmxvYWRpbmcuLi5gKVxyXG4gICAgdGhpcy5jbGVhckpTKGZpbGUpXHJcbiAgICB0aGlzLnNldERpcnR5KClcclxuICB9XHJcblxyXG4gIGZpbGVBZGRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBhZGRlZCB0byBzY3JpcHQgZGlyZWN0b3J5LCBsb2FkaW5nLi4uYClcclxuICAgIHRoaXMubG9hZEFuZFNldChmaWxlKVxyXG4gICAgLnRoZW4oKCkgPT4ge3RoaXMuc2V0RGlydHkoKX0sICgpID0+IHRoaXMuY2xlYXJKUyhmaWxlKSlcclxuICB9XHJcblxyXG4gIGZpbGVSZW5hbWVkKGZpbGU6IFRBYnN0cmFjdEZpbGUsIG9sZE5hbWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgaWYgKCFpc0ZpbGUoZmlsZSkpIHJldHVybjtcclxuICAgIHZMb2coYFNjcmlwdCBmaWxlICcke29sZE5hbWV9JyByZW5hbWVkIHRvICcke2ZpbGUubmFtZX0nLCB1cGRhdGluZy4uLmApXHJcbiAgICB0aGlzLmNsZWFySlMob2xkTmFtZSlcclxuICAgIHRoaXMubG9hZEFuZFNldChmaWxlKVxyXG4gICAgLnRoZW4oKCkgPT4ge3RoaXMuc2V0RGlydHkoKX0sICgpID0+IHt9KVxyXG4gIH1cclxuXHJcbiAgZGlyZWN0b3J5Q2hhbmdlZCgpOiB2b2lkIHtcclxuICAgIHZMb2coYFNjcmlwdCBkaXJlY3RvcnkgY2hhbmdlZCwgcmVsb2FkaW5nIHNjcmlwdHMuLi5gKVxyXG4gICAgdGhpcy5yZWxvYWQoKS50aGVuKCgpID0+IHRoaXMuc2V0RGlydHkoKSwgKGUpID0+IHtjb25zb2xlLndhcm4oZSl9KVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBcHAsIE1hcmtkb3duUmVuZGVyZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcbmltcG9ydCB7IFZBUl9OQU1FIH0gZnJvbSBcInNyYy90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgeyBEeW5hbWljU3RhdGUsIFN0cmluZ2RleCwgU3RyaW5nZGV4ZWQgfSBmcm9tIFwic3JjL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRnVuYyB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyU0sgfSBmcm9tIFwiLi9wcm92aWRlcnMvYmFzZVwiO1xyXG5pbXBvcnQgeyBQcm92aWRlckRhdGF2aWV3IH0gZnJvbSBcIi4vcHJvdmlkZXJzL2ludGVncmF0aW9uL2R2XCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyV2VhdGhlciB9IGZyb20gXCIuL3Byb3ZpZGVycy9pbnRlZ3JhdGlvbi93ZWF0aGVyXCI7XHJcbmltcG9ydCB7IFByb3ZpZGVyU2NyaXB0bG9hZGVyIH0gZnJvbSBcIi4vcHJvdmlkZXJzL3NjcmlwdGxvYWRlclwiO1xyXG5pbXBvcnQgeyBJUHJvdmlkZXIsIFByb3ZpZGVyLCBQcm92aWRlclByZWRpY2F0ZWQgfSBmcm9tIFwiLi9wcm92aWRlcl9hYnNcIjtcclxuXHJcbmNvbnN0IG9ic2lkaWFuTW9kdWxlID0gcmVxdWlyZShcIm9ic2lkaWFuXCIpO1xyXG5cclxuY29uc3QgTU9EVUxFX05BTUVfSU5URUdSQVRJT05TOiBzdHJpbmcgPSAnaW50JztcclxuXHJcbnR5cGUgUHJvdmlkZXJpc2ggPSBJUHJvdmlkZXJcclxuXHJcbi8qIEhhbmRsZXMgYWxsIHNjcmlwdCBmdW5jdGlvbiBwcm92aWRlcnMgKi9cclxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyQnVzIHtcclxuXHJcbiAgaGFuZGxlcjogRXRhSGFuZGxlclxyXG4gIHBsdWdpbjogU2tyaWJvc1BsdWdpblxyXG5cclxuICBwcm92aWRlcnM6IE1hcDxzdHJpbmcsIFByb3ZpZGVyPiA9IG5ldyBNYXAoKVxyXG4gIHByb3ZpZGVyc1ByZWRpY2F0ZWQ6IE1hcDxzdHJpbmcsIFByb3ZpZGVyUHJlZGljYXRlZD4gPSBuZXcgTWFwKClcclxuXHJcbiAgLyogSGFzIGEgcmVmZXJlbmNlIHNvIHRoYXQgaXQgY2FuIGJlIG5vdGlmaWVkIGJ5IHVwZGF0ZSBldmVudHMgKi9cclxuICBzY3JpcHRMb2FkZXI6IFByb3ZpZGVyU2NyaXB0bG9hZGVyO1xyXG5cclxuICBza0Jhc2U6IFByb3ZpZGVyU0s7XHJcblxyXG4gIHByaXZhdGUgc2NvcGVTdGF0aWM6IFN0cmluZ2RleCA9IHt9XHJcblxyXG4gIC8vIEluZGljYXRlcyB0aGF0IGEgcHJvdmlkZXIgaGFzIGJlZW4gYWRkZWQgb3IgcmVtb3ZlZCwgYW5kIHRoZSBzdGF0aWMgc2NvcGUgc2hvdWxkIGJlIHJlZ2VuZXJhdGVkLlxyXG4gIGlzU3RhdGljU2NvcGVEaXJ0eTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihoYW5kbGVyOiBFdGFIYW5kbGVyKSB7XHJcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyXHJcbiAgICB0aGlzLnBsdWdpbiA9IGhhbmRsZXIucGx1Z2luXHJcblxyXG4gICAgdGhpcy5zY3JpcHRMb2FkZXIgPSBuZXcgUHJvdmlkZXJTY3JpcHRsb2FkZXIodGhpcywgJ2pzJyk7IC8vIGFzc2lnbmVkIGhlcmUgc28gdGhhdCB3ZSBjYW4gcmVnaXN0ZXIgZmlsZSBldmVudHMgaW4gaGFuZGxlclxyXG4gIH1cclxuXHJcbiAgLyogQ29uc3RydWN0IGFsbCBwcm92aWRlcnMgYnV0IGRvIG5vdCBpbml0aWFsaXplIHRoZW0geWV0LCBzbyB0aGF0IHdlIGNhbiBjb21waWxlIGFuZCBjYWNoZSB0ZW1wbGF0ZXMgQVNBUCAqL1xyXG4gIGFzeW5jIHByZUluaXQoKSB7XHJcbiAgICB0aGlzLmFkZFRvKHRoaXMucHJvdmlkZXJzLCB0aGlzLnNjcmlwdExvYWRlcilcclxuICAgIHRoaXMuYWRkVG8odGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLCBuZXcgUHJvdmlkZXJEYXRhdmlldyh0aGlzLCAnZHYnKSlcclxuICAgIHRoaXMuYWRkVG8odGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLCBuZXcgUHJvdmlkZXJXZWF0aGVyKHRoaXMsICd3ZWF0aGVyJykpXHJcbiAgICB0aGlzLnNrQmFzZSA9IG5ldyBQcm92aWRlclNLKHRoaXMsIFZBUl9OQU1FKVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgY29uc3QgaW5pdHMgPSBPYmplY3QudmFsdWVzKHRoaXMuZXhlY09uUHJvdmlkZXJzKCdpbml0JykpXHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGluaXRzKVxyXG4gICAgdGhpcy5jcmVhdGVTdGF0aWNTY29wZSgpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkVG8ocHJvdmlkZXJzOiBNYXA8c3RyaW5nLCBJUHJvdmlkZXI+LCBwcm92aWRlcjogUHJvdmlkZXIpIHtcclxuICAgIHByb3ZpZGVycy5zZXQocHJvdmlkZXIuaWQsIHByb3ZpZGVyKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW50ZWdyYXRpb24gcG9pbnQgZm9yIG90aGVyIHBsdWdpbnMgdG8gYWRkIGEgcHJvdmlkZXIgXHJcbiAgICogQHBhcmFtIHByb3ZpZGVyIFByb3ZpZGVyIGltcGxlbWVudGF0aW9uIHRvIGFkZCAqL1xyXG4gIHB1YmxpYyBhZGRQcm92aWRlciA9IChwcm92aWRlcjogUHJvdmlkZXIpID0+IHtcclxuICAgIHRoaXMucHJvdmlkZXJzLnNldChwcm92aWRlci5pZCwgcHJvdmlkZXIpXHJcbiAgICB0aGlzLmlzU3RhdGljU2NvcGVEaXJ0eSA9IHRydWVcclxuICAgIHRoaXMuaGFuZGxlci5yZWNvbXBpbGVUZW1wbGF0ZXMoKVxyXG4gIH1cclxuICBcclxuICAvKipcclxuICAgKiBJbnRlZ3JhdGlvbiBwb2ludCBmb3Igb3RoZXIgcGx1Z2lucyB0byBhZGQgYSBwcmVkaWNhdGVkIHByb3ZpZGVyXHJcbiAgICogQHBhcmFtIHByb3ZpZGVyIFByb3ZpZGVyUHJlZGljYXRlZCBpbXBsZW1lbnRhdGlvbiB0byBhZGQgKi9cclxuICBhZGRQcm92aWRlclByZWRpY2F0ZWQgPSAocHJvdmlkZXI6IFByb3ZpZGVyUHJlZGljYXRlZCkgPT4ge1xyXG4gICAgdGhpcy5wcm92aWRlcnNQcmVkaWNhdGVkLnNldChwcm92aWRlci5pZCwgcHJvdmlkZXIpXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmV4ZWNPblByb3ZpZGVycygndW5sb2FkJylcclxuICB9XHJcblxyXG4gIC8qIEludm9rZWQgYnkgcHJvdmlkZXJzIHRvIGluZGljYXRlIHRoZWlyIHByb3Zpc2lvbiBtdXN0IGJlIHJlZ2VuZXJhdGVkICovXHJcbiAgcHJvdmlkZXJOb3RpZmljYXRpb25EaXJ0eShwcm92aWRlcjogUHJvdmlkZXIsIGlzRGlydHk6IGJvb2xlYW4pIHtcclxuICAgIGlmIChpc0RpcnR5KSB0aGlzLnJlZnJlc2hQcm92aWRlcihwcm92aWRlcilcclxuICB9XHJcblxyXG4gIC8qIENsZWFuIGRpcnR5IHByb3ZpZGVycyBieSByZWdlbmVyYXRpbmcgdGhlaXIgcHJvdmlzaW9uICovXHJcbiAgcmVmcmVzaFByb3ZpZGVyKC4uLnByb3ZpZGVyczogUHJvdmlkZXJbXSkge1xyXG4gICAgbGV0IHByb3h5OiBhbnkgPSB7fTtcclxuXHJcbiAgICBmb3IgKGxldCBwcm92aWRlciBvZiBwcm92aWRlcnMpIHtcclxuICAgICAgcHJveHlbcHJvdmlkZXIuaWRdID0gcHJvdmlkZXIuY3JlYXRlT2JqZWN0KClcclxuICAgICAgcHJvdmlkZXIuc2V0RGlydHkoZmFsc2UpXHJcbiAgICB9XHJcblxyXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnNjb3BlU3RhdGljLCBwcm94eSlcclxuICB9XHJcblxyXG4gIC8qIFJlbG9hZHMgYWxsIHByb3ZpZGVycyAqL1xyXG4gIGFzeW5jIHJlbG9hZFByb3ZpZGVycygpIHtcclxuICAgIGxldCBwcm9tcyA9IHRoaXMuZXhlY09uUHJvdmlkZXJzKCdyZWxvYWQnKVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbFNldHRsZWQoT2JqZWN0LnZhbHVlcyhwcm9tcykpXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0U2NvcGVLZXlzKCkge1xyXG4gICAgcmV0dXJuIFsuLi50aGlzLnByb3ZpZGVycy5rZXlzKCksIE1PRFVMRV9OQU1FX0lOVEVHUkFUSU9OUywgJ21vbWVudCcsICdvYnNpZGlhbiddXHJcbiAgfVxyXG5cclxuICAvKiBSZXRyaWV2ZXMgcHJvdmlkZXJzIG9iamVjdCAqL1xyXG4gIHB1YmxpYyBnZXRTY29wZShjdHg/OiBEeW5hbWljU3RhdGUsIHJlZnJlc2g/OiBib29sZWFuKSB7XHJcbiAgICBsZXQgZGlydGllcyA9IE9iamVjdC52YWx1ZXModGhpcy5wcm92aWRlcnMpLmZpbHRlcigocDogUHJvdmlkZXIpID0+IHtyZXR1cm4gcC5pc0RpcnR5fSlcclxuICAgIGlmIChkaXJ0aWVzKSB0aGlzLnJlZnJlc2hQcm92aWRlciguLi5kaXJ0aWVzKVxyXG5cclxuICAgIGlmICh0aGlzLmlzU3RhdGljU2NvcGVEaXJ0eSkgdGhpcy5jcmVhdGVTdGF0aWNTY29wZSgpXHJcblxyXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2NvcGVTdGF0aWMsIHtbTU9EVUxFX05BTUVfSU5URUdSQVRJT05TXTogdGhpcy5jcmVhdGVQcmVkaWNhdGVkU2NvcGUoY3R4IHx8IG51bGwpfSlcclxuICB9XHJcblxyXG4gIC8qIENyZWF0ZXMgc2NvcGUgb2JqZWN0LiBTaG91bGQgbm90IGJlIHVzZWQgdG8gZ2V0IHRoZSBzY29wZS4gKi9cclxuICBwcml2YXRlIGNyZWF0ZVN0YXRpY1Njb3BlKCkge1xyXG4gICAgbGV0IHNwYWNlczoge1trZXk6IHN0cmluZ106IGFueX0gPSB7fTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgcCBvZiB0aGlzLnByb3ZpZGVycykgc3BhY2VzW3BbMF1dID0gcFsxXS5jcmVhdGVPYmplY3QoKTtcclxuXHJcbiAgICBzcGFjZXNbJ21vbWVudCddID0gd2luZG93Lm1vbWVudFxyXG4gICAgc3BhY2VzWydvYnNpZGlhbiddID0gb2JzaWRpYW5Nb2R1bGVcclxuICAgIFxyXG4gICAgdGhpcy5zY29wZVN0YXRpYyA9IHNwYWNlc1xyXG4gICAgdGhpcy5pc1N0YXRpY1Njb3BlRGlydHkgPSBmYWxzZVxyXG4gICAgcmV0dXJuIHRoaXMuc2NvcGVTdGF0aWNcclxuICB9XHJcblxyXG4gIC8qIFByZWRpY2F0ZWQgcHJvdmlkZXJzICovXHJcbiAgY3JlYXRlUHJlZGljYXRlZFNjb3BlKGN0eD86IER5bmFtaWNTdGF0ZSkge1xyXG4gICAgbGV0IHNwYWNlczoge1trZXk6IHN0cmluZ106IGFueX0gPSB7fTtcclxuICAgXHJcbiAgICBmb3IgKGxldCBwIG9mIHRoaXMucHJvdmlkZXJzUHJlZGljYXRlZCkge1xyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3BhY2VzLCBwWzBdLCB7IGdldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZiAocFsxXS5wcmVkaWNhdGVDaGVjaygpKSByZXR1cm4gcFsxXS5jcmVhdGVPYmplY3QoKVxyXG4gICAgICAgICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IocFsxXS5wcmVkaWNhdGVFcnJvcigpKVxyXG4gICAgICAgIH0gXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBzcGFjZXNcclxuICB9XHJcblxyXG4gIC8qIEdldCB0aGUgYmFzZSBwcm92aWRlciBzY29wZSAqL1xyXG4gIGdldFNjb3BlU0soKSB7XHJcbiAgICByZXR1cm4gdGhpcy5za0Jhc2UuY3JlYXRlT2JqZWN0KClcclxuICB9XHJcblxyXG4gIC8qIEludm9rZSBmdW5jdGlvbiBvbiBhbGwgcHJvdmlkZXJzIGFuZCByZXR1cm4gYXJyYXkgb2YgcmVzdWx0cyAqL1xyXG4gIGV4ZWNPblByb3ZpZGVycyhmdW5jOiAoa2V5b2YgSVByb3ZpZGVyKSk6IFN0cmluZ2RleCB7XHJcbiAgICBsZXQgcmV0czogU3RyaW5nZGV4ID0ge307XHJcblxyXG4gICAgY29uc3QgaW52b2tlID0gKHByb3ZpZGVyczogTWFwPHN0cmluZywgUHJvdmlkZXI+KSA9PiB7XHJcbiAgICAgIGZvciAobGV0IHAgb2YgcHJvdmlkZXJzKSBpZiAoKHAgIT0gbnVsbCkgJiYgKGlzRnVuYyhwWzFdW2Z1bmNdKSkpIHtyZXRzW3BbMF1dID0gKHBbMV1bZnVuY10gYXMgRnVuY3Rpb24pKCl9XHJcbiAgICB9XHJcblxyXG4gICAgaW52b2tlKHRoaXMucHJvdmlkZXJzKVxyXG4gICAgaW52b2tlKHRoaXMucHJvdmlkZXJzUHJlZGljYXRlZClcclxuXHJcbiAgICByZXR1cm4gcmV0c1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQcm92aWRlckJ1cyB7XHJcbiAgZXhlY09uUHJvdmlkZXJzKGZ1bmM6ICdyZWxvYWQnKToge1tpbmRleDogc3RyaW5nXTogUHJvbWlzZTx2b2lkPn1cclxuICBleGVjT25Qcm92aWRlcihmdW5jOiAnaW5pdCcpOiB7W2luZGV4OiBzdHJpbmddOiBQcm9taXNlPHZvaWQ+fVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBDYWNoZXI8VD4ge1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY2FjaGU6IFJlY29yZDxzdHJpbmcsIFQ+KSB7fVxyXG4gIGRlZmluZShrZXk6IHN0cmluZywgdmFsOiBUKTogdm9pZCB7dGhpcy5jYWNoZVtrZXldID0gdmFsfVxyXG4gIGdldChrZXk6IHN0cmluZyk6IFQge3JldHVybiB0aGlzLmNhY2hlW2tleV19XHJcbiAgcmVtb3ZlKGtleTogc3RyaW5nKTogdm9pZCB7ZGVsZXRlIHRoaXMuY2FjaGVba2V5XX1cclxuICByZXNldCgpOiB2b2lkIHt0aGlzLmNhY2hlID0ge319XHJcbiAgbG9hZChjYWNoZU9iajogUmVjb3JkPHN0cmluZywgVD4pOiB2b2lkIHtjb3B5UHJvcHModGhpcy5jYWNoZSwgY2FjaGVPYmopfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29weVByb3BzPFQ+KHRvT2JqOiBULCBmcm9tT2JqOiBUKTogVCB7XHJcbiAgZm9yIChjb25zdCBrZXkgaW4gZnJvbU9iaikge1xyXG4gICAgaWYgKGhhc093blByb3AoKGZyb21PYmogYXMgdW5rbm93bikgYXMgb2JqZWN0LCBrZXkpKSB7XHJcbiAgICAgIHRvT2JqW2tleV0gPSBmcm9tT2JqW2tleV1cclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHRvT2JqXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNPd25Qcm9wKG9iajogb2JqZWN0LCBwcm9wOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcClcclxufSIsImltcG9ydCAqIGFzIEV0YSBmcm9tIFwiZXRhXCI7XHJcbmltcG9ydCB7IEZyb250TWF0dGVyQ2FjaGUsIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xyXG5pbXBvcnQgeyBFQkFSLCBWQVJfTkFNRSB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IHsgY2hlY2tGaWxlRXh0LCBnZXRGaWxlcywgaXNFeHRhbnQsIGlzRmlsZSwgcm91bmRUbywgdkxvZywgd2l0aG91dEtleSB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSBcIi4vZXRhXCI7XHJcbmltcG9ydCB7IENhY2hlciB9IGZyb20gXCIuL2NhY2hlclwiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBjb21waWxlV2l0aCB9IGZyb20gXCIuL2NvbXBcIjtcclxuXHJcbi8qIFJlc3BvbnNpYmxlIGZvciB0aGUgY2FjaGluZyBhbmQgbWFuYWdlbWVudCBvZiB0ZW1wbGF0ZXMuICovXHJcbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZUxvYWRlciB7XHJcbiAgcHJpdmF0ZSBoYW5kbGVyOiBFdGFIYW5kbGVyXHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuXHJcbiAgdGVtcGxhdGVDYWNoZTogQ2FjaGVyPFRlbXBsYXRlRnVuY3Rpb25TY29wZWQ+ID0gbmV3IENhY2hlcjxUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkPih7fSlcclxuICB0ZW1wbGF0ZUZhaWx1cmVzOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xyXG4gIHRlbXBsYXRlRnJvbnRtYXR0ZXJzOiBNYXA8c3RyaW5nLCBGcm9udE1hdHRlckNhY2hlPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgZ2V0IGRpcmVjdG9yeSgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVGb2xkZXIgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihoYW5kbGVyOiBFdGFIYW5kbGVyKSB7XHJcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyXHJcbiAgICB0aGlzLnBsdWdpbiA9IGhhbmRsZXIucGx1Z2luXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCk6IFByb21pc2U8YW55PiB7XHJcbiAgICByZXR1cm4gdGhpcy5pbml0TG9hZCgpXHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0TG9hZCgpIHtcclxuICAgIGF3YWl0IHRoaXMuZGVmaW5lUGFydGlhbHMoLi4uZ2V0RmlsZXModGhpcy5wbHVnaW4uYXBwLCB0aGlzLmRpcmVjdG9yeSkpIFxyXG4gICAgdGhpcy5wbHVnaW4ubG9hZEV2ZW50cy50cmlnZ2VyKCdpbml0LWxvYWQtY29tcGxldGUnKSAvL1RPRE86IHVzZSBuYXRpdmUgZXZlbnRzP1xyXG5cclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG4gIH1cclxuXHJcbiAgLyogTG9hZCBhbmQgY29tcGlsZSBmaWxlcyBpbnRvIHRoZSB0ZW1wbGF0ZSBjYWNoZSAqL1xyXG4gIGFzeW5jIGRlZmluZVBhcnRpYWxzKC4uLmZpbGVzOiBURmlsZVtdKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcclxuICAgIHZhciBmYWlsdXJlQ291bnQgPSAwXHJcbiAgICB2YXIgc3VjY2Vzc0NvdW50ID0gMFxyXG5cclxuICAgIGNvbnN0IHNjb3BlS2V5cyA9IHRoaXMuaGFuZGxlci5idXMuZ2V0U2NvcGVLZXlzKClcclxuXHJcbiAgICBjb25zdCByZWFkUHJvbWlzZXMgPSBmaWxlcy5tYXAoYXN5bmMgZmlsZSA9PiB7XHJcbiAgICAgIGlmICghY2hlY2tGaWxlRXh0KGZpbGUsIFtcIm1kXCIsIFwiZXRhXCIsIFwidHh0XCJdKSkgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XHJcblxyXG4gICAgICBsZXQgcmVhZCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpXHJcblxyXG4gICAgICBsZXQgZmlsZUZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlclxyXG4gICAgICBpZiAoZmlsZUZyb250bWF0dGVyKSB7XHJcbiAgICAgICAgbGV0IGZtU2VhcmNoID0gKC8oPzxmcm9udG1hdHRlcj5eLS0tLio/KD89XFxuLS0tKVxcbi0tLSkvcykuZXhlYyhyZWFkKTtcclxuICAgICAgICBsZXQgZm1UZXh0ID0gZm1TZWFyY2g/Lmdyb3Vwcz8uZnJvbnRtYXR0ZXIgPz8gbnVsbFxyXG4gICAgICAgIGlmIChpc0V4dGFudChmbVRleHQpKSB7IHJlYWQgPSByZWFkLnN1YnN0cihmbVRleHQubGVuZ3RoKX0gICAgICBcclxuICAgICAgfVxyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBsZXQgY29tcGlsZWRTdHJpbmcgPSBFdGEuY29tcGlsZVRvU3RyaW5nKHJlYWQsIEV0YS5nZXRDb25maWcoe3Zhck5hbWU6IFZBUl9OQU1FLCBuYW1lOiBmaWxlLmJhc2VuYW1lfSkpXHJcbiAgICAgICAgdmFyIGNvbXBpbGVkID0gY29tcGlsZVdpdGgoY29tcGlsZWRTdHJpbmcsIFtWQVJfTkFNRSwgJ0UnLCAnY2InLCAuLi5zY29wZUtleXNdKVxyXG4gICAgICB9IGNhdGNoKGVycikge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVGYWlsdXJlcy5zZXQoZmlsZS5iYXNlbmFtZSwgZXJyIHx8IGBUZW1wbGF0ZSBmYWlsZWQgdG8gY29tcGlsZTogVW5rbm93biBFcnJvcmApXHJcbiAgICAgICAgY29uc29sZS53YXJuKGBTa3JpYmk6IHRlbXBsYXRlICcke2ZpbGUuYmFzZW5hbWV9JyBmYWlsZWQgdG8gY29tcGlsZWAsIEVCQVIsIGVyciwgRUJBUiwgcmVhZClcclxuICAgICAgICB0aGlzLnRlbXBsYXRlQ2FjaGUucmVtb3ZlKGZpbGUuYmFzZW5hbWUpXHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUZyb250bWF0dGVycy5kZWxldGUoZmlsZS5iYXNlbmFtZSlcclxuICAgICAgICBmYWlsdXJlQ291bnQrK1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMudGVtcGxhdGVGYWlsdXJlcy5kZWxldGUoZmlsZS5iYXNlbmFtZSlcclxuICAgICAgdGhpcy50ZW1wbGF0ZUNhY2hlLmRlZmluZShmaWxlLmJhc2VuYW1lLCBjb21waWxlZClcclxuICAgICAgaWYgKGZpbGVGcm9udG1hdHRlcikgdGhpcy50ZW1wbGF0ZUZyb250bWF0dGVycy5zZXQoZmlsZS5iYXNlbmFtZSwgd2l0aG91dEtleShmaWxlRnJvbnRtYXR0ZXIsICdwb3NpdGlvbicpIGFzIEZyb250TWF0dGVyQ2FjaGUpXHJcbiAgICAgIHN1Y2Nlc3NDb3VudCsrXHJcblxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgIH0pXHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHJlYWRQcm9taXNlcylcclxuXHJcbiAgICBpZiAoKCF0aGlzLnBsdWdpbi5pbml0TG9hZGVkKSAmJiBmaWxlcy5sZW5ndGgpIHtcclxuICAgICAgbGV0IHN0ciA9IGAke3N1Y2Nlc3NDb3VudH0gdGVtcGxhdGUkeyhzdWNjZXNzQ291bnQgPT0gMSkgPyAnJyA6ICdzJ31gXHJcbiAgICAgIGlmIChmYWlsdXJlQ291bnQpIHN0ciArPSBgXFxuIE9mICR7ZmlsZXMubGVuZ3RofSB0b3RhbCB0ZW1wbGF0ZXMsICR7ZmFpbHVyZUNvdW50fSBmYWlsZWQgdG8gY29tcGlsZS5gXHJcbiAgICAgIGNvbnNvbGUubG9nKGBTa3JpYmk6IExvYWRlZCBgICsgc3RyKVxyXG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdWdpbi5pbml0TG9hZGVkKSB7XHJcbiAgICAgIHZMb2coYFVwZGF0ZWQgdGVtcGxhdGUgJyR7ZmlsZXNbMF0uYmFzZW5hbWV9JyBpbiAke3JvdW5kVG8od2luZG93LnBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lLCA0KX1tc2ApXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgfVxyXG5cclxuICAvKiBEZWxldGVzIGNhY2hlIGVudHJpZXMgYnkgc3RyaW5nIG5hbWUgb3IgZmlsZSBvZiBvcmlnaW4gKi9cclxuICBkZWxldGVQYXJ0aWFsKC4uLml0ZW1zOiBBcnJheTxURmlsZSB8IHN0cmluZz4pOiB2b2lkIHtcclxuICAgIGZvciAobGV0IGl0ZW0gb2YgaXRlbXMpIHtcclxuICAgICAgbGV0IG5hbWUgPSBpc0ZpbGUoaXRlbSkgPyBpdGVtLmJhc2VuYW1lIDogaXRlbVxyXG4gICAgICB0aGlzLnRlbXBsYXRlQ2FjaGUucmVtb3ZlKG5hbWUpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyByZWxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnRlbXBsYXRlQ2FjaGUucmVzZXQoKVxyXG4gICAgcmV0dXJuIHRoaXMuZGVmaW5lUGFydGlhbHMoLi4uZ2V0RmlsZXModGhpcy5wbHVnaW4uYXBwLCB0aGlzLmRpcmVjdG9yeSkpXHJcbiAgfVxyXG5cclxuICAvKiBUaGVzZSBmdW5jdGlvbnMgYXJlIHJlZ2lzdGVyZWQgdG8gdGhlIGFwcHJvcHJpYXRlIGV2ZW50cyBieSBoYW5kbGVyICovXHJcblxyXG4gIGZpbGVVcGRhdGVkKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiB2b2lkIHtcclxuICAgIGlmICghaXNGaWxlKGZpbGUpKSByZXR1cm47XHJcbiAgICB2TG9nKGBGaWxlICcke2ZpbGUubmFtZX0nIGluIHRlbXBsYXRlIGRpcmVjdG9yeSBtb2RpZmllZCwgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5kZWZpbmVQYXJ0aWFscyhmaWxlKVxyXG4gIH1cclxuXHJcbiAgZmlsZURlbGV0ZWQoZmlsZTogVEFic3RyYWN0RmlsZSB8IHN0cmluZyk6IHZvaWQge1xyXG4gICAgbGV0IGlzZiA9IGlzRmlsZShmaWxlKVxyXG4gICAgaWYgKCghaXNmICYmICEoU3RyaW5nLmlzU3RyaW5nKGZpbGUpICYmIHRoaXMudGVtcGxhdGVDYWNoZS5nZXQoZmlsZSkpKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtpc2YgPyAoZmlsZSBhcyBURmlsZSkubmFtZSA6IGZpbGV9JyByZW1vdmVkIGZyb20gdGVtcGxhdGUgZGlyZWN0b3J5LCB1bmxvYWRpbmcuLi5gKVxyXG4gICAgdGhpcy5kZWxldGVQYXJ0aWFsKGZpbGUgYXMgKFRGaWxlIHwgc3RyaW5nKSlcclxuICB9XHJcblxyXG4gIGZpbGVBZGRlZChmaWxlOiBUQWJzdHJhY3RGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgRmlsZSAnJHtmaWxlLm5hbWV9JyBhZGRlZCB0byB0ZW1wbGF0ZSBkaXJlY3RvcnksIGxvYWRpbmcuLi5gKVxyXG4gICAgdGhpcy5kZWZpbmVQYXJ0aWFscyhmaWxlKVxyXG4gIH1cclxuXHJcbiAgZmlsZVJlbmFtZWQoZmlsZTogVEFic3RyYWN0RmlsZSwgb2xkTmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuO1xyXG4gICAgdkxvZyhgVGVtcGxhdGUgZmlsZSAnJHtvbGROYW1lfScgcmVuYW1lZCB0byAnJHtmaWxlLm5hbWV9JywgdXBkYXRpbmcuLi5gKVxyXG4gICAgdGhpcy5kZWxldGVQYXJ0aWFsKG9sZE5hbWUpXHJcbiAgICB0aGlzLmRlZmluZVBhcnRpYWxzKGZpbGUpXHJcbiAgfVxyXG5cclxuICBkaXJlY3RvcnlDaGFuZ2VkKCk6IHZvaWQge1xyXG4gICAgdkxvZyhgVGVtcGxhdGUgZGlyZWN0b3J5IGNoYW5nZWQsIHJlbG9hZGluZyB0ZW1wbGF0ZXMuLi5gKVxyXG4gICAgdGhpcy5yZWxvYWQoKVxyXG4gIH1cclxufSIsImltcG9ydCAqIGFzIEV0YSBmcm9tIFwiZXRhXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlRnVuY3Rpb24gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29tcGlsZVwiO1xyXG5pbXBvcnQgeyBFdGFDb25maWcgfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29uZmlnXCI7XHJcbmltcG9ydCB7IG5vcm1hbGl6ZVBhdGgsIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IG5vcm1hbGl6ZSB9IGZyb20gXCJwYXRoXCI7XHJcbmltcG9ydCB7IEVCQVIsIFZBUl9OQU1FIH0gZnJvbSBcInNyYy90eXBlcy9jb25zdFwiO1xyXG5pbXBvcnQgU2tyaWJvc1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xyXG5pbXBvcnQgeyBzY29wZWRWYXJzLCBTdHJpbmdkZXgsIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgfSBmcm9tIFwiLi4vdHlwZXMvdHlwZXNcIjtcclxuaW1wb3J0IHsgaXNFeHRhbnQsIGlzRmlsZSwgaXNJbkZvbGRlciB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IHJlbmRlckV0YUFzeW5jLCByZW5kZXJFdGEsIGNvbXBpbGVXaXRoIH0gZnJvbSBcIi4vY29tcFwiO1xyXG5pbXBvcnQgeyBQcm92aWRlckJ1cyB9IGZyb20gXCIuL3Byb3ZpZGVyX2J1c1wiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZUxvYWRlciB9IGZyb20gXCIuL3RlbXBsYXRlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEV0YUhhbmRsZXIge1xyXG4gIHBsdWdpbjogU2tyaWJvc1BsdWdpbjtcclxuICBidXM6IFByb3ZpZGVyQnVzO1xyXG4gIGxvYWRlcjogVGVtcGxhdGVMb2FkZXI7XHJcblxyXG4gIHRlbXBsYXRlc0RpcnR5OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGJhc2VDb250ZXh0OiB7W2luZGV4OiBzdHJpbmddOiBhbnl9ID0ge31cclxuXHJcbiAgZ2V0IHRlbXBsYXRlcygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZX1cclxuICBnZXQgZmFpbGVkVGVtcGxhdGVzKCkge3JldHVybiB0aGlzLmxvYWRlci50ZW1wbGF0ZUZhaWx1cmVzfVxyXG4gIGdldCB0ZW1wbGF0ZUZyb250bWF0dGVycygpIHtyZXR1cm4gdGhpcy5sb2FkZXIudGVtcGxhdGVGcm9udG1hdHRlcnN9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmJ1cyA9IG5ldyBQcm92aWRlckJ1cyh0aGlzKVxyXG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgVGVtcGxhdGVMb2FkZXIodGhpcylcclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UubGF5b3V0UmVhZHkpXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB0aGlzLmluaXQuYmluZCh0aGlzKSgpKVxyXG4gICAgZWxzZSB0aGlzLmluaXQoKVxyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIHRoaXMuaW5pdExvYWQoKS50aGVuKCgpID0+IHtcclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ21vZGlmeScsIGUgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5TY3JpcHRzKGUpKSB0aGlzLmJ1cy5zY3JpcHRMb2FkZXIuZmlsZVVwZGF0ZWQoZSlcclxuICAgICAgICBpZiAodGhpcy5pc0luVGVtcGxhdGVzKGUpKSB0aGlzLmxvYWRlci5maWxlVXBkYXRlZChlKVxyXG4gICAgICB9KSlcclxuICBcclxuICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ2RlbGV0ZScsIGUgPT4ge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGUpXHJcbiAgICAgICAgaWYgKHRoaXMuaXNJblNjcmlwdHMoZSkpIHRoaXMuYnVzLnNjcmlwdExvYWRlci5maWxlRGVsZXRlZChlKVxyXG4gICAgICAgIGlmICh0aGlzLmlzSW5UZW1wbGF0ZXMoZSkpIHRoaXMubG9hZGVyLmZpbGVEZWxldGVkKGUpXHJcbiAgICAgIH0pKVxyXG4gIFxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignY3JlYXRlJywgZSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJblNjcmlwdHMoZSkpIHRoaXMuYnVzLnNjcmlwdExvYWRlci5maWxlQWRkZWQoZSlcclxuICAgICAgICBpZiAodGhpcy5pc0luVGVtcGxhdGVzKGUpKSB0aGlzLmxvYWRlci5maWxlQWRkZWQoZSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbigncmVuYW1lJywgKGZpbGUsIG9sZFBhdGgpID0+IHtcclxuICAgICAgICBmb3IgKGxldCBvYmogb2YgW3RoaXMuYnVzLnNjcmlwdExvYWRlciwgdGhpcy5sb2FkZXJdKSB7XHJcbiAgICAgICAgICBsZXQgb3VyRGlyID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3JtYWxpemVQYXRoKG9iai5kaXJlY3RvcnkpKVxyXG4gICAgICAgICAgbGV0IG9sZERpciA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplUGF0aCgoLy4rXFwvL2cpLmV4ZWMob2xkUGF0aClbMF0pKVxyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2cob2xkRGlyLCBvdXJEaXIpXHJcbiAgICAgICAgICBpZiAoZmlsZS5wYXJlbnQgPT0gb3VyRGlyKSB7XHJcbiAgICAgICAgICAgIC8vIE5ldyBsb2NhdGlvbiBvZiBmaWxlIGlzIGluIG91ciBkaXJlY3RvcnlcclxuICAgICAgICAgICAgaWYgKGZpbGUucGFyZW50ID09IG9sZERpcikge1xyXG4gICAgICAgICAgICAgIC8vIEZpbGUgZGlkIG5vdCBtb3ZlIGJ1dCB3YXMgcmVuYW1lZFxyXG4gICAgICAgICAgICAgIG9iai5maWxlUmVuYW1lZChmaWxlLCAoLyhbYS16QS1aMC05LV8uXStcXC4uKikvZykuZXhlYyhvbGRQYXRoKVswXSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBGaWxlIHdhcyBtb3ZlZCBmcm9tIGVsc2V3aGVyZSBpbnRvIHRoZSB0ZW1wbGF0ZSBkaXJlY3RvcnlcclxuICAgICAgICAgICAgICBvYmouZmlsZUFkZGVkKGZpbGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAob2xkRGlyID09IG91ckRpcikge1xyXG4gICAgICAgICAgICAvLyBGaWxlIHVzZWQgdG8gYmUgaW4gdGVtcGxhdGVzIGRpcmVjdG9yeSBhbmQgaXMgbm8gbG9uZ2VyXHJcbiAgICAgICAgICAgIG9iai5maWxlRGVsZXRlZChmaWxlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSkpXHJcbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFNrcmliaTogRXRhSGFuZGxlciBmYWlsZWQgdG8gaW5pdGlhbGl6ZSFgLCBFQkFSLCBlcnIpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgaXNJblRlbXBsYXRlcyA9IChlOiBUQWJzdHJhY3RGaWxlKSA9PiBpc0luRm9sZGVyKGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlRm9sZGVyKVxyXG5cdGlzSW5TY3JpcHRzID0gKGU6IFRBYnN0cmFjdEZpbGUpID0+IGlzSW5Gb2xkZXIoZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2NyaXB0Rm9sZGVyKVxyXG5cclxuICBhc3luYyBpbml0TG9hZCgpIHtcclxuICAgIGxldCB7YTogYSwgYjogYn0gPSBhd2FpdCB0aGlzLmJ1cy5wcmVJbml0KCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHJldHVybiB7YTogdGhpcy5idXMuaW5pdCgpLCBiOiB0aGlzLmxvYWRlci5pbml0KCl9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbYSwgYl0pXHJcbiAgfVxyXG5cclxuICB1bmxvYWQoKSB7XHJcbiAgICB0aGlzLmJ1cy51bmxvYWQoKVxyXG4gIH1cclxuXHJcbiAgcmVjb21waWxlVGVtcGxhdGVzKCkge1xyXG4gICAgLy8gSWYgdGhlIGJ1cyBzY29wZSBjaGFuZ2VzLCB0aGUgdGVtcGxhdGVzIG11c3QgYmUgcmVjb21waWxlZC4gXHJcbiAgICAvLyBUaGUgYnVzIHNjb3BlIHNob3VsZCBub3QgY2hhbmdlIHBvc3QtaW5pdCB1bmxlc3MgYW4gZXh0ZXJuYWwgc291cmNlIG1vZGlmaWVzIHRoZSBwcm92aWRlciBsaXN0LlxyXG4gICAgdGhpcy5sb2FkZXIucmVsb2FkKClcclxuICB9XHJcblxyXG4gIGdldFBhcnRpYWwoaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMubG9hZGVyLnRlbXBsYXRlQ2FjaGUuZ2V0KGlkKVxyXG4gIH1cclxuXHJcbiAgaGFzUGFydGlhbChpZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gaXNFeHRhbnQodGhpcy5sb2FkZXIudGVtcGxhdGVDYWNoZS5nZXQoaWQpKVxyXG4gIH1cclxuXHJcbiAgZ2V0Q2FjaGVLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudGVtcGxhdGVzLmNhY2hlKVxyXG4gIH1cclxuXHJcbiAgLyoqICAgXHJcbiAgKiBQcmltYXJ5IHNrcmliaSByZW5kZXIgZnVuY3Rpb24uIFJlbmRlcnMgYXN5bmNocm9ub3VzbHkgKFRlbXBsYXRlRnVuY3Rpb24gbWF5IG9yIG1heSBub3QgYmUgYXN5bmMpXHJcbiAgKiBAcGFyYW0gY29udGVudCBTdHJpbmcgb3Igc2NvcGVkIHRlbXBsYXRlIGZ1bmN0aW9uIHRvIHJlbmRlclxyXG4gICogQHBhcmFtIGN0eEluIENvbnRleHQgb2JqZWN0IHRvIGJlIGFkZGVkIHRvIGBza2Agb2JqZWN0XHJcbiAgKiBAcGFyYW0gZmlsZSBGaWxlIGluIHdoaWNoIHRoZSBza3JpYmkgaXMgYmVpbmcgcmVuZGVyZWQgIFxyXG4gICogQHJldHVybnMgW3JlbmRlcmVkIHN0cmluZywgcmV0dXJuZWQgcGFja2V0IChjdXJyZW50bHkgdW51c2VkKV0gKi9cclxuICBhc3luYyByZW5kZXJBc3luYyhjb250ZW50OiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBjdHhJbj86IGFueSwgZmlsZT86IFRGaWxlKTogUHJvbWlzZTxbc3RyaW5nLCBTdHJpbmdkZXhdPiB7XHJcbiAgICBpZiAoIWlzRmlsZShmaWxlKSkgcmV0dXJuIFByb21pc2UucmVqZWN0KGBDb3VsZCBub3QgaWRlbnRpZnkgY3VycmVudCBmaWxlOiAke2ZpbGV9YCk7XHJcblxyXG4gICAgbGV0IHo6IFN0cmluZ2RleCA9IHt9O1xyXG4gICAgZnVuY3Rpb24gcCgpIHtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHg6IHN0cmluZywgeTogYW55KSB7XHJcbiAgICAgICAgelt4XSA9IHlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBjZmcgPSBFdGEuZ2V0Q29uZmlnKHt2YXJOYW1lOiBWQVJfTkFNRX0pXHJcblxyXG4gICAgLyogdGhlICd0aGlzJyBvYmplY3Qgb2YgdGhlIHNrIGNvbnRleHQqL1xyXG4gICAgbGV0IGJpbmRlciA9IHtcclxuICAgICAgZmlsZTogZmlsZSxcclxuICAgICAgcGx1Z2luOiB0aGlzLnBsdWdpbixcclxuICAgICAgYXBwOiB0aGlzLnBsdWdpbi5hcHBcclxuICAgIH1cclxuXHJcbiAgICAvKiBUaGUgJ3NrJyBvYmplY3QgKi9cclxuICAgIGxldCBzayA9IE9iamVjdC5hc3NpZ24oe30sXHJcbiAgICAgIHRoaXMuYmFzZUNvbnRleHQsXHJcbiAgICAgIGN0eEluIHx8IHt9LCBcclxuICAgICAge3VwOiBwKCksIHRoaXM6IGJpbmRlcn0sXHJcbiAgICAgIHRoaXMuYnVzLmdldFNjb3BlU0soKVxyXG4gICAgKVxyXG5cclxuICAgIC8qIHNjb3BlIG9mIHRoZSB0ZnVuYyBlbnYgKi9cclxuICAgIGxldCBzY29wZTogc2NvcGVkVmFycyA9IHtcclxuICAgICAgJ3NrJzogc2ssXHJcbiAgICAgICdFJzogY2ZnLFxyXG4gICAgICAnY2InOiBudWxsLFxyXG4gICAgICAuLi50aGlzLmJ1cy5nZXRTY29wZSgpLFxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZW4gPSAoY29udGVudC50b1N0cmluZygpLmNvbnRhaW5zKCdhd2FpdCcpKSAvLyBUaGlzIHdpbGwgY2F0Y2ggc3RyaW5ncyBjb250YWluaW5nIGF3YWl0IGFzIHdlbGwsIG1heWJlIGEgZmxhZyBzaG91bGQgYmUgdXNlZCBpbnN0ZWFkXHJcbiAgICAgID8gcmVuZGVyRXRhQXN5bmModGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuICAgICAgOiByZW5kZXJFdGEodGhpcywgY29udGVudCwge30sIGNmZywgbnVsbCwgc2NvcGUsIGJpbmRlcilcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcInBzdWVkbyBwb3N0OlwiLCBzaylcclxuICAgIGlmIChyZW4gaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCByZW4udGhlbigocikgPT4ge3JldHVybiBQcm9taXNlLnJlc29sdmUoW3IsIHpdKX0sIChyKSA9PiB7cmV0dXJuIFByb21pc2UucmVqZWN0KHIpfSlcclxuICAgIH0gZWxzZSBpZiAoU3RyaW5nLmlzU3RyaW5nKHJlbikpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcmVuIGFzIHN0cmluZywgel0pIH1cclxuICAgIGVsc2UgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiRXRhSGFuZGxlci5yZW5kZXJBc3luYzogVW5rbm93biBFcnJvclwiKVxyXG4gIH1cclxuXHJcbiAgLyogdGhpcyBpcyBzb21laG93IDEuM3ggc2xvd2VyIHRoYW4gcmVuZGVyQXN5bmMgKi9cclxuICBhc3luYyByZW5kZXJBc3luY05haXZlKGNvbnRlbnQ6IHN0cmluZyB8IEZ1bmN0aW9uLCBjdHhJbj86IGFueSwgdmFyTmFtZT86IGFueSkge1xyXG4gICAgY29uc29sZS5sb2coJ1Nrcmlib3M6IHJlbmRlckFzeW5jTmFpdmUgaW52b2tlZCcsIGNvbnRlbnQsIGN0eEluKVxyXG4gICAgbGV0IGNvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmJhc2VDb250ZXh0LCBjdHhJbiB8fCB7fSlcclxuICAgIGxldCByZW4gPSBFdGEucmVuZGVyQXN5bmMoY29udGVudCBhcyAoc3RyaW5nIHwgVGVtcGxhdGVGdW5jdGlvbiksIGNvbnRleHQsIHt2YXJOYW1lOiB2YXJOYW1lID8/IFZBUl9OQU1FfSlcclxuXHJcbiAgICBpZiAocmVuIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICByZXR1cm4gYXdhaXQgcmVuLnRoZW4oKHIpID0+IHtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHIpfSwgKHIpID0+IHtyZXR1cm4gUHJvbWlzZS5yZWplY3Qocil9KVxyXG4gICAgfSBlbHNlIGlmIChTdHJpbmcuaXNTdHJpbmcocmVuKSkgeyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlbiBhcyBzdHJpbmcpIH1cclxuICAgIGVsc2UgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiVW5rbm93biBlcnJvclwiKVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKGNvbnRlbnQ6IHN0cmluZywgY3R4SW4/OiBhbnkpIHtcclxuICAgIGxldCBjb250ZXh0ID0gY3R4SW4gfHwge307XHJcblxyXG4gICAgY29udGVudCA9IEV0YS5yZW5kZXIoY29udGVudCwgY29udGV4dCwgeyBcclxuICAgICAgdmFyTmFtZTogVkFSX05BTUVcclxuICAgIH0pIGFzIHN0cmluZztcclxuXHJcbiAgICByZXR1cm4gY29udGVudDtcclxuICB9XHJcblxyXG4gIC8qKiBUZW1wbGF0ZUZ1bmN0aW9uIGhhbmRsZXIsIHdpbGwgcmV0dXJuIGNhY2hlZCBvciBjb21waWxlZCBmdW5jdGlvbiwgYXBwcm9wcmlhdGVseSBib3VuZCBhbmQgc2NvcGVkXHJcbiAgICogQHBhcmFtIHRlbXBsYXRlIFN0cmluZyBvciBzY29wZWQgdGVtcGxhdGUgZnVuY3Rpb25cclxuICAgKiBAcGFyYW0gb3B0aW9ucyBFdGFDb25maWcgXHJcbiAgICogQHBhcmFtIHNjb3BlIE9iamVjdCBjb250YWluaW5nIG9iamVjdHMgdGhhdCBzaG91bGQgYmUgYXZhaWxhYmxlIGluIHRoZSByZXR1cm5lZCBmdW5jdGlvbidzIHNjb3BlIFxyXG4gICAqIEBwYXJhbSBiaW5kZXIgT2JqZWN0IHRvIHdoaWNoIHRoZSByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGJlIGJvdW5kICovXHJcbiAgZ2V0Q2FjaGVkKHRlbXBsYXRlOiBzdHJpbmcgfCBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkLCBvcHRpb25zOiBFdGFDb25maWcsIHNjb3BlPzogU3RyaW5nZGV4LCBiaW5kZXI/OiBhbnkpOiBUZW1wbGF0ZUZ1bmN0aW9uU2NvcGVkIHtcclxuICAgIGlmIChvcHRpb25zLm5hbWUgJiYgdGhpcy50ZW1wbGF0ZXMuZ2V0KG9wdGlvbnMubmFtZSkpIHtcclxuICAgICAgcmV0dXJuIChiaW5kZXIpID8gdGhpcy50ZW1wbGF0ZXMuZ2V0KG9wdGlvbnMubmFtZSkuYmluZChiaW5kZXIpIDogdGhpcy50ZW1wbGF0ZXMuZ2V0KG9wdGlvbnMubmFtZSlcclxuICAgIH1cclxuICBcclxuICAgIGNvbnN0IHRlbXBsYXRlRnVuYyA9IHR5cGVvZiB0ZW1wbGF0ZSA9PT0gJ2Z1bmN0aW9uJyA/IHRlbXBsYXRlIDogY29tcGlsZVdpdGgoRXRhLmNvbXBpbGVUb1N0cmluZyh0ZW1wbGF0ZSwgb3B0aW9ucyksIE9iamVjdC5rZXlzKHNjb3BlKSwgb3B0aW9ucy5hc3luYylcclxuICBcclxuICAgIGlmIChvcHRpb25zLm5hbWUpIHRoaXMudGVtcGxhdGVzLmRlZmluZShvcHRpb25zLm5hbWUsIHRlbXBsYXRlRnVuYyk7XHJcbiAgXHJcbiAgICByZXR1cm4gKGJpbmRlcikgPyB0ZW1wbGF0ZUZ1bmMuYmluZChiaW5kZXIpIDogdGVtcGxhdGVGdW5jXHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiLCBBcHAsIFNldHRpbmcsIFRleHRBcmVhQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIGRlYm91bmNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBTa3JpYm9zUGx1Z2luIGZyb20gXCIuL21haW5cIjtcclxuaW1wb3J0IHsgaXNFeHRhbnQsIGlzRmlsZSwgaXNGdW5jIH0gZnJvbSBcIi4vdXRpbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNrcmlib3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBTa3JpYm9zUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRsZXQge2NvbnRhaW5lckVsfSA9IHRoaXM7XHJcbiBcclxuXHRcdGNvbnRhaW5lckVsLmFkZENsYXNzKFwic2tyaWJpLXNldHRpbmdzXCIpO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnU2tyaWJpIFNldHRpbmdzJ30pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnVGVtcGxhdGUgRGlyZWN0b3J5JylcclxuXHRcdFx0LnNldERlc2MoJ1NrcmliaSB3aWxsIGxvb2sgZm9yIHRlbXBsYXRlcyBpbiB0aGlzIGZvbGRlci4nKVxyXG5cdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQ6IFRleHRBcmVhQ29tcG9uZW50KSA9PiB7dGV4dFxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlcilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSk7IHRleHQuaW5wdXRFbC5jb2xzID0gMzA7IHJldHVybiB0ZXh0fSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdTa3JpcHQgRGlyZWN0b3J5JylcclxuXHRcdFx0LnNldERlc2MoJ1NrcmliaSB3aWxsIGxvb2sgZm9yIEpTIGZpbGVzIGluIHRoaXMgZm9sZGVyLicpXHJcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dDogVGV4dEFyZWFDb21wb25lbnQpID0+IHt0ZXh0XHJcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNjcmlwdEZvbGRlcilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnNhdmVTZXR0aW5nKCdzY3JpcHRGb2xkZXInLCB2YWx1ZSwgKCkgPT4gdGhpcy5wbHVnaW4uZXRhLmJ1cy5zY3JpcHRMb2FkZXIuZGlyZWN0b3J5Q2hhbmdlZCgpKVxyXG5cdFx0XHRcdH0pOyB0ZXh0LmlucHV0RWwuY29scyA9IDMwOyByZXR1cm4gdGV4dH0pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnRXJyb3IgTG9nZ2luZycpXHJcblx0XHRcdC5zZXREZXNjKCdFbmFibGUgdG8gZHVtcCBhbnkgZXJyb3JlZCByZW5kZXJzIHRvIHRoZSBjb25zb2xlLicgXHJcblx0XHRcdCsgJ0lmIGZhbHNlLCB3aWxsIHN0aWxsIGFkZCB0aGUgZXJyb3IgYXMgdG9vbHRpcCBvbiB0aGUgZXJyb3JlZCBlbGVtZW50LiBcXG4nIFxyXG5cdFx0XHQrICdXaWxsIHNwYW0geW91ciBjb25zb2xlIGlmIHR5cGluZyBpbnRvIGEgc2tyaWJpIHdpdGggYSBwcmV2aWV3IHdpbmRvdyBvcGVuLicpXHJcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZTogVG9nZ2xlQ29tcG9uZW50KSA9PiB7IHRvZ2dsZVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lcnJvckxvZ2dpbmcpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZXJyb3JMb2dnaW5nID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KX0pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnVmVyYm9zZSBMb2dnaW5nJylcclxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSB0byBnZXQgbW9yZSBkZXRhaWxlZCBsb2dzIGluIHRoZSBjb25zb2xlLicpXHJcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZTogVG9nZ2xlQ29tcG9uZW50KSA9PiB7IHRvZ2dsZVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJib3NlTG9nZ2luZylcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJib3NlTG9nZ2luZyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSl9KTtcclxuXHR9XHJcblxyXG5cdHNhdmVTZXR0aW5nID0gZGVib3VuY2UoYXN5bmMgKHNldHRpbmc6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4sIGNiPzogRnVuY3Rpb24sIC4uLmFyZ3M6IGFueVtdKSA9PiB7XHJcblx0XHQvLyBjb25zb2xlLmxvZyhcInNhdmluZzogXCIgKyBzZXR0aW5nICsgXCIgPSBcIiArIHZhbHVlKVxyXG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Nbc2V0dGluZ10gPSB2YWx1ZTtcclxuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpLnRoZW4oKCkgPT4ge2lmIChpc0V4dGFudChjYikgJiYgaXNGdW5jKGNiKSkgY2IoLi4uYXJncyB8fCBudWxsKX0pXHJcblx0fSwgMjAwMCwgdHJ1ZSlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTa3JpYm9zU2V0dGluZ3Mge1xyXG5cdFtrZXk6IHN0cmluZ10gOiBib29sZWFuIHwgc3RyaW5nIHwgc3RyaW5nW10gfCBudW1iZXI7XHJcblxyXG5cdHRlbXBsYXRlRm9sZGVyOiBzdHJpbmc7XHJcblx0c2NyaXB0Rm9sZGVyOiBzdHJpbmc7XHJcblx0dmVyYm9zZUxvZ2dpbmc6IGJvb2xlYW47XHJcblx0ZGV2TG9nZ2luZzogYm9vbGVhbjtcclxuXHRlcnJvckxvZ2dpbmc6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBTa3JpYm9zU2V0dGluZ3MgPSB7XHJcblx0dGVtcGxhdGVGb2xkZXI6IFwiXCIsXHJcblx0c2NyaXB0Rm9sZGVyOiBcIlwiLFxyXG5cdHZlcmJvc2VMb2dnaW5nOiBmYWxzZSxcclxuXHRkZXZMb2dnaW5nOiBmYWxzZSxcclxuXHRlcnJvckxvZ2dpbmc6IGZhbHNlLFxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBSZWdlbnREYXRhIHtcclxuXHRbaW5kZXg6IHN0cmluZ106IGFueSxcclxuXHRjbGFzcz86IHN0cmluZyxcclxuXHRsYWJlbD86IHN0cmluZyxcclxuXHRjbGVhcj86IGJvb2xlYW4sXHJcblx0aG92ZXI/OiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJFcnJvcihlbDogSFRNTEVsZW1lbnQsIGU6IFJlZ2VudERhdGEpIHtcclxuXHRpZiAoZT8uZmxhZyAmJiBlLmZsYWcgPT0gXCJhYm9ydFwiKSB7XHJcblx0XHRyZW5kZXJSZWdlbnQoZWwsIE9iamVjdC5hc3NpZ24oe30sIHtcclxuXHRcdFx0Y2xhc3M6ICdhYm9ydCcsXHJcblx0XHRcdGxhYmVsOiAnc2snLFxyXG5cdFx0XHRob3ZlcjogJ1JlbmRlciBBYm9ydGVkJ1xyXG5cdFx0fSwgZSkpXHJcblx0fSBlbHNlIHtcclxuXHRcdHJlbmRlclJlZ2VudChlbCwge2NsYXNzOiAnZXJyb3InLCBsYWJlbDogJ3NrJywgaG92ZXI6IGU/Lm1zZyB8fCBcIlVua25vd24gRXJyb3JcIiwgY2xlYXI6IHRydWV9KVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcldhaXQoZWw6IEhUTUxFbGVtZW50KSB7XHJcblx0Y29uc3QgcHJlID0gY3JlYXRlRWwoXCJjb2RlXCIsIHtjbHM6IFwic2tyaWJpLXdhaXRcIiwgdGV4dDogXCJza1wifSlcclxuXHRlbC5yZXBsYWNlV2l0aChwcmUpXHJcblx0cmV0dXJuIHByZVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyU3RhdGUoZWw6IEhUTUxFbGVtZW50LCBkYXRhSW46IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwic3RhdGVcIixcclxuXHRcdGxhYmVsOiBcInNrXCIsXHJcblx0XHRjbGVhcjogZmFsc2UsXHJcblx0XHRob3ZlcjogXCJcIlxyXG5cdH0sIGRhdGFJbiB8fCB7fSlcclxuXHJcblx0ZWwuY2xhc3NOYW1lID0gYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWBcclxuXHRlbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVnZW50KGRhdGFJbj86IFJlZ2VudERhdGEpOiBbSFRNTEVsZW1lbnQsIFJlZ2VudERhdGFdIHtcclxuXHRsZXQgZGF0YSA9IE9iamVjdC5hc3NpZ24oe1xyXG5cdFx0Y2xhc3M6IFwiZ2VuZXJpY1wiLFxyXG5cdFx0bGFiZWw6IFwic2tcIixcclxuXHRcdGNsZWFyOiBmYWxzZSxcclxuXHRcdGhvdmVyOiBcIlwiXHJcblx0fSwgZGF0YUluIHx8IHt9KVxyXG5cclxuXHRjb25zdCBwcmUgPSBjcmVhdGVFbChcImNvZGVcIiwge2NsczogYHNrcmliaS1yZWdlbnQgJHtkYXRhLmNsYXNzfWAsIHRleHQ6IGRhdGEubGFiZWx9KVxyXG5cdHByZS5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBkYXRhLmhvdmVyKVxyXG5cclxuXHRyZXR1cm4gW3ByZSwgZGF0YV1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclJlZ2VudChlbDogSFRNTEVsZW1lbnQsIGRhdGFJbj86IFJlZ2VudERhdGEpIHtcclxuXHRsZXQgW3ByZSwgZGF0YV0gPSBjcmVhdGVSZWdlbnQoZGF0YUluKVxyXG5cdGlmIChkYXRhLmNsZWFyKSBlbC5jbGFzc05hbWUgPSBcIlwiO1xyXG5cdGVsLnJlcGxhY2VXaXRoKHByZSlcclxuXHJcblx0cmV0dXJuIHByZVxyXG59IiwiaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgbm9ybWFsaXplUGF0aCwgcGFyc2VGcm9udE1hdHRlclN0cmluZ0FycmF5LCBNYXJrZG93blJlbmRlcmVyLCBzZXRJY29uLCBNYXJrZG93blByZXZpZXdWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgY3JlYXRlUmVnZW50IH0gZnJvbSBcIi4vcmVnZW50XCJcclxuaW1wb3J0IHsgZExvZywgaXNFeHRhbnQgfSBmcm9tIFwiLi4vdXRpbFwiXHJcblxyXG5jb25zdCBleHRJbWcgPSBbXCJibXBcIiwgXCJwbmdcIiwgXCJqcGdcIiwgXCJqcGVnXCIsIFwiZ2lmXCIsIFwic3ZnXCJdXHJcbmNvbnN0IGV4dEF1ZCA9IFtcIm1wM1wiLCBcIndhdlwiLCBcIm00YVwiLCBcIjNncFwiLCBcImZsYWNcIiwgXCJvZ2dcIiwgXCJvZ2FcIl1cclxuY29uc3QgZXh0VmlkID0gW1wibXA0XCIsIFwid2VibVwiLCBcIm9ndlwiXVxyXG5jb25zdCBleHRUeHQgPSBbXCJtZFwiXVxyXG5jb25zdCBleHRQZGYgPSBbXCJwZGZcIl1cclxuXHJcbi8qIFJlcGFpcnMgbWVkaWEgZW1iZWRzIHRoYXQgaGF2ZSBiZWVuIHJlbmRlcmVkIHRvIG1hcmtkb3duICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbWJlZE1lZGlhIChcclxuICBlbDogSFRNTEVsZW1lbnQsIFxyXG4gIHNyY1BhdGg6IHN0cmluZyxcclxuICBwbHVnaW46IFNrcmlib3NQbHVnaW4sXHJcbiAgZGVwdGg/OiBudW1iZXIsXHJcbiAgc2VsZj86IGJvb2xlYW5cclxuKSB7XHJcbiAgZExvZyhcImVtYmVkIHNlbGY6XCIsIHNlbGYpXHJcbiAgZExvZyhcImVtYmVkOlwiLCBlbClcclxuICB2YXIgcHJvbXM6IFByb21pc2U8dm9pZD5bXSA9IFtdXHJcblxyXG4gIGNvbnN0IGNhdGNoZXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwic3Bhbi5pbnRlcm5hbC1lbWJlZFwiKSBcclxuXHJcbiAgbGV0IGVsRGVwdGggPSBlbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKTtcclxuICBsZXQgZCA9IChpc0V4dGFudChlbERlcHRoKSA/IHBhcnNlSW50KGVsRGVwdGgpIDogaXNFeHRhbnQoZGVwdGgpID8gZGVwdGggOiAwKVxyXG5cclxuICBkTG9nKFwiZW1iZWRkZXIgZGVwdGg6XCIsIGQpXHJcblxyXG5cclxuICBmb3IgKGxldCBmaXNoIG9mIEFycmF5LmZyb20oY2F0Y2hlcykpIHtcclxuICAgIGlmIChmaXNoLmhhc0NsYXNzKFwiaXMtbG9hZGVkXCIpKSBjb250aW51ZTtcclxuXHJcbiAgICBsZXQgc3JjID0gbm9ybWFsaXplUGF0aChmaXNoLmdldEF0dHJpYnV0ZShcInNyY1wiKSlcclxuXHJcbiAgICBsZXQgZGVzdCA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChzcmMsIHNyY1BhdGgpXHJcbiAgICBcclxuICAgIGlmIChkZXN0KSB7XHJcbiAgICAgIGxldCBwYXRoID0gcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChkZXN0LnBhdGgpXHJcblxyXG4gICAgICBsZXQgZXh0ID0gZGVzdC5leHRlbnNpb247XHJcblxyXG4gICAgICBpZiAoZXh0SW1nLmNvbnRhaW5zKGV4dCkpIHsvLyBFbWJlZCBJbWFnZVxyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJpbWFnZS1lbWJlZFwiKTtcclxuICAgICAgICBcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiaW1nXCIpO1xyXG4gICAgICAgIG5lbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgcGF0aClcclxuICAgICAgICBcclxuICAgICAgfSBlbHNlIGlmIChleHRBdWQuY29udGFpbnMoZXh0KSkgeyAvLyBFbWJlZCBBdWRpb1xyXG4gICAgICAgIGZpc2guYWRkQ2xhc3MoXCJtZWRpYS1lbWJlZFwiKTtcclxuICAgICAgICBmaXNoLmNoaWxkTm9kZXMuZm9yRWFjaCgobikgPT4ge2Zpc2gucmVtb3ZlQ2hpbGQobil9KVxyXG4gICAgICAgIGxldCBuZWwgPSBmaXNoLmNyZWF0ZUVsKFwiYXVkaW9cIiwge1wiYXR0clwiOiB7XCJjb250cm9sc1wiIDogdHJ1ZX19KTtcclxuICAgICAgICBuZWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFZpZC5jb250YWlucyhleHQpKSB7IC8vIEVtYmVkIFZpZGVvXHJcbiAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuXHJcbiAgICAgICAgbGV0IHZpZGl2ID0gZmlzaC5jcmVhdGVFbChcInZpZGVvXCIsIHtcImF0dHJcIiA6IHtcImNvbnRyb2xzXCIgOiB0cnVlfX0pXHJcbiAgICAgICAgdmlkaXYuc2V0QXR0cmlidXRlKFwic3JjXCIsIHBhdGgpXHJcblxyXG4gICAgICB9IGVsc2UgaWYgKGV4dFR4dC5jb250YWlucyhleHQpKSB7IFxyXG4gICAgICAgIC8qIEVtYmVkIFRyYW5zY2x1c2lvbiAqL1xyXG5cclxuICAgICAgICBjb25zdCBjcmVhdGVFbWJlZFByb21pc2U6ICgpPT5Qcm9taXNlPHZvaWQ+ID0gKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRMb2coXCJuZXcgZW1iZWQgcHJvbVwiKVxyXG5cclxuICAgICAgICAgICAgZmlzaC5jaGlsZE5vZGVzLmZvckVhY2goKG4pID0+IHtmaXNoLnJlbW92ZUNoaWxkKG4pfSlcclxuICBcclxuICAgICAgICAgICAgICBsZXQgY2FjaGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZGVzdC5wYXRoKVxyXG4gICAgICAgICAgICAgIGxldCByZWFkID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGRlc3QpXHJcbiAgICAgICAgICAgICAgbGV0IGNsYXNzZXMgPSBwYXJzZUZyb250TWF0dGVyU3RyaW5nQXJyYXkoY2FjaGU/LmZyb250bWF0dGVyLCBcImNzc2NsYXNzXCIpXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgZGl2ID0gZmlzaC5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZFwifSlcclxuICAgICAgICAgICAgICBsZXQgZGl2dGl0bGUgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtdGl0bGVcIiwgdGV4dDogZGVzdC5iYXNlbmFtZX0pXHJcbiAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBkaXYuY3JlYXRlRGl2KHtjbHM6IFwibWFya2Rvd24tZW1iZWQtY29udGVudFwifSlcclxuICAgICAgICAgICAgICBsZXQgbGluayA9IGRpdi5jcmVhdGVEaXYoe2NsczogXCJtYXJrZG93bi1lbWJlZC1saW5rXCJ9KVxyXG4gICAgICAgICAgICAgIHNldEljb24obGluaywgXCJsaW5rXCIpXHJcbiAgICAgICAgICAgICAgbGluay5vbkNsaWNrRXZlbnQoKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChzcmMsIHNyY1BhdGgpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICAgICAgICBsZXQgcHYgPSBjb250ZW50LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctdmlld1wifSk7IHB2LmFkZENsYXp6KGNsYXNzZXMpO1xyXG4gICAgICAgICAgICAgIGxldCBwcyA9IHB2LmNyZWF0ZURpdih7Y2xzOiBcIm1hcmtkb3duLXByZXZpZXctc2l6ZXIgbWFya2Rvd24tcHJldmlldy1zZWN0aW9uXCJ9KVxyXG4gICAgXHJcbiAgICAgICAgICAgICAgbGV0IG1raCA9IGNyZWF0ZURpdih7YXR0cjoge1wiZGVwdGhcIjogZGVwdGgudG9TdHJpbmcoKX19KVxyXG4gICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24ocmVhZCwgbWtoLCBzcmNQYXRoLCBudWxsKVxyXG4gICAgICAgICAgICAgIGNvbnN0IG1rZTogQ2hpbGROb2RlW10gPSAoQXJyYXkuZnJvbShta2g/LmNoaWxkTm9kZXMgfHwgW10pLm1hcCgobikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKG4uY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7IGxldCBkID0gY3JlYXRlRGl2KCk7IGQuYXBwZW5kKG4uY2xvbmVOb2RlKHRydWUpKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyBsZXQgZCA9IGNyZWF0ZURpdigpOyBkLmFwcGVuZChuKTsgcmV0dXJuIGQ7fSBlbHNlIHJldHVybiBuO30pKTtcclxuXHJcbiAgICAgICAgICAgICAgcHMuYXBwZW5kKC4uLm1rZSk7IC8vcHMuc2V0QXR0cmlidXRlKFwiZGVwdGhcIiwgZC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVtYmVkTWVkaWEocHMsIHNyY1BhdGgsIHBsdWdpbiwgZC0xLCB0cnVlKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkIDw9IDApICB7XHJcbiAgICAgICAgICBsZXQgW2xdID0gY3JlYXRlUmVnZW50KHtjbGFzczogXCJkZXB0aC1saW1pdFwiLCBob3ZlcjogXCJJdCBnb2VzIG9uIGZvcmV2ZXIuLi5cIn0pXHJcbiAgICAgICAgICBmaXNoLnJlcGxhY2VXaXRoKGwpXHJcblxyXG4gICAgICAgICAgZExvZyhcImVtYmVkZGVyIGhpdCBsaW1pdFwiKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm9tcy5wdXNoKGNyZWF0ZUVtYmVkUHJvbWlzZSgpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChwcm9tcykudGhlbih2YWx1ZXMgPT4ge1xyXG4gICAgZExvZyhcImVtYmVkZGVyIGRvbmVcIiwgcHJvbXMpXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb21zLmxlbmd0aClcclxuICB9KVxyXG59IiwiaW1wb3J0IHsgRXZlbnRSZWYsIE1hcmtkb3duUmVuZGVyQ2hpbGQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgU3RyaW5nZGV4IH0gZnJvbSBcInNyYy90eXBlcy90eXBlc1wiO1xyXG5pbXBvcnQgeyBkTG9nIH0gZnJvbSBcInNyYy91dGlsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2tyaWJpQ2hpbGQgZXh0ZW5kcyBNYXJrZG93blJlbmRlckNoaWxkIHtcclxuXHRwYWNrZXQ6IFN0cmluZ2RleFxyXG5cdGludGVydmFsczogbnVtYmVyW10gPSBbXTtcclxuXHJcblx0Y2JPblVubG9hZDogW0Z1bmN0aW9uLCBhbnldW10gPSBbXVxyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKGVsOiBIVE1MRWxlbWVudCkge1xyXG5cdFx0c3VwZXIoZWwpXHJcblx0fVxyXG5cclxuICBwcm92aWRlQ29udGV4dCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGVsOiB0aGlzLmNvbnRhaW5lckVsLFxyXG4gICAgICByZWdpc3RlckludGVydmFsOiB0aGlzLnNrUmVnaXN0ZXJJbnRlcnZhbC5iaW5kKHRoaXMpLFxyXG4gICAgICByZWdpc3RlclVubG9hZDogdGhpcy5za1JlZ2lzdGVyVW5sb2FkLmJpbmQodGhpcyksXHJcbiAgICAgIHJlZ2lzdGVyRXZlbnQ6IHRoaXMuc2tSZWdpc3RlckV2ZW50LmJpbmQodGhpcyksXHJcbiAgICAgIHJlbG9hZDogdGhpcy5yZXJlbmRlciwgLy8gQm91bmQgb24gYXNzaWdubWVudFxyXG4gICAgICBjOiB0aGlzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHRzZXRQYWNrZXQocGFja2V0OiBTdHJpbmdkZXgpIHtcclxuXHRcdGlmICh0aGlzLnBhY2tldCA9PSBudWxsKSB7XHJcblx0XHRcdHRoaXMucGFja2V0ID0gcGFja2V0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0b25sb2FkKCkge31cclxuXHJcblx0Y2xlYXIoKSB7XHJcblx0XHRkTG9nKFwic2tyZWViIGNsZWFyXCIpXHJcblx0XHRmb3IgKGxldCBpIG9mIHRoaXMuaW50ZXJ2YWxzKSB3aW5kb3cuY2xlYXJJbnRlcnZhbChpKTsgLy8gdGhlcmUgbWlnaHQgYmUgY2FzZXMgd2hlcmUgdGhpcyBkb2Vzbid0IGdldCBjYWxsZWQgcHJvcGVybHlcclxuXHRcdGZvciAobGV0IGNiIG9mIHRoaXMuY2JPblVubG9hZCkgY2JbMF0oY2JbMV0pO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7XHJcblx0XHRkTG9nKFwic2tyZWViIHVubG9hZFwiKVxyXG5cdFx0dGhpcy5jbGVhcigpXHJcblx0fVxyXG5cclxuXHJcbiAgLyogUHJvdmlkZXIgRnVuY3Rpb25zICovXHJcbiAgXHJcblx0c2tSZWdpc3RlckludGVydmFsKGNiOiBGdW5jdGlvbiwgdGltZTogbnVtYmVyLCAuLi5hcmdzOiBhbnlbXSkge1xyXG5cdFx0Ly9AdHMtaWdub3JlXHJcblx0XHRsZXQgeCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoLi4uYTogYW55KSA9PiB7IGlmICh0aGlzLl9sb2FkZWQgPT0gZmFsc2UpIHt3aW5kb3cuY2xlYXJJbnRlcnZhbCh4KX1cclxuXHRcdFx0Y2IoLi4uYSl9LCB0aW1lICogMTAwMCwgLi4uYXJncylcclxuXHRcdHRoaXMuaW50ZXJ2YWxzLnB1c2goeClcclxuXHRcdHJldHVybiB4O1xyXG5cdH1cclxuXHJcbiAgc2tSZWdpc3RlckV2ZW50KGV2ZW50OiBFdmVudFJlZikge1xyXG4gICAgZExvZygnU2tDaGlsZCByZWdpc3RlcmVkIGV2ZW50OicsIGV2ZW50KVxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KGV2ZW50KVxyXG4gIH1cclxuXHJcblx0c2tSZWdpc3RlclVubG9hZChjYjogRnVuY3Rpb24sIC4uLmFyZ3M6IGFueVtdKSB7XHJcblx0XHR0aGlzLmNiT25VbmxvYWQucHVzaChbKC4uLng6IGFueSkgPT4gY2IoLi4ueCksIGFyZ3NdKVxyXG5cdH1cclxuXHJcbiAgLy8gQXNzaWduZWQgaW4gcmVuZGVyU2tyaWJpKClcclxuICByZXJlbmRlcigpIHt9XHJcbn0iLCJpbXBvcnQgeyBpc0V4dGFudCB9IGZyb20gXCJzcmMvdXRpbFwiO1xyXG5cclxuLyogQ2hlY2sgaWYgY29kZSBibG9jayBpcyB0aGF0IGdvb2QgZ29vZCBhbmQgaWYgc28gd2hhdCB0eXBlIG9mIGdvb2QgZ29vZCAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJlcGFyc2VTa3JpYmkoZWw6IEhUTUxFbGVtZW50LCBzdHI/OiBzdHJpbmcsIGZsZz86IGFueSkge1xyXG5cdGxldCB0ZXh0ID0gaXNFeHRhbnQoc3RyKSA/IHN0ciA6IGVsLnRleHRDb250ZW50XHJcblx0aWYgKHRleHQubGVuZ3RoIDwgMykgcmV0dXJuO1xyXG5cclxuXHRsZXQgZSA9IHRleHQuc3Vic3RyKHRleHQubGVuZ3RoLTIpXHJcblx0bGV0IHMgPSB0ZXh0LnN1YnN0cigwLCAyKVxyXG5cdFxyXG5cdGlmIChzLnN0YXJ0c1dpdGgoXCJ7XCIpICYmIGUuZW5kc1dpdGgoXCJ9XCIpKSB7XHJcblx0XHRsZXQgZiA9IHNbMV07XHJcblx0XHRsZXQgZmxhZyA9IChmID09IFwiOlwiKSA/IDEgOiAoZiA9PSBcIj1cIikgPyAyIDogKGYgPT0gXCJ+XCIpID8gMyA6IChmID09IFwie1wiKSA/IDQgOiAoZiA9PSBcIi5cIikgPyA1IDogLTE7XHJcblx0XHRpZiAoKGZsYWcgPiAwKSAmJiAoZmxhZyAhPSA0IHx8IChlID09IFwifX1cIikpKSB7XHJcblx0XHRcdHJldHVybiB7ZmxhZzogZmxhZywgdGV4dDogdGV4dC5zdWJzdHJpbmcoMiwgdGV4dC5sZW5ndGggLSAoZmxhZyA9PSA0ID8gMiA6IDEgKSl9XHJcblx0XHR9IGVsc2UgcmV0dXJuXHJcblx0fSBlbHNlIHJldHVyblxyXG59XHJcblxyXG4vKiBQYXJzZSB2YXJpYWJsZXMgaW4gdGVtcGxhdGUgaW52b2NhdGlvbnMgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlU2tyaWJpKHNyYzogc3RyaW5nKTogUHJvbWlzZTx7XHJcblx0aWQ6IHN0cmluZyxcclxuXHRhcmdzOiBhbnlcclxufT4ge1xyXG5cdGxldCBzYSA9IHNyYy5zcGxpdCgvKD88IVtcXFxcXSlcXHwvKVxyXG5cdGxldCBpZCA9IHNhLnNwbGljZSgwLCAxKVswXS50cmltKClcclxuXHJcblx0bGV0IGFyZ3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcclxuXHRmb3IgKGxldCBzZWcgb2Ygc2EpIHtcclxuXHRcdGxldCBzaSA9IHNlZy5pbmRleE9mKFwiOlwiKVxyXG5cdFx0aWYgKHNpID09IC0xKSBjb250aW51ZTtcclxuXHRcdGFyZ3Nbc2VnLnNsaWNlKDAsIHNpKS50cmltKCldID0gc2VnLnNsaWNlKHNpKzEpLnRyaW0oKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7aWQ6IGlkLCBhcmdzOiB7djogYXJnc319O1xyXG59IiwiaW1wb3J0IHsgRnV6enlTdWdnZXN0TW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU3VnZ2VzdGlvbk1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XHJcbiAgcHJpdmF0ZSByZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZDtcclxuXHJcbiAgcHJpdmF0ZSBwbHVnaW46IFNrcmlib3NQbHVnaW5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFNrcmlib3NQbHVnaW4pIHtcclxuICAgIHN1cGVyKHBsdWdpbi5hcHApXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gIH1cclxuXHJcbiAgZ2V0SXRlbXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uZXRhLmdldENhY2hlS2V5cygpXHJcbiAgfVxyXG5cclxuICBnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge3JldHVybiBpdGVtfVxyXG5cclxuICBvbkNob29zZUl0ZW0oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLnJlc29sdmUoaXRlbSlcclxuICB9XHJcblxyXG4gIGFzeW5jIG9wZW5BbmRHZXRWYWx1ZShyZXNvbHZlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCwgcmVqZWN0OiAoKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlXHJcbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdFxyXG4gICAgdGhpcy5vcGVuKClcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBFdGFDb25maWcgfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvY29uZmlnXCI7XHJcbmltcG9ydCB7IENhbGxiYWNrRm4gfSBmcm9tIFwiZXRhL2Rpc3QvdHlwZXMvZmlsZS1oYW5kbGVyc1wiO1xyXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gXCJzcmMvcmVuZGVyL2NoaWxkXCI7XHJcbmltcG9ydCB7IE1vZGVzLCBGbGFncyB9IGZyb20gXCIuL2NvbnN0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrQ29udGV4dCB7XHJcblx0dGltZTogbnVtYmVyLFxyXG5cdGZsYWc6IG51bWJlcixcclxuXHRkZXB0aDogbnVtYmVyLFxyXG5cdGN0eD86IGFueVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFByb2Nlc3Nvck1vZGUge1xyXG5cdHNyY1R5cGU6IE1vZGVzXHJcblx0ZmxhZz86IEZsYWdzXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGVtcGxhdGUge1xyXG5cdGZpbGU6IFRGaWxlXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3RyaW5nZGV4IHtcclxuXHRbaW5kZXg6IHN0cmluZ106IGFueVxyXG59XHJcblxyXG5leHBvcnQgZGVjbGFyZSB0eXBlIFN0cmluZ2RleGVkPFQ+ID0ge1tpbmRleDogc3RyaW5nXTogVH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXJnU2V0IHtbaW5kZXg6IHN0cmluZ106IHN0cmluZyB8IHN0cmluZ1tdfTtcclxuXHJcbmV4cG9ydCBlbnVtIHByb21wdFR5cGVzIHtcclxuICBzdHJpbmcgPSBcInN0cmluZ1wiXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgZmllbGRQcm9tcHQge1xyXG5cdFtpbmRleDogc3RyaW5nXTogYW55XHJcblx0aWQ6IHN0cmluZ1xyXG5cdHR5cGU6IHByb21wdFR5cGVzXHJcblx0bmFtZTogc3RyaW5nXHJcblx0cGxhY2Vob2xkZXI6IHN0cmluZ1xyXG5cdGRlZmF1bHQ6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHNjb3BlZFZhcnMgZXh0ZW5kcyBTdHJpbmdkZXgge1xyXG4gIHNrOiBvYmplY3QsIFxyXG4gIEU6IEV0YUNvbmZpZywgXHJcbiAgY2I/OiBDYWxsYmFja0ZuLCBcclxuICBzY29wZT86IFN0cmluZ2RleFxyXG59XHJcblxyXG5leHBvcnQgZGVjbGFyZSB0eXBlIFRlbXBsYXRlRnVuY3Rpb25TY29wZWQgPSAoc2NvcGU6IHNjb3BlZFZhcnMpID0+IFByb21pc2U8c3RyaW5nPjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRHluYW1pY1N0YXRlIHtcclxuICBlbDogSFRNTEVsZW1lbnQsXHJcbiAgZmlsZTogVEZpbGUsXHJcbiAgY2hpbGQ6IFNrcmliaUNoaWxkXHJcbn0iLCJpbXBvcnQgeyBBYnN0cmFjdFRleHRDb21wb25lbnQsIEVkaXRvciwgRWRpdG9yUmFuZ2VPckNhcmV0LEtleW1hcEV2ZW50SGFuZGxlciwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgZmllbGRQcm9tcHQsIHByb21wdFR5cGVzIH0gZnJvbSBcIi4uL3R5cGVzL3R5cGVzXCI7XHJcbmltcG9ydCB7IGlzRXh0YW50LCB0b0R1cGVSZWNvcmQgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEluc2VydGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBTa3JpYm9zUGx1Z2luO1xyXG4gIHByaXZhdGUgZWRpdG9yOiBFZGl0b3I7XHJcbiAgcHJpdmF0ZSBrZXlwcmVzc1JlZjogS2V5bWFwRXZlbnRIYW5kbGVyO1xyXG5cclxuICBjdXJyZW50SUQ6IHN0cmluZztcclxuICB0ZXh0SW5wdXQ6IEFic3RyYWN0VGV4dENvbXBvbmVudDxhbnk+XHJcblxyXG4gIHZhbEZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogU2tyaWJvc1BsdWdpbiwgZWRpdG9yOiBFZGl0b3IsIGlkOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKHBsdWdpbi5hcHApXHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yO1xyXG5cclxuICAgIHRoaXMuY3VycmVudElEID0gaWQudG9TdHJpbmcoKVxyXG5cclxuICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJza3JpYmktaW5zZXJ0aW9uLW1vZGFsXCIpXHJcbiAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkluc2VydCBTa3JpYmkgVGVtcGxhdGVcIilcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIHRoaXMuY3JlYXRlKClcclxuICB9XHJcblxyXG4gIGNyZWF0ZSgpIHtcclxuICAgIGxldCBzID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBzLmFkZERyb3Bkb3duKChkcm9wKSA9PiB7IGRyb3BcclxuICAgICAgLmFkZE9wdGlvbnModG9EdXBlUmVjb3JkKHRoaXMucGx1Z2luLmV0YS5nZXRDYWNoZUtleXMoKSkpXHJcbiAgICAgIC5zZXRWYWx1ZSh0aGlzLmN1cnJlbnRJRClcclxuICAgICAgLm9uQ2hhbmdlKCh2KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SUQgPSB2XHJcbiAgICAgICAgbGV0IGYgPSB0aGlzLmdlbmVyYXRlRmllbGRzKGZpZWxkc0RpdiwgdGhpcy5jdXJyZW50SUQpO1xyXG4gICAgICAgICgoZi5sZW5ndGggPiAwKSA/IGZbMF0gOiB0aGlzLnRleHRJbnB1dCkuaW5wdXRFbC5mb2N1cygpO1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgZmllbGRzRGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLW1vZGFsLWZpZWxkc1wifSlcclxuXHJcbiAgICBsZXQgdCA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgdC5hZGRUZXh0KCh0ZSkgPT4ge3RoaXMudGV4dElucHV0ID0gdGU7IHJldHVybiB0ZTt9KVxyXG4gICAgdC5zZXROYW1lKFwiQXBwZW5kXCIpXHJcbiAgICB0LnNldHRpbmdFbC5hZGRDbGFzcyhcInNrcmliaS1tb2RhbC1maWVsZC1hcHBlbmRcIilcclxuXHJcbiAgICBsZXQgZiA9IHRoaXMuZ2VuZXJhdGVGaWVsZHMoZmllbGRzRGl2LCB0aGlzLmN1cnJlbnRJRCk7XHJcbiAgICAoKGYubGVuZ3RoID4gMCkgPyBmWzBdIDogdGhpcy50ZXh0SW5wdXQpLmlucHV0RWwuZm9jdXMoKTtcclxuXHJcbiAgICBsZXQgY29uZmlybSA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgbGV0IGNiID0gY29uZmlybS5hZGRCdXR0b24oKGJ1dHRvbikgPT4gYnV0dG9uXHJcbiAgICAgIC5zZXRCdXR0b25UZXh0KFwiSW5zZXJ0XCIpXHJcbiAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuZG9JbnNlcnQoKSkpXHJcblxyXG4gICAgdGhpcy5rZXlwcmVzc1JlZiA9IHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgdGhpcy5kb0luc2VydC5iaW5kKHRoaXMpKVxyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHRoaXMuc2NvcGUudW5yZWdpc3Rlcih0aGlzLmtleXByZXNzUmVmKVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVGaWVsZHMoZWw6IEhUTUxFbGVtZW50LCBpZDogc3RyaW5nKSB7XHJcbiAgICBlbC5lbXB0eSgpO1xyXG5cclxuICAgIHZhciBhcnI6IEFic3RyYWN0VGV4dENvbXBvbmVudDxhbnk+W10gPSBbXTtcclxuXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uZXRhLnRlbXBsYXRlRnJvbnRtYXR0ZXJzLmhhcyhpZCkpIHtcclxuICAgICAgbGV0IGZtID0gdGhpcy5wbHVnaW4uZXRhLnRlbXBsYXRlRnJvbnRtYXR0ZXJzLmdldChpZClcclxuICAgICAgbGV0IHB2ID0gW11cclxuICAgICAgZm9yIChsZXQgdiBvZiBPYmplY3Qua2V5cyhmbSkpIHtcclxuICAgICAgICBpZiAodi5jaGFyQXQoMCk9PVwiX1wiKSB7XHJcbiAgICAgICAgICBsZXQgdm4gPSB2LnN1YnN0cmluZygxKVxyXG4gICAgICAgICAgbGV0IGZtYSA9IHRoaXMucGFyc2VQcm9tcHRWYWwodm4sIGZtW3ZdKVxyXG5cclxuICAgICAgICAgIGxldCBzID0gbmV3IFNldHRpbmcoZWwpXHJcbiAgICAgICAgICBzLnNldHRpbmdFbC5hZGRDbGFzcyhcInNrcmliaS1tb2RhbC10ZW1wbGF0ZS1maWVsZFwiKVxyXG4gICAgICAgICAgaWYgKGZtYS50eXBlID09IHByb21wdFR5cGVzLnN0cmluZykge1xyXG4gICAgICAgICAgICBhcnIucHVzaCh0aGlzLmNyZWF0ZVRleHRGaWVsZChzLCBmbWEpKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcy5zZXROYW1lKGZtYS5uYW1lKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhcnI7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVUZXh0RmllbGQoc2V0OiBTZXR0aW5nLCBmbWE6IGZpZWxkUHJvbXB0KSB7XHJcbiAgICBsZXQgdDtcclxuICAgIHNldC5hZGRUZXh0KCh0ZXh0KSA9PiB7IFxyXG4gICAgICB0ZXh0XHJcbiAgICAgIC5zZXRWYWx1ZShmbWEuZGVmYXVsdClcclxuICAgICAgLnNldFBsYWNlaG9sZGVyKGZtYS5wbGFjZWhvbGRlcilcclxuICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgIHRoaXMudmFsRmllbGRzW2ZtYS5pZF0gPSB2YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgICB0ZXh0LmlucHV0RWwuYWRkQ2xhc3MoXCJza3JpYmktdGV4dC1pbnB1dFwiKVxyXG4gICAgICB0ID0gdGV4dFxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoZm1hLmRlZmF1bHQubGVuZ3RoID4gMCkgdGhpcy52YWxGaWVsZHNbZm1hLmlkXSA9IGZtYS5kZWZhdWx0XHJcblxyXG4gICAgcmV0dXJuIHRcclxuICB9XHJcblxyXG4gIHBhcnNlUHJvbXB0VmFsKGs6IGFueSwgdmFsOiBhbnkpOiBmaWVsZFByb21wdCB7XHJcbiAgICBsZXQgdjogZmllbGRQcm9tcHQgPSB7XHJcbiAgICAgIGlkOiBrLFxyXG4gICAgICB0eXBlOiBwcm9tcHRUeXBlcy5zdHJpbmcsXHJcbiAgICAgIG5hbWU6IGlzRXh0YW50KHZhbD8ubmFtZSkgPyB2YWwubmFtZSA6IGssXHJcbiAgICAgIHBsYWNlaG9sZGVyOiBpc0V4dGFudCh2YWw/LnBsYWNlaG9sZGVyKSA/IHZhbC5wbGFjZWhvbGRlciA6IFwiXCIsXHJcbiAgICAgIGRlZmF1bHQ6IGlzRXh0YW50KHZhbD8uZGVmYXVsdCkgPyB2YWwuZGVmYXVsdCA6IGlzRXh0YW50KHZhbD8uZGVmKSA/IHZhbC5kZWYgOiBcIlwiLFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB2XHJcbiAgfVxyXG5cclxuICBkb0luc2VydCgpIHtcclxuICAgIGxldCBpZCA9IHRoaXMuY3VycmVudElEXHJcblxyXG4gICAgbGV0IG9zZWwgPSB0aGlzLmVkaXRvci5saXN0U2VsZWN0aW9ucygpXHJcbiAgICBcclxuICAgIGxldCB0b0luc2VydCA9IGBcXGB7OiR7aWR9YFxyXG5cclxuICAgIGZvciAobGV0IGUgb2YgT2JqZWN0LmVudHJpZXModGhpcy52YWxGaWVsZHMpKSB7XHJcbiAgICAgIHRvSW5zZXJ0ICs9IGAgfCAke2VbMF19OiAke2VbMV19YFxyXG4gICAgfVxyXG5cclxuICAgIHRvSW5zZXJ0ICs9ICh0aGlzPy50ZXh0SW5wdXQuZ2V0VmFsdWUoKS5sZW5ndGggPiAwKSA/IFwiIHwgXCIgKyB0aGlzLnRleHRJbnB1dC5nZXRWYWx1ZSgpIDogXCJcIlxyXG4gICAgdG9JbnNlcnQgKz0gYH1cXGBgXHJcblxyXG4gICAgdGhpcy5lZGl0b3IuZ2V0RG9jKCkucmVwbGFjZVNlbGVjdGlvbih0b0luc2VydClcclxuXHJcbiAgICBsZXQgbnNlbDogRWRpdG9yUmFuZ2VPckNhcmV0W10gPSBbXSBcclxuICAgIGZvciAobGV0IHAgb2Ygb3NlbCkge25zZWwucHVzaCh7ZnJvbToge2xpbmU6IHAuYW5jaG9yLmxpbmUsIGNoOiBwLmFuY2hvci5jaCArICh0b0luc2VydC5sZW5ndGgpfX0pfVxyXG4gICAgdGhpcy5lZGl0b3IudHJhbnNhY3Rpb24oe3NlbGVjdGlvbnM6IG5zZWx9KVxyXG5cclxuICAgIHRoaXMuY2xvc2UoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQWJzdHJhY3RUZXh0Q29tcG9uZW50LCBLZXltYXBFdmVudEhhbmRsZXIsIE1hcmtkb3duU2VjdGlvbkluZm9ybWF0aW9uLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBNb2RlcyB9IGZyb20gXCJzcmMvdHlwZXMvY29uc3RcIjtcclxuaW1wb3J0IFNrcmlib3NQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHsgYXZlcmFnZSwgIGxpbmtUb0RvY3VtZW50YXRpb24sIG1ha2VFeHRlcm5hbExpbmssIHJvdW5kVG8sIHZMb2cgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5cclxuY29uc3QgbWF4aW11bUl0ZXJhdGlvbnMgPSAxMDAwMFxyXG5cclxuZXhwb3J0IGNsYXNzIFRlc3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBwcml2YXRlIHBsdWdpbjogU2tyaWJvc1BsdWdpbjtcclxuICBwcml2YXRlIGtleXByZXNzUmVmOiBLZXltYXBFdmVudEhhbmRsZXI7XHJcblxyXG4gIHRleHRGaWVsZFRvRXZhbDogQWJzdHJhY3RUZXh0Q29tcG9uZW50PGFueT5cclxuICBpdGVyYXRpb25zOiBudW1iZXIgPSAxMDtcclxuICBtdWx0aUJsb2NrOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIHJlc3VsdHNGaWVsZDogSFRNTEVsZW1lbnRcclxuXHJcbiAgdmFsRmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cclxuXHJcbiAgdGV4dEluOiBzdHJpbmdcclxuICBhdXRvZmlsbDoge1xyXG4gICAgdHlwZTogc3RyaW5nXHJcbiAgICB2YWx1ZTogc3RyaW5nXHJcbiAgfSA9IG51bGxcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBTa3JpYm9zUGx1Z2luLCBhdXRvZmlsbD86IHt0eXBlOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9KSB7XHJcbiAgICBzdXBlcihwbHVnaW4uYXBwKVxyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB0aGlzLmF1dG9maWxsID0gYXV0b2ZpbGxcclxuICAgIFxyXG4gICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcInNrcmliaS10ZXN0LW1vZGFsXCIpXHJcbiAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIlNrcmliaSBQZXJmb3JtYW5jZSBUZXN0XCIpXHJcblxyXG4gICAgbGV0IGRlc2MgPSBjcmVhdGVEaXYoe2NsczogJ3NrcmliaS1tb2RhbC1kZXNjJ30pXHJcbiAgICBtYWtlRXh0ZXJuYWxMaW5rKGRlc2MuY3JlYXRlRWwoJ2EnLCB7dGV4dDogJ0RvY3VtZW50YXRpb24nLCBhdHRyOiB7J2hyZWYnOiBsaW5rVG9Eb2N1bWVudGF0aW9uKCdjb21tYW5kcy9wZXJmb3JtYW5jZScpfX0pKVxyXG5cclxuICAgIGRlc2MuaW5zZXJ0QWZ0ZXIodGhpcy50aXRsZUVsKVxyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgdGhpcy5jcmVhdGUoKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlKCkge1xyXG4gICAgbGV0IGZpZWxkVGV4dFRvRXZhbCA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgZmllbGRUZXh0VG9FdmFsLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7dGhpcy50ZXh0RmllbGRUb0V2YWwgPSB0ZXh0OyByZXR1cm4gdGV4dH0pXHJcbiAgICBmaWVsZFRleHRUb0V2YWwuc2V0TmFtZSgnVGV4dCBUbyBFdmFsdWF0ZScpXHJcbiAgICBmaWVsZFRleHRUb0V2YWwuc2V0RGVzYygnVGV4dCBpcyBldmFsdWF0ZWQgYXMgdGhlIGNvbnRlbnRzIG9mIGEgY29kZSBzcGFuLicpXHJcbiAgICB0aGlzLnRleHRGaWVsZFRvRXZhbC5zZXRQbGFjZWhvbGRlcihge34gY29uc29sZS5sb2coJ0hlbGxvIFdvcmxkJyk7IH1gKVxyXG4gICAgaWYgKHRoaXMuYXV0b2ZpbGwpIHtcclxuICAgICAgZmllbGRUZXh0VG9FdmFsLmluZm9FbC5hcHBlbmQoY3JlYXRlRGl2KHt0ZXh0OiBgQXV0b2ZpbGxlZCBmcm9tICR7dGhpcy5hdXRvZmlsbC50eXBlfWAsIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBza3JpYmktYXV0b2ZpbGwtbm90aWZpY2F0aW9uJ30pKVxyXG4gICAgICB0aGlzLnRleHRGaWVsZFRvRXZhbC5zZXRWYWx1ZSh0aGlzLmF1dG9maWxsLnZhbHVlKVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBmaWVsZEl0ZXJhdGlvbnMgPSBuZXcgU2V0dGluZyh0aGlzLmNvbnRlbnRFbClcclxuICAgIGxldCBpdGVyczogSFRNTElucHV0RWxlbWVudCA9IGZpZWxkSXRlcmF0aW9ucy5jb250cm9sRWwuY3JlYXRlRWwoJ2lucHV0Jywge2F0dHI6IHt0eXBlOiAnbnVtYmVyJ319KVxyXG4gICAgaXRlcnMuZGVmYXVsdFZhbHVlID0gdGhpcy5pdGVyYXRpb25zLnRvU3RyaW5nKClcclxuICAgIGl0ZXJzLm9uY2hhbmdlID0gKGV2KSA9PiB7dGhpcy5pdGVyYXRpb25zID0gaXRlcnMudmFsdWVBc051bWJlcn1cclxuICAgIGZpZWxkSXRlcmF0aW9ucy5zZXROYW1lKCdFdmFsdWF0aW9uIEl0ZXJhdGlvbnMnKVxyXG4gICAgZmllbGRJdGVyYXRpb25zLnNldERlc2MoJ0hvdyBtYW55IHRpbWVzIHNob3VsZCB0aGUgdGV4dCBiZSBldmFsdWF0ZWQ/JylcclxuXHJcbiAgICBsZXQgYmxvY2tTZXR0aW5nID0gbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICBibG9ja1NldHRpbmcuYWRkVG9nZ2xlKCh0b2cpID0+IHtcclxuICAgICAgdG9nLnNldFZhbHVlKHRoaXMubXVsdGlCbG9jaylcclxuICAgICAgdG9nLm9uQ2hhbmdlKCh2KSA9PiB0aGlzLm11bHRpQmxvY2sgPSB2KVxyXG4gICAgICByZXR1cm4gdG9nXHJcbiAgICB9KVxyXG4gICAgYmxvY2tTZXR0aW5nLnNldE5hbWUoJ0V2YWwgQXMgSW5kaXZpZHVhbCBCbG9ja3M/JylcclxuXHJcbiAgICBsZXQgY29uZmlybSA9IG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKS5zZXRDbGFzcygnc2tyaWJpLWJ1dHRvbi1ldmFsJylcclxuICAgIGNvbmZpcm0uYWRkQnV0dG9uKChidXR0b24pID0+IGJ1dHRvblxyXG4gICAgICAuc2V0QnV0dG9uVGV4dChcIkV2YWx1YXRlXCIpXHJcbiAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuZG9FdmFsKCkpKVxyXG4gICAgdGhpcy5rZXlwcmVzc1JlZiA9IHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgdGhpcy5kb0V2YWwuYmluZCh0aGlzKSlcclxuXHJcbiAgICB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbCgnaHInKVxyXG5cclxuICAgIHRoaXMucmVzdWx0c0ZpZWxkID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLXRlc3QtcmVzdWx0cy1maWVsZFwifSlcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICB0aGlzLnNjb3BlLnVucmVnaXN0ZXIodGhpcy5rZXlwcmVzc1JlZilcclxuICB9XHJcblxyXG4gIGFzeW5jIGRvRXZhbCgpIHtcclxuICAgIGxldCBjb250YWluZXIgPSBjcmVhdGVEaXYoKVxyXG4gICAgbGV0IGVsID0gY3JlYXRlRGl2KClcclxuXHJcbiAgICBsZXQgYmxvY2tzVG9Qcm9jZXNzOiBIVE1MRWxlbWVudFtdID0gW11cclxuICAgIGxldCB0b0l0ZXIgPSBNYXRoLm1pbih0aGlzLml0ZXJhdGlvbnMsIClcclxuICAgIGlmICh0aGlzLm11bHRpQmxvY2spIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLml0ZXJhdGlvbnM7IGkrKykge1xyXG4gICAgICAgIGxldCBkID0gY3JlYXRlRGl2KClcclxuICAgICAgICBkLmNyZWF0ZUVsKCdjb2RlJywge3RleHQ6IHRoaXMudGV4dEZpZWxkVG9FdmFsLmdldFZhbHVlKCl9KVxyXG4gICAgICAgIGJsb2Nrc1RvUHJvY2Vzcy5wdXNoKGQpXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBzaW5nbGVEaXYgPSBjcmVhdGVEaXYoKVxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaXRlcmF0aW9uczsgaSsrKSB7XHJcbiAgICAgICAgc2luZ2xlRGl2LmNyZWF0ZUVsKCdjb2RlJywge3RleHQ6IHRoaXMudGV4dEZpZWxkVG9FdmFsLmdldFZhbHVlKCl9KVxyXG4gICAgICB9XHJcbiAgICAgIGJsb2Nrc1RvUHJvY2Vzcy5wdXNoKHNpbmdsZURpdilcclxuICAgIH1cclxuXHJcbiAgICBsZXQgdGltZVN0YXJ0ID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXHJcblxyXG4gICAgY29uc3QgcHJvbXM6IFByb21pc2U8W1tdLCBudW1iZXIsIG51bWJlcl0+W10gPSBibG9ja3NUb1Byb2Nlc3MubWFwKGFzeW5jIChkaXYpID0+IHtcclxuICAgICAgbGV0IHByb21pc2VTdGFydFRpbWUgPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcclxuXHJcbiAgICAgIGxldCBwcm9taXNlID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvY2Vzc29yKHtzcmNUeXBlOiBNb2Rlcy5nZW5lcmFsfSwgZGl2LCB7XHJcbiAgICAgICAgcmVtYWluaW5nTmVzdExldmVsOiA0LFxyXG4gICAgICAgIGRvY0lkOiAnNTU1NTU1NTUnLFxyXG4gICAgICAgIGZyb250bWF0dGVyOiBudWxsLFxyXG4gICAgICAgIHNvdXJjZVBhdGg6IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgsXHJcbiAgICAgICAgYWRkQ2hpbGQ6IChjaGlsZDogYW55KSA9PiB7fSxcclxuICAgICAgICBnZXRTZWN0aW9uSW5mbzogKCkgPT4ge3JldHVybiBudWxsIGFzIE1hcmtkb3duU2VjdGlvbkluZm9ybWF0aW9ufSxcclxuICAgICAgICBjb250YWluZXJFbDogY29udGFpbmVyLFxyXG4gICAgICAgIGVsOiBlbFxyXG4gICAgICB9LCA0LCBmYWxzZSwgbnVsbCkuY2F0Y2goKCkgPT4ge30pXHJcblxyXG4gICAgICByZXR1cm4gW3Byb21pc2UsIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKSwgcHJvbWlzZVN0YXJ0VGltZV0gYXMgYW55XHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucmVzdWx0c0ZpZWxkLnNldFRleHQoJ0V2YWx1YXRpbmcuLi4nKVxyXG5cclxuICAgIGxldCBzZXR0bGVkVmFsdWVzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHByb21zKVxyXG5cclxuICAgIHZMb2coYFBlcmZvcm1hbmNlIHRlc3Qgc2V0dGxlZCBpbjogJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS10aW1lU3RhcnQsIDMpfW1zYClcclxuXHJcbiAgICBsZXQgZnVsbGZpbGxlZDogW1tdLCBudW1iZXIsIG51bWJlcl1bXSA9IHNldHRsZWRWYWx1ZXMubWFwKCh2KSA9PiB7aWYgKHYuc3RhdHVzID09ICdmdWxmaWxsZWQnKSByZXR1cm4gdi52YWx1ZX0pXHJcbiAgICBsZXQgdGltZXMgPSBmdWxsZmlsbGVkLm1hcCgocmVzdWx0KSA9PiAocmVzdWx0WzFdIGFzIG51bWJlciAtIChyZXN1bHRbMl0gYXMgbnVtYmVyKSkpXHJcbiAgICBsZXQgYXZnID0gYXZlcmFnZSguLi50aW1lcylcclxuICAgIHRoaXMucmVzdWx0c0ZpZWxkLnNldFRleHQoYEF2ZXJhZ2UgZnVsZmlsbG1lbnQgdGltZSAoJHt0aW1lcy5sZW5ndGh9IGJsb2NrJHt0aW1lcy5sZW5ndGggPiAxID8gJ3MnIDogJyd9KTogJHtyb3VuZFRvKGF2ZywgMyl9bXNgKVxyXG4gIFxyXG4gICAgZWwuZGV0YWNoKClcclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IGRlYm91bmNlLCBFZGl0b3IsIEV2ZW50UmVmLCBFdmVudHMsIE1hcmtkb3duUG9zdFByb2Nlc3NvciwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgTWFya2Rvd25QcmV2aWV3VmlldywgTWFya2Rvd25SZW5kZXJDaGlsZCwgTWFya2Rvd25SZW5kZXJlciwgTWFya2Rvd25TZWN0aW9uSW5mb3JtYXRpb24sIE1hcmtkb3duU291cmNlVmlldywgTWFya2Rvd25WaWV3LCBQbHVnaW4sIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFdGFIYW5kbGVyIH0gZnJvbSAnLi9ldGEvZXRhJztcclxuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUywgU2tyaWJvc1NldHRpbmdzLCBTa3JpYm9zU2V0dGluZ1RhYiB9IGZyb20gJy4vc2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBkTG9nLCBnZXRQcmV2aWV3VmlldywgaXNFeHRhbnQsIGlzRmlsZSwgcm91bmRUbywgdkxvZyB9IGZyb20gJy4vdXRpbCc7XHJcbmltcG9ydCB7IGVtYmVkTWVkaWEgfSBmcm9tICcuL3JlbmRlci9lbWJlZCc7XHJcbmltcG9ydCB7IE1vZGVzLCBGbGFncywgRUJBUiB9IGZyb20gJy4vdHlwZXMvY29uc3QnO1xyXG5pbXBvcnQgeyBQcm9jZXNzb3JNb2RlLCBTa0NvbnRleHQsIFN0cmluZ2RleCwgVGVtcGxhdGVGdW5jdGlvblNjb3BlZCB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xyXG5pbXBvcnQgeyBTa3JpYmlDaGlsZCB9IGZyb20gJy4vcmVuZGVyL2NoaWxkJztcclxuaW1wb3J0IHsgcHJlcGFyc2VTa3JpYmksIHBhcnNlU2tyaWJpIH0gZnJvbSAnLi9yZW5kZXIvcGFyc2UnO1xyXG5pbXBvcnQgeyByZW5kZXJFcnJvciwgcmVuZGVyUmVnZW50LCByZW5kZXJTdGF0ZSwgcmVuZGVyV2FpdCB9IGZyb20gJy4vcmVuZGVyL3JlZ2VudCc7XHJcbmltcG9ydCB7IFN1Z2dlc3Rpb25Nb2RhbCB9IGZyb20gJy4vbW9kYWwvc3VnZ2VzdGlvbk1vZGFsJztcclxuaW1wb3J0IHsgSW5zZXJ0aW9uTW9kYWwgfSBmcm9tICcuL21vZGFsL2luc2VydGlvbk1vZGFsJztcclxuaW1wb3J0IHsgVGVzdE1vZGFsIH0gZnJvbSAnLi9tb2RhbC90ZXN0TW9kYWwnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2tyaWJvc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblx0c2V0dGluZ3M6IFNrcmlib3NTZXR0aW5ncztcclxuXHRldGE6IEV0YUhhbmRsZXI7XHJcblx0dmFyTmFtZTogc3RyaW5nID0gXCJza1wiO1xyXG5cclxuXHRsb2FkRXZlbnRzID0gbmV3IEV2ZW50cygpO1xyXG5cdHByaXZhdGUgaW5pdExvYWRSZWY6IEV2ZW50UmVmXHJcblx0aW5pdExvYWRlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRjb25zb2xlLmxvZygnU2tyaWJpOiBMb2FkaW5nLi4uJyk7XHJcblxyXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2tyaWJvc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLmV0YSA9IG5ldyBFdGFIYW5kbGVyKHRoaXMpO1xyXG5cclxuXHRcdGxldCBwcm9jZXNzOiBNYXJrZG93blBvc3RQcm9jZXNzb3IgPSBhc3luYyAoZWwsIGN0eCkgPT4geyB0aGlzLnByb2Nlc3Nvcih7c3JjVHlwZTogTW9kZXMuZ2VuZXJhbH0sIGVsLCBjdHgsICkgfVxyXG5cdFx0Ly8gcHJvY2Vzcy5zb3J0T3JkZXIgPSAtNTBcclxuXHRcdHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHByb2Nlc3MoZWwsIGN0eCkpXHJcblxyXG5cdFx0bGV0IHByb2Nlc3NCbG9jayA9IGFzeW5jIChtb2RlOiBQcm9jZXNzb3JNb2RlLCBzdHI6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50LCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpID0+IHsgdGhpcy5wcm9jZXNzb3IobW9kZSwgZWwsIGN0eCwgbnVsbCwgbnVsbCwgc3RyLnRyaW1FbmQoKSkgfVxyXG5cdFx0XHJcblx0XHQoW1tcIm5vcm1hbFwiLCBcIlwiLCBGbGFncy5ub25lXSwgW1wicmF3XCIsIFwiLXJhd1wiLCBGbGFncy5yYXddLCBbXCJsaXRlcmFsXCIsIFwiLWxpdFwiLCBGbGFncy5saXRlcmFsXSwgW1wiaW50ZXJwb2xhdGVcIiwgXCItaW50XCIsIEZsYWdzLmludGVycF0sIFtcImV2YWx1YXRlXCIsIFwiLWV2YWxcIiwgRmxhZ3MuZXZhbF1dKVxyXG5cdFx0LmZvckVhY2goKHYpID0+IHtcclxuXHRcdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKGBza3JpYmkke3ZbMV19YCwgcHJvY2Vzc0Jsb2NrLmJpbmQodGhpcywge3NyY1R5cGU6IE1vZGVzLmJsb2NrLCBmbGFnOiB2WzJdfSkpXHJcblx0XHRcdHRoaXMucmVnaXN0ZXJNYXJrZG93bkNvZGVCbG9ja1Byb2Nlc3Nvcihgc2ske3ZbMV19YCwgcHJvY2Vzc0Jsb2NrLmJpbmQodGhpcywge3NyY1R5cGU6IE1vZGVzLmJsb2NrLCBmbGFnOiB2WzJdfSkpXHJcblx0XHR9KVxyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgZSA9PiB7XHJcblx0XHRcdC8vIGlmIChlPy5wYXJlbnQucGF0aC5jb250YWlucyh0aGlzLnNldHRpbmdzLnRlbXBsYXRlRm9sZGVyKSkgeyBiVXBkYXRlKGUpOyB9XHJcblx0XHR9KSlcclxuXHJcblx0XHR0aGlzLmluaXRMb2FkUmVmID0gdGhpcy5sb2FkRXZlbnRzLm9uKCdpbml0LWxvYWQtY29tcGxldGUnLCAoKSA9PiB7dGhpcy5pbml0TG9hZGVkID0gdHJ1ZTsgZExvZyhcImluaXQtbG9hZC1jb21wbGV0ZVwiKX0pXHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJpbnNlcnQtc2tyaWJpXCIsIG5hbWU6IFwiSW5zZXJ0IFNrcmliaVwiLCBcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IsIHZpZXcpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuaW5pdExvYWRlZCkgcmV0dXJuO1xyXG5cdFx0XHRcdGxldCB4ID0gbmV3IFN1Z2dlc3Rpb25Nb2RhbCh0aGlzKTtcclxuXHRcdFx0XHRuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQsIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZCkgPT4geC5vcGVuQW5kR2V0VmFsdWUocmVzb2x2ZSwgcmVqZWN0KSlcclxuXHRcdFx0XHQudGhlbihyZXN1bHQgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMuZXRhLmhhc1BhcnRpYWwocmVzdWx0KSkge1xyXG5cdFx0XHRcdFx0XHRsZXQgaSA9IG5ldyBJbnNlcnRpb25Nb2RhbCh0aGlzLCBlZGl0b3IsIHJlc3VsdClcclxuXHRcdFx0XHRcdFx0aS5vcGVuKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgKHIpID0+IHt9KTtcclxuXHRcdFx0fX0pXHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJyZWxvYWQtc2NyaXB0c1wiLCBuYW1lOiBcIlJlbG9hZCBTY3JpcHRzXCIsXHJcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5ldGEuYnVzLnNjcmlwdExvYWRlci5yZWxvYWQoKS50aGVuKCgpID0+IGNvbnNvbGUubG9nKFwiU2tyaWJpOiBSZWxvYWRlZCBTY3JpcHRzXCIpKTtcclxuXHRcdFx0fX0pXHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtpZDogXCJ0ZXN0LXBlcmZvcm1hbmNlXCIsIG5hbWU6ICdUZXN0IFBlcmZvcm1hbmNlJywgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0bGV0IHNlbCA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcj8uZ2V0U2VsZWN0aW9uKClcclxuXHRcdFx0bGV0IGNsaXAgPSBhd2FpdCB3aW5kb3cubmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpO1xyXG5cdFx0XHRsZXQgZmlsbCA9IChzZWwgfHwgY2xpcCkgPyB7XHJcblx0XHRcdFx0dHlwZTogc2VsID8gJ1NlbGVjdGlvbicgOiAnQ2xpcGJvYXJkJyxcclxuXHRcdFx0XHR2YWx1ZTogc2VsID8gc2VsIDogY2xpcFxyXG5cdFx0XHR9IDogbnVsbFxyXG5cdFx0XHRcclxuXHRcdFx0bmV3IFRlc3RNb2RhbCh0aGlzLCBmaWxsKS5vcGVuKClcclxuXHRcdH19KVxyXG5cclxuXHRcdC8vIHJlZ2lzdGVyTWlycm9yKHRoaXMpO1xyXG5cdH1cclxuXHRcclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdHRoaXMuZXRhLnVubG9hZCgpXHJcblx0XHR0aGlzLmxvYWRFdmVudHMub2ZmcmVmKHRoaXMuaW5pdExvYWRSZWYpXHJcblx0XHRjb25zb2xlLmxvZygnU2tyaWJpOiBVbmxvYWRpbmcuLi4nKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHByb2Nlc3NvciAoXHJcblx0XHRtb2RlOiBQcm9jZXNzb3JNb2RlLCAvLyAwOiBjb2Rlc3BhbjsgMTogY29kZWJsb2NrO1xyXG5cdFx0ZG9jOiBIVE1MRWxlbWVudCxcclxuXHRcdGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCxcclxuXHRcdGRlcHRoPzogbnVtYmVyLFxyXG5cdFx0c2VsZj86IGJvb2xlYW4sXHJcblx0XHRzcmNJbj86IHN0cmluZ1xyXG5cdCkge1xyXG5cdFx0bGV0IG5lc3RFeHRhbnQgPSBpc0V4dGFudChjdHgucmVtYWluaW5nTmVzdExldmVsKVxyXG5cdFx0bGV0IG5lc3RMZXZlbCA9IG5lc3RFeHRhbnQgPyBjdHgucmVtYWluaW5nTmVzdExldmVsIDogbnVsbDtcclxuXHRcdC8qIG5lc3RFeHRhbnQgbWVhbnMgdGhhdCB3ZSBhcmUgaW5zaWRlIG9mIGEgbmF0dXJhbCB0cmFuc2NsdXNpb24gKi9cclxuXHJcblx0XHRzZWxmID0gaXNFeHRhbnQoc2VsZilcclxuXHRcdGRlcHRoID0gc2VsZiA/IGRlcHRoIDogbnVsbFxyXG5cdFx0Lyogc2VsZiBtZWFucyB0aGF0IHdlIGhhdmUgYmVlbiBjYWxsZWQgYnkgcmVuZGVyU2tyaWJpLCB0byBsb29rIGZvciBjb2RlYmxvY2tzICovXHJcblxyXG5cdFx0bGV0IGVsSGFzRGVwdGggPSBpc0V4dGFudChkb2MuZ2V0QXR0cmlidXRlKFwiZGVwdGhcIikpXHJcblx0XHRsZXQgZWxFbEhhc0RlcHRoID0gaXNFeHRhbnQoY3R4LmVsLmdldEF0dHJpYnV0ZShcImRlcHRoXCIpKVxyXG5cdFx0bGV0IGVsRGVwdGggPSBlbEhhc0RlcHRoID8gcGFyc2VJbnQoZG9jLmdldEF0dHJpYnV0ZShcImRlcHRoXCIpKSA6IGVsRWxIYXNEZXB0aCA/IHBhcnNlSW50KGN0eC5lbC5nZXRBdHRyaWJ1dGUoXCJkZXB0aFwiKSkgOiBudWxsO1xyXG5cdFx0LyogVXNlZCBmb3IgcGFzc2luZyBkZXB0aCB0byB2aXJ0dWFsIGVsZW1lbnRzICh3ZSBtYXkgYmUgaW4gb25lIGV2ZW4gYXMgd2Ugc3BlYWsuLi4pKi9cclxuXHJcblx0XHQvKiBkZXRlcm1pbmUgb3VyIGRlcHRoIGNvbmRpdGlvbiB0eXBlICovXHJcblx0XHRsZXQgZCA9IHNlbGYgPyBkZXB0aCA6IChlbEhhc0RlcHRoIHx8IGVsRWxIYXNEZXB0aCkgPyBlbERlcHRoIDogbmVzdEV4dGFudCA/IG5lc3RMZXZlbCA6IDBcclxuXHJcblx0XHRpZiAoIW5lc3RFeHRhbnQgJiYgIShlbEhhc0RlcHRoIHx8IGVsRWxIYXNEZXB0aCkpIGRMb2coXCJwcm9jZXNzb3Igc2VlcyBubyBkZXB0aFwiKVxyXG5cclxuXHRcdGlmIChlbEhhc0RlcHRoKSB7IFxyXG5cdFx0XHRkTG9nKFwiZWxEZXB0aFwiLCBlbERlcHRoLCBcImRvY1wiLCBkb2MsIFwiZWxcIiwgY3R4LmVsLCBcImNvbkVsXCIsIGN0eC5jb250YWluZXJFbCkgXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRkTG9nKFwicHJvY2Vzc29yOiBcIiwgXCJkb2NcIiwgZG9jLCBcImVsXCIsIGN0eC5lbCwgXCJjb25FbFwiLCBjdHguY29udGFpbmVyRWwsIFwibmVzdFwiLCBjdHgucmVtYWluaW5nTmVzdExldmVsKVxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvKiBEaXNwYXRjaCByZW5kZXIgcHJvbWlzZXMgKi9cclxuXHRcdHZhciBwcm9tczogUHJvbWlzZTxhbnk+W10gPSBbXVxyXG5cdFx0dmFyIHRlbXBzID0gMDtcclxuXHRcdGNvbnN0IGVsQ29kZXMgPSAobW9kZS5zcmNUeXBlID09IE1vZGVzLmJsb2NrKSA/IFtkb2NdIDogZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjb2RlXCIpXHJcblx0XHRpZiAoIShkIDw9IDApKSB7XHJcblx0XHRcdGlmIChmYWxzZSkgeyAvLyBub3Qgc3VyZSB0aGUgdGVtcGxhdGUgcHJldmlldyBpZGVhIGlzIGZlYXNpYmxlXHJcblx0XHRcdFx0bGV0IGYgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KCcnLCBjdHguc291cmNlUGF0aClcclxuXHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy50ZW1wbGF0ZUZvbGRlci5jb250YWlucyhmLnBhcmVudC5wYXRoKSkge1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ2NoZWNrJylcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRcdGxldCB2aWV3ID0gZ2V0UHJldmlld1ZpZXcodGhpcy5hcHApIGFzIE1hcmtkb3duVmlld1xyXG5cdFx0XHRcdFx0bGV0IGVkaXRvciA9IGdldFByZXZpZXdWaWV3KHRoaXMuYXBwLCB0cnVlKT8uZWRpdG9yIHx8IG51bGxcclxuXHJcblx0XHRcdFx0XHRsZXQgcGUgPSB2aWV3LnByZXZpZXdNb2RlLnJlbmRlcmVyLnByZXZpZXdFbFxyXG5cdFx0XHRcdFx0cGUuZW1wdHkoKVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdFx0bGV0IHNoZWxsID0gcGUuY3JlYXRlRGl2KHtjbHM6ICdza3JpYmktdGVtcGxhdGUtcHJldmlldycsIGF0dHI6IHsnZGVwdGgnOiBkfX0pXHJcblx0XHRcdFx0XHR0aGlzLnJlbmRlclNrcmliaShzaGVsbC5jcmVhdGVEaXYoKSwgdmlldy5nZXRWaWV3RGF0YSgpLCBcImxpdGVyYWxcIiwgY3R4LCB7dGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLCBkZXB0aDogZCwgZmxhZzogNH0pXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgdG0gPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdGNvbnN0IGVsUHJvbXMgPSBBcnJheS5mcm9tKGVsQ29kZXMpLm1hcChhc3luYyAoZWwpID0+IHtcclxuXHRcdFx0XHRsZXQgdCA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKTtcclxuXHRcdFx0XHRkTG9nKFwic3RhcnQ6XCIsIHQpXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bGV0IHNyYyA9IChpc0V4dGFudChtb2RlLmZsYWcpICYmIG1vZGUuZmxhZyAhPSBGbGFncy5ub25lKSA/XHJcblx0XHRcdFx0XHR7dGV4dDogc3JjSW4gfHwgZG9jLnRleHRDb250ZW50LCBmbGFnOiBtb2RlLmZsYWd9IDogYXdhaXQgcHJlcGFyc2VTa3JpYmkoZWwpO1xyXG5cclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0aWYgKHNyYyAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdGxldCBuZWwgPSByZW5kZXJSZWdlbnQoZWwsIHtjbGFzczogJ3NrLWxvYWRpbmcnLCBob3ZlcjogJ0V2YWx1YXRpbmcuLi4nfSlcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdGlmIChzcmMuZmxhZyA9PSAxKSB7XHJcblx0XHRcdFx0XHRcdFx0cHJvbXMucHVzaCh0aGlzLnByZWRpY2F0ZSh7ZWw6IG5lbCwgc3JjOiBzcmMudGV4dCwgbWRDdHg6IGN0eCwgc2tDdHg6IHt0aW1lOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCksIGRlcHRoOiBkLCBmbGFnOiBzcmMuZmxhZ319KSk7XHJcblx0XHRcdFx0XHRcdFx0dGVtcHMrKztcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRwcm9tcy5wdXNoKHRoaXMucHJvY2Vzc1NrcmliaShuZWwsIHNyYy50ZXh0LCBjdHgsIHt0aW1lOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCksIGRlcHRoOiBkLCBmbGFnOiBzcmMuZmxhZ30pKVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IFxyXG5cdFx0XHRcdH0gY2F0Y2goZSkge1xyXG5cdFx0XHRcdFx0aWYgKCFlLmZsYWdzLm5vUmVuZGVyKSB7XHJcblx0XHRcdFx0XHRcdHJlbmRlckVycm9yKGVsLCBlKVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXHJcblx0XHRcdH0pXHJcblx0XHRcclxuXHRcdFx0aWYgKC8qIXNlbGYgJiYgKi8hZG9jLmhhc0NsYXNzKFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCIpKSB7XHJcblx0XHRcdFx0bGV0IGFwcyA9IFByb21pc2UuYWxsKGVsUHJvbXMpXHJcblx0XHRcdFx0YXBzLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdFx0UHJvbWlzZS5hbGxTZXR0bGVkKHByb21zKS50aGVuKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0aWYgKHByb21zLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5pbml0TG9hZGVkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2TG9nKGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGh9IHNrcmliaXMgKCR7cm91bmRUbygod2luZG93LnBlcmZvcm1hbmNlLm5vdygpLXRtKSwgNCl9IG1zKSBpbiBFbGVtZW50YCwgZG9jKVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgc3RyID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0ZW1wcyA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHByb21zLmxlbmd0aCAtIHRlbXBzID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN0ciA9IGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGgtdGVtcHN9IGFuZCBxdWV1ZWQgJHt0ZW1wc30gc2tyaWJpc2A7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBzdHIgPSBgUXVldWVkICR7dGVtcHN9IHNrcmliaXNgO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHN0ciA9IGBQcm9jZXNzZWQgJHtwcm9tcy5sZW5ndGgtdGVtcHN9IHNrcmliaXNgO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdHZMb2coc3RyICsgYCAoJHtyb3VuZFRvKCh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktdG0pLCA0KX0gbXMpIGluIEVsZW1lbnRgLCBkb2MpXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChlbFByb21zKVxyXG5cclxuXHRcdFx0cmV0dXJuIHByb21zXHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0LyogRGVwdGggdG9vIGhpZ2ghICovXHJcblxyXG5cdFx0XHRlbENvZGVzLmZvckVhY2goYXN5bmMgKGVsKSA9PiB7XHJcblx0XHRcdFx0cHJlcGFyc2VTa3JpYmkoZWwpLnRoZW4oYXN5bmMgKHNyYykgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKHNyYyAhPSBudWxsKSByZW5kZXJTdGF0ZShlbCwge2hvdmVyOiBcIlJlY3Vyc2lvbiBsaW1pdCByZWFjaGVkIVwiLCBjbGFzczogJ3N0YXNpcyd9KVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH0pXHJcblx0XHRcdGRMb2coXCJwcm9jZXNzb3IgaGl0IGxpbWl0XCIpOyBcclxuXHRcdFx0XHJcblx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoJ0RlcHRoIExpbWl0Jyk7IFxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyogQXdhaXQgaW5pdGlhbCBsb2FkaW5nIG9mIHRlbXBsYXRlcyAqL1xyXG5cdGFzeW5jIHByZWRpY2F0ZShhcmdzOiBhbnkpIHtcclxuXHRcdGxldCBlbCA9IHJlbmRlcldhaXQoYXJncy5lbClcclxuXHJcblx0XHRpZiAoIXRoaXMuaW5pdExvYWRlZCkge1xyXG5cdFx0XHRkTG9nKFwibm90IHlldCBsb2FkZWRcIilcclxuXHRcdFx0dGhpcy5pbml0TG9hZFJlZiA9IHRoaXMubG9hZEV2ZW50cy5vbignaW5pdC1sb2FkLWNvbXBsZXRlJywgYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdHRoaXMuaW5pdExvYWRlZCA9IHRydWVcclxuXHRcdFx0XHRyZXR1cm4gYXdhaXQgdGhpcy5wcm9jZXNzU2tyaWJpVGVtcGxhdGUoZWwsIGFyZ3Muc3JjLCBhcmdzLm1kQ3R4LCBPYmplY3QuYXNzaWduKGFyZ3Muc2tDdHgsIHt0aW1lOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCl9KSlcclxuXHRcdFx0fSlcclxuXHRcdH0gZWxzZSByZXR1cm4gYXdhaXQgdGhpcy5wcm9jZXNzU2tyaWJpVGVtcGxhdGUoZWwsIGFyZ3Muc3JjLCBhcmdzLm1kQ3R4LCBhcmdzLnNrQ3R4KVxyXG5cdH1cclxuXHJcblx0YXN5bmMgcHJvY2Vzc1NrcmliaVRlbXBsYXRlKFxyXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcclxuXHRcdHNyYzogc3RyaW5nLCBcclxuXHRcdG1kQ3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBcclxuXHRcdHNrQ3R4OiBTa0NvbnRleHRcclxuXHQpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdGxldCBwYXJzZWQ6IHtpZDogc3RyaW5nLCBhcmdzOiBhbnl9ID0gbnVsbDtcclxuXHRcdHRyeSB7IHBhcnNlZCA9IGF3YWl0IHBhcnNlU2tyaWJpKHNyYykgfVxyXG5cdFx0Y2F0Y2ggKGUpIHsgcmVuZGVyRXJyb3IoZWwsIGUpOyByZXR1cm4gbnVsbCB9XHJcblx0XHRcclxuXHRcdGlmICh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KFwiXCIsIG1kQ3R4LnNvdXJjZVBhdGgpLmJhc2VuYW1lID09IHBhcnNlZC5pZCkge1xyXG5cdFx0XHRyZW5kZXJSZWdlbnQoZWwsIHtjbGFzczogJ3NlbGYnLCBob3ZlcjogJ1NlbGYgUmVuZGVyIFByb2hpYml0ZWQnfSk7IHJldHVybiBudWxsOyB9XHJcblx0XHRsZXQgdGVtcGxhdGUgPSB0aGlzLmV0YS5nZXRQYXJ0aWFsKHBhcnNlZC5pZClcclxuXHRcdGlmICghaXNFeHRhbnQodGVtcGxhdGUpKSB7XHJcblx0XHRcdGlmICh0aGlzLmV0YS5mYWlsZWRUZW1wbGF0ZXMuaGFzKHBhcnNlZC5pZCkpIHsgcmVuZGVyRXJyb3IoZWwsIHttc2c6IGBUZW1wbGF0ZSAke3BhcnNlZC5pZH0gZmFpbGVkIHRvIGNvbXBpbGUsIGVycm9yOiBcXG5gICsgdGhpcy5ldGEuZmFpbGVkVGVtcGxhdGVzLmdldChwYXJzZWQuaWQpfSkgfVxyXG5cdFx0XHRlbHNlIHtyZW5kZXJFcnJvcihlbCwge21zZzogYE5vIHN1Y2ggdGVtcGxhdGUgXCIke3BhcnNlZC5pZH1cImB9KX1cclxuXHRcdFx0cmV0dXJuIG51bGwgXHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJTa3JpYmkoZWwsIHRlbXBsYXRlLCBwYXJzZWQuaWQsIG1kQ3R4LCBPYmplY3QuYXNzaWduKHt9LCBza0N0eCwge2N0eDogcGFyc2VkLmFyZ3N9KSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBwcm9jZXNzU2tyaWJpKFxyXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcclxuXHRcdHNyYzogc3RyaW5nLCBcclxuXHRcdG1kQ3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBcclxuXHRcdHNrQ3R4OiBTa0NvbnRleHRcclxuXHQpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdGNvbnN0IHByZXAgPSBmdW5jdGlvbiAoc3RyOiBzdHJpbmcsIGZsYWc6IG51bWJlcikge1xyXG5cdFx0XHRzd2l0Y2ggKGZsYWcpIHsgXHJcblx0XHRcdFx0Y2FzZSAyOiByZXR1cm4gYDwlPSR7c3JjfSU+YDsgXHJcblx0XHRcdFx0Y2FzZSAzOiByZXR1cm4gYDwlfiR7c3JjfSU+YDsgXHJcblx0XHRcdFx0Y2FzZSA0OiByZXR1cm4gc3RyO1xyXG5cdFx0XHRcdGNhc2UgNTogcmV0dXJuIGA8JSR7c3JjfSU+YDtcclxuXHRcdFx0fSBcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJTa3JpYmkoZWwsIHByZXAoc3JjLCBza0N0eC5mbGFnKSwgXCJsaXRlcmFsXCIsIG1kQ3R4LCBza0N0eClcclxuXHR9XHJcblxyXG5cdGFzeW5jIHJlbmRlclNrcmliaShcclxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXHJcblx0XHRjb246IHN0cmluZyB8IFRlbXBsYXRlRnVuY3Rpb25TY29wZWQsIFxyXG5cdFx0aWQ6IHN0cmluZywgXHJcblx0XHRtZEN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgXHJcblx0XHRza0N0eDogU2tDb250ZXh0XHJcblx0KTogUHJvbWlzZTxhbnk+IHtcclxuXHRcdGxldCBmaWxlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChcIlwiLCBtZEN0eC5zb3VyY2VQYXRoKVxyXG5cclxuXHRcdGxldCBlID0gY3JlYXRlRGl2KHtjbHM6IFwic2tyaWJpLXJlbmRlci12aXJ0dWFsXCJ9KTtcclxuXHRcdGxldCBjID0gbmV3IFNrcmliaUNoaWxkKGUpXHJcblx0XHRPYmplY3QuYXNzaWduKGMsIHsgcmVyZW5kZXI6ICgoKSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJlXCIpOyBcclxuXHRcdFx0XHRjLmNsZWFyKCk7IFxyXG5cdFx0XHRcdHRoaXMucmVuZGVyU2tyaWJpKGUsIGNvbiwgaWQsIG1kQ3R4LCBza0N0eCl9KS5iaW5kKHRoaXMpXHJcblx0XHRcdH0pIFxyXG5cdFx0XHRcclxuXHRcdGxldCBjdHggPSBPYmplY3QuYXNzaWduKHt9LCBza0N0eD8uY3R4IHx8IHt9LCB7Y2hpbGQ6IGMucHJvdmlkZUNvbnRleHQoKX0pXHJcblxyXG5cdFx0bGV0IFtyZW5kZXJlZCwgcGFja2V0XTogW3N0cmluZywgU3RyaW5nZGV4XSA9IGF3YWl0IHRoaXMuZXRhLnJlbmRlckFzeW5jKGNvbiwgY3R4LCBmaWxlKS5jYXRjaCgoZXJyKSA9PiB7XHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmVycm9yTG9nZ2luZykgY29uc29sZS53YXJuKGBTa3JpYmkgcmVuZGVyIHRocmV3IGVycm9yISBEaXNwbGF5aW5nIGNvbnRlbnQgYW5kIGVycm9yLi4uYCwgRUJBUiwgY29uLCBFQkFSLCBlcnIpO1xyXG5cdFx0XHRyZW5kZXJFcnJvcihlbCwgKGVycj8uaGFzRGF0YSkgPyBlcnIgOiB7bXNnOiBlcnI/Lm1zZyB8fCBlcnIgfHwgXCJSZW5kZXIgRXJyb3JcIn0pXHJcblx0XHRcdGMudW5sb2FkKClcclxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKVxyXG5cdFx0fSlcclxuXHRcdFxyXG5cdFx0ZExvZyhcInJlbmRlclNrcmliOlwiLCBlbCwgbWRDdHgsIHNrQ3R4LCBpZClcclxuXHRcdGlmIChpc0V4dGFudChyZW5kZXJlZCkpIHtcclxuXHRcdFx0bGV0IGQgPSBpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpID8gbWRDdHgucmVtYWluaW5nTmVzdExldmVsIDogKHNrQ3R4LmRlcHRoKVxyXG5cdFx0XHRsZXQgciA9IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24ocmVuZGVyZWQsIGUsIG1kQ3R4LnNvdXJjZVBhdGgsIG51bGwpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdGUuc2V0QXR0cmlidXRlKFwic2tyaWJpXCIsIGlkKTsgLy9lLnNldEF0dHJpYnV0ZShcImRlcHRoXCIsIGQudG9TdHJpbmcoKSk7XHJcblx0XHRcdFx0ZS5yZW1vdmVDbGFzcyhcInNrcmliaS1yZW5kZXItdmlydHVhbFwiKVxyXG5cdFx0XHRcdGVsLnJlcGxhY2VXaXRoKGUpOyBkTG9nKFwiZmluaXNoOiBcIiwgc2tDdHgudGltZSwgd2luZG93LnBlcmZvcm1hbmNlLm5vdygpKVxyXG5cdFx0XHRcdGlmIChza0N0eC5mbGFnID09IDEpIHtcclxuXHRcdFx0XHRcdHZMb2coYFJlbmRlcmVkIHRlbXBsYXRlIFwiJHtpZH1cIiAoJHtyb3VuZFRvKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKS1za0N0eC50aW1lLCA0KX0gbXMpYCwgZSlcclxuXHRcdFx0XHR9IGVsc2UgdkxvZyhgUmVuZGVyZWQgbGl0ZXJhbCAoZjogJHtza0N0eC5mbGFnfSkgKCR7cm91bmRUbyh3aW5kb3cucGVyZm9ybWFuY2Uubm93KCktc2tDdHgudGltZSwgNCl9IG1zKWAsIGUpXHJcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShlKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRjLnNldFBhY2tldChwYWNrZXQpXHJcblx0XHRcdG1kQ3R4LmFkZENoaWxkKGMpO1xyXG5cdFx0XHRcclxuXHRcdFx0ci50aGVuKChlKTogUHJvbWlzZTxhbnk+ID0+IHtcclxuXHRcdFx0XHQvLyBUT0RPOiBvbmx5IHJlc3RyaWN0IGRlcHRoIGZvciB0cmFuc2NsdXNpb25zXHJcblx0XHRcdFx0aWYgKGlzRXh0YW50KG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCkgJiYgKG1kQ3R4LnJlbWFpbmluZ05lc3RMZXZlbCA+IDApIHx8ICFpc0V4dGFudChtZEN0eC5yZW1haW5pbmdOZXN0TGV2ZWwpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZW1iZWRNZWRpYShlLCBtZEN0eC5zb3VyY2VQYXRoLCB0aGlzLCBza0N0eC5kZXB0aCkgXHJcblx0XHRcdFx0fSBlbHNlIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxyXG5cdFx0XHRcdC8vZS5zZXRBdHRyaWJ1dGUoXCJkZXB0aFwiLCBkLnRvU3RyaW5nKCkpXHJcblxyXG5cdFx0XHR9KVxyXG5cdFx0XHQudGhlbigoeCkgPT4ge1xyXG5cdFx0XHRcdGRMb2coXCJyZW5kZXJlciBmaW5hbDogXCIsIGQpXHJcblx0XHRcdFx0Ly8gZS5zZXRBdHRyaWJ1dGUoXCJkZXB0aFwiLCBkLnRvU3RyaW5nKCkpXHJcblx0XHRcdFx0dGhpcy5wcm9jZXNzb3Ioe3NyY1R5cGU6IE1vZGVzLmdlbmVyYWx9LCBlLCBtZEN0eCwgc2tDdHguZGVwdGgtMSwgdHJ1ZSkgLyogUmVjdXJzZSB0aGUgcHJvY2Vzc29yIHRvIHBhcnNlIHNrcmVlYmxpbmdzICovXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHRyZXR1cm4gcjtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGMuY2xlYXIoKTtcclxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KFwiUmVuZGVyIEVycm9yXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxufSJdLCJuYW1lcyI6WyJwcm9taXNlSW1wbCIsImhhc093blByb3AiLCJjb3B5UHJvcHMiLCJDYWNoZXIiLCJyZXNvbHZlIiwiZGlybmFtZSIsImV4dG5hbWUiLCJleGlzdHNTeW5jIiwicmVhZEZpbGVTeW5jIiwiTW9kYWwiLCJub3JtYWxpemVQYXRoIiwiVEZvbGRlciIsIlZhdWx0IiwiVEZpbGUiLCJFdGEuZ2V0Q29uZmlnIiwiTWFya2Rvd25SZW5kZXJlciIsIkZpbGVTeXN0ZW1BZGFwdGVyIiwiRXRhLmNvbXBpbGVUb1N0cmluZyIsIkV0YS5yZW5kZXJBc3luYyIsIkV0YS5yZW5kZXIiLCJQbHVnaW5TZXR0aW5nVGFiIiwiZGVib3VuY2UiLCJTZXR0aW5nIiwicGFyc2VGcm9udE1hdHRlclN0cmluZ0FycmF5Iiwic2V0SWNvbiIsIk1hcmtkb3duUmVuZGVyQ2hpbGQiLCJGdXp6eVN1Z2dlc3RNb2RhbCIsIlBsdWdpbiIsIkV2ZW50cyIsIk1hcmtkb3duVmlldyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdURBO0FBQ08sU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQzdELElBQUksU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxLQUFLLFlBQVksQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0FBQ2hILElBQUksT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEdB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
